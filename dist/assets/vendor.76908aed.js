var ak=Object.defineProperty,lk=Object.defineProperties;var ck=Object.getOwnPropertyDescriptors;var Fp=Object.getOwnPropertySymbols;var Ix=Object.prototype.hasOwnProperty,Ax=Object.prototype.propertyIsEnumerable;var Mx=(t,n,s)=>n in t?ak(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s,bt=(t,n)=>{for(var s in n||(n={}))Ix.call(n,s)&&Mx(t,s,n[s]);if(Fp)for(var s of Fp(n))Ax.call(n,s)&&Mx(t,s,n[s]);return t},Sn=(t,n)=>lk(t,ck(n));var kr=(t,n)=>{var s={};for(var h in t)Ix.call(t,h)&&n.indexOf(h)<0&&(s[h]=t[h]);if(t!=null&&Fp)for(var h of Fp(t))n.indexOf(h)<0&&Ax.call(t,h)&&(s[h]=t[h]);return s};function uk(t,n){return n.forEach(function(s){s&&typeof s!="string"&&!Array.isArray(s)&&Object.keys(s).forEach(function(h){if(h!=="default"&&!(h in t)){var g=Object.getOwnPropertyDescriptor(s,h);Object.defineProperty(t,h,g.get?g:{enumerable:!0,get:function(){return s[h]}})}})}),Object.freeze(t)}var hk=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},te={exports:{}},rn={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Px=Object.getOwnPropertySymbols,dk=Object.prototype.hasOwnProperty,pk=Object.prototype.propertyIsEnumerable;function fk(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function mk(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var n={},s=0;s<10;s++)n["_"+String.fromCharCode(s)]=s;var h=Object.getOwnPropertyNames(n).map(function(x){return n[x]});if(h.join("")!=="0123456789")return!1;var g={};return"abcdefghijklmnopqrst".split("").forEach(function(x){g[x]=x}),Object.keys(Object.assign({},g)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var zx=mk()?Object.assign:function(t,n){for(var s,h=fk(t),g,x=1;x<arguments.length;x++){s=Object(arguments[x]);for(var E in s)dk.call(s,E)&&(h[E]=s[E]);if(Px){g=Px(s);for(var a=0;a<g.length;a++)pk.call(s,g[a])&&(h[g[a]]=s[g[a]])}}return h};/** @license React v17.0.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zg=zx,mc=60103,Dx=60106;rn.Fragment=60107;rn.StrictMode=60108;rn.Profiler=60114;var Rx=60109,Lx=60110,Ox=60112;rn.Suspense=60113;var Bx=60115,Fx=60116;if(typeof Symbol=="function"&&Symbol.for){var Ki=Symbol.for;mc=Ki("react.element"),Dx=Ki("react.portal"),rn.Fragment=Ki("react.fragment"),rn.StrictMode=Ki("react.strict_mode"),rn.Profiler=Ki("react.profiler"),Rx=Ki("react.provider"),Lx=Ki("react.context"),Ox=Ki("react.forward_ref"),rn.Suspense=Ki("react.suspense"),Bx=Ki("react.memo"),Fx=Ki("react.lazy")}var $x=typeof Symbol=="function"&&Symbol.iterator;function gk(t){return t===null||typeof t!="object"?null:(t=$x&&t[$x]||t["@@iterator"],typeof t=="function"?t:null)}function ih(t){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Nx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ux={};function gc(t,n,s){this.props=t,this.context=n,this.refs=Ux,this.updater=s||Nx}gc.prototype.isReactComponent={};gc.prototype.setState=function(t,n){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error(ih(85));this.updater.enqueueSetState(this,t,n,"setState")};gc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function jx(){}jx.prototype=gc.prototype;function Dg(t,n,s){this.props=t,this.context=n,this.refs=Ux,this.updater=s||Nx}var Rg=Dg.prototype=new jx;Rg.constructor=Dg;zg(Rg,gc.prototype);Rg.isPureReactComponent=!0;var Lg={current:null},Vx=Object.prototype.hasOwnProperty,Gx={key:!0,ref:!0,__self:!0,__source:!0};function Zx(t,n,s){var h,g={},x=null,E=null;if(n!=null)for(h in n.ref!==void 0&&(E=n.ref),n.key!==void 0&&(x=""+n.key),n)Vx.call(n,h)&&!Gx.hasOwnProperty(h)&&(g[h]=n[h]);var a=arguments.length-2;if(a===1)g.children=s;else if(1<a){for(var A=Array(a),D=0;D<a;D++)A[D]=arguments[D+2];g.children=A}if(t&&t.defaultProps)for(h in a=t.defaultProps,a)g[h]===void 0&&(g[h]=a[h]);return{$$typeof:mc,type:t,key:x,ref:E,props:g,_owner:Lg.current}}function _k(t,n){return{$$typeof:mc,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}function Og(t){return typeof t=="object"&&t!==null&&t.$$typeof===mc}function yk(t){var n={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return n[s]})}var qx=/\/+/g;function Bg(t,n){return typeof t=="object"&&t!==null&&t.key!=null?yk(""+t.key):n.toString(36)}function $p(t,n,s,h,g){var x=typeof t;(x==="undefined"||x==="boolean")&&(t=null);var E=!1;if(t===null)E=!0;else switch(x){case"string":case"number":E=!0;break;case"object":switch(t.$$typeof){case mc:case Dx:E=!0}}if(E)return E=t,g=g(E),t=h===""?"."+Bg(E,0):h,Array.isArray(g)?(s="",t!=null&&(s=t.replace(qx,"$&/")+"/"),$p(g,n,s,"",function(D){return D})):g!=null&&(Og(g)&&(g=_k(g,s+(!g.key||E&&E.key===g.key?"":(""+g.key).replace(qx,"$&/")+"/")+t)),n.push(g)),1;if(E=0,h=h===""?".":h+":",Array.isArray(t))for(var a=0;a<t.length;a++){x=t[a];var A=h+Bg(x,a);E+=$p(x,n,s,A,g)}else if(A=gk(t),typeof A=="function")for(t=A.call(t),a=0;!(x=t.next()).done;)x=x.value,A=h+Bg(x,a++),E+=$p(x,n,s,A,g);else if(x==="object")throw n=""+t,Error(ih(31,n==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":n));return E}function Np(t,n,s){if(t==null)return t;var h=[],g=0;return $p(t,h,"","",function(x){return n.call(s,x,g++)}),h}function vk(t){if(t._status===-1){var n=t._result;n=n(),t._status=0,t._result=n,n.then(function(s){t._status===0&&(s=s.default,t._status=1,t._result=s)},function(s){t._status===0&&(t._status=2,t._result=s)})}if(t._status===1)return t._result;throw t._result}var Wx={current:null};function Qo(){var t=Wx.current;if(t===null)throw Error(ih(321));return t}var xk={ReactCurrentDispatcher:Wx,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:Lg,IsSomeRendererActing:{current:!1},assign:zg};rn.Children={map:Np,forEach:function(t,n,s){Np(t,function(){n.apply(this,arguments)},s)},count:function(t){var n=0;return Np(t,function(){n++}),n},toArray:function(t){return Np(t,function(n){return n})||[]},only:function(t){if(!Og(t))throw Error(ih(143));return t}};rn.Component=gc;rn.PureComponent=Dg;rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xk;rn.cloneElement=function(t,n,s){if(t==null)throw Error(ih(267,t));var h=zg({},t.props),g=t.key,x=t.ref,E=t._owner;if(n!=null){if(n.ref!==void 0&&(x=n.ref,E=Lg.current),n.key!==void 0&&(g=""+n.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(A in n)Vx.call(n,A)&&!Gx.hasOwnProperty(A)&&(h[A]=n[A]===void 0&&a!==void 0?a[A]:n[A])}var A=arguments.length-2;if(A===1)h.children=s;else if(1<A){a=Array(A);for(var D=0;D<A;D++)a[D]=arguments[D+2];h.children=a}return{$$typeof:mc,type:t.type,key:g,ref:x,props:h,_owner:E}};rn.createContext=function(t,n){return n===void 0&&(n=null),t={$$typeof:Lx,_calculateChangedBits:n,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider={$$typeof:Rx,_context:t},t.Consumer=t};rn.createElement=Zx;rn.createFactory=function(t){var n=Zx.bind(null,t);return n.type=t,n};rn.createRef=function(){return{current:null}};rn.forwardRef=function(t){return{$$typeof:Ox,render:t}};rn.isValidElement=Og;rn.lazy=function(t){return{$$typeof:Fx,_payload:{_status:-1,_result:t},_init:vk}};rn.memo=function(t,n){return{$$typeof:Bx,type:t,compare:n===void 0?null:n}};rn.useCallback=function(t,n){return Qo().useCallback(t,n)};rn.useContext=function(t,n){return Qo().useContext(t,n)};rn.useDebugValue=function(){};rn.useEffect=function(t,n){return Qo().useEffect(t,n)};rn.useImperativeHandle=function(t,n,s){return Qo().useImperativeHandle(t,n,s)};rn.useLayoutEffect=function(t,n){return Qo().useLayoutEffect(t,n)};rn.useMemo=function(t,n){return Qo().useMemo(t,n)};rn.useReducer=function(t,n,s){return Qo().useReducer(t,n,s)};rn.useRef=function(t){return Qo().useRef(t)};rn.useState=function(t){return Qo().useState(t)};rn.version="17.0.2";te.exports=rn;var Nt=te.exports,bk=Object.freeze(uk({__proto__:null,[Symbol.toStringTag]:"Module",default:Nt},[te.exports])),Hx={exports:{}},Pi={},Xx={exports:{}},Kx={};/** @license React v0.20.2
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){var n,s,h,g;if(typeof performance=="object"&&typeof performance.now=="function"){var x=performance;t.unstable_now=function(){return x.now()}}else{var E=Date,a=E.now();t.unstable_now=function(){return E.now()-a}}if(typeof window=="undefined"||typeof MessageChannel!="function"){var A=null,D=null,V=function(){if(A!==null)try{var Ze=t.unstable_now();A(!0,Ze),A=null}catch(_t){throw setTimeout(V,0),_t}};n=function(Ze){A!==null?setTimeout(n,0,Ze):(A=Ze,setTimeout(V,0))},s=function(Ze,_t){D=setTimeout(Ze,_t)},h=function(){clearTimeout(D)},t.unstable_shouldYield=function(){return!1},g=t.unstable_forceFrameRate=function(){}}else{var N=window.setTimeout,F=window.clearTimeout;if(typeof console!="undefined"){var ae=window.cancelAnimationFrame;typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),typeof ae!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var be=!1,fe=null,ee=-1,G=5,X=0;t.unstable_shouldYield=function(){return t.unstable_now()>=X},g=function(){},t.unstable_forceFrameRate=function(Ze){0>Ze||125<Ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<Ze?Math.floor(1e3/Ze):5};var me=new MessageChannel,Te=me.port2;me.port1.onmessage=function(){if(fe!==null){var Ze=t.unstable_now();X=Ze+G;try{fe(!0,Ze)?Te.postMessage(null):(be=!1,fe=null)}catch(_t){throw Te.postMessage(null),_t}}else be=!1},n=function(Ze){fe=Ze,be||(be=!0,Te.postMessage(null))},s=function(Ze,_t){ee=N(function(){Ze(t.unstable_now())},_t)},h=function(){F(ee),ee=-1}}function We(Ze,_t){var dt=Ze.length;Ze.push(_t);e:for(;;){var Ut=dt-1>>>1,vn=Ze[Ut];if(vn!==void 0&&0<Ke(vn,_t))Ze[Ut]=_t,Ze[dt]=vn,dt=Ut;else break e}}function Pe(Ze){return Ze=Ze[0],Ze===void 0?null:Ze}function Le(Ze){var _t=Ze[0];if(_t!==void 0){var dt=Ze.pop();if(dt!==_t){Ze[0]=dt;e:for(var Ut=0,vn=Ze.length;Ut<vn;){var wn=2*(Ut+1)-1,An=Ze[wn],ur=wn+1,It=Ze[ur];if(An!==void 0&&0>Ke(An,dt))It!==void 0&&0>Ke(It,An)?(Ze[Ut]=It,Ze[ur]=dt,Ut=ur):(Ze[Ut]=An,Ze[wn]=dt,Ut=wn);else if(It!==void 0&&0>Ke(It,dt))Ze[Ut]=It,Ze[ur]=dt,Ut=ur;else break e}}return _t}return null}function Ke(Ze,_t){var dt=Ze.sortIndex-_t.sortIndex;return dt!==0?dt:Ze.id-_t.id}var Ye=[],it=[],st=1,ut=null,ht=3,kt=!1,Tt=!1,Gt=!1;function nn(Ze){for(var _t=Pe(it);_t!==null;){if(_t.callback===null)Le(it);else if(_t.startTime<=Ze)Le(it),_t.sortIndex=_t.expirationTime,We(Ye,_t);else break;_t=Pe(it)}}function an(Ze){if(Gt=!1,nn(Ze),!Tt)if(Pe(Ye)!==null)Tt=!0,n(In);else{var _t=Pe(it);_t!==null&&s(an,_t.startTime-Ze)}}function In(Ze,_t){Tt=!1,Gt&&(Gt=!1,h()),kt=!0;var dt=ht;try{for(nn(_t),ut=Pe(Ye);ut!==null&&(!(ut.expirationTime>_t)||Ze&&!t.unstable_shouldYield());){var Ut=ut.callback;if(typeof Ut=="function"){ut.callback=null,ht=ut.priorityLevel;var vn=Ut(ut.expirationTime<=_t);_t=t.unstable_now(),typeof vn=="function"?ut.callback=vn:ut===Pe(Ye)&&Le(Ye),nn(_t)}else Le(Ye);ut=Pe(Ye)}if(ut!==null)var wn=!0;else{var An=Pe(it);An!==null&&s(an,An.startTime-_t),wn=!1}return wn}finally{ut=null,ht=dt,kt=!1}}var er=g;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ze){Ze.callback=null},t.unstable_continueExecution=function(){Tt||kt||(Tt=!0,n(In))},t.unstable_getCurrentPriorityLevel=function(){return ht},t.unstable_getFirstCallbackNode=function(){return Pe(Ye)},t.unstable_next=function(Ze){switch(ht){case 1:case 2:case 3:var _t=3;break;default:_t=ht}var dt=ht;ht=_t;try{return Ze()}finally{ht=dt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=er,t.unstable_runWithPriority=function(Ze,_t){switch(Ze){case 1:case 2:case 3:case 4:case 5:break;default:Ze=3}var dt=ht;ht=Ze;try{return _t()}finally{ht=dt}},t.unstable_scheduleCallback=function(Ze,_t,dt){var Ut=t.unstable_now();switch(typeof dt=="object"&&dt!==null?(dt=dt.delay,dt=typeof dt=="number"&&0<dt?Ut+dt:Ut):dt=Ut,Ze){case 1:var vn=-1;break;case 2:vn=250;break;case 5:vn=1073741823;break;case 4:vn=1e4;break;default:vn=5e3}return vn=dt+vn,Ze={id:st++,callback:_t,priorityLevel:Ze,startTime:dt,expirationTime:vn,sortIndex:-1},dt>Ut?(Ze.sortIndex=dt,We(it,Ze),Pe(Ye)===null&&Ze===Pe(it)&&(Gt?h():Gt=!0,s(an,dt-Ut))):(Ze.sortIndex=vn,We(Ye,Ze),Tt||kt||(Tt=!0,n(In))),Ze},t.unstable_wrapCallback=function(Ze){var _t=ht;return function(){var dt=ht;ht=_t;try{return Ze.apply(this,arguments)}finally{ht=dt}}}})(Kx);Xx.exports=Kx;/** @license React v17.0.2
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Up=te.exports,zn=zx,br=Xx.exports;function rt(t){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!Up)throw Error(rt(227));var Yx=new Set,oh={};function Va(t,n){_c(t,n),_c(t+"Capture",n)}function _c(t,n){for(oh[t]=n,t=0;t<n.length;t++)Yx.add(n[t])}var es=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),wk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jx=Object.prototype.hasOwnProperty,Qx={},e1={};function Ek(t){return Jx.call(e1,t)?!0:Jx.call(Qx,t)?!1:wk.test(t)?e1[t]=!0:(Qx[t]=!0,!1)}function Tk(t,n,s,h){if(s!==null&&s.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return h?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Sk(t,n,s,h){if(n===null||typeof n=="undefined"||Tk(t,n,s,h))return!0;if(h)return!1;if(s!==null)switch(s.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function qr(t,n,s,h,g,x,E){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=h,this.attributeNamespace=g,this.mustUseProperty=s,this.propertyName=t,this.type=n,this.sanitizeURL=x,this.removeEmptyString=E}var Ir={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ir[t]=new qr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var n=t[0];Ir[n]=new qr(n,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ir[t]=new qr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ir[t]=new qr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ir[t]=new qr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ir[t]=new qr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ir[t]=new qr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ir[t]=new qr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ir[t]=new qr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Fg=/[\-:]([a-z])/g;function $g(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var n=t.replace(Fg,$g);Ir[n]=new qr(n,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var n=t.replace(Fg,$g);Ir[n]=new qr(n,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var n=t.replace(Fg,$g);Ir[n]=new qr(n,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ir[t]=new qr(t,1,!1,t.toLowerCase(),null,!1,!1)});Ir.xlinkHref=new qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ir[t]=new qr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ng(t,n,s,h){var g=Ir.hasOwnProperty(n)?Ir[n]:null,x=g!==null?g.type===0:h?!1:!(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N");x||(Sk(n,s,g,h)&&(s=null),h||g===null?Ek(n)&&(s===null?t.removeAttribute(n):t.setAttribute(n,""+s)):g.mustUseProperty?t[g.propertyName]=s===null?g.type===3?!1:"":s:(n=g.attributeName,h=g.attributeNamespace,s===null?t.removeAttribute(n):(g=g.type,s=g===3||g===4&&s===!0?"":""+s,h?t.setAttributeNS(h,n,s):t.setAttribute(n,s))))}var Ga=Up.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sh=60103,Za=60106,Vs=60107,Ug=60108,ah=60114,jg=60109,Vg=60110,jp=60112,lh=60113,Vp=60120,Gp=60115,Gg=60116,Zg=60121,qg=60128,t1=60129,Wg=60130,Hg=60131;if(typeof Symbol=="function"&&Symbol.for){var wr=Symbol.for;sh=wr("react.element"),Za=wr("react.portal"),Vs=wr("react.fragment"),Ug=wr("react.strict_mode"),ah=wr("react.profiler"),jg=wr("react.provider"),Vg=wr("react.context"),jp=wr("react.forward_ref"),lh=wr("react.suspense"),Vp=wr("react.suspense_list"),Gp=wr("react.memo"),Gg=wr("react.lazy"),Zg=wr("react.block"),wr("react.scope"),qg=wr("react.opaque.id"),t1=wr("react.debug_trace_mode"),Wg=wr("react.offscreen"),Hg=wr("react.legacy_hidden")}var n1=typeof Symbol=="function"&&Symbol.iterator;function ch(t){return t===null||typeof t!="object"?null:(t=n1&&t[n1]||t["@@iterator"],typeof t=="function"?t:null)}var Xg;function uh(t){if(Xg===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);Xg=n&&n[1]||""}return`
`+Xg+t}var Kg=!1;function Zp(t,n){if(!t||Kg)return"";Kg=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(A){var h=A}Reflect.construct(t,[],n)}else{try{n.call()}catch(A){h=A}t.call(n.prototype)}else{try{throw Error()}catch(A){h=A}t()}}catch(A){if(A&&h&&typeof A.stack=="string"){for(var g=A.stack.split(`
`),x=h.stack.split(`
`),E=g.length-1,a=x.length-1;1<=E&&0<=a&&g[E]!==x[a];)a--;for(;1<=E&&0<=a;E--,a--)if(g[E]!==x[a]){if(E!==1||a!==1)do if(E--,a--,0>a||g[E]!==x[a])return`
`+g[E].replace(" at new "," at ");while(1<=E&&0<=a);break}}}finally{Kg=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?uh(t):""}function Ck(t){switch(t.tag){case 5:return uh(t.type);case 16:return uh("Lazy");case 13:return uh("Suspense");case 19:return uh("SuspenseList");case 0:case 2:case 15:return t=Zp(t.type,!1),t;case 11:return t=Zp(t.type.render,!1),t;case 22:return t=Zp(t.type._render,!1),t;case 1:return t=Zp(t.type,!0),t;default:return""}}function yc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Vs:return"Fragment";case Za:return"Portal";case ah:return"Profiler";case Ug:return"StrictMode";case lh:return"Suspense";case Vp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Vg:return(t.displayName||"Context")+".Consumer";case jg:return(t._context.displayName||"Context")+".Provider";case jp:var n=t.render;return n=n.displayName||n.name||"",t.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case Gp:return yc(t.type);case Zg:return yc(t._render);case Gg:n=t._payload,t=t._init;try{return yc(t(n))}catch{}}return null}function Gs(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function r1(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function kk(t){var n=r1(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),h=""+t[n];if(!t.hasOwnProperty(n)&&typeof s!="undefined"&&typeof s.get=="function"&&typeof s.set=="function"){var g=s.get,x=s.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return g.call(this)},set:function(E){h=""+E,x.call(this,E)}}),Object.defineProperty(t,n,{enumerable:s.enumerable}),{getValue:function(){return h},setValue:function(E){h=""+E},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function qp(t){t._valueTracker||(t._valueTracker=kk(t))}function i1(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var s=n.getValue(),h="";return t&&(h=r1(t)?t.checked?"true":"false":t.value),t=h,t!==s?(n.setValue(t),!0):!1}function Wp(t){if(t=t||(typeof document!="undefined"?document:void 0),typeof t=="undefined")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yg(t,n){var s=n.checked;return zn({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s!=null?s:t._wrapperState.initialChecked})}function o1(t,n){var s=n.defaultValue==null?"":n.defaultValue,h=n.checked!=null?n.checked:n.defaultChecked;s=Gs(n.value!=null?n.value:s),t._wrapperState={initialChecked:h,initialValue:s,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function s1(t,n){n=n.checked,n!=null&&Ng(t,"checked",n,!1)}function Jg(t,n){s1(t,n);var s=Gs(n.value),h=n.type;if(s!=null)h==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(h==="submit"||h==="reset"){t.removeAttribute("value");return}n.hasOwnProperty("value")?Qg(t,n.type,s):n.hasOwnProperty("defaultValue")&&Qg(t,n.type,Gs(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(t.defaultChecked=!!n.defaultChecked)}function a1(t,n,s){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var h=n.type;if(!(h!=="submit"&&h!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+t._wrapperState.initialValue,s||n===t.value||(t.value=n),t.defaultValue=n}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function Qg(t,n,s){(n!=="number"||Wp(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}function Ik(t){var n="";return Up.Children.forEach(t,function(s){s!=null&&(n+=s)}),n}function e_(t,n){return t=zn({children:void 0},n),(n=Ik(n.children))&&(t.children=n),t}function vc(t,n,s,h){if(t=t.options,n){n={};for(var g=0;g<s.length;g++)n["$"+s[g]]=!0;for(s=0;s<t.length;s++)g=n.hasOwnProperty("$"+t[s].value),t[s].selected!==g&&(t[s].selected=g),g&&h&&(t[s].defaultSelected=!0)}else{for(s=""+Gs(s),n=null,g=0;g<t.length;g++){if(t[g].value===s){t[g].selected=!0,h&&(t[g].defaultSelected=!0);return}n!==null||t[g].disabled||(n=t[g])}n!==null&&(n.selected=!0)}}function t_(t,n){if(n.dangerouslySetInnerHTML!=null)throw Error(rt(91));return zn({},n,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function l1(t,n){var s=n.value;if(s==null){if(s=n.children,n=n.defaultValue,s!=null){if(n!=null)throw Error(rt(92));if(Array.isArray(s)){if(!(1>=s.length))throw Error(rt(93));s=s[0]}n=s}n==null&&(n=""),s=n}t._wrapperState={initialValue:Gs(s)}}function c1(t,n){var s=Gs(n.value),h=Gs(n.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),n.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),h!=null&&(t.defaultValue=""+h)}function u1(t){var n=t.textContent;n===t._wrapperState.initialValue&&n!==""&&n!==null&&(t.value=n)}var n_={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function h1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function r_(t,n){return t==null||t==="http://www.w3.org/1999/xhtml"?h1(n):t==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Hp,d1=function(t){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(n,s,h,g){MSApp.execUnsafeLocalFunction(function(){return t(n,s,h,g)})}:t}(function(t,n){if(t.namespaceURI!==n_.svg||"innerHTML"in t)t.innerHTML=n;else{for(Hp=Hp||document.createElement("div"),Hp.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Hp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;n.firstChild;)t.appendChild(n.firstChild)}});function hh(t,n){if(n){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=n;return}}t.textContent=n}var dh={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ak=["Webkit","ms","Moz","O"];Object.keys(dh).forEach(function(t){Ak.forEach(function(n){n=n+t.charAt(0).toUpperCase()+t.substring(1),dh[n]=dh[t]})});function p1(t,n,s){return n==null||typeof n=="boolean"||n===""?"":s||typeof n!="number"||n===0||dh.hasOwnProperty(t)&&dh[t]?(""+n).trim():n+"px"}function f1(t,n){t=t.style;for(var s in n)if(n.hasOwnProperty(s)){var h=s.indexOf("--")===0,g=p1(s,n[s],h);s==="float"&&(s="cssFloat"),h?t.setProperty(s,g):t[s]=g}}var Mk=zn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function i_(t,n){if(n){if(Mk[t]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(rt(137,t));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(rt(60));if(!(typeof n.dangerouslySetInnerHTML=="object"&&"__html"in n.dangerouslySetInnerHTML))throw Error(rt(61))}if(n.style!=null&&typeof n.style!="object")throw Error(rt(62))}}function o_(t,n){if(t.indexOf("-")===-1)return typeof n.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function s_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var a_=null,xc=null,bc=null;function m1(t){if(t=Ph(t)){if(typeof a_!="function")throw Error(rt(280));var n=t.stateNode;n&&(n=pf(n),a_(t.stateNode,t.type,n))}}function g1(t){xc?bc?bc.push(t):bc=[t]:xc=t}function _1(){if(xc){var t=xc,n=bc;if(bc=xc=null,m1(t),n)for(t=0;t<n.length;t++)m1(n[t])}}function l_(t,n){return t(n)}function y1(t,n,s,h,g){return t(n,s,h,g)}function c_(){}var v1=l_,qa=!1,u_=!1;function h_(){(xc!==null||bc!==null)&&(c_(),_1())}function Pk(t,n,s){if(u_)return t(n,s);u_=!0;try{return v1(t,n,s)}finally{u_=!1,h_()}}function ph(t,n){var s=t.stateNode;if(s===null)return null;var h=pf(s);if(h===null)return null;s=h[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(t=t.type,h=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!h;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(rt(231,n,typeof s));return s}var d_=!1;if(es)try{var fh={};Object.defineProperty(fh,"passive",{get:function(){d_=!0}}),window.addEventListener("test",fh,fh),window.removeEventListener("test",fh,fh)}catch{d_=!1}function zk(t,n,s,h,g,x,E,a,A){var D=Array.prototype.slice.call(arguments,3);try{n.apply(s,D)}catch(V){this.onError(V)}}var mh=!1,Xp=null,Kp=!1,p_=null,Dk={onError:function(t){mh=!0,Xp=t}};function Rk(t,n,s,h,g,x,E,a,A){mh=!1,Xp=null,zk.apply(Dk,arguments)}function Lk(t,n,s,h,g,x,E,a,A){if(Rk.apply(this,arguments),mh){if(mh){var D=Xp;mh=!1,Xp=null}else throw Error(rt(198));Kp||(Kp=!0,p_=D)}}function Wa(t){var n=t,s=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,(n.flags&1026)!=0&&(s=n.return),t=n.return;while(t)}return n.tag===3?s:null}function x1(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function b1(t){if(Wa(t)!==t)throw Error(rt(188))}function Ok(t){var n=t.alternate;if(!n){if(n=Wa(t),n===null)throw Error(rt(188));return n!==t?null:t}for(var s=t,h=n;;){var g=s.return;if(g===null)break;var x=g.alternate;if(x===null){if(h=g.return,h!==null){s=h;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===s)return b1(g),t;if(x===h)return b1(g),n;x=x.sibling}throw Error(rt(188))}if(s.return!==h.return)s=g,h=x;else{for(var E=!1,a=g.child;a;){if(a===s){E=!0,s=g,h=x;break}if(a===h){E=!0,h=g,s=x;break}a=a.sibling}if(!E){for(a=x.child;a;){if(a===s){E=!0,s=x,h=g;break}if(a===h){E=!0,h=x,s=g;break}a=a.sibling}if(!E)throw Error(rt(189))}}if(s.alternate!==h)throw Error(rt(190))}if(s.tag!==3)throw Error(rt(188));return s.stateNode.current===s?t:n}function w1(t){if(t=Ok(t),!t)return null;for(var n=t;;){if(n.tag===5||n.tag===6)return n;if(n.child)n.child.return=n,n=n.child;else{if(n===t)break;for(;!n.sibling;){if(!n.return||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}}return null}function E1(t,n){for(var s=t.alternate;n!==null;){if(n===t||n===s)return!0;n=n.return}return!1}var T1,f_,S1,C1,m_=!1,To=[],Zs=null,qs=null,Ws=null,gh=new Map,_h=new Map,yh=[],k1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function g_(t,n,s,h,g){return{blockedOn:t,domEventName:n,eventSystemFlags:s|16,nativeEvent:g,targetContainers:[h]}}function I1(t,n){switch(t){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":qs=null;break;case"mouseover":case"mouseout":Ws=null;break;case"pointerover":case"pointerout":gh.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":_h.delete(n.pointerId)}}function vh(t,n,s,h,g,x){return t===null||t.nativeEvent!==x?(t=g_(n,s,h,g,x),n!==null&&(n=Ph(n),n!==null&&f_(n)),t):(t.eventSystemFlags|=h,n=t.targetContainers,g!==null&&n.indexOf(g)===-1&&n.push(g),t)}function Bk(t,n,s,h,g){switch(n){case"focusin":return Zs=vh(Zs,t,n,s,h,g),!0;case"dragenter":return qs=vh(qs,t,n,s,h,g),!0;case"mouseover":return Ws=vh(Ws,t,n,s,h,g),!0;case"pointerover":var x=g.pointerId;return gh.set(x,vh(gh.get(x)||null,t,n,s,h,g)),!0;case"gotpointercapture":return x=g.pointerId,_h.set(x,vh(_h.get(x)||null,t,n,s,h,g)),!0}return!1}function Fk(t){var n=Ha(t.target);if(n!==null){var s=Wa(n);if(s!==null){if(n=s.tag,n===13){if(n=x1(s),n!==null){t.blockedOn=n,C1(t.lanePriority,function(){br.unstable_runWithPriority(t.priority,function(){S1(s)})});return}}else if(n===3&&s.stateNode.hydrate){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Yp(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var s=w_(t.domEventName,t.eventSystemFlags,n[0],t.nativeEvent);if(s!==null)return n=Ph(s),n!==null&&f_(n),t.blockedOn=s,!1;n.shift()}return!0}function A1(t,n,s){Yp(t)&&s.delete(n)}function $k(){for(m_=!1;0<To.length;){var t=To[0];if(t.blockedOn!==null){t=Ph(t.blockedOn),t!==null&&T1(t);break}for(var n=t.targetContainers;0<n.length;){var s=w_(t.domEventName,t.eventSystemFlags,n[0],t.nativeEvent);if(s!==null){t.blockedOn=s;break}n.shift()}t.blockedOn===null&&To.shift()}Zs!==null&&Yp(Zs)&&(Zs=null),qs!==null&&Yp(qs)&&(qs=null),Ws!==null&&Yp(Ws)&&(Ws=null),gh.forEach(A1),_h.forEach(A1)}function xh(t,n){t.blockedOn===n&&(t.blockedOn=null,m_||(m_=!0,br.unstable_scheduleCallback(br.unstable_NormalPriority,$k)))}function M1(t){function n(g){return xh(g,t)}if(0<To.length){xh(To[0],t);for(var s=1;s<To.length;s++){var h=To[s];h.blockedOn===t&&(h.blockedOn=null)}}for(Zs!==null&&xh(Zs,t),qs!==null&&xh(qs,t),Ws!==null&&xh(Ws,t),gh.forEach(n),_h.forEach(n),s=0;s<yh.length;s++)h=yh[s],h.blockedOn===t&&(h.blockedOn=null);for(;0<yh.length&&(s=yh[0],s.blockedOn===null);)Fk(s),s.blockedOn===null&&yh.shift()}function Jp(t,n){var s={};return s[t.toLowerCase()]=n.toLowerCase(),s["Webkit"+t]="webkit"+n,s["Moz"+t]="moz"+n,s}var wc={animationend:Jp("Animation","AnimationEnd"),animationiteration:Jp("Animation","AnimationIteration"),animationstart:Jp("Animation","AnimationStart"),transitionend:Jp("Transition","TransitionEnd")},__={},P1={};es&&(P1=document.createElement("div").style,"AnimationEvent"in window||(delete wc.animationend.animation,delete wc.animationiteration.animation,delete wc.animationstart.animation),"TransitionEvent"in window||delete wc.transitionend.transition);function Qp(t){if(__[t])return __[t];if(!wc[t])return t;var n=wc[t],s;for(s in n)if(n.hasOwnProperty(s)&&s in P1)return __[t]=n[s];return t}var z1=Qp("animationend"),D1=Qp("animationiteration"),R1=Qp("animationstart"),L1=Qp("transitionend"),O1=new Map,y_=new Map,Nk=["abort","abort",z1,"animationEnd",D1,"animationIteration",R1,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",L1,"transitionEnd","waiting","waiting"];function v_(t,n){for(var s=0;s<t.length;s+=2){var h=t[s],g=t[s+1];g="on"+(g[0].toUpperCase()+g.slice(1)),y_.set(h,n),O1.set(h,g),Va(g,[h])}}var Uk=br.unstable_now;Uk();var En=8;function Ec(t){if((1&t)!=0)return En=15,1;if((2&t)!=0)return En=14,2;if((4&t)!=0)return En=13,4;var n=24&t;return n!==0?(En=12,n):(t&32)!=0?(En=11,32):(n=192&t,n!==0?(En=10,n):(t&256)!=0?(En=9,256):(n=3584&t,n!==0?(En=8,n):(t&4096)!=0?(En=7,4096):(n=4186112&t,n!==0?(En=6,n):(n=62914560&t,n!==0?(En=5,n):t&67108864?(En=4,67108864):(t&134217728)!=0?(En=3,134217728):(n=805306368&t,n!==0?(En=2,n):(1073741824&t)!=0?(En=1,1073741824):(En=8,t))))))}function jk(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}function Vk(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(rt(358,t))}}function bh(t,n){var s=t.pendingLanes;if(s===0)return En=0;var h=0,g=0,x=t.expiredLanes,E=t.suspendedLanes,a=t.pingedLanes;if(x!==0)h=x,g=En=15;else if(x=s&134217727,x!==0){var A=x&~E;A!==0?(h=Ec(A),g=En):(a&=x,a!==0&&(h=Ec(a),g=En))}else x=s&~E,x!==0?(h=Ec(x),g=En):a!==0&&(h=Ec(a),g=En);if(h===0)return 0;if(h=31-Hs(h),h=s&((0>h?0:1<<h)<<1)-1,n!==0&&n!==h&&(n&E)==0){if(Ec(n),g<=En)return n;En=g}if(n=t.entangledLanes,n!==0)for(t=t.entanglements,n&=h;0<n;)s=31-Hs(n),g=1<<s,h|=t[s],n&=~g;return h}function B1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ef(t,n){switch(t){case 15:return 1;case 14:return 2;case 12:return t=Tc(24&~n),t===0?ef(10,n):t;case 10:return t=Tc(192&~n),t===0?ef(8,n):t;case 8:return t=Tc(3584&~n),t===0&&(t=Tc(4186112&~n),t===0&&(t=512)),t;case 2:return n=Tc(805306368&~n),n===0&&(n=268435456),n}throw Error(rt(358,t))}function Tc(t){return t&-t}function x_(t){for(var n=[],s=0;31>s;s++)n.push(t);return n}function tf(t,n,s){t.pendingLanes|=n;var h=n-1;t.suspendedLanes&=h,t.pingedLanes&=h,t=t.eventTimes,n=31-Hs(n),t[n]=s}var Hs=Math.clz32?Math.clz32:qk,Gk=Math.log,Zk=Math.LN2;function qk(t){return t===0?32:31-(Gk(t)/Zk|0)|0}var Wk=br.unstable_UserBlockingPriority,Hk=br.unstable_runWithPriority,nf=!0;function Xk(t,n,s,h){qa||c_();var g=b_,x=qa;qa=!0;try{y1(g,t,n,s,h)}finally{(qa=x)||h_()}}function Kk(t,n,s,h){Hk(Wk,b_.bind(null,t,n,s,h))}function b_(t,n,s,h){if(nf){var g;if((g=(n&4)==0)&&0<To.length&&-1<k1.indexOf(t))t=g_(null,t,n,s,h),To.push(t);else{var x=w_(t,n,s,h);if(x===null)g&&I1(t,h);else{if(g){if(-1<k1.indexOf(t)){t=g_(x,t,n,s,h),To.push(t);return}if(Bk(x,t,n,s,h))return;I1(t,h)}pb(t,n,h,null,s)}}}}function w_(t,n,s,h){var g=s_(h);if(g=Ha(g),g!==null){var x=Wa(g);if(x===null)g=null;else{var E=x.tag;if(E===13){if(g=x1(x),g!==null)return g;g=null}else if(E===3){if(x.stateNode.hydrate)return x.tag===3?x.stateNode.containerInfo:null;g=null}else x!==g&&(g=null)}}return pb(t,n,h,g,s),null}var Xs=null,E_=null,rf=null;function F1(){if(rf)return rf;var t,n=E_,s=n.length,h,g="value"in Xs?Xs.value:Xs.textContent,x=g.length;for(t=0;t<s&&n[t]===g[t];t++);var E=s-t;for(h=1;h<=E&&n[s-h]===g[x-h];h++);return rf=g.slice(t,1<h?1-h:void 0)}function of(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function sf(){return!0}function $1(){return!1}function wi(t){function n(s,h,g,x,E){this._reactName=s,this._targetInst=g,this.type=h,this.nativeEvent=x,this.target=E,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(s=t[a],this[a]=s?s(x):x[a]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?sf:$1,this.isPropagationStopped=$1,this}return zn(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=sf)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=sf)},persist:function(){},isPersistent:sf}),n}var Sc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},T_=wi(Sc),wh=zn({},Sc,{view:0,detail:0}),Yk=wi(wh),S_,C_,Eh,af=zn({},wh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:I_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Eh&&(Eh&&t.type==="mousemove"?(S_=t.screenX-Eh.screenX,C_=t.screenY-Eh.screenY):C_=S_=0,Eh=t),S_)},movementY:function(t){return"movementY"in t?t.movementY:C_}}),N1=wi(af),Jk=zn({},af,{dataTransfer:0}),Qk=wi(Jk),eI=zn({},wh,{relatedTarget:0}),k_=wi(eI),tI=zn({},Sc,{animationName:0,elapsedTime:0,pseudoElement:0}),nI=wi(tI),rI=zn({},Sc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),iI=wi(rI),oI=zn({},Sc,{data:0}),U1=wi(oI),sI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cI(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=lI[t])?!!n[t]:!1}function I_(){return cI}var uI=zn({},wh,{key:function(t){if(t.key){var n=sI[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=of(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?aI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:I_,charCode:function(t){return t.type==="keypress"?of(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?of(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),hI=wi(uI),dI=zn({},af,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j1=wi(dI),pI=zn({},wh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:I_}),fI=wi(pI),mI=zn({},Sc,{propertyName:0,elapsedTime:0,pseudoElement:0}),gI=wi(mI),_I=zn({},af,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),yI=wi(_I),vI=[9,13,27,32],A_=es&&"CompositionEvent"in window,Th=null;es&&"documentMode"in document&&(Th=document.documentMode);var xI=es&&"TextEvent"in window&&!Th,V1=es&&(!A_||Th&&8<Th&&11>=Th),G1=String.fromCharCode(32),Z1=!1;function q1(t,n){switch(t){case"keyup":return vI.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function W1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Cc=!1;function bI(t,n){switch(t){case"compositionend":return W1(n);case"keypress":return n.which!==32?null:(Z1=!0,G1);case"textInput":return t=n.data,t===G1&&Z1?null:t;default:return null}}function wI(t,n){if(Cc)return t==="compositionend"||!A_&&q1(t,n)?(t=F1(),rf=E_=Xs=null,Cc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return V1&&n.locale!=="ko"?null:n.data;default:return null}}var EI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function H1(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!EI[t.type]:n==="textarea"}function X1(t,n,s,h){g1(h),n=cf(n,"onChange"),0<n.length&&(s=new T_("onChange","change",null,s,h),t.push({event:s,listeners:n}))}var Sh=null,Ch=null;function TI(t){lb(t,0)}function lf(t){var n=Pc(t);if(i1(n))return t}function SI(t,n){if(t==="change")return n}var K1=!1;if(es){var M_;if(es){var P_="oninput"in document;if(!P_){var Y1=document.createElement("div");Y1.setAttribute("oninput","return;"),P_=typeof Y1.oninput=="function"}M_=P_}else M_=!1;K1=M_&&(!document.documentMode||9<document.documentMode)}function J1(){Sh&&(Sh.detachEvent("onpropertychange",Q1),Ch=Sh=null)}function Q1(t){if(t.propertyName==="value"&&lf(Ch)){var n=[];if(X1(n,Ch,t,s_(t)),t=TI,qa)t(n);else{qa=!0;try{l_(t,n)}finally{qa=!1,h_()}}}}function CI(t,n,s){t==="focusin"?(J1(),Sh=n,Ch=s,Sh.attachEvent("onpropertychange",Q1)):t==="focusout"&&J1()}function kI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return lf(Ch)}function II(t,n){if(t==="click")return lf(n)}function AI(t,n){if(t==="input"||t==="change")return lf(n)}function MI(t,n){return t===n&&(t!==0||1/t==1/n)||t!==t&&n!==n}var zi=typeof Object.is=="function"?Object.is:MI,PI=Object.prototype.hasOwnProperty;function kh(t,n){if(zi(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var s=Object.keys(t),h=Object.keys(n);if(s.length!==h.length)return!1;for(h=0;h<s.length;h++)if(!PI.call(n,s[h])||!zi(t[s[h]],n[s[h]]))return!1;return!0}function eb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function tb(t,n){var s=eb(t);t=0;for(var h;s;){if(s.nodeType===3){if(h=t+s.textContent.length,t<=n&&h>=n)return{node:s,offset:n-t};t=h}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=eb(s)}}function nb(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?nb(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function rb(){for(var t=window,n=Wp();n instanceof t.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)t=n.contentWindow;else break;n=Wp(t.document)}return n}function z_(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}var zI=es&&"documentMode"in document&&11>=document.documentMode,kc=null,D_=null,Ih=null,R_=!1;function ib(t,n,s){var h=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;R_||kc==null||kc!==Wp(h)||(h=kc,"selectionStart"in h&&z_(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ih&&kh(Ih,h)||(Ih=h,h=cf(D_,"onSelect"),0<h.length&&(n=new T_("onSelect","select",null,n,s),t.push({event:n,listeners:h}),n.target=kc)))}v_("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);v_("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);v_(Nk,2);for(var ob="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),L_=0;L_<ob.length;L_++)y_.set(ob[L_],0);_c("onMouseEnter",["mouseout","mouseover"]);_c("onMouseLeave",["mouseout","mouseover"]);_c("onPointerEnter",["pointerout","pointerover"]);_c("onPointerLeave",["pointerout","pointerover"]);Va("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Va("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Va("onBeforeInput",["compositionend","keypress","textInput","paste"]);Va("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Va("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Va("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ah="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ah));function ab(t,n,s){var h=t.type||"unknown-event";t.currentTarget=s,Lk(h,n,void 0,t),t.currentTarget=null}function lb(t,n){n=(n&4)!=0;for(var s=0;s<t.length;s++){var h=t[s],g=h.event;h=h.listeners;e:{var x=void 0;if(n)for(var E=h.length-1;0<=E;E--){var a=h[E],A=a.instance,D=a.currentTarget;if(a=a.listener,A!==x&&g.isPropagationStopped())break e;ab(g,a,D),x=A}else for(E=0;E<h.length;E++){if(a=h[E],A=a.instance,D=a.currentTarget,a=a.listener,A!==x&&g.isPropagationStopped())break e;ab(g,a,D),x=A}}}if(Kp)throw t=p_,Kp=!1,p_=null,t}function Cn(t,n){var s=vb(n),h=t+"__bubble";s.has(h)||(db(n,t,2,!1),s.add(h))}var cb="_reactListening"+Math.random().toString(36).slice(2);function ub(t){t[cb]||(t[cb]=!0,Yx.forEach(function(n){sb.has(n)||hb(n,!1,t,null),hb(n,!0,t,null)}))}function hb(t,n,s,h){var g=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,x=s;if(t==="selectionchange"&&s.nodeType!==9&&(x=s.ownerDocument),h!==null&&!n&&sb.has(t)){if(t!=="scroll")return;g|=2,x=h}var E=vb(x),a=t+"__"+(n?"capture":"bubble");E.has(a)||(n&&(g|=4),db(x,t,g,n),E.add(a))}function db(t,n,s,h){var g=y_.get(n);switch(g===void 0?2:g){case 0:g=Xk;break;case 1:g=Kk;break;default:g=b_}s=g.bind(null,n,s,t),g=void 0,!d_||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(g=!0),h?g!==void 0?t.addEventListener(n,s,{capture:!0,passive:g}):t.addEventListener(n,s,!0):g!==void 0?t.addEventListener(n,s,{passive:g}):t.addEventListener(n,s,!1)}function pb(t,n,s,h,g){var x=h;if((n&1)==0&&(n&2)==0&&h!==null)e:for(;;){if(h===null)return;var E=h.tag;if(E===3||E===4){var a=h.stateNode.containerInfo;if(a===g||a.nodeType===8&&a.parentNode===g)break;if(E===4)for(E=h.return;E!==null;){var A=E.tag;if((A===3||A===4)&&(A=E.stateNode.containerInfo,A===g||A.nodeType===8&&A.parentNode===g))return;E=E.return}for(;a!==null;){if(E=Ha(a),E===null)return;if(A=E.tag,A===5||A===6){h=x=E;continue e}a=a.parentNode}}h=h.return}Pk(function(){var D=x,V=s_(s),N=[];e:{var F=O1.get(t);if(F!==void 0){var ae=T_,be=t;switch(t){case"keypress":if(of(s)===0)break e;case"keydown":case"keyup":ae=hI;break;case"focusin":be="focus",ae=k_;break;case"focusout":be="blur",ae=k_;break;case"beforeblur":case"afterblur":ae=k_;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ae=N1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ae=Qk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ae=fI;break;case z1:case D1:case R1:ae=nI;break;case L1:ae=gI;break;case"scroll":ae=Yk;break;case"wheel":ae=yI;break;case"copy":case"cut":case"paste":ae=iI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ae=j1}var fe=(n&4)!=0,ee=!fe&&t==="scroll",G=fe?F!==null?F+"Capture":null:F;fe=[];for(var X=D,me;X!==null;){me=X;var Te=me.stateNode;if(me.tag===5&&Te!==null&&(me=Te,G!==null&&(Te=ph(X,G),Te!=null&&fe.push(Mh(X,Te,me)))),ee)break;X=X.return}0<fe.length&&(F=new ae(F,be,null,s,V),N.push({event:F,listeners:fe}))}}if((n&7)==0){e:{if(F=t==="mouseover"||t==="pointerover",ae=t==="mouseout"||t==="pointerout",F&&(n&16)==0&&(be=s.relatedTarget||s.fromElement)&&(Ha(be)||be[Mc]))break e;if((ae||F)&&(F=V.window===V?V:(F=V.ownerDocument)?F.defaultView||F.parentWindow:window,ae?(be=s.relatedTarget||s.toElement,ae=D,be=be?Ha(be):null,be!==null&&(ee=Wa(be),be!==ee||be.tag!==5&&be.tag!==6)&&(be=null)):(ae=null,be=D),ae!==be)){if(fe=N1,Te="onMouseLeave",G="onMouseEnter",X="mouse",(t==="pointerout"||t==="pointerover")&&(fe=j1,Te="onPointerLeave",G="onPointerEnter",X="pointer"),ee=ae==null?F:Pc(ae),me=be==null?F:Pc(be),F=new fe(Te,X+"leave",ae,s,V),F.target=ee,F.relatedTarget=me,Te=null,Ha(V)===D&&(fe=new fe(G,X+"enter",be,s,V),fe.target=me,fe.relatedTarget=ee,Te=fe),ee=Te,ae&&be)t:{for(fe=ae,G=be,X=0,me=fe;me;me=Ic(me))X++;for(me=0,Te=G;Te;Te=Ic(Te))me++;for(;0<X-me;)fe=Ic(fe),X--;for(;0<me-X;)G=Ic(G),me--;for(;X--;){if(fe===G||G!==null&&fe===G.alternate)break t;fe=Ic(fe),G=Ic(G)}fe=null}else fe=null;ae!==null&&fb(N,F,ae,fe,!1),be!==null&&ee!==null&&fb(N,ee,be,fe,!0)}}e:{if(F=D?Pc(D):window,ae=F.nodeName&&F.nodeName.toLowerCase(),ae==="select"||ae==="input"&&F.type==="file")var We=SI;else if(H1(F))if(K1)We=AI;else{We=kI;var Pe=CI}else(ae=F.nodeName)&&ae.toLowerCase()==="input"&&(F.type==="checkbox"||F.type==="radio")&&(We=II);if(We&&(We=We(t,D))){X1(N,We,s,V);break e}Pe&&Pe(t,F,D),t==="focusout"&&(Pe=F._wrapperState)&&Pe.controlled&&F.type==="number"&&Qg(F,"number",F.value)}switch(Pe=D?Pc(D):window,t){case"focusin":(H1(Pe)||Pe.contentEditable==="true")&&(kc=Pe,D_=D,Ih=null);break;case"focusout":Ih=D_=kc=null;break;case"mousedown":R_=!0;break;case"contextmenu":case"mouseup":case"dragend":R_=!1,ib(N,s,V);break;case"selectionchange":if(zI)break;case"keydown":case"keyup":ib(N,s,V)}var Le;if(A_)e:{switch(t){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else Cc?q1(t,s)&&(Ke="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(Ke="onCompositionStart");Ke&&(V1&&s.locale!=="ko"&&(Cc||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&Cc&&(Le=F1()):(Xs=V,E_="value"in Xs?Xs.value:Xs.textContent,Cc=!0)),Pe=cf(D,Ke),0<Pe.length&&(Ke=new U1(Ke,t,null,s,V),N.push({event:Ke,listeners:Pe}),Le?Ke.data=Le:(Le=W1(s),Le!==null&&(Ke.data=Le)))),(Le=xI?bI(t,s):wI(t,s))&&(D=cf(D,"onBeforeInput"),0<D.length&&(V=new U1("onBeforeInput","beforeinput",null,s,V),N.push({event:V,listeners:D}),V.data=Le))}lb(N,n)})}function Mh(t,n,s){return{instance:t,listener:n,currentTarget:s}}function cf(t,n){for(var s=n+"Capture",h=[];t!==null;){var g=t,x=g.stateNode;g.tag===5&&x!==null&&(g=x,x=ph(t,s),x!=null&&h.unshift(Mh(t,x,g)),x=ph(t,n),x!=null&&h.push(Mh(t,x,g))),t=t.return}return h}function Ic(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function fb(t,n,s,h,g){for(var x=n._reactName,E=[];s!==null&&s!==h;){var a=s,A=a.alternate,D=a.stateNode;if(A!==null&&A===h)break;a.tag===5&&D!==null&&(a=D,g?(A=ph(s,x),A!=null&&E.unshift(Mh(s,A,a))):g||(A=ph(s,x),A!=null&&E.push(Mh(s,A,a)))),s=s.return}E.length!==0&&t.push({event:n,listeners:E})}function uf(){}var O_=null,B_=null;function mb(t,n){switch(t){case"button":case"input":case"select":case"textarea":return!!n.autoFocus}return!1}function F_(t,n){return t==="textarea"||t==="option"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var gb=typeof setTimeout=="function"?setTimeout:void 0,DI=typeof clearTimeout=="function"?clearTimeout:void 0;function $_(t){t.nodeType===1?t.textContent="":t.nodeType===9&&(t=t.body,t!=null&&(t.textContent=""))}function Ac(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break}return t}function _b(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return t;n--}else s==="/$"&&n++}t=t.previousSibling}return null}var N_=0;function RI(t){return{$$typeof:qg,toString:t,valueOf:t}}var hf=Math.random().toString(36).slice(2),Ks="__reactFiber$"+hf,df="__reactProps$"+hf,Mc="__reactContainer$"+hf,yb="__reactEvents$"+hf;function Ha(t){var n=t[Ks];if(n)return n;for(var s=t.parentNode;s;){if(n=s[Mc]||s[Ks]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(t=_b(t);t!==null;){if(s=t[Ks])return s;t=_b(t)}return n}t=s,s=t.parentNode}return null}function Ph(t){return t=t[Ks]||t[Mc],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Pc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(rt(33))}function pf(t){return t[df]||null}function vb(t){var n=t[yb];return n===void 0&&(n=t[yb]=new Set),n}var U_=[],zc=-1;function Ys(t){return{current:t}}function kn(t){0>zc||(t.current=U_[zc],U_[zc]=null,zc--)}function Xn(t,n){zc++,U_[zc]=t.current,t.current=n}var Js={},Rr=Ys(Js),si=Ys(!1),Xa=Js;function Dc(t,n){var s=t.type.contextTypes;if(!s)return Js;var h=t.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===n)return h.__reactInternalMemoizedMaskedChildContext;var g={},x;for(x in s)g[x]=n[x];return h&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=g),g}function ai(t){return t=t.childContextTypes,t!=null}function ff(){kn(si),kn(Rr)}function xb(t,n,s){if(Rr.current!==Js)throw Error(rt(168));Xn(Rr,n),Xn(si,s)}function bb(t,n,s){var h=t.stateNode;if(t=n.childContextTypes,typeof h.getChildContext!="function")return s;h=h.getChildContext();for(var g in h)if(!(g in t))throw Error(rt(108,yc(n)||"Unknown",g));return zn({},s,h)}function mf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Js,Xa=Rr.current,Xn(Rr,t),Xn(si,si.current),!0}function wb(t,n,s){var h=t.stateNode;if(!h)throw Error(rt(169));s?(t=bb(t,n,Xa),h.__reactInternalMemoizedMergedChildContext=t,kn(si),kn(Rr),Xn(Rr,t)):kn(si),Xn(si,s)}var j_=null,Ka=null,LI=br.unstable_runWithPriority,V_=br.unstable_scheduleCallback,G_=br.unstable_cancelCallback,OI=br.unstable_shouldYield,Eb=br.unstable_requestPaint,Z_=br.unstable_now,BI=br.unstable_getCurrentPriorityLevel,gf=br.unstable_ImmediatePriority,Tb=br.unstable_UserBlockingPriority,Sb=br.unstable_NormalPriority,Cb=br.unstable_LowPriority,kb=br.unstable_IdlePriority,q_={},FI=Eb!==void 0?Eb:function(){},ts=null,_f=null,W_=!1,Ib=Z_(),Lr=1e4>Ib?Z_:function(){return Z_()-Ib};function Rc(){switch(BI()){case gf:return 99;case Tb:return 98;case Sb:return 97;case Cb:return 96;case kb:return 95;default:throw Error(rt(332))}}function Ab(t){switch(t){case 99:return gf;case 98:return Tb;case 97:return Sb;case 96:return Cb;case 95:return kb;default:throw Error(rt(332))}}function Ya(t,n){return t=Ab(t),LI(t,n)}function zh(t,n,s){return t=Ab(t),V_(t,n,s)}function So(){if(_f!==null){var t=_f;_f=null,G_(t)}Mb()}function Mb(){if(!W_&&ts!==null){W_=!0;var t=0;try{var n=ts;Ya(99,function(){for(;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}}),ts=null}catch(s){throw ts!==null&&(ts=ts.slice(t+1)),V_(gf,So),s}finally{W_=!1}}}var $I=Ga.ReactCurrentBatchConfig;function Yi(t,n){if(t&&t.defaultProps){n=zn({},n),t=t.defaultProps;for(var s in t)n[s]===void 0&&(n[s]=t[s]);return n}return n}var yf=Ys(null),vf=null,Lc=null,xf=null;function H_(){xf=Lc=vf=null}function X_(t){var n=yf.current;kn(yf),t.type._context._currentValue=n}function Pb(t,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&n)===n){if(s===null||(s.childLanes&n)===n)break;s.childLanes|=n}else t.childLanes|=n,s!==null&&(s.childLanes|=n);t=t.return}}function Oc(t,n){vf=t,xf=Lc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&n)!=0&&(Ji=!0),t.firstContext=null)}function Di(t,n){if(xf!==t&&n!==!1&&n!==0)if((typeof n!="number"||n===1073741823)&&(xf=t,n=1073741823),n={context:t,observedBits:n,next:null},Lc===null){if(vf===null)throw Error(rt(308));Lc=n,vf.dependencies={lanes:0,firstContext:n,responders:null}}else Lc=Lc.next=n;return t._currentValue}var Qs=!1;function K_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function zb(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ea(t,n){return{eventTime:t,lane:n,tag:0,payload:null,callback:null,next:null}}function ta(t,n){if(t=t.updateQueue,t!==null){t=t.shared;var s=t.pending;s===null?n.next=n:(n.next=s.next,s.next=n),t.pending=n}}function Db(t,n){var s=t.updateQueue,h=t.alternate;if(h!==null&&(h=h.updateQueue,s===h)){var g=null,x=null;if(s=s.firstBaseUpdate,s!==null){do{var E={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};x===null?g=x=E:x=x.next=E,s=s.next}while(s!==null);x===null?g=x=n:x=x.next=n}else g=x=n;s={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:h.shared,effects:h.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=n:t.next=n,s.lastBaseUpdate=n}function Dh(t,n,s,h){var g=t.updateQueue;Qs=!1;var x=g.firstBaseUpdate,E=g.lastBaseUpdate,a=g.shared.pending;if(a!==null){g.shared.pending=null;var A=a,D=A.next;A.next=null,E===null?x=D:E.next=D,E=A;var V=t.alternate;if(V!==null){V=V.updateQueue;var N=V.lastBaseUpdate;N!==E&&(N===null?V.firstBaseUpdate=D:N.next=D,V.lastBaseUpdate=A)}}if(x!==null){N=g.baseState,E=0,V=D=A=null;do{a=x.lane;var F=x.eventTime;if((h&a)===a){V!==null&&(V=V.next={eventTime:F,lane:0,tag:x.tag,payload:x.payload,callback:x.callback,next:null});e:{var ae=t,be=x;switch(a=n,F=s,be.tag){case 1:if(ae=be.payload,typeof ae=="function"){N=ae.call(F,N,a);break e}N=ae;break e;case 3:ae.flags=ae.flags&-4097|64;case 0:if(ae=be.payload,a=typeof ae=="function"?ae.call(F,N,a):ae,a==null)break e;N=zn({},N,a);break e;case 2:Qs=!0}}x.callback!==null&&(t.flags|=32,a=g.effects,a===null?g.effects=[x]:a.push(x))}else F={eventTime:F,lane:a,tag:x.tag,payload:x.payload,callback:x.callback,next:null},V===null?(D=V=F,A=N):V=V.next=F,E|=a;if(x=x.next,x===null){if(a=g.shared.pending,a===null)break;x=a.next,a.next=null,g.lastBaseUpdate=a,g.shared.pending=null}}while(1);V===null&&(A=N),g.baseState=A,g.firstBaseUpdate=D,g.lastBaseUpdate=V,Zh|=E,t.lanes=E,t.memoizedState=N}}function Rb(t,n,s){if(t=n.effects,n.effects=null,t!==null)for(n=0;n<t.length;n++){var h=t[n],g=h.callback;if(g!==null){if(h.callback=null,h=s,typeof g!="function")throw Error(rt(191,g));g.call(h)}}}var Lb=new Up.Component().refs;function bf(t,n,s,h){n=t.memoizedState,s=s(h,n),s=s==null?n:zn({},n,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var wf={isMounted:function(t){return(t=t._reactInternals)?Wa(t)===t:!1},enqueueSetState:function(t,n,s){t=t._reactInternals;var h=Ei(),g=ia(t),x=ea(h,g);x.payload=n,s!=null&&(x.callback=s),ta(t,x),oa(t,g,h)},enqueueReplaceState:function(t,n,s){t=t._reactInternals;var h=Ei(),g=ia(t),x=ea(h,g);x.tag=1,x.payload=n,s!=null&&(x.callback=s),ta(t,x),oa(t,g,h)},enqueueForceUpdate:function(t,n){t=t._reactInternals;var s=Ei(),h=ia(t),g=ea(s,h);g.tag=2,n!=null&&(g.callback=n),ta(t,g),oa(t,h,s)}};function Ob(t,n,s,h,g,x,E){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(h,x,E):n.prototype&&n.prototype.isPureReactComponent?!kh(s,h)||!kh(g,x):!0}function Bb(t,n,s){var h=!1,g=Js,x=n.contextType;return typeof x=="object"&&x!==null?x=Di(x):(g=ai(n)?Xa:Rr.current,h=n.contextTypes,x=(h=h!=null)?Dc(t,g):Js),n=new n(s,x),t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=wf,t.stateNode=n,n._reactInternals=t,h&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=g,t.__reactInternalMemoizedMaskedChildContext=x),n}function Fb(t,n,s,h){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,h),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,h),n.state!==t&&wf.enqueueReplaceState(n,n.state,null)}function Y_(t,n,s,h){var g=t.stateNode;g.props=s,g.state=t.memoizedState,g.refs=Lb,K_(t);var x=n.contextType;typeof x=="object"&&x!==null?g.context=Di(x):(x=ai(n)?Xa:Rr.current,g.context=Dc(t,x)),Dh(t,s,g,h),g.state=t.memoizedState,x=n.getDerivedStateFromProps,typeof x=="function"&&(bf(t,n,x,s),g.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(n=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),n!==g.state&&wf.enqueueReplaceState(g,g.state,null),Dh(t,s,g,h),g.state=t.memoizedState),typeof g.componentDidMount=="function"&&(t.flags|=4)}var Ef=Array.isArray;function Rh(t,n,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(rt(309));var h=s.stateNode}if(!h)throw Error(rt(147,t));var g=""+t;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===g?n.ref:(n=function(x){var E=h.refs;E===Lb&&(E=h.refs={}),x===null?delete E[g]:E[g]=x},n._stringRef=g,n)}if(typeof t!="string")throw Error(rt(284));if(!s._owner)throw Error(rt(290,t))}return t}function Tf(t,n){if(t.type!=="textarea")throw Error(rt(31,Object.prototype.toString.call(n)==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":n))}function $b(t){function n(ee,G){if(t){var X=ee.lastEffect;X!==null?(X.nextEffect=G,ee.lastEffect=G):ee.firstEffect=ee.lastEffect=G,G.nextEffect=null,G.flags=8}}function s(ee,G){if(!t)return null;for(;G!==null;)n(ee,G),G=G.sibling;return null}function h(ee,G){for(ee=new Map;G!==null;)G.key!==null?ee.set(G.key,G):ee.set(G.index,G),G=G.sibling;return ee}function g(ee,G){return ee=la(ee,G),ee.index=0,ee.sibling=null,ee}function x(ee,G,X){return ee.index=X,t?(X=ee.alternate,X!==null?(X=X.index,X<G?(ee.flags=2,G):X):(ee.flags=2,G)):G}function E(ee){return t&&ee.alternate===null&&(ee.flags=2),ee}function a(ee,G,X,me){return G===null||G.tag!==6?(G=Dy(X,ee.mode,me),G.return=ee,G):(G=g(G,X),G.return=ee,G)}function A(ee,G,X,me){return G!==null&&G.elementType===X.type?(me=g(G,X.props),me.ref=Rh(ee,G,X),me.return=ee,me):(me=jf(X.type,X.key,X.props,null,ee.mode,me),me.ref=Rh(ee,G,X),me.return=ee,me)}function D(ee,G,X,me){return G===null||G.tag!==4||G.stateNode.containerInfo!==X.containerInfo||G.stateNode.implementation!==X.implementation?(G=Ry(X,ee.mode,me),G.return=ee,G):(G=g(G,X.children||[]),G.return=ee,G)}function V(ee,G,X,me,Te){return G===null||G.tag!==7?(G=Gc(X,ee.mode,me,Te),G.return=ee,G):(G=g(G,X),G.return=ee,G)}function N(ee,G,X){if(typeof G=="string"||typeof G=="number")return G=Dy(""+G,ee.mode,X),G.return=ee,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case sh:return X=jf(G.type,G.key,G.props,null,ee.mode,X),X.ref=Rh(ee,null,G),X.return=ee,X;case Za:return G=Ry(G,ee.mode,X),G.return=ee,G}if(Ef(G)||ch(G))return G=Gc(G,ee.mode,X,null),G.return=ee,G;Tf(ee,G)}return null}function F(ee,G,X,me){var Te=G!==null?G.key:null;if(typeof X=="string"||typeof X=="number")return Te!==null?null:a(ee,G,""+X,me);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case sh:return X.key===Te?X.type===Vs?V(ee,G,X.props.children,me,Te):A(ee,G,X,me):null;case Za:return X.key===Te?D(ee,G,X,me):null}if(Ef(X)||ch(X))return Te!==null?null:V(ee,G,X,me,null);Tf(ee,X)}return null}function ae(ee,G,X,me,Te){if(typeof me=="string"||typeof me=="number")return ee=ee.get(X)||null,a(G,ee,""+me,Te);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case sh:return ee=ee.get(me.key===null?X:me.key)||null,me.type===Vs?V(G,ee,me.props.children,Te,me.key):A(G,ee,me,Te);case Za:return ee=ee.get(me.key===null?X:me.key)||null,D(G,ee,me,Te)}if(Ef(me)||ch(me))return ee=ee.get(X)||null,V(G,ee,me,Te,null);Tf(G,me)}return null}function be(ee,G,X,me){for(var Te=null,We=null,Pe=G,Le=G=0,Ke=null;Pe!==null&&Le<X.length;Le++){Pe.index>Le?(Ke=Pe,Pe=null):Ke=Pe.sibling;var Ye=F(ee,Pe,X[Le],me);if(Ye===null){Pe===null&&(Pe=Ke);break}t&&Pe&&Ye.alternate===null&&n(ee,Pe),G=x(Ye,G,Le),We===null?Te=Ye:We.sibling=Ye,We=Ye,Pe=Ke}if(Le===X.length)return s(ee,Pe),Te;if(Pe===null){for(;Le<X.length;Le++)Pe=N(ee,X[Le],me),Pe!==null&&(G=x(Pe,G,Le),We===null?Te=Pe:We.sibling=Pe,We=Pe);return Te}for(Pe=h(ee,Pe);Le<X.length;Le++)Ke=ae(Pe,ee,Le,X[Le],me),Ke!==null&&(t&&Ke.alternate!==null&&Pe.delete(Ke.key===null?Le:Ke.key),G=x(Ke,G,Le),We===null?Te=Ke:We.sibling=Ke,We=Ke);return t&&Pe.forEach(function(it){return n(ee,it)}),Te}function fe(ee,G,X,me){var Te=ch(X);if(typeof Te!="function")throw Error(rt(150));if(X=Te.call(X),X==null)throw Error(rt(151));for(var We=Te=null,Pe=G,Le=G=0,Ke=null,Ye=X.next();Pe!==null&&!Ye.done;Le++,Ye=X.next()){Pe.index>Le?(Ke=Pe,Pe=null):Ke=Pe.sibling;var it=F(ee,Pe,Ye.value,me);if(it===null){Pe===null&&(Pe=Ke);break}t&&Pe&&it.alternate===null&&n(ee,Pe),G=x(it,G,Le),We===null?Te=it:We.sibling=it,We=it,Pe=Ke}if(Ye.done)return s(ee,Pe),Te;if(Pe===null){for(;!Ye.done;Le++,Ye=X.next())Ye=N(ee,Ye.value,me),Ye!==null&&(G=x(Ye,G,Le),We===null?Te=Ye:We.sibling=Ye,We=Ye);return Te}for(Pe=h(ee,Pe);!Ye.done;Le++,Ye=X.next())Ye=ae(Pe,ee,Le,Ye.value,me),Ye!==null&&(t&&Ye.alternate!==null&&Pe.delete(Ye.key===null?Le:Ye.key),G=x(Ye,G,Le),We===null?Te=Ye:We.sibling=Ye,We=Ye);return t&&Pe.forEach(function(st){return n(ee,st)}),Te}return function(ee,G,X,me){var Te=typeof X=="object"&&X!==null&&X.type===Vs&&X.key===null;Te&&(X=X.props.children);var We=typeof X=="object"&&X!==null;if(We)switch(X.$$typeof){case sh:e:{for(We=X.key,Te=G;Te!==null;){if(Te.key===We){switch(Te.tag){case 7:if(X.type===Vs){s(ee,Te.sibling),G=g(Te,X.props.children),G.return=ee,ee=G;break e}break;default:if(Te.elementType===X.type){s(ee,Te.sibling),G=g(Te,X.props),G.ref=Rh(ee,Te,X),G.return=ee,ee=G;break e}}s(ee,Te);break}else n(ee,Te);Te=Te.sibling}X.type===Vs?(G=Gc(X.props.children,ee.mode,me,X.key),G.return=ee,ee=G):(me=jf(X.type,X.key,X.props,null,ee.mode,me),me.ref=Rh(ee,G,X),me.return=ee,ee=me)}return E(ee);case Za:e:{for(Te=X.key;G!==null;){if(G.key===Te)if(G.tag===4&&G.stateNode.containerInfo===X.containerInfo&&G.stateNode.implementation===X.implementation){s(ee,G.sibling),G=g(G,X.children||[]),G.return=ee,ee=G;break e}else{s(ee,G);break}else n(ee,G);G=G.sibling}G=Ry(X,ee.mode,me),G.return=ee,ee=G}return E(ee)}if(typeof X=="string"||typeof X=="number")return X=""+X,G!==null&&G.tag===6?(s(ee,G.sibling),G=g(G,X),G.return=ee,ee=G):(s(ee,G),G=Dy(X,ee.mode,me),G.return=ee,ee=G),E(ee);if(Ef(X))return be(ee,G,X,me);if(ch(X))return fe(ee,G,X,me);if(We&&Tf(ee,X),typeof X=="undefined"&&!Te)switch(ee.tag){case 1:case 22:case 0:case 11:case 15:throw Error(rt(152,yc(ee.type)||"Component"))}return s(ee,G)}}var Sf=$b(!0),Nb=$b(!1),Lh={},Co=Ys(Lh),Oh=Ys(Lh),Bh=Ys(Lh);function Ja(t){if(t===Lh)throw Error(rt(174));return t}function J_(t,n){switch(Xn(Bh,n),Xn(Oh,t),Xn(Co,Lh),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:r_(null,"");break;default:t=t===8?n.parentNode:n,n=t.namespaceURI||null,t=t.tagName,n=r_(n,t)}kn(Co),Xn(Co,n)}function Bc(){kn(Co),kn(Oh),kn(Bh)}function Ub(t){Ja(Bh.current);var n=Ja(Co.current),s=r_(n,t.type);n!==s&&(Xn(Oh,t),Xn(Co,s))}function Q_(t){Oh.current===t&&(kn(Co),kn(Oh))}var Kn=Ys(0);function Cf(t){for(var n=t;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&64)!=0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var ns=null,na=null,ko=!1;function jb(t,n){var s=Oi(5,null,null,0);s.elementType="DELETED",s.type="DELETED",s.stateNode=n,s.return=t,s.flags=8,t.lastEffect!==null?(t.lastEffect.nextEffect=s,t.lastEffect=s):t.firstEffect=t.lastEffect=s}function Vb(t,n){switch(t.tag){case 5:var s=t.type;return n=n.nodeType!==1||s.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(t.stateNode=n,!0):!1;case 6:return n=t.pendingProps===""||n.nodeType!==3?null:n,n!==null?(t.stateNode=n,!0):!1;case 13:return!1;default:return!1}}function ey(t){if(ko){var n=na;if(n){var s=n;if(!Vb(t,n)){if(n=Ac(s.nextSibling),!n||!Vb(t,n)){t.flags=t.flags&-1025|2,ko=!1,ns=t;return}jb(ns,s)}ns=t,na=Ac(n.firstChild)}else t.flags=t.flags&-1025|2,ko=!1,ns=t}}function Gb(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ns=t}function kf(t){if(t!==ns)return!1;if(!ko)return Gb(t),ko=!0,!1;var n=t.type;if(t.tag!==5||n!=="head"&&n!=="body"&&!F_(n,t.memoizedProps))for(n=na;n;)jb(t,n),n=Ac(n.nextSibling);if(Gb(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(rt(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(n===0){na=Ac(t.nextSibling);break e}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++}t=t.nextSibling}na=null}}else na=ns?Ac(t.stateNode.nextSibling):null;return!0}function ty(){na=ns=null,ko=!1}var Fc=[];function ny(){for(var t=0;t<Fc.length;t++)Fc[t]._workInProgressVersionPrimary=null;Fc.length=0}var Fh=Ga.ReactCurrentDispatcher,Ri=Ga.ReactCurrentBatchConfig,$h=0,Qn=null,Or=null,Ar=null,If=!1,Nh=!1;function li(){throw Error(rt(321))}function ry(t,n){if(n===null)return!1;for(var s=0;s<n.length&&s<t.length;s++)if(!zi(t[s],n[s]))return!1;return!0}function iy(t,n,s,h,g,x){if($h=x,Qn=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Fh.current=t===null||t.memoizedState===null?UI:jI,t=s(h,g),Nh){x=0;do{if(Nh=!1,!(25>x))throw Error(rt(301));x+=1,Ar=Or=null,n.updateQueue=null,Fh.current=VI,t=s(h,g)}while(Nh)}if(Fh.current=zf,n=Or!==null&&Or.next!==null,$h=0,Ar=Or=Qn=null,If=!1,n)throw Error(rt(300));return t}function Qa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?Qn.memoizedState=Ar=t:Ar=Ar.next=t,Ar}function el(){if(Or===null){var t=Qn.alternate;t=t!==null?t.memoizedState:null}else t=Or.next;var n=Ar===null?Qn.memoizedState:Ar.next;if(n!==null)Ar=n,Or=t;else{if(t===null)throw Error(rt(310));Or=t,t={memoizedState:Or.memoizedState,baseState:Or.baseState,baseQueue:Or.baseQueue,queue:Or.queue,next:null},Ar===null?Qn.memoizedState=Ar=t:Ar=Ar.next=t}return Ar}function Io(t,n){return typeof n=="function"?n(t):n}function Uh(t){var n=el(),s=n.queue;if(s===null)throw Error(rt(311));s.lastRenderedReducer=t;var h=Or,g=h.baseQueue,x=s.pending;if(x!==null){if(g!==null){var E=g.next;g.next=x.next,x.next=E}h.baseQueue=g=x,s.pending=null}if(g!==null){g=g.next,h=h.baseState;var a=E=x=null,A=g;do{var D=A.lane;if(($h&D)===D)a!==null&&(a=a.next={lane:0,action:A.action,eagerReducer:A.eagerReducer,eagerState:A.eagerState,next:null}),h=A.eagerReducer===t?A.eagerState:t(h,A.action);else{var V={lane:D,action:A.action,eagerReducer:A.eagerReducer,eagerState:A.eagerState,next:null};a===null?(E=a=V,x=h):a=a.next=V,Qn.lanes|=D,Zh|=D}A=A.next}while(A!==null&&A!==g);a===null?x=h:a.next=E,zi(h,n.memoizedState)||(Ji=!0),n.memoizedState=h,n.baseState=x,n.baseQueue=a,s.lastRenderedState=h}return[n.memoizedState,s.dispatch]}function jh(t){var n=el(),s=n.queue;if(s===null)throw Error(rt(311));s.lastRenderedReducer=t;var h=s.dispatch,g=s.pending,x=n.memoizedState;if(g!==null){s.pending=null;var E=g=g.next;do x=t(x,E.action),E=E.next;while(E!==g);zi(x,n.memoizedState)||(Ji=!0),n.memoizedState=x,n.baseQueue===null&&(n.baseState=x),s.lastRenderedState=x}return[x,h]}function Zb(t,n,s){var h=n._getVersion;h=h(n._source);var g=n._workInProgressVersionPrimary;if(g!==null?t=g===h:(t=t.mutableReadLanes,(t=($h&t)===t)&&(n._workInProgressVersionPrimary=h,Fc.push(n))),t)return s(n._source);throw Fc.push(n),Error(rt(350))}function qb(t,n,s,h){var g=Wr;if(g===null)throw Error(rt(349));var x=n._getVersion,E=x(n._source),a=Fh.current,A=a.useState(function(){return Zb(g,n,s)}),D=A[1],V=A[0];A=Ar;var N=t.memoizedState,F=N.refs,ae=F.getSnapshot,be=N.source;N=N.subscribe;var fe=Qn;return t.memoizedState={refs:F,source:n,subscribe:h},a.useEffect(function(){F.getSnapshot=s,F.setSnapshot=D;var ee=x(n._source);if(!zi(E,ee)){ee=s(n._source),zi(V,ee)||(D(ee),ee=ia(fe),g.mutableReadLanes|=ee&g.pendingLanes),ee=g.mutableReadLanes,g.entangledLanes|=ee;for(var G=g.entanglements,X=ee;0<X;){var me=31-Hs(X),Te=1<<me;G[me]|=ee,X&=~Te}}},[s,n,h]),a.useEffect(function(){return h(n._source,function(){var ee=F.getSnapshot,G=F.setSnapshot;try{G(ee(n._source));var X=ia(fe);g.mutableReadLanes|=X&g.pendingLanes}catch(me){G(function(){throw me})}})},[n,h]),zi(ae,s)&&zi(be,n)&&zi(N,h)||(t={pending:null,dispatch:null,lastRenderedReducer:Io,lastRenderedState:V},t.dispatch=D=ly.bind(null,Qn,t),A.queue=t,A.baseQueue=null,V=Zb(g,n,s),A.memoizedState=A.baseState=V),V}function Wb(t,n,s){var h=el();return qb(h,t,n,s)}function Vh(t){var n=Qa();return typeof t=="function"&&(t=t()),n.memoizedState=n.baseState=t,t=n.queue={pending:null,dispatch:null,lastRenderedReducer:Io,lastRenderedState:t},t=t.dispatch=ly.bind(null,Qn,t),[n.memoizedState,t]}function Af(t,n,s,h){return t={tag:t,create:n,destroy:s,deps:h,next:null},n=Qn.updateQueue,n===null?(n={lastEffect:null},Qn.updateQueue=n,n.lastEffect=t.next=t):(s=n.lastEffect,s===null?n.lastEffect=t.next=t:(h=s.next,s.next=t,t.next=h,n.lastEffect=t)),t}function Hb(t){var n=Qa();return t={current:t},n.memoizedState=t}function Mf(){return el().memoizedState}function oy(t,n,s,h){var g=Qa();Qn.flags|=t,g.memoizedState=Af(1|n,s,void 0,h===void 0?null:h)}function sy(t,n,s,h){var g=el();h=h===void 0?null:h;var x=void 0;if(Or!==null){var E=Or.memoizedState;if(x=E.destroy,h!==null&&ry(h,E.deps)){Af(n,s,x,h);return}}Qn.flags|=t,g.memoizedState=Af(1|n,s,x,h)}function Xb(t,n){return oy(516,4,t,n)}function Pf(t,n){return sy(516,4,t,n)}function Kb(t,n){return sy(4,2,t,n)}function Yb(t,n){if(typeof n=="function")return t=t(),n(t),function(){n(null)};if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function Jb(t,n,s){return s=s!=null?s.concat([t]):null,sy(4,2,Yb.bind(null,n,t),s)}function ay(){}function Qb(t,n){var s=el();n=n===void 0?null:n;var h=s.memoizedState;return h!==null&&n!==null&&ry(n,h[1])?h[0]:(s.memoizedState=[t,n],t)}function ew(t,n){var s=el();n=n===void 0?null:n;var h=s.memoizedState;return h!==null&&n!==null&&ry(n,h[1])?h[0]:(t=t(),s.memoizedState=[t,n],t)}function NI(t,n){var s=Rc();Ya(98>s?98:s,function(){t(!0)}),Ya(97<s?97:s,function(){var h=Ri.transition;Ri.transition=1;try{t(!1),n()}finally{Ri.transition=h}})}function ly(t,n,s){var h=Ei(),g=ia(t),x={lane:g,action:s,eagerReducer:null,eagerState:null,next:null},E=n.pending;if(E===null?x.next=x:(x.next=E.next,E.next=x),n.pending=x,E=t.alternate,t===Qn||E!==null&&E===Qn)Nh=If=!0;else{if(t.lanes===0&&(E===null||E.lanes===0)&&(E=n.lastRenderedReducer,E!==null))try{var a=n.lastRenderedState,A=E(a,s);if(x.eagerReducer=E,x.eagerState=A,zi(A,a))return}catch{}finally{}oa(t,g,h)}}var zf={readContext:Di,useCallback:li,useContext:li,useEffect:li,useImperativeHandle:li,useLayoutEffect:li,useMemo:li,useReducer:li,useRef:li,useState:li,useDebugValue:li,useDeferredValue:li,useTransition:li,useMutableSource:li,useOpaqueIdentifier:li,unstable_isNewReconciler:!1},UI={readContext:Di,useCallback:function(t,n){return Qa().memoizedState=[t,n===void 0?null:n],t},useContext:Di,useEffect:Xb,useImperativeHandle:function(t,n,s){return s=s!=null?s.concat([t]):null,oy(4,2,Yb.bind(null,n,t),s)},useLayoutEffect:function(t,n){return oy(4,2,t,n)},useMemo:function(t,n){var s=Qa();return n=n===void 0?null:n,t=t(),s.memoizedState=[t,n],t},useReducer:function(t,n,s){var h=Qa();return n=s!==void 0?s(n):n,h.memoizedState=h.baseState=n,t=h.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},t=t.dispatch=ly.bind(null,Qn,t),[h.memoizedState,t]},useRef:Hb,useState:Vh,useDebugValue:ay,useDeferredValue:function(t){var n=Vh(t),s=n[0],h=n[1];return Xb(function(){var g=Ri.transition;Ri.transition=1;try{h(t)}finally{Ri.transition=g}},[t]),s},useTransition:function(){var t=Vh(!1),n=t[0];return t=NI.bind(null,t[1]),Hb(t),[t,n]},useMutableSource:function(t,n,s){var h=Qa();return h.memoizedState={refs:{getSnapshot:n,setSnapshot:null},source:t,subscribe:s},qb(h,t,n,s)},useOpaqueIdentifier:function(){if(ko){var t=!1,n=RI(function(){throw t||(t=!0,s("r:"+(N_++).toString(36))),Error(rt(355))}),s=Vh(n)[1];return(Qn.mode&2)==0&&(Qn.flags|=516,Af(5,function(){s("r:"+(N_++).toString(36))},void 0,null)),n}return n="r:"+(N_++).toString(36),Vh(n),n},unstable_isNewReconciler:!1},jI={readContext:Di,useCallback:Qb,useContext:Di,useEffect:Pf,useImperativeHandle:Jb,useLayoutEffect:Kb,useMemo:ew,useReducer:Uh,useRef:Mf,useState:function(){return Uh(Io)},useDebugValue:ay,useDeferredValue:function(t){var n=Uh(Io),s=n[0],h=n[1];return Pf(function(){var g=Ri.transition;Ri.transition=1;try{h(t)}finally{Ri.transition=g}},[t]),s},useTransition:function(){var t=Uh(Io)[0];return[Mf().current,t]},useMutableSource:Wb,useOpaqueIdentifier:function(){return Uh(Io)[0]},unstable_isNewReconciler:!1},VI={readContext:Di,useCallback:Qb,useContext:Di,useEffect:Pf,useImperativeHandle:Jb,useLayoutEffect:Kb,useMemo:ew,useReducer:jh,useRef:Mf,useState:function(){return jh(Io)},useDebugValue:ay,useDeferredValue:function(t){var n=jh(Io),s=n[0],h=n[1];return Pf(function(){var g=Ri.transition;Ri.transition=1;try{h(t)}finally{Ri.transition=g}},[t]),s},useTransition:function(){var t=jh(Io)[0];return[Mf().current,t]},useMutableSource:Wb,useOpaqueIdentifier:function(){return jh(Io)[0]},unstable_isNewReconciler:!1},GI=Ga.ReactCurrentOwner,Ji=!1;function ci(t,n,s,h){n.child=t===null?Nb(n,null,s,h):Sf(n,t.child,s,h)}function tw(t,n,s,h,g){s=s.render;var x=n.ref;return Oc(n,g),h=iy(t,n,s,h,x,g),t!==null&&!Ji?(n.updateQueue=t.updateQueue,n.flags&=-517,t.lanes&=~g,rs(t,n,g)):(n.flags|=1,ci(t,n,h,g),n.child)}function nw(t,n,s,h,g,x){if(t===null){var E=s.type;return typeof E=="function"&&!Py(E)&&E.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(n.tag=15,n.type=E,rw(t,n,E,h,g,x)):(t=jf(s.type,null,h,n,n.mode,x),t.ref=n.ref,t.return=n,n.child=t)}return E=t.child,(g&x)==0&&(g=E.memoizedProps,s=s.compare,s=s!==null?s:kh,s(g,h)&&t.ref===n.ref)?rs(t,n,x):(n.flags|=1,t=la(E,h),t.ref=n.ref,t.return=n,n.child=t)}function rw(t,n,s,h,g,x){if(t!==null&&kh(t.memoizedProps,h)&&t.ref===n.ref)if(Ji=!1,(x&g)!=0)(t.flags&16384)!=0&&(Ji=!0);else return n.lanes=t.lanes,rs(t,n,x);return uy(t,n,s,h,x)}function cy(t,n,s){var h=n.pendingProps,g=h.children,x=t!==null?t.memoizedState:null;if(h.mode==="hidden"||h.mode==="unstable-defer-without-hiding")if((n.mode&4)==0)n.memoizedState={baseLanes:0},Uf(n,s);else if((s&1073741824)!=0)n.memoizedState={baseLanes:0},Uf(n,x!==null?x.baseLanes:s);else return t=x!==null?x.baseLanes|s:s,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:t},Uf(n,t),null;else x!==null?(h=x.baseLanes|s,n.memoizedState=null):h=s,Uf(n,h);return ci(t,n,g,s),n.child}function iw(t,n){var s=n.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(n.flags|=128)}function uy(t,n,s,h,g){var x=ai(s)?Xa:Rr.current;return x=Dc(n,x),Oc(n,g),s=iy(t,n,s,h,x,g),t!==null&&!Ji?(n.updateQueue=t.updateQueue,n.flags&=-517,t.lanes&=~g,rs(t,n,g)):(n.flags|=1,ci(t,n,s,g),n.child)}function ow(t,n,s,h,g){if(ai(s)){var x=!0;mf(n)}else x=!1;if(Oc(n,g),n.stateNode===null)t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2),Bb(n,s,h),Y_(n,s,h,g),h=!0;else if(t===null){var E=n.stateNode,a=n.memoizedProps;E.props=a;var A=E.context,D=s.contextType;typeof D=="object"&&D!==null?D=Di(D):(D=ai(s)?Xa:Rr.current,D=Dc(n,D));var V=s.getDerivedStateFromProps,N=typeof V=="function"||typeof E.getSnapshotBeforeUpdate=="function";N||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(a!==h||A!==D)&&Fb(n,E,h,D),Qs=!1;var F=n.memoizedState;E.state=F,Dh(n,h,E,g),A=n.memoizedState,a!==h||F!==A||si.current||Qs?(typeof V=="function"&&(bf(n,s,V,h),A=n.memoizedState),(a=Qs||Ob(n,s,a,h,F,A,D))?(N||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(n.flags|=4)):(typeof E.componentDidMount=="function"&&(n.flags|=4),n.memoizedProps=h,n.memoizedState=A),E.props=h,E.state=A,E.context=D,h=a):(typeof E.componentDidMount=="function"&&(n.flags|=4),h=!1)}else{E=n.stateNode,zb(t,n),a=n.memoizedProps,D=n.type===n.elementType?a:Yi(n.type,a),E.props=D,N=n.pendingProps,F=E.context,A=s.contextType,typeof A=="object"&&A!==null?A=Di(A):(A=ai(s)?Xa:Rr.current,A=Dc(n,A));var ae=s.getDerivedStateFromProps;(V=typeof ae=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(a!==N||F!==A)&&Fb(n,E,h,A),Qs=!1,F=n.memoizedState,E.state=F,Dh(n,h,E,g);var be=n.memoizedState;a!==N||F!==be||si.current||Qs?(typeof ae=="function"&&(bf(n,s,ae,h),be=n.memoizedState),(D=Qs||Ob(n,s,D,h,F,be,A))?(V||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(h,be,A),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(h,be,A)),typeof E.componentDidUpdate=="function"&&(n.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(n.flags|=256)):(typeof E.componentDidUpdate!="function"||a===t.memoizedProps&&F===t.memoizedState||(n.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&F===t.memoizedState||(n.flags|=256),n.memoizedProps=h,n.memoizedState=be),E.props=h,E.state=be,E.context=A,h=D):(typeof E.componentDidUpdate!="function"||a===t.memoizedProps&&F===t.memoizedState||(n.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&F===t.memoizedState||(n.flags|=256),h=!1)}return hy(t,n,s,h,x,g)}function hy(t,n,s,h,g,x){iw(t,n);var E=(n.flags&64)!=0;if(!h&&!E)return g&&wb(n,s,!1),rs(t,n,x);h=n.stateNode,GI.current=n;var a=E&&typeof s.getDerivedStateFromError!="function"?null:h.render();return n.flags|=1,t!==null&&E?(n.child=Sf(n,t.child,null,x),n.child=Sf(n,null,a,x)):ci(t,n,a,x),n.memoizedState=h.state,g&&wb(n,s,!0),n.child}function sw(t){var n=t.stateNode;n.pendingContext?xb(t,n.pendingContext,n.pendingContext!==n.context):n.context&&xb(t,n.context,!1),J_(t,n.containerInfo)}var Df={dehydrated:null,retryLane:0};function aw(t,n,s){var h=n.pendingProps,g=Kn.current,x=!1,E;return(E=(n.flags&64)!=0)||(E=t!==null&&t.memoizedState===null?!1:(g&2)!=0),E?(x=!0,n.flags&=-65):t!==null&&t.memoizedState===null||h.fallback===void 0||h.unstable_avoidThisFallback===!0||(g|=1),Xn(Kn,g&1),t===null?(h.fallback!==void 0&&ey(n),t=h.children,g=h.fallback,x?(t=lw(n,t,g,s),n.child.memoizedState={baseLanes:s},n.memoizedState=Df,t):typeof h.unstable_expectedLoadTime=="number"?(t=lw(n,t,g,s),n.child.memoizedState={baseLanes:s},n.memoizedState=Df,n.lanes=33554432,t):(s=zy({mode:"visible",children:t},n.mode,s,null),s.return=n,n.child=s)):t.memoizedState!==null?x?(h=uw(t,n,h.children,h.fallback,s),x=n.child,g=t.child.memoizedState,x.memoizedState=g===null?{baseLanes:s}:{baseLanes:g.baseLanes|s},x.childLanes=t.childLanes&~s,n.memoizedState=Df,h):(s=cw(t,n,h.children,s),n.memoizedState=null,s):x?(h=uw(t,n,h.children,h.fallback,s),x=n.child,g=t.child.memoizedState,x.memoizedState=g===null?{baseLanes:s}:{baseLanes:g.baseLanes|s},x.childLanes=t.childLanes&~s,n.memoizedState=Df,h):(s=cw(t,n,h.children,s),n.memoizedState=null,s)}function lw(t,n,s,h){var g=t.mode,x=t.child;return n={mode:"hidden",children:n},(g&2)==0&&x!==null?(x.childLanes=0,x.pendingProps=n):x=zy(n,g,0,null),s=Gc(s,g,h,null),x.return=t,s.return=t,x.sibling=s,t.child=x,s}function cw(t,n,s,h){var g=t.child;return t=g.sibling,s=la(g,{mode:"visible",children:s}),(n.mode&2)==0&&(s.lanes=h),s.return=n,s.sibling=null,t!==null&&(t.nextEffect=null,t.flags=8,n.firstEffect=n.lastEffect=t),n.child=s}function uw(t,n,s,h,g){var x=n.mode,E=t.child;t=E.sibling;var a={mode:"hidden",children:s};return(x&2)==0&&n.child!==E?(s=n.child,s.childLanes=0,s.pendingProps=a,E=s.lastEffect,E!==null?(n.firstEffect=s.firstEffect,n.lastEffect=E,E.nextEffect=null):n.firstEffect=n.lastEffect=null):s=la(E,a),t!==null?h=la(t,h):(h=Gc(h,x,g,null),h.flags|=2),h.return=n,s.return=n,s.sibling=h,n.child=s,h}function hw(t,n){t.lanes|=n;var s=t.alternate;s!==null&&(s.lanes|=n),Pb(t.return,n)}function dy(t,n,s,h,g,x){var E=t.memoizedState;E===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:h,tail:s,tailMode:g,lastEffect:x}:(E.isBackwards=n,E.rendering=null,E.renderingStartTime=0,E.last=h,E.tail=s,E.tailMode=g,E.lastEffect=x)}function dw(t,n,s){var h=n.pendingProps,g=h.revealOrder,x=h.tail;if(ci(t,n,h.children,s),h=Kn.current,(h&2)!=0)h=h&1|2,n.flags|=64;else{if(t!==null&&(t.flags&64)!=0)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&hw(t,s);else if(t.tag===19)hw(t,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}h&=1}if(Xn(Kn,h),(n.mode&2)==0)n.memoizedState=null;else switch(g){case"forwards":for(s=n.child,g=null;s!==null;)t=s.alternate,t!==null&&Cf(t)===null&&(g=s),s=s.sibling;s=g,s===null?(g=n.child,n.child=null):(g=s.sibling,s.sibling=null),dy(n,!1,g,s,x,n.lastEffect);break;case"backwards":for(s=null,g=n.child,n.child=null;g!==null;){if(t=g.alternate,t!==null&&Cf(t)===null){n.child=g;break}t=g.sibling,g.sibling=s,s=g,g=t}dy(n,!0,s,null,x,n.lastEffect);break;case"together":dy(n,!1,null,null,void 0,n.lastEffect);break;default:n.memoizedState=null}return n.child}function rs(t,n,s){if(t!==null&&(n.dependencies=t.dependencies),Zh|=n.lanes,(s&n.childLanes)!=0){if(t!==null&&n.child!==t.child)throw Error(rt(153));if(n.child!==null){for(t=n.child,s=la(t,t.pendingProps),n.child=s,s.return=n;t.sibling!==null;)t=t.sibling,s=s.sibling=la(t,t.pendingProps),s.return=n;s.sibling=null}return n.child}return null}var pw,py,fw,mw;pw=function(t,n){for(var s=n.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};py=function(){};fw=function(t,n,s,h){var g=t.memoizedProps;if(g!==h){t=n.stateNode,Ja(Co.current);var x=null;switch(s){case"input":g=Yg(t,g),h=Yg(t,h),x=[];break;case"option":g=e_(t,g),h=e_(t,h),x=[];break;case"select":g=zn({},g,{value:void 0}),h=zn({},h,{value:void 0}),x=[];break;case"textarea":g=t_(t,g),h=t_(t,h),x=[];break;default:typeof g.onClick!="function"&&typeof h.onClick=="function"&&(t.onclick=uf)}i_(s,h);var E;s=null;for(D in g)if(!h.hasOwnProperty(D)&&g.hasOwnProperty(D)&&g[D]!=null)if(D==="style"){var a=g[D];for(E in a)a.hasOwnProperty(E)&&(s||(s={}),s[E]="")}else D!=="dangerouslySetInnerHTML"&&D!=="children"&&D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(oh.hasOwnProperty(D)?x||(x=[]):(x=x||[]).push(D,null));for(D in h){var A=h[D];if(a=g!=null?g[D]:void 0,h.hasOwnProperty(D)&&A!==a&&(A!=null||a!=null))if(D==="style")if(a){for(E in a)!a.hasOwnProperty(E)||A&&A.hasOwnProperty(E)||(s||(s={}),s[E]="");for(E in A)A.hasOwnProperty(E)&&a[E]!==A[E]&&(s||(s={}),s[E]=A[E])}else s||(x||(x=[]),x.push(D,s)),s=A;else D==="dangerouslySetInnerHTML"?(A=A?A.__html:void 0,a=a?a.__html:void 0,A!=null&&a!==A&&(x=x||[]).push(D,A)):D==="children"?typeof A!="string"&&typeof A!="number"||(x=x||[]).push(D,""+A):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&(oh.hasOwnProperty(D)?(A!=null&&D==="onScroll"&&Cn("scroll",t),x||a===A||(x=[])):typeof A=="object"&&A!==null&&A.$$typeof===qg?A.toString():(x=x||[]).push(D,A))}s&&(x=x||[]).push("style",s);var D=x;(n.updateQueue=D)&&(n.flags|=4)}};mw=function(t,n,s,h){s!==h&&(n.flags|=4)};function Gh(t,n){if(!ko)switch(t.tailMode){case"hidden":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var h=null;s!==null;)s.alternate!==null&&(h=s),s=s.sibling;h===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:h.sibling=null}}function ZI(t,n,s){var h=n.pendingProps;switch(n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return ai(n.type)&&ff(),null;case 3:return Bc(),kn(si),kn(Rr),ny(),h=n.stateNode,h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(t===null||t.child===null)&&(kf(n)?n.flags|=4:h.hydrate||(n.flags|=256)),py(n),null;case 5:Q_(n);var g=Ja(Bh.current);if(s=n.type,t!==null&&n.stateNode!=null)fw(t,n,s,h,g),t.ref!==n.ref&&(n.flags|=128);else{if(!h){if(n.stateNode===null)throw Error(rt(166));return null}if(t=Ja(Co.current),kf(n)){h=n.stateNode,s=n.type;var x=n.memoizedProps;switch(h[Ks]=n,h[df]=x,s){case"dialog":Cn("cancel",h),Cn("close",h);break;case"iframe":case"object":case"embed":Cn("load",h);break;case"video":case"audio":for(t=0;t<Ah.length;t++)Cn(Ah[t],h);break;case"source":Cn("error",h);break;case"img":case"image":case"link":Cn("error",h),Cn("load",h);break;case"details":Cn("toggle",h);break;case"input":o1(h,x),Cn("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!x.multiple},Cn("invalid",h);break;case"textarea":l1(h,x),Cn("invalid",h)}i_(s,x),t=null;for(var E in x)x.hasOwnProperty(E)&&(g=x[E],E==="children"?typeof g=="string"?h.textContent!==g&&(t=["children",g]):typeof g=="number"&&h.textContent!==""+g&&(t=["children",""+g]):oh.hasOwnProperty(E)&&g!=null&&E==="onScroll"&&Cn("scroll",h));switch(s){case"input":qp(h),a1(h,x,!0);break;case"textarea":qp(h),u1(h);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(h.onclick=uf)}h=t,n.updateQueue=h,h!==null&&(n.flags|=4)}else{switch(E=g.nodeType===9?g:g.ownerDocument,t===n_.html&&(t=h1(s)),t===n_.html?s==="script"?(t=E.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof h.is=="string"?t=E.createElement(s,{is:h.is}):(t=E.createElement(s),s==="select"&&(E=t,h.multiple?E.multiple=!0:h.size&&(E.size=h.size))):t=E.createElementNS(t,s),t[Ks]=n,t[df]=h,pw(t,n,!1,!1),n.stateNode=t,E=o_(s,h),s){case"dialog":Cn("cancel",t),Cn("close",t),g=h;break;case"iframe":case"object":case"embed":Cn("load",t),g=h;break;case"video":case"audio":for(g=0;g<Ah.length;g++)Cn(Ah[g],t);g=h;break;case"source":Cn("error",t),g=h;break;case"img":case"image":case"link":Cn("error",t),Cn("load",t),g=h;break;case"details":Cn("toggle",t),g=h;break;case"input":o1(t,h),g=Yg(t,h),Cn("invalid",t);break;case"option":g=e_(t,h);break;case"select":t._wrapperState={wasMultiple:!!h.multiple},g=zn({},h,{value:void 0}),Cn("invalid",t);break;case"textarea":l1(t,h),g=t_(t,h),Cn("invalid",t);break;default:g=h}i_(s,g);var a=g;for(x in a)if(a.hasOwnProperty(x)){var A=a[x];x==="style"?f1(t,A):x==="dangerouslySetInnerHTML"?(A=A?A.__html:void 0,A!=null&&d1(t,A)):x==="children"?typeof A=="string"?(s!=="textarea"||A!=="")&&hh(t,A):typeof A=="number"&&hh(t,""+A):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(oh.hasOwnProperty(x)?A!=null&&x==="onScroll"&&Cn("scroll",t):A!=null&&Ng(t,x,A,E))}switch(s){case"input":qp(t),a1(t,h,!1);break;case"textarea":qp(t),u1(t);break;case"option":h.value!=null&&t.setAttribute("value",""+Gs(h.value));break;case"select":t.multiple=!!h.multiple,x=h.value,x!=null?vc(t,!!h.multiple,x,!1):h.defaultValue!=null&&vc(t,!!h.multiple,h.defaultValue,!0);break;default:typeof g.onClick=="function"&&(t.onclick=uf)}mb(s,h)&&(n.flags|=4)}n.ref!==null&&(n.flags|=128)}return null;case 6:if(t&&n.stateNode!=null)mw(t,n,t.memoizedProps,h);else{if(typeof h!="string"&&n.stateNode===null)throw Error(rt(166));s=Ja(Bh.current),Ja(Co.current),kf(n)?(h=n.stateNode,s=n.memoizedProps,h[Ks]=n,h.nodeValue!==s&&(n.flags|=4)):(h=(s.nodeType===9?s:s.ownerDocument).createTextNode(h),h[Ks]=n,n.stateNode=h)}return null;case 13:return kn(Kn),h=n.memoizedState,(n.flags&64)!=0?(n.lanes=s,n):(h=h!==null,s=!1,t===null?n.memoizedProps.fallback!==void 0&&kf(n):s=t.memoizedState!==null,h&&!s&&(n.mode&2)!=0&&(t===null&&n.memoizedProps.unstable_avoidThisFallback!==!0||(Kn.current&1)!=0?Mr===0&&(Mr=3):((Mr===0||Mr===3)&&(Mr=4),Wr===null||(Zh&134217727)==0&&(Nc&134217727)==0||jc(Wr,Br))),(h||s)&&(n.flags|=4),null);case 4:return Bc(),py(n),t===null&&ub(n.stateNode.containerInfo),null;case 10:return X_(n),null;case 17:return ai(n.type)&&ff(),null;case 19:if(kn(Kn),h=n.memoizedState,h===null)return null;if(x=(n.flags&64)!=0,E=h.rendering,E===null)if(x)Gh(h,!1);else{if(Mr!==0||t!==null&&(t.flags&64)!=0)for(t=n.child;t!==null;){if(E=Cf(t),E!==null){for(n.flags|=64,Gh(h,!1),x=E.updateQueue,x!==null&&(n.updateQueue=x,n.flags|=4),h.lastEffect===null&&(n.firstEffect=null),n.lastEffect=h.lastEffect,h=s,s=n.child;s!==null;)x=s,t=h,x.flags&=2,x.nextEffect=null,x.firstEffect=null,x.lastEffect=null,E=x.alternate,E===null?(x.childLanes=0,x.lanes=t,x.child=null,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=E.childLanes,x.lanes=E.lanes,x.child=E.child,x.memoizedProps=E.memoizedProps,x.memoizedState=E.memoizedState,x.updateQueue=E.updateQueue,x.type=E.type,t=E.dependencies,x.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return Xn(Kn,Kn.current&1|2),n.child}t=t.sibling}h.tail!==null&&Lr()>Ty&&(n.flags|=64,x=!0,Gh(h,!1),n.lanes=33554432)}else{if(!x)if(t=Cf(E),t!==null){if(n.flags|=64,x=!0,s=t.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),Gh(h,!0),h.tail===null&&h.tailMode==="hidden"&&!E.alternate&&!ko)return n=n.lastEffect=h.lastEffect,n!==null&&(n.nextEffect=null),null}else 2*Lr()-h.renderingStartTime>Ty&&s!==1073741824&&(n.flags|=64,x=!0,Gh(h,!1),n.lanes=33554432);h.isBackwards?(E.sibling=n.child,n.child=E):(s=h.last,s!==null?s.sibling=E:n.child=E,h.last=E)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.lastEffect=n.lastEffect,h.renderingStartTime=Lr(),s.sibling=null,n=Kn.current,Xn(Kn,x?n&1|2:n&1),s):null;case 23:case 24:return My(),t!==null&&t.memoizedState!==null!=(n.memoizedState!==null)&&h.mode!=="unstable-defer-without-hiding"&&(n.flags|=4),null}throw Error(rt(156,n.tag))}function qI(t){switch(t.tag){case 1:ai(t.type)&&ff();var n=t.flags;return n&4096?(t.flags=n&-4097|64,t):null;case 3:if(Bc(),kn(si),kn(Rr),ny(),n=t.flags,(n&64)!=0)throw Error(rt(285));return t.flags=n&-4097|64,t;case 5:return Q_(t),null;case 13:return kn(Kn),n=t.flags,n&4096?(t.flags=n&-4097|64,t):null;case 19:return kn(Kn),null;case 4:return Bc(),null;case 10:return X_(t),null;case 23:case 24:return My(),null;default:return null}}function fy(t,n){try{var s="",h=n;do s+=Ck(h),h=h.return;while(h);var g=s}catch(x){g=`
Error generating stack: `+x.message+`
`+x.stack}return{value:t,source:n,stack:g}}function my(t,n){try{console.error(n.value)}catch(s){setTimeout(function(){throw s})}}var WI=typeof WeakMap=="function"?WeakMap:Map;function gw(t,n,s){s=ea(-1,s),s.tag=3,s.payload={element:null};var h=n.value;return s.callback=function(){Of||(Of=!0,Sy=h),my(t,n)},s}function _w(t,n,s){s=ea(-1,s),s.tag=3;var h=t.type.getDerivedStateFromError;if(typeof h=="function"){var g=n.value;s.payload=function(){return my(t,n),h(g)}}var x=t.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(s.callback=function(){typeof h!="function"&&(Ao===null?Ao=new Set([this]):Ao.add(this),my(t,n));var E=n.stack;this.componentDidCatch(n.value,{componentStack:E!==null?E:""})}),s}var HI=typeof WeakSet=="function"?WeakSet:Set;function yw(t){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){aa(t,s)}else n.current=null}function XI(t,n){switch(n.tag){case 0:case 11:case 15:case 22:return;case 1:if(n.flags&256&&t!==null){var s=t.memoizedProps,h=t.memoizedState;t=n.stateNode,n=t.getSnapshotBeforeUpdate(n.elementType===n.type?s:Yi(n.type,s),h),t.__reactInternalSnapshotBeforeUpdate=n}return;case 3:n.flags&256&&$_(n.stateNode.containerInfo);return;case 5:case 6:case 4:case 17:return}throw Error(rt(163))}function KI(t,n,s){switch(s.tag){case 0:case 11:case 15:case 22:if(n=s.updateQueue,n=n!==null?n.lastEffect:null,n!==null){t=n=n.next;do{if((t.tag&3)==3){var h=t.create;t.destroy=h()}t=t.next}while(t!==n)}if(n=s.updateQueue,n=n!==null?n.lastEffect:null,n!==null){t=n=n.next;do{var g=t;h=g.next,g=g.tag,(g&4)!=0&&(g&1)!=0&&(Dw(s,t),iA(s,t)),t=h}while(t!==n)}return;case 1:t=s.stateNode,s.flags&4&&(n===null?t.componentDidMount():(h=s.elementType===s.type?n.memoizedProps:Yi(s.type,n.memoizedProps),t.componentDidUpdate(h,n.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),n=s.updateQueue,n!==null&&Rb(s,n,t);return;case 3:if(n=s.updateQueue,n!==null){if(t=null,s.child!==null)switch(s.child.tag){case 5:t=s.child.stateNode;break;case 1:t=s.child.stateNode}Rb(s,n,t)}return;case 5:t=s.stateNode,n===null&&s.flags&4&&mb(s.type,s.memoizedProps)&&t.focus();return;case 6:return;case 4:return;case 12:return;case 13:s.memoizedState===null&&(s=s.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&M1(s))));return;case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(rt(163))}function vw(t,n){for(var s=t;;){if(s.tag===5){var h=s.stateNode;if(n)h=h.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none";else{h=s.stateNode;var g=s.memoizedProps.style;g=g!=null&&g.hasOwnProperty("display")?g.display:null,h.style.display=p1("display",g)}}else if(s.tag===6)s.stateNode.nodeValue=n?"":s.memoizedProps;else if((s.tag!==23&&s.tag!==24||s.memoizedState===null||s===t)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}}function xw(t,n){if(Ka&&typeof Ka.onCommitFiberUnmount=="function")try{Ka.onCommitFiberUnmount(j_,n)}catch{}switch(n.tag){case 0:case 11:case 14:case 15:case 22:if(t=n.updateQueue,t!==null&&(t=t.lastEffect,t!==null)){var s=t=t.next;do{var h=s,g=h.destroy;if(h=h.tag,g!==void 0)if((h&4)!=0)Dw(n,s);else{h=n;try{g()}catch(x){aa(h,x)}}s=s.next}while(s!==t)}break;case 1:if(yw(n),t=n.stateNode,typeof t.componentWillUnmount=="function")try{t.props=n.memoizedProps,t.state=n.memoizedState,t.componentWillUnmount()}catch(x){aa(n,x)}break;case 5:yw(n);break;case 4:Tw(t,n)}}function bw(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function ww(t){return t.tag===5||t.tag===3||t.tag===4}function Ew(t){e:{for(var n=t.return;n!==null;){if(ww(n))break e;n=n.return}throw Error(rt(160))}var s=n;switch(n=s.stateNode,s.tag){case 5:var h=!1;break;case 3:n=n.containerInfo,h=!0;break;case 4:n=n.containerInfo,h=!0;break;default:throw Error(rt(161))}s.flags&16&&(hh(n,""),s.flags&=-17);e:t:for(s=t;;){for(;s.sibling===null;){if(s.return===null||ww(s.return)){s=null;break e}s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2)){s=s.stateNode;break e}}h?gy(t,s,n):_y(t,s,n)}function gy(t,n,s){var h=t.tag,g=h===5||h===6;if(g)t=g?t.stateNode:t.stateNode.instance,n?s.nodeType===8?s.parentNode.insertBefore(t,n):s.insertBefore(t,n):(s.nodeType===8?(n=s.parentNode,n.insertBefore(t,s)):(n=s,n.appendChild(t)),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=uf));else if(h!==4&&(t=t.child,t!==null))for(gy(t,n,s),t=t.sibling;t!==null;)gy(t,n,s),t=t.sibling}function _y(t,n,s){var h=t.tag,g=h===5||h===6;if(g)t=g?t.stateNode:t.stateNode.instance,n?s.insertBefore(t,n):s.appendChild(t);else if(h!==4&&(t=t.child,t!==null))for(_y(t,n,s),t=t.sibling;t!==null;)_y(t,n,s),t=t.sibling}function Tw(t,n){for(var s=n,h=!1,g,x;;){if(!h){h=s.return;e:for(;;){if(h===null)throw Error(rt(160));switch(g=h.stateNode,h.tag){case 5:x=!1;break e;case 3:g=g.containerInfo,x=!0;break e;case 4:g=g.containerInfo,x=!0;break e}h=h.return}h=!0}if(s.tag===5||s.tag===6){e:for(var E=t,a=s,A=a;;)if(xw(E,A),A.child!==null&&A.tag!==4)A.child.return=A,A=A.child;else{if(A===a)break e;for(;A.sibling===null;){if(A.return===null||A.return===a)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}x?(E=g,a=s.stateNode,E.nodeType===8?E.parentNode.removeChild(a):E.removeChild(a)):g.removeChild(s.stateNode)}else if(s.tag===4){if(s.child!==null){g=s.stateNode.containerInfo,x=!0,s.child.return=s,s=s.child;continue}}else if(xw(t,s),s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return;s=s.return,s.tag===4&&(h=!1)}s.sibling.return=s.return,s=s.sibling}}function yy(t,n){switch(n.tag){case 0:case 11:case 14:case 15:case 22:var s=n.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var h=s=s.next;do(h.tag&3)==3&&(t=h.destroy,h.destroy=void 0,t!==void 0&&t()),h=h.next;while(h!==s)}return;case 1:return;case 5:if(s=n.stateNode,s!=null){h=n.memoizedProps;var g=t!==null?t.memoizedProps:h;t=n.type;var x=n.updateQueue;if(n.updateQueue=null,x!==null){for(s[df]=h,t==="input"&&h.type==="radio"&&h.name!=null&&s1(s,h),o_(t,g),n=o_(t,h),g=0;g<x.length;g+=2){var E=x[g],a=x[g+1];E==="style"?f1(s,a):E==="dangerouslySetInnerHTML"?d1(s,a):E==="children"?hh(s,a):Ng(s,E,a,n)}switch(t){case"input":Jg(s,h);break;case"textarea":c1(s,h);break;case"select":t=s._wrapperState.wasMultiple,s._wrapperState.wasMultiple=!!h.multiple,x=h.value,x!=null?vc(s,!!h.multiple,x,!1):t!==!!h.multiple&&(h.defaultValue!=null?vc(s,!!h.multiple,h.defaultValue,!0):vc(s,!!h.multiple,h.multiple?[]:"",!1))}}}return;case 6:if(n.stateNode===null)throw Error(rt(162));n.stateNode.nodeValue=n.memoizedProps;return;case 3:s=n.stateNode,s.hydrate&&(s.hydrate=!1,M1(s.containerInfo));return;case 12:return;case 13:n.memoizedState!==null&&(Ey=Lr(),vw(n.child,!0)),Sw(n);return;case 19:Sw(n);return;case 17:return;case 23:case 24:vw(n,n.memoizedState!==null);return}throw Error(rt(163))}function Sw(t){var n=t.updateQueue;if(n!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new HI),n.forEach(function(h){var g=aA.bind(null,t,h);s.has(h)||(s.add(h),h.then(g,g))})}}function YI(t,n){return t!==null&&(t=t.memoizedState,t===null||t.dehydrated!==null)?(n=n.memoizedState,n!==null&&n.dehydrated===null):!1}var JI=Math.ceil,Rf=Ga.ReactCurrentDispatcher,vy=Ga.ReactCurrentOwner,zt=0,Wr=null,lr=null,Br=0,tl=0,xy=Ys(0),Mr=0,Lf=null,$c=0,Zh=0,Nc=0,by=0,wy=null,Ey=0,Ty=1/0;function Uc(){Ty=Lr()+500}var ft=null,Of=!1,Sy=null,Ao=null,ra=!1,qh=null,Wh=90,Cy=[],ky=[],is=null,Hh=0,Iy=null,Bf=-1,os=0,Ff=0,Xh=null,$f=!1;function Ei(){return(zt&48)!=0?Lr():Bf!==-1?Bf:Bf=Lr()}function ia(t){if(t=t.mode,(t&2)==0)return 1;if((t&4)==0)return Rc()===99?1:2;if(os===0&&(os=$c),$I.transition!==0){Ff!==0&&(Ff=wy!==null?wy.pendingLanes:0),t=os;var n=4186112&~Ff;return n&=-n,n===0&&(t=4186112&~t,n=t&-t,n===0&&(n=8192)),n}return t=Rc(),(zt&4)!=0&&t===98?t=ef(12,os):(t=jk(t),t=ef(t,os)),t}function oa(t,n,s){if(50<Hh)throw Hh=0,Iy=null,Error(rt(185));if(t=Nf(t,n),t===null)return null;tf(t,n,s),t===Wr&&(Nc|=n,Mr===4&&jc(t,Br));var h=Rc();n===1?(zt&8)!=0&&(zt&48)==0?Ay(t):(Li(t,s),zt===0&&(Uc(),So())):((zt&4)==0||h!==98&&h!==99||(is===null?is=new Set([t]):is.add(t)),Li(t,s)),wy=t}function Nf(t,n){t.lanes|=n;var s=t.alternate;for(s!==null&&(s.lanes|=n),s=t,t=t.return;t!==null;)t.childLanes|=n,s=t.alternate,s!==null&&(s.childLanes|=n),s=t,t=t.return;return s.tag===3?s.stateNode:null}function Li(t,n){for(var s=t.callbackNode,h=t.suspendedLanes,g=t.pingedLanes,x=t.expirationTimes,E=t.pendingLanes;0<E;){var a=31-Hs(E),A=1<<a,D=x[a];if(D===-1){if((A&h)==0||(A&g)!=0){D=n,Ec(A);var V=En;x[a]=10<=V?D+250:6<=V?D+5e3:-1}}else D<=n&&(t.expiredLanes|=A);E&=~A}if(h=bh(t,t===Wr?Br:0),n=En,h===0)s!==null&&(s!==q_&&G_(s),t.callbackNode=null,t.callbackPriority=0);else{if(s!==null){if(t.callbackPriority===n)return;s!==q_&&G_(s)}n===15?(s=Ay.bind(null,t),ts===null?(ts=[s],_f=V_(gf,Mb)):ts.push(s),s=q_):n===14?s=zh(99,Ay.bind(null,t)):(s=Vk(n),s=zh(s,Cw.bind(null,t))),t.callbackPriority=n,t.callbackNode=s}}function Cw(t){if(Bf=-1,Ff=os=0,(zt&48)!=0)throw Error(rt(327));var n=t.callbackNode;if(sa()&&t.callbackNode!==n)return null;var s=bh(t,t===Wr?Br:0);if(s===0)return null;var h=s,g=zt;zt|=16;var x=Mw();(Wr!==t||Br!==h)&&(Uc(),Vc(t,h));do try{tA();break}catch(a){Aw(t,a)}while(1);if(H_(),Rf.current=x,zt=g,lr!==null?h=0:(Wr=null,Br=0,h=Mr),($c&Nc)!=0)Vc(t,0);else if(h!==0){if(h===2&&(zt|=64,t.hydrate&&(t.hydrate=!1,$_(t.containerInfo)),s=B1(t),s!==0&&(h=Kh(t,s))),h===1)throw n=Lf,Vc(t,0),jc(t,s),Li(t,Lr()),n;switch(t.finishedWork=t.current.alternate,t.finishedLanes=s,h){case 0:case 1:throw Error(rt(345));case 2:nl(t);break;case 3:if(jc(t,s),(s&62914560)===s&&(h=Ey+500-Lr(),10<h)){if(bh(t,0)!==0)break;if(g=t.suspendedLanes,(g&s)!==s){Ei(),t.pingedLanes|=t.suspendedLanes&g;break}t.timeoutHandle=gb(nl.bind(null,t),h);break}nl(t);break;case 4:if(jc(t,s),(s&4186112)===s)break;for(h=t.eventTimes,g=-1;0<s;){var E=31-Hs(s);x=1<<E,E=h[E],E>g&&(g=E),s&=~x}if(s=g,s=Lr()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*JI(s/1960))-s,10<s){t.timeoutHandle=gb(nl.bind(null,t),s);break}nl(t);break;case 5:nl(t);break;default:throw Error(rt(329))}}return Li(t,Lr()),t.callbackNode===n?Cw.bind(null,t):null}function jc(t,n){for(n&=~by,n&=~Nc,t.suspendedLanes|=n,t.pingedLanes&=~n,t=t.expirationTimes;0<n;){var s=31-Hs(n),h=1<<s;t[s]=-1,n&=~h}}function Ay(t){if((zt&48)!=0)throw Error(rt(327));if(sa(),t===Wr&&(t.expiredLanes&Br)!=0){var n=Br,s=Kh(t,n);($c&Nc)!=0&&(n=bh(t,n),s=Kh(t,n))}else n=bh(t,0),s=Kh(t,n);if(t.tag!==0&&s===2&&(zt|=64,t.hydrate&&(t.hydrate=!1,$_(t.containerInfo)),n=B1(t),n!==0&&(s=Kh(t,n))),s===1)throw s=Lf,Vc(t,0),jc(t,n),Li(t,Lr()),s;return t.finishedWork=t.current.alternate,t.finishedLanes=n,nl(t),Li(t,Lr()),null}function QI(){if(is!==null){var t=is;is=null,t.forEach(function(n){n.expiredLanes|=24&n.pendingLanes,Li(n,Lr())})}So()}function kw(t,n){var s=zt;zt|=1;try{return t(n)}finally{zt=s,zt===0&&(Uc(),So())}}function Iw(t,n){var s=zt;zt&=-2,zt|=8;try{return t(n)}finally{zt=s,zt===0&&(Uc(),So())}}function Uf(t,n){Xn(xy,tl),tl|=n,$c|=n}function My(){tl=xy.current,kn(xy)}function Vc(t,n){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,DI(s)),lr!==null)for(s=lr.return;s!==null;){var h=s;switch(h.tag){case 1:h=h.type.childContextTypes,h!=null&&ff();break;case 3:Bc(),kn(si),kn(Rr),ny();break;case 5:Q_(h);break;case 4:Bc();break;case 13:kn(Kn);break;case 19:kn(Kn);break;case 10:X_(h);break;case 23:case 24:My()}s=s.return}Wr=t,lr=la(t.current,null),Br=tl=$c=n,Mr=0,Lf=null,by=Nc=Zh=0}function Aw(t,n){do{var s=lr;try{if(H_(),Fh.current=zf,If){for(var h=Qn.memoizedState;h!==null;){var g=h.queue;g!==null&&(g.pending=null),h=h.next}If=!1}if($h=0,Ar=Or=Qn=null,Nh=!1,vy.current=null,s===null||s.return===null){Mr=1,Lf=n,lr=null;break}e:{var x=t,E=s.return,a=s,A=n;if(n=Br,a.flags|=2048,a.firstEffect=a.lastEffect=null,A!==null&&typeof A=="object"&&typeof A.then=="function"){var D=A;if((a.mode&2)==0){var V=a.alternate;V?(a.updateQueue=V.updateQueue,a.memoizedState=V.memoizedState,a.lanes=V.lanes):(a.updateQueue=null,a.memoizedState=null)}var N=(Kn.current&1)!=0,F=E;do{var ae;if(ae=F.tag===13){var be=F.memoizedState;if(be!==null)ae=be.dehydrated!==null;else{var fe=F.memoizedProps;ae=fe.fallback===void 0?!1:fe.unstable_avoidThisFallback!==!0?!0:!N}}if(ae){var ee=F.updateQueue;if(ee===null){var G=new Set;G.add(D),F.updateQueue=G}else ee.add(D);if((F.mode&2)==0){if(F.flags|=64,a.flags|=16384,a.flags&=-2981,a.tag===1)if(a.alternate===null)a.tag=17;else{var X=ea(-1,1);X.tag=2,ta(a,X)}a.lanes|=1;break e}A=void 0,a=n;var me=x.pingCache;if(me===null?(me=x.pingCache=new WI,A=new Set,me.set(D,A)):(A=me.get(D),A===void 0&&(A=new Set,me.set(D,A))),!A.has(a)){A.add(a);var Te=sA.bind(null,x,D,a);D.then(Te,Te)}F.flags|=4096,F.lanes=n;break e}F=F.return}while(F!==null);A=Error((yc(a.type)||"A React component")+` suspended while rendering, but no fallback UI was specified.

Add a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.`)}Mr!==5&&(Mr=2),A=fy(A,a),F=E;do{switch(F.tag){case 3:x=A,F.flags|=4096,n&=-n,F.lanes|=n;var We=gw(F,x,n);Db(F,We);break e;case 1:x=A;var Pe=F.type,Le=F.stateNode;if((F.flags&64)==0&&(typeof Pe.getDerivedStateFromError=="function"||Le!==null&&typeof Le.componentDidCatch=="function"&&(Ao===null||!Ao.has(Le)))){F.flags|=4096,n&=-n,F.lanes|=n;var Ke=_w(F,x,n);Db(F,Ke);break e}}F=F.return}while(F!==null)}zw(s)}catch(Ye){n=Ye,lr===s&&s!==null&&(lr=s=s.return);continue}break}while(1)}function Mw(){var t=Rf.current;return Rf.current=zf,t===null?zf:t}function Kh(t,n){var s=zt;zt|=16;var h=Mw();Wr===t&&Br===n||Vc(t,n);do try{eA();break}catch(g){Aw(t,g)}while(1);if(H_(),zt=s,Rf.current=h,lr!==null)throw Error(rt(261));return Wr=null,Br=0,Mr}function eA(){for(;lr!==null;)Pw(lr)}function tA(){for(;lr!==null&&!OI();)Pw(lr)}function Pw(t){var n=Lw(t.alternate,t,tl);t.memoizedProps=t.pendingProps,n===null?zw(t):lr=n,vy.current=null}function zw(t){var n=t;do{var s=n.alternate;if(t=n.return,(n.flags&2048)==0){if(s=ZI(s,n,tl),s!==null){lr=s;return}if(s=n,s.tag!==24&&s.tag!==23||s.memoizedState===null||(tl&1073741824)!=0||(s.mode&4)==0){for(var h=0,g=s.child;g!==null;)h|=g.lanes|g.childLanes,g=g.sibling;s.childLanes=h}t!==null&&(t.flags&2048)==0&&(t.firstEffect===null&&(t.firstEffect=n.firstEffect),n.lastEffect!==null&&(t.lastEffect!==null&&(t.lastEffect.nextEffect=n.firstEffect),t.lastEffect=n.lastEffect),1<n.flags&&(t.lastEffect!==null?t.lastEffect.nextEffect=n:t.firstEffect=n,t.lastEffect=n))}else{if(s=qI(n),s!==null){s.flags&=2047,lr=s;return}t!==null&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(n=n.sibling,n!==null){lr=n;return}lr=n=t}while(n!==null);Mr===0&&(Mr=5)}function nl(t){var n=Rc();return Ya(99,nA.bind(null,t,n)),null}function nA(t,n){do sa();while(qh!==null);if((zt&48)!=0)throw Error(rt(327));var s=t.finishedWork;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(rt(177));t.callbackNode=null;var h=s.lanes|s.childLanes,g=h,x=t.pendingLanes&~g;t.pendingLanes=g,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=g,t.mutableReadLanes&=g,t.entangledLanes&=g,g=t.entanglements;for(var E=t.eventTimes,a=t.expirationTimes;0<x;){var A=31-Hs(x),D=1<<A;g[A]=0,E[A]=-1,a[A]=-1,x&=~D}if(is!==null&&(h&24)==0&&is.has(t)&&is.delete(t),t===Wr&&(lr=Wr=null,Br=0),1<s.flags?s.lastEffect!==null?(s.lastEffect.nextEffect=s,h=s.firstEffect):h=s:h=s.firstEffect,h!==null){if(g=zt,zt|=32,vy.current=null,O_=nf,E=rb(),z_(E)){if("selectionStart"in E)a={start:E.selectionStart,end:E.selectionEnd};else e:if(a=(a=E.ownerDocument)&&a.defaultView||window,(D=a.getSelection&&a.getSelection())&&D.rangeCount!==0){a=D.anchorNode,x=D.anchorOffset,A=D.focusNode,D=D.focusOffset;try{a.nodeType,A.nodeType}catch{a=null;break e}var V=0,N=-1,F=-1,ae=0,be=0,fe=E,ee=null;t:for(;;){for(var G;fe!==a||x!==0&&fe.nodeType!==3||(N=V+x),fe!==A||D!==0&&fe.nodeType!==3||(F=V+D),fe.nodeType===3&&(V+=fe.nodeValue.length),(G=fe.firstChild)!==null;)ee=fe,fe=G;for(;;){if(fe===E)break t;if(ee===a&&++ae===x&&(N=V),ee===A&&++be===D&&(F=V),(G=fe.nextSibling)!==null)break;fe=ee,ee=fe.parentNode}fe=G}a=N===-1||F===-1?null:{start:N,end:F}}else a=null;a=a||{start:0,end:0}}else a=null;B_={focusedElem:E,selectionRange:a},nf=!1,Xh=null,$f=!1,ft=h;do try{rA()}catch(Ye){if(ft===null)throw Error(rt(330));aa(ft,Ye),ft=ft.nextEffect}while(ft!==null);Xh=null,ft=h;do try{for(E=t;ft!==null;){var X=ft.flags;if(X&16&&hh(ft.stateNode,""),X&128){var me=ft.alternate;if(me!==null){var Te=me.ref;Te!==null&&(typeof Te=="function"?Te(null):Te.current=null)}}switch(X&1038){case 2:Ew(ft),ft.flags&=-3;break;case 6:Ew(ft),ft.flags&=-3,yy(ft.alternate,ft);break;case 1024:ft.flags&=-1025;break;case 1028:ft.flags&=-1025,yy(ft.alternate,ft);break;case 4:yy(ft.alternate,ft);break;case 8:a=ft,Tw(E,a);var We=a.alternate;bw(a),We!==null&&bw(We)}ft=ft.nextEffect}}catch(Ye){if(ft===null)throw Error(rt(330));aa(ft,Ye),ft=ft.nextEffect}while(ft!==null);if(Te=B_,me=rb(),X=Te.focusedElem,E=Te.selectionRange,me!==X&&X&&X.ownerDocument&&nb(X.ownerDocument.documentElement,X)){for(E!==null&&z_(X)&&(me=E.start,Te=E.end,Te===void 0&&(Te=me),"selectionStart"in X?(X.selectionStart=me,X.selectionEnd=Math.min(Te,X.value.length)):(Te=(me=X.ownerDocument||document)&&me.defaultView||window,Te.getSelection&&(Te=Te.getSelection(),a=X.textContent.length,We=Math.min(E.start,a),E=E.end===void 0?We:Math.min(E.end,a),!Te.extend&&We>E&&(a=E,E=We,We=a),a=tb(X,We),x=tb(X,E),a&&x&&(Te.rangeCount!==1||Te.anchorNode!==a.node||Te.anchorOffset!==a.offset||Te.focusNode!==x.node||Te.focusOffset!==x.offset)&&(me=me.createRange(),me.setStart(a.node,a.offset),Te.removeAllRanges(),We>E?(Te.addRange(me),Te.extend(x.node,x.offset)):(me.setEnd(x.node,x.offset),Te.addRange(me)))))),me=[],Te=X;Te=Te.parentNode;)Te.nodeType===1&&me.push({element:Te,left:Te.scrollLeft,top:Te.scrollTop});for(typeof X.focus=="function"&&X.focus(),X=0;X<me.length;X++)Te=me[X],Te.element.scrollLeft=Te.left,Te.element.scrollTop=Te.top}nf=!!O_,B_=O_=null,t.current=s,ft=h;do try{for(X=t;ft!==null;){var Pe=ft.flags;if(Pe&36&&KI(X,ft.alternate,ft),Pe&128){me=void 0;var Le=ft.ref;if(Le!==null){var Ke=ft.stateNode;switch(ft.tag){case 5:me=Ke;break;default:me=Ke}typeof Le=="function"?Le(me):Le.current=me}}ft=ft.nextEffect}}catch(Ye){if(ft===null)throw Error(rt(330));aa(ft,Ye),ft=ft.nextEffect}while(ft!==null);ft=null,FI(),zt=g}else t.current=s;if(ra)ra=!1,qh=t,Wh=n;else for(ft=h;ft!==null;)n=ft.nextEffect,ft.nextEffect=null,ft.flags&8&&(Pe=ft,Pe.sibling=null,Pe.stateNode=null),ft=n;if(h=t.pendingLanes,h===0&&(Ao=null),h===1?t===Iy?Hh++:(Hh=0,Iy=t):Hh=0,s=s.stateNode,Ka&&typeof Ka.onCommitFiberRoot=="function")try{Ka.onCommitFiberRoot(j_,s,void 0,(s.current.flags&64)==64)}catch{}if(Li(t,Lr()),Of)throw Of=!1,t=Sy,Sy=null,t;return(zt&8)!=0||So(),null}function rA(){for(;ft!==null;){var t=ft.alternate;$f||Xh===null||((ft.flags&8)!=0?E1(ft,Xh)&&($f=!0):ft.tag===13&&YI(t,ft)&&E1(ft,Xh)&&($f=!0));var n=ft.flags;(n&256)!=0&&XI(t,ft),(n&512)==0||ra||(ra=!0,zh(97,function(){return sa(),null})),ft=ft.nextEffect}}function sa(){if(Wh!==90){var t=97<Wh?97:Wh;return Wh=90,Ya(t,oA)}return!1}function iA(t,n){Cy.push(n,t),ra||(ra=!0,zh(97,function(){return sa(),null}))}function Dw(t,n){ky.push(n,t),ra||(ra=!0,zh(97,function(){return sa(),null}))}function oA(){if(qh===null)return!1;var t=qh;if(qh=null,(zt&48)!=0)throw Error(rt(331));var n=zt;zt|=32;var s=ky;ky=[];for(var h=0;h<s.length;h+=2){var g=s[h],x=s[h+1],E=g.destroy;if(g.destroy=void 0,typeof E=="function")try{E()}catch(A){if(x===null)throw Error(rt(330));aa(x,A)}}for(s=Cy,Cy=[],h=0;h<s.length;h+=2){g=s[h],x=s[h+1];try{var a=g.create;g.destroy=a()}catch(A){if(x===null)throw Error(rt(330));aa(x,A)}}for(a=t.current.firstEffect;a!==null;)t=a.nextEffect,a.nextEffect=null,a.flags&8&&(a.sibling=null,a.stateNode=null),a=t;return zt=n,So(),!0}function Rw(t,n,s){n=fy(s,n),n=gw(t,n,1),ta(t,n),n=Ei(),t=Nf(t,1),t!==null&&(tf(t,1,n),Li(t,n))}function aa(t,n){if(t.tag===3)Rw(t,t,n);else for(var s=t.return;s!==null;){if(s.tag===3){Rw(s,t,n);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ao===null||!Ao.has(h))){t=fy(n,t);var g=_w(s,t,1);if(ta(s,g),g=Ei(),s=Nf(s,1),s!==null)tf(s,1,g),Li(s,g);else if(typeof h.componentDidCatch=="function"&&(Ao===null||!Ao.has(h)))try{h.componentDidCatch(n,t)}catch{}break}}s=s.return}}function sA(t,n,s){var h=t.pingCache;h!==null&&h.delete(n),n=Ei(),t.pingedLanes|=t.suspendedLanes&s,Wr===t&&(Br&s)===s&&(Mr===4||Mr===3&&(Br&62914560)===Br&&500>Lr()-Ey?Vc(t,0):by|=s),Li(t,n)}function aA(t,n){var s=t.stateNode;s!==null&&s.delete(n),n=0,n===0&&(n=t.mode,(n&2)==0?n=1:(n&4)==0?n=Rc()===99?1:2:(os===0&&(os=$c),n=Tc(62914560&~os),n===0&&(n=4194304))),s=Ei(),t=Nf(t,n),t!==null&&(tf(t,n,s),Li(t,s))}var Lw;Lw=function(t,n,s){var h=n.lanes;if(t!==null)if(t.memoizedProps!==n.pendingProps||si.current)Ji=!0;else if((s&h)!=0)Ji=(t.flags&16384)!=0;else{switch(Ji=!1,n.tag){case 3:sw(n),ty();break;case 5:Ub(n);break;case 1:ai(n.type)&&mf(n);break;case 4:J_(n,n.stateNode.containerInfo);break;case 10:h=n.memoizedProps.value;var g=n.type._context;Xn(yf,g._currentValue),g._currentValue=h;break;case 13:if(n.memoizedState!==null)return(s&n.child.childLanes)!=0?aw(t,n,s):(Xn(Kn,Kn.current&1),n=rs(t,n,s),n!==null?n.sibling:null);Xn(Kn,Kn.current&1);break;case 19:if(h=(s&n.childLanes)!=0,(t.flags&64)!=0){if(h)return dw(t,n,s);n.flags|=64}if(g=n.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Xn(Kn,Kn.current),h)break;return null;case 23:case 24:return n.lanes=0,cy(t,n,s)}return rs(t,n,s)}else Ji=!1;switch(n.lanes=0,n.tag){case 2:if(h=n.type,t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2),t=n.pendingProps,g=Dc(n,Rr.current),Oc(n,s),g=iy(null,n,h,t,g,s),n.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0){if(n.tag=1,n.memoizedState=null,n.updateQueue=null,ai(h)){var x=!0;mf(n)}else x=!1;n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,K_(n);var E=h.getDerivedStateFromProps;typeof E=="function"&&bf(n,h,E,t),g.updater=wf,n.stateNode=g,g._reactInternals=n,Y_(n,h,t,s),n=hy(null,n,h,!0,x,s)}else n.tag=0,ci(null,n,g,s),n=n.child;return n;case 16:g=n.elementType;e:{switch(t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2),t=n.pendingProps,x=g._init,g=x(g._payload),n.type=g,x=n.tag=cA(g),t=Yi(g,t),x){case 0:n=uy(null,n,g,t,s);break e;case 1:n=ow(null,n,g,t,s);break e;case 11:n=tw(null,n,g,t,s);break e;case 14:n=nw(null,n,g,Yi(g.type,t),h,s);break e}throw Error(rt(306,g,""))}return n;case 0:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:Yi(h,g),uy(t,n,h,g,s);case 1:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:Yi(h,g),ow(t,n,h,g,s);case 3:if(sw(n),h=n.updateQueue,t===null||h===null)throw Error(rt(282));if(h=n.pendingProps,g=n.memoizedState,g=g!==null?g.element:null,zb(t,n),Dh(n,h,null,s),h=n.memoizedState.element,h===g)ty(),n=rs(t,n,s);else{if(g=n.stateNode,(x=g.hydrate)&&(na=Ac(n.stateNode.containerInfo.firstChild),ns=n,x=ko=!0),x){if(t=g.mutableSourceEagerHydrationData,t!=null)for(g=0;g<t.length;g+=2)x=t[g],x._workInProgressVersionPrimary=t[g+1],Fc.push(x);for(s=Nb(n,null,h,s),n.child=s;s;)s.flags=s.flags&-3|1024,s=s.sibling}else ci(t,n,h,s),ty();n=n.child}return n;case 5:return Ub(n),t===null&&ey(n),h=n.type,g=n.pendingProps,x=t!==null?t.memoizedProps:null,E=g.children,F_(h,g)?E=null:x!==null&&F_(h,x)&&(n.flags|=16),iw(t,n),ci(t,n,E,s),n.child;case 6:return t===null&&ey(n),null;case 13:return aw(t,n,s);case 4:return J_(n,n.stateNode.containerInfo),h=n.pendingProps,t===null?n.child=Sf(n,null,h,s):ci(t,n,h,s),n.child;case 11:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:Yi(h,g),tw(t,n,h,g,s);case 7:return ci(t,n,n.pendingProps,s),n.child;case 8:return ci(t,n,n.pendingProps.children,s),n.child;case 12:return ci(t,n,n.pendingProps.children,s),n.child;case 10:e:{h=n.type._context,g=n.pendingProps,E=n.memoizedProps,x=g.value;var a=n.type._context;if(Xn(yf,a._currentValue),a._currentValue=x,E!==null)if(a=E.value,x=zi(a,x)?0:(typeof h._calculateChangedBits=="function"?h._calculateChangedBits(a,x):1073741823)|0,x===0){if(E.children===g.children&&!si.current){n=rs(t,n,s);break e}}else for(a=n.child,a!==null&&(a.return=n);a!==null;){var A=a.dependencies;if(A!==null){E=a.child;for(var D=A.firstContext;D!==null;){if(D.context===h&&(D.observedBits&x)!=0){a.tag===1&&(D=ea(-1,s&-s),D.tag=2,ta(a,D)),a.lanes|=s,D=a.alternate,D!==null&&(D.lanes|=s),Pb(a.return,s),A.lanes|=s;break}D=D.next}}else E=a.tag===10&&a.type===n.type?null:a.child;if(E!==null)E.return=a;else for(E=a;E!==null;){if(E===n){E=null;break}if(a=E.sibling,a!==null){a.return=E.return,E=a;break}E=E.return}a=E}ci(t,n,g.children,s),n=n.child}return n;case 9:return g=n.type,x=n.pendingProps,h=x.children,Oc(n,s),g=Di(g,x.unstable_observedBits),h=h(g),n.flags|=1,ci(t,n,h,s),n.child;case 14:return g=n.type,x=Yi(g,n.pendingProps),x=Yi(g.type,x),nw(t,n,g,x,h,s);case 15:return rw(t,n,n.type,n.pendingProps,h,s);case 17:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:Yi(h,g),t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2),n.tag=1,ai(h)?(t=!0,mf(n)):t=!1,Oc(n,s),Bb(n,h,g),Y_(n,h,g,s),hy(null,n,h,!0,t,s);case 19:return dw(t,n,s);case 23:return cy(t,n,s);case 24:return cy(t,n,s)}throw Error(rt(156,n.tag))};function lA(t,n,s,h){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Oi(t,n,s,h){return new lA(t,n,s,h)}function Py(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cA(t){if(typeof t=="function")return Py(t)?1:0;if(t!=null){if(t=t.$$typeof,t===jp)return 11;if(t===Gp)return 14}return 2}function la(t,n){var s=t.alternate;return s===null?(s=Oi(t.tag,n,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=n,s.type=t.type,s.flags=0,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null),s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,n=t.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function jf(t,n,s,h,g,x){var E=2;if(h=t,typeof t=="function")Py(t)&&(E=1);else if(typeof t=="string")E=5;else e:switch(t){case Vs:return Gc(s.children,g,x,n);case t1:E=8,g|=16;break;case Ug:E=8,g|=1;break;case ah:return t=Oi(12,s,n,g|8),t.elementType=ah,t.type=ah,t.lanes=x,t;case lh:return t=Oi(13,s,n,g),t.type=lh,t.elementType=lh,t.lanes=x,t;case Vp:return t=Oi(19,s,n,g),t.elementType=Vp,t.lanes=x,t;case Wg:return zy(s,g,x,n);case Hg:return t=Oi(24,s,n,g),t.elementType=Hg,t.lanes=x,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case jg:E=10;break e;case Vg:E=9;break e;case jp:E=11;break e;case Gp:E=14;break e;case Gg:E=16,h=null;break e;case Zg:E=22;break e}throw Error(rt(130,t==null?t:typeof t,""))}return n=Oi(E,s,n,g),n.elementType=t,n.type=h,n.lanes=x,n}function Gc(t,n,s,h){return t=Oi(7,t,h,n),t.lanes=s,t}function zy(t,n,s,h){return t=Oi(23,t,h,n),t.elementType=Wg,t.lanes=s,t}function Dy(t,n,s){return t=Oi(6,t,null,n),t.lanes=s,t}function Ry(t,n,s){return n=Oi(4,t.children!==null?t.children:[],t.key,n),n.lanes=s,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function uA(t,n,s){this.tag=n,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=s,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=x_(0),this.expirationTimes=x_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=x_(0),this.mutableSourceEagerHydrationData=null}function hA(t,n,s){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Za,key:h==null?null:""+h,children:t,containerInfo:n,implementation:s}}function Vf(t,n,s,h){var g=n.current,x=Ei(),E=ia(g);e:if(s){s=s._reactInternals;t:{if(Wa(s)!==s||s.tag!==1)throw Error(rt(170));var a=s;do{switch(a.tag){case 3:a=a.stateNode.context;break t;case 1:if(ai(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break t}}a=a.return}while(a!==null);throw Error(rt(171))}if(s.tag===1){var A=s.type;if(ai(A)){s=bb(s,A,a);break e}}s=a}else s=Js;return n.context===null?n.context=s:n.pendingContext=s,n=ea(x,E),n.payload={element:t},h=h===void 0?null:h,h!==null&&(n.callback=h),ta(g,n),oa(g,E,x),E}function Ly(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ow(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<n?s:n}}function Oy(t,n){Ow(t,n),(t=t.alternate)&&Ow(t,n)}function dA(){return null}function By(t,n,s){var h=s!=null&&s.hydrationOptions!=null&&s.hydrationOptions.mutableSources||null;if(s=new uA(t,n,s!=null&&s.hydrate===!0),n=Oi(3,null,null,n===2?7:n===1?3:0),s.current=n,n.stateNode=s,K_(n),t[Mc]=s.current,ub(t.nodeType===8?t.parentNode:t),h)for(t=0;t<h.length;t++){n=h[t];var g=n._getVersion;g=g(n._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[n,g]:s.mutableSourceEagerHydrationData.push(n,g)}this._internalRoot=s}By.prototype.render=function(t){Vf(t,this._internalRoot,null,null)};By.prototype.unmount=function(){var t=this._internalRoot,n=t.containerInfo;Vf(null,t,null,function(){n[Mc]=null})};function Yh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pA(t,n){if(n||(n=t?t.nodeType===9?t.documentElement:t.firstChild:null,n=!(!n||n.nodeType!==1||!n.hasAttribute("data-reactroot"))),!n)for(var s;s=t.lastChild;)t.removeChild(s);return new By(t,0,n?{hydrate:!0}:void 0)}function Gf(t,n,s,h,g){var x=s._reactRootContainer;if(x){var E=x._internalRoot;if(typeof g=="function"){var a=g;g=function(){var D=Ly(E);a.call(D)}}Vf(n,E,t,g)}else{if(x=s._reactRootContainer=pA(s,h),E=x._internalRoot,typeof g=="function"){var A=g;g=function(){var D=Ly(E);A.call(D)}}Iw(function(){Vf(n,E,t,g)})}return Ly(E)}T1=function(t){if(t.tag===13){var n=Ei();oa(t,4,n),Oy(t,4)}};f_=function(t){if(t.tag===13){var n=Ei();oa(t,67108864,n),Oy(t,67108864)}};S1=function(t){if(t.tag===13){var n=Ei(),s=ia(t);oa(t,s,n),Oy(t,s)}};C1=function(t,n){return n()};a_=function(t,n,s){switch(n){case"input":if(Jg(t,s),n=s.name,s.type==="radio"&&n!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<s.length;n++){var h=s[n];if(h!==t&&h.form===t.form){var g=pf(h);if(!g)throw Error(rt(90));i1(h),Jg(h,g)}}}break;case"textarea":c1(t,s);break;case"select":n=s.value,n!=null&&vc(t,!!s.multiple,n,!1)}};l_=kw;y1=function(t,n,s,h,g){var x=zt;zt|=4;try{return Ya(98,t.bind(null,n,s,h,g))}finally{zt=x,zt===0&&(Uc(),So())}};c_=function(){(zt&49)==0&&(QI(),sa())};v1=function(t,n){var s=zt;zt|=2;try{return t(n)}finally{zt=s,zt===0&&(Uc(),So())}};function Bw(t,n){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yh(n))throw Error(rt(200));return hA(t,n,null,s)}var fA={Events:[Ph,Pc,pf,g1,_1,sa,{current:!1}]},Jh={findFiberByHostInstance:Ha,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},mA={bundleType:Jh.bundleType,version:Jh.version,rendererPackageName:Jh.rendererPackageName,rendererConfig:Jh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ga.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=w1(t),t===null?null:t.stateNode},findFiberByHostInstance:Jh.findFiberByHostInstance||dA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var Zf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zf.isDisabled&&Zf.supportsFiber)try{j_=Zf.inject(mA),Ka=Zf}catch{}}Pi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fA;Pi.createPortal=Bw;Pi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(rt(188)):Error(rt(268,Object.keys(t)));return t=w1(n),t=t===null?null:t.stateNode,t};Pi.flushSync=function(t,n){var s=zt;if((s&48)!=0)return t(n);zt|=1;try{if(t)return Ya(99,t.bind(null,n))}finally{zt=s,So()}};Pi.hydrate=function(t,n,s){if(!Yh(n))throw Error(rt(200));return Gf(null,t,n,!0,s)};Pi.render=function(t,n,s){if(!Yh(n))throw Error(rt(200));return Gf(null,t,n,!1,s)};Pi.unmountComponentAtNode=function(t){if(!Yh(t))throw Error(rt(40));return t._reactRootContainer?(Iw(function(){Gf(null,null,t,!1,function(){t._reactRootContainer=null,t[Mc]=null})}),!0):!1};Pi.unstable_batchedUpdates=kw;Pi.unstable_createPortal=function(t,n){return Bw(t,n,2<arguments.length&&arguments[2]!==void 0?arguments[2]:null)};Pi.unstable_renderSubtreeIntoContainer=function(t,n,s,h){if(!Yh(s))throw Error(rt(200));if(t==null||t._reactInternals===void 0)throw Error(rt(38));return Gf(t,n,s,!1,h)};Pi.version="17.0.2";function Fw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Fw)}catch(t){console.error(t)}}Fw(),Hx.exports=Pi;var $w=Hx.exports,Nw={exports:{}};(function(t,n){(function(s,h){t.exports=h()})(hk,function(){var s,h,g;function x(a,A){if(!s)s=A;else if(!h)h=A;else{var D="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+s+")(sharedChunk); ("+h+")(sharedChunk); self.onerror = null;",V={};s(V),g=A(V),typeof window!="undefined"&&(g.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}x(["exports"],function(a){var A="2.6.1",D=V;function V(i,e,o,l){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(l-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=l,this.p2x=o,this.p2y=l}V.prototype.sampleCurveX=function(i){return((this.ax*i+this.bx)*i+this.cx)*i},V.prototype.sampleCurveY=function(i){return((this.ay*i+this.by)*i+this.cy)*i},V.prototype.sampleCurveDerivativeX=function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},V.prototype.solveCurveX=function(i,e){var o,l,u,p,m;for(e===void 0&&(e=1e-6),u=i,m=0;m<8;m++){if(p=this.sampleCurveX(u)-i,Math.abs(p)<e)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=p/v}if((u=i)<(o=0))return o;if(u>(l=1))return l;for(;o<l;){if(p=this.sampleCurveX(u),Math.abs(p-i)<e)return u;i>p?o=u:l=u,u=.5*(l-o)+o}return u},V.prototype.solve=function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))};var N=F;function F(i,e){this.x=i,this.y=e}F.prototype={clone:function(){return new F(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,o=i.y-this.y;return e*e+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),o=Math.sin(i),l=o*this.x+e*this.y;return this.x=e*this.x-o*this.y,this.y=l,this},_rotateAround:function(i,e){var o=Math.cos(i),l=Math.sin(i),u=e.y+l*(this.x-e.x)+o*(this.y-e.y);return this.x=e.x+o*(this.x-e.x)-l*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},F.convert=function(i){return i instanceof F?i:Array.isArray(i)?new F(i[0],i[1]):i};var ae=typeof self!="undefined"?self:{};const be=Math.pow(2,53)-1,fe=Math.PI/180,ee=180/Math.PI;function G(i){return i*fe}function X(i){return i*ee}const me=[[0,0],[1,0],[1,1],[0,1]];function Te(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,o=e*i;return 4*(i<.5?o:3*(i-e)+o-.75)}function We(i,e,o,l){const u=new D(i,e,o,l);return function(p){return u.solve(p)}}const Pe=We(.25,.1,.25,1);function Le(i,e,o){return Math.min(o,Math.max(e,i))}function Ke(i,e,o){const l=o-e,u=((i-e)%l+l)%l+e;return u===e?o:u}function Ye(i,e,o){if(!i.length)return o(null,[]);let l=i.length;const u=new Array(i.length);let p=null;i.forEach((m,v)=>{e(m,(b,T)=>{b&&(p=b),u[v]=T,--l==0&&o(p,u)})})}function it(i){const e=[];for(const o in i)e.push(i[o]);return e}function st(i,...e){for(const o of e)for(const l in o)i[l]=o[l];return i}let ut=1;function ht(){return ut++}function kt(){return function i(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function Tt(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Gt(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function nn(i,e){i.forEach(o=>{e[o]&&(e[o]=e[o].bind(e))})}function an(i,e){return i.indexOf(e,i.length-e.length)!==-1}function In(i,e,o){const l={};for(const u in i)l[u]=e.call(o||this,i[u],u,i);return l}function er(i,e,o){const l={};for(const u in i)e.call(o||this,i[u],u,i)&&(l[u]=i[u]);return l}function Ze(i){return Array.isArray(i)?i.map(Ze):typeof i=="object"&&i?In(i,Ze):i}const _t={};function dt(i){_t[i]||(typeof console!="undefined"&&console.warn(i),_t[i]=!0)}function Ut(i,e,o){return(o.y-i.y)*(e.x-i.x)>(e.y-i.y)*(o.x-i.x)}function vn(i){let e=0;for(let o,l,u=0,p=i.length,m=p-1;u<p;m=u++)o=i[u],l=i[m],e+=(l.x-o.x)*(o.y+l.y);return e}function wn(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function An(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,l,u,p)=>{const m=u||p;return e[l]=!m||m.toLowerCase(),""}),e["max-age"]){const o=parseInt(e["max-age"],10);isNaN(o)?delete e["max-age"]:e["max-age"]=o}return e}let ur,It,di,no=null;function Po(i){if(no==null){const e=i.navigator?i.navigator.userAgent:null;no=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return no}function Ni(i){try{const e=ae[i];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}const hr={now:()=>di!==void 0?di:ae.performance.now(),setNow(i){di=i},restoreNow(){di=void 0},frame(i){const e=ae.requestAnimationFrame(i);return{cancel:()=>ae.cancelAnimationFrame(e)}},getImageData(i,e=0){const o=ae.document.createElement("canvas"),l=o.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return o.width=i.width,o.height=i.height,l.drawImage(i,0,0,i.width,i.height),l.getImageData(-e,-e,i.width+2*e,i.height+2*e)},resolveURL:i=>(ur||(ur=ae.document.createElement("a")),ur.href=i,ur.href),get devicePixelRatio(){return ae.devicePixelRatio},get prefersReducedMotion(){return!!ae.matchMedia&&(It==null&&(It=ae.matchMedia("(prefers-reduced-motion: reduce)")),It.matches)}};let Ui;const Ot={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(Ui==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Ui={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):i}catch{Ui=i}}return Ui},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ct={supported:!1,testSupport:function(i){!tr&&cn&&(Nn?Jr(i):$t=i)}};let $t,cn,tr=!1,Nn=!1;function Jr(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,cn),i.isContextLost())return;ct.supported=!0}catch{}i.deleteTexture(e),tr=!0}ae.document&&(cn=ae.document.createElement("img"),cn.onload=function(){$t&&Jr($t),$t=null,Nn=!0},cn.onerror=function(){tr=!0,$t=null},cn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Nr="01",Ti="NO_ACCESS_TOKEN";function dr(i){return i.indexOf("mapbox:")===0}function Qr(i){return Ot.API_URL_REGEX.test(i)}const ji=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function pr(i){const e=i.match(ji);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function rr(i){const e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}function ro(i){if(!i)return null;const e=i.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(ae.atob(e[1]).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Si{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const o=ro(Ot.ACCESS_TOKEN);let l="";return l=o&&o.u?ae.btoa(encodeURIComponent(o.u).replace(/%([0-9A-F]{2})/g,(u,p)=>String.fromCharCode(Number("0x"+p)))):Ot.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${l}`:`mapbox.eventData:${l}`}fetchEventData(){const e=Ni("localStorage"),o=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{const u=ae.localStorage.getItem(o);u&&(this.eventData=JSON.parse(u));const p=ae.localStorage.getItem(l);p&&(this.anonId=p)}catch{dt("Unable to read from LocalStorage")}}saveEventData(){const e=Ni("localStorage"),o=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{ae.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&ae.localStorage.setItem(o,JSON.stringify(this.eventData))}catch{dt("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,o,l,u){if(!Ot.EVENTS_URL)return;const p=pr(Ot.EVENTS_URL);p.params.push(`access_token=${u||Ot.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:A,skuId:Nr,userId:this.anonId},v=o?st(m,o):m,b={url:rr(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=Y(b,T=>{this.pendingRequest=null,l(T),this.saveEventData(),this.processRequests(u)})}queueRequest(e,o){this.queue.push(e),this.processRequests(o)}}const zo=new class extends Si{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,e){Ot.EVENTS_URL&&Ot.ACCESS_TOKEN&&Array.isArray(i)&&i.some(o=>dr(o)||Qr(o))&&this.queueRequest(Date.now(),e)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=ro(Ot.ACCESS_TOKEN),o=e?e.u:Ot.ACCESS_TOKEN;let l=o!==this.eventData.tokenU;Gt(this.anonId)||(this.anonId=kt(),l=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),m=new Date(u),v=(u-this.eventData.lastSuccess)/864e5;l=l||v>=1||v<-1||p.getDate()!==m.getDate()}else l=!0;if(!l)return this.processRequests();this.postEvent(u,{"enabled.telemetry":!1},p=>{p||(this.eventData.lastSuccess=u,this.eventData.tokenU=o)},i)}},ha=zo.postTurnstileEvent.bind(zo),ds=new class extends Si{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,e,o,l){this.skuToken=e,this.errorCb=l,Ot.EVENTS_URL&&(o||Ot.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},o):this.errorCb(new Error(Ti)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Gt(this.anonId)||(this.anonId=kt()),this.postEvent(o,{skuToken:this.skuToken},l=>{l?this.errorCb(l):e&&(this.success[e]=!0)},i))}},tu=ds.postMapLoadEvent.bind(ds),cl=new class extends Si{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,e,o,l){if(!Ot.API_URL||!Ot.SESSION_PATH)return;const u=pr(Ot.API_URL+Ot.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${l||Ot.ACCESS_TOKEN||""}`);const p={url:rr(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=ie(p,m=>{this.pendingRequest=null,o(m),this.saveEventData(),this.processRequests(l)})}getSessionAPI(i,e,o,l){this.skuToken=e,this.errorCb=l,Ot.SESSION_PATH&&Ot.API_URL&&(o||Ot.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},o):this.errorCb(new Error(Ti)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||this.getSession(o,this.skuToken,l=>{l?this.errorCb(l):e&&(this.success[e]=!0)},i)}},ul=cl.getSessionAPI.bind(cl),io=new Set,da="mapbox-tiles";let ei,Do,hl=500,Ro=50;function Vi(){ae.caches&&!ei&&(ei=ae.caches.open(da))}function ps(i){const e=i.indexOf("?");return e<0?i:i.slice(0,e)}let pa=1/0;const Lo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Lo);class Oo extends Error{constructor(e,o,l){o===401&&Qr(l)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=o,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Q=wn()?()=>self.worker&&self.worker.referrer:()=>(ae.location.protocol==="blob:"?ae.parent:ae).location.href,L=function(i,e){if(!(/^file:/.test(o=i.url)||/^file:/.test(Q())&&!/^\w+:/.test(o))){if(ae.fetch&&ae.Request&&ae.AbortController&&ae.Request.prototype.hasOwnProperty("signal"))return function(l,u){const p=new ae.AbortController,m=new ae.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:Q(),signal:p.signal});let v=!1,b=!1;const T=(C=m.url).indexOf("sku=")>0&&Qr(C);var C;l.type==="json"&&m.headers.set("Accept","application/json");const k=(O,B,j)=>{if(b)return;if(O&&O.message!=="SecurityError"&&dt(O),B&&j)return M(B);const J=Date.now();ae.fetch(m).then(oe=>{if(oe.ok){const ce=T?oe.clone():null;return M(oe,ce,J)}return u(new Oo(oe.statusText,oe.status,l.url))}).catch(oe=>{oe.code!==20&&u(new Error(oe.message))})},M=(O,B,j)=>{(l.type==="arrayBuffer"?O.arrayBuffer():l.type==="json"?O.json():O.text()).then(J=>{b||(B&&j&&function(oe,ce,pe){if(Vi(),!ei)return;const ye={status:ce.status,statusText:ce.statusText,headers:new ae.Headers};ce.headers.forEach((ve,Re)=>ye.headers.set(Re,ve));const ge=An(ce.headers.get("Cache-Control")||"");ge["no-store"]||(ge["max-age"]&&ye.headers.set("Expires",new Date(pe+1e3*ge["max-age"]).toUTCString()),new Date(ye.headers.get("Expires")).getTime()-pe<42e4||function(ve,Re){if(Do===void 0)try{new Response(new ReadableStream),Do=!0}catch{Do=!1}Do?Re(ve.body):ve.blob().then(Re)}(ce,ve=>{const Re=new ae.Response(ve,ye);Vi(),ei&&ei.then(Ie=>Ie.put(ps(oe.url),Re)).catch(Ie=>dt(Ie.message))}))}(m,B,j),v=!0,u(null,J,O.headers.get("Cache-Control"),O.headers.get("Expires")))}).catch(J=>{b||u(new Error(J.message))})};return T?function(O,B){if(Vi(),!ei)return B(null);const j=ps(O.url);ei.then(J=>{J.match(j).then(oe=>{const ce=function(pe){if(!pe)return!1;const ye=new Date(pe.headers.get("Expires")||0),ge=An(pe.headers.get("Cache-Control")||"");return ye>Date.now()&&!ge["no-cache"]}(oe);J.delete(j),ce&&J.put(j,oe.clone()),B(null,oe,ce)}).catch(B)}).catch(B)}(m,k):k(null,null),{cancel:()=>{b=!0,v||p.abort()}}}(i,e);if(wn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var o;return function(l,u){const p=new ae.XMLHttpRequest;p.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const m in l.headers)p.setRequestHeader(m,l.headers[m]);return l.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=l.credentials==="include",p.onerror=()=>{u(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let m=p.response;if(l.type==="json")try{m=JSON.parse(p.response)}catch(v){return u(v)}u(null,m,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else u(new Oo(p.statusText,p.status,l.url))},p.send(l.body),{cancel:()=>p.abort()}}(i,e)},$=function(i,e){return L(st(i,{type:"arrayBuffer"}),e)},Y=function(i,e){return L(st(i,{method:"POST"}),e)},ie=function(i,e){return L(st(i,{method:"GET"}),e)};function ue(i){const e=ae.document.createElement("a");return e.href=i,e.protocol===ae.document.location.protocol&&e.host===ae.document.location.host}const we="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let xe,de;xe=[],de=0;const Ee=function(i,e){if(ct.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),de>=Ot.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return xe.push(p),p}de++;let o=!1;const l=()=>{if(!o)for(o=!0,de--;xe.length&&de<Ot.MAX_PARALLEL_IMAGE_REQUESTS;){const p=xe.shift(),{requestParameters:m,callback:v,cancelled:b}=p;b||(p.cancel=Ee(m,v).cancel)}},u=$(i,(p,m,v,b)=>{l(),p?e(p):m&&(ae.createImageBitmap?function(T,C){const k=new ae.Blob([new Uint8Array(T)],{type:"image/png"});ae.createImageBitmap(k).then(M=>{C(null,M)}).catch(M=>{C(new Error(`Could not load image because of ${M.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(T,C)=>e(T,C,v,b)):function(T,C){const k=new ae.Image,M=ae.URL;k.onload=()=>{C(null,k),M.revokeObjectURL(k.src),k.onload=null,ae.requestAnimationFrame(()=>{k.src=we})},k.onerror=()=>C(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const O=new ae.Blob([new Uint8Array(T)],{type:"image/png"});k.src=T.byteLength?M.createObjectURL(O):we}(m,(T,C)=>e(T,C,v,b)))});return{cancel:()=>{u.cancel(),l()}}};function Fe(i,e,o){o[i]&&o[i].indexOf(e)!==-1||(o[i]=o[i]||[],o[i].push(e))}function Je(i,e,o){if(o&&o[i]){const l=o[i].indexOf(e);l!==-1&&o[i].splice(l,1)}}class Ne{constructor(e,o={}){st(this,o),this.type=e}}class pt extends Ne{constructor(e,o={}){super("error",st({error:e},o))}}class Xe{on(e,o){return this._listeners=this._listeners||{},Fe(e,o,this._listeners),this}off(e,o){return Je(e,o,this._listeners),Je(e,o,this._oneTimeListeners),this}once(e,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Fe(e,o,this._oneTimeListeners),this):new Promise(l=>this.once(e,l))}fire(e,o){typeof e=="string"&&(e=new Ne(e,o||{}));const l=e.type;if(this.listens(l)){e.target=this;const u=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const v of u)v.call(this,e);const p=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const v of p)Je(l,v,this._oneTimeListeners),v.call(this,e);const m=this._eventedParent;m&&(st(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),m.fire(e))}else e instanceof pt&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,o){return this._eventedParent=e,this._eventedParentData=o,this}}var _e=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class Ae{constructor(e,o,l,u){this.message=(e?`${e}: `:"")+l,u&&(this.identifier=u),o!=null&&o.__line__&&(this.line=o.__line__)}}function Bt(i){const e=i.value;return e?[new Ae(i.key,e,"constants have been deprecated as of v8")]:[]}function Jt(i,...e){for(const o of e)for(const l in o)i[l]=o[l];return i}function St(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function jt(i){if(Array.isArray(i))return i.map(jt);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const o in i)e[o]=jt(i[o]);return e}return St(i)}class Wt extends Error{constructor(e,o){super(o),this.message=o,this.key=e}}class Bo{constructor(e,o=[]){this.parent=e,this.bindings={};for(const[l,u]of o)this.bindings[l]=u}concat(e){return new Bo(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Ci={kind:"null"},Qe={kind:"number"},Lt={kind:"string"},Dt={kind:"boolean"},Rn={kind:"color"},Fo={kind:"object"},Rt={kind:"value"},dl={kind:"collator"},fs={kind:"formatted"},ms={kind:"resolvedImage"};function Ur(i,e){return{kind:"array",itemType:i,N:e}}function xn(i){if(i.kind==="array"){const e=xn(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const fd=[Ci,Qe,Lt,Dt,Rn,fs,Fo,Ur(Rt),ms];function oo(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!oo(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const o of fd)if(!oo(o,e))return null}}return`Expected ${xn(i)} but found ${xn(e)} instead.`}function nu(i,e){return e.some(o=>o.kind===i.kind)}function pi(i,e){return e.some(o=>o==="null"?i===null:o==="array"?Array.isArray(i):o==="object"?i&&!Array.isArray(i)&&typeof i=="object":o===typeof i)}function pl(i){var e={exports:{}};return i(e,e.exports),e.exports}var fi=pl(function(i,e){var o={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(v){return(v=Math.round(v))<0?0:v>255?255:v}function u(v){return l(v[v.length-1]==="%"?parseFloat(v)/100*255:parseInt(v))}function p(v){return(b=v[v.length-1]==="%"?parseFloat(v)/100:parseFloat(v))<0?0:b>1?1:b;var b}function m(v,b,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?v+(b-v)*T*6:2*T<1?b:3*T<2?v+(b-v)*(2/3-T)*6:v}try{e.parseCSSColor=function(v){var b,T=v.replace(/ /g,"").toLowerCase();if(T in o)return o[T].slice();if(T[0]==="#")return T.length===4?(b=parseInt(T.substr(1),16))>=0&&b<=4095?[(3840&b)>>4|(3840&b)>>8,240&b|(240&b)>>4,15&b|(15&b)<<4,1]:null:T.length===7&&(b=parseInt(T.substr(1),16))>=0&&b<=16777215?[(16711680&b)>>16,(65280&b)>>8,255&b,1]:null;var C=T.indexOf("("),k=T.indexOf(")");if(C!==-1&&k+1===T.length){var M=T.substr(0,C),O=T.substr(C+1,k-(C+1)).split(","),B=1;switch(M){case"rgba":if(O.length!==4)return null;B=p(O.pop());case"rgb":return O.length!==3?null:[u(O[0]),u(O[1]),u(O[2]),B];case"hsla":if(O.length!==4)return null;B=p(O.pop());case"hsl":if(O.length!==3)return null;var j=(parseFloat(O[0])%360+360)%360/360,J=p(O[1]),oe=p(O[2]),ce=oe<=.5?oe*(J+1):oe+J-oe*J,pe=2*oe-ce;return[l(255*m(pe,ce,j+1/3)),l(255*m(pe,ce,j)),l(255*m(pe,ce,j-1/3)),B];default:return null}}return null}}catch{}});class Ht{constructor(e,o,l,u=1){this.r=e,this.g=o,this.b=l,this.a=u}static parse(e){if(!e)return;if(e instanceof Ht)return e;if(typeof e!="string")return;const o=fi.parseCSSColor(e);return o?new Ht(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[e,o,l,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(o)},${Math.round(l)},${u})`}toArray(){const{r:e,g:o,b:l,a:u}=this;return u===0?[0,0,0,0]:[255*e/u,255*o/u,255*l/u,u]}}Ht.black=new Ht(0,0,0,1),Ht.white=new Ht(1,1,1,1),Ht.transparent=new Ht(0,0,0,0),Ht.red=new Ht(1,0,0,1),Ht.blue=new Ht(0,0,1,1);class fl{constructor(e,o,l){this.sensitivity=e?o?"variant":"case":o?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,o){return this.collator.compare(e,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class $o{constructor(e,o,l,u,p){this.text=e,this.image=o,this.scale=l,this.fontStack=u,this.textColor=p}}class fr{constructor(e){this.sections=e}static fromString(e){return new fr([new $o(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof fr?e:fr.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const o of this.sections){if(o.image){e.push(["image",o.image.name]);continue}e.push(o.text);const l={};o.fontStack&&(l["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(l["font-scale"]=o.scale),o.textColor&&(l["text-color"]=["rgba"].concat(o.textColor.toArray())),e.push(l)}return e}}class ti{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new ti({name:e,available:!1}):null}serialize(){return["image",this.name]}}function md(i,e,o,l){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof o=="number"&&o>=0&&o<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,e,o,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,e,o,l]:[i,e,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ml(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Ht||i instanceof fl||i instanceof fr||i instanceof ti)return!0;if(Array.isArray(i)){for(const e of i)if(!ml(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!ml(i[e]))return!1;return!0}return!1}function Ln(i){if(i===null)return Ci;if(typeof i=="string")return Lt;if(typeof i=="boolean")return Dt;if(typeof i=="number")return Qe;if(i instanceof Ht)return Rn;if(i instanceof fl)return dl;if(i instanceof fr)return fs;if(i instanceof ti)return ms;if(Array.isArray(i)){const e=i.length;let o;for(const l of i){const u=Ln(l);if(o){if(o===u)continue;o=Rt;break}o=u}return Ur(o||Rt,e)}return Fo}function No(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof Ht||i instanceof fr||i instanceof ti?i.toString():JSON.stringify(i)}class Uo{constructor(e,o){this.type=e,this.value=o}static parse(e,o){if(e.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ml(e[1]))return o.error("invalid value");const l=e[1];let u=Ln(l);const p=o.expectedType;return u.kind!=="array"||u.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(u=p),new Uo(u,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ht?["rgba"].concat(this.value.toArray()):this.value instanceof fr?this.value.serialize():this.value}}class Un{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const ru={string:Lt,number:Qe,boolean:Dt,object:Fo};class mi{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");let l,u=1;const p=e[0];if(p==="array"){let v,b;if(e.length>2){const T=e[1];if(typeof T!="string"||!(T in ru)||T==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);v=ru[T],u++}else v=Rt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return o.error('The length argument to "array" must be a positive integer literal',2);b=e[2],u++}l=Ur(v,b)}else l=ru[p];const m=[];for(;u<e.length;u++){const v=o.parse(e[u],u,Rt);if(!v)return null;m.push(v)}return new mi(l,m)}evaluate(e){for(let o=0;o<this.args.length;o++){const l=this.args[o].evaluate(e);if(!oo(this.type,Ln(l)))return l;if(o===this.args.length-1)throw new Un(`Expected value to be of type ${xn(this.type)}, but found ${xn(Ln(l))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,o=[e.kind];if(e.kind==="array"){const l=e.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){o.push(l.kind);const u=e.N;(typeof u=="number"||this.args.length>1)&&o.push(u)}}return o.concat(this.args.map(l=>l.serialize()))}}class fa{constructor(e){this.type=fs,this.sections=e}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const l=e[1];if(!Array.isArray(l)&&typeof l=="object")return o.error("First argument must be an image or text section.");const u=[];let p=!1;for(let m=1;m<=e.length-1;++m){const v=e[m];if(p&&typeof v=="object"&&!Array.isArray(v)){p=!1;let b=null;if(v["font-scale"]&&(b=o.parse(v["font-scale"],1,Qe),!b))return null;let T=null;if(v["text-font"]&&(T=o.parse(v["text-font"],1,Ur(Lt)),!T))return null;let C=null;if(v["text-color"]&&(C=o.parse(v["text-color"],1,Rn),!C))return null;const k=u[u.length-1];k.scale=b,k.font=T,k.textColor=C}else{const b=o.parse(e[m],1,Rt);if(!b)return null;const T=b.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,u.push({content:b,scale:null,font:null,textColor:null})}}return new fa(u)}evaluate(e){return new fr(this.sections.map(o=>{const l=o.content.evaluate(e);return Ln(l)===ms?new $o("",l,null,null,null):new $o(No(l),null,o.scale?o.scale.evaluate(e):null,o.font?o.font.evaluate(e).join(","):null,o.textColor?o.textColor.evaluate(e):null)}))}eachChild(e){for(const o of this.sections)e(o.content),o.scale&&e(o.scale),o.font&&e(o.font),o.textColor&&e(o.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const o of this.sections){e.push(o.content.serialize());const l={};o.scale&&(l["font-scale"]=o.scale.serialize()),o.font&&(l["text-font"]=o.font.serialize()),o.textColor&&(l["text-color"]=o.textColor.serialize()),e.push(l)}return e}}class gl{constructor(e){this.type=ms,this.input=e}static parse(e,o){if(e.length!==2)return o.error("Expected two arguments.");const l=o.parse(e[1],1,Lt);return l?new gl(l):o.error("No image name provided.")}evaluate(e){const o=this.input.evaluate(e),l=ti.fromString(o);return l&&e.availableImages&&(l.available=e.availableImages.indexOf(o)>-1),l}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const ym={"to-boolean":Dt,"to-color":Rn,"to-number":Qe,"to-string":Lt};class so{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const l=e[0];if((l==="to-boolean"||l==="to-string")&&e.length!==2)return o.error("Expected one argument.");const u=ym[l],p=[];for(let m=1;m<e.length;m++){const v=o.parse(e[m],m,Rt);if(!v)return null;p.push(v)}return new so(u,p)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let o,l;for(const u of this.args){if(o=u.evaluate(e),l=null,o instanceof Ht)return o;if(typeof o=="string"){const p=e.parseColor(o);if(p)return p}else if(Array.isArray(o)&&(l=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:md(o[0],o[1],o[2],o[3]),!l))return new Ht(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Un(l||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const l of this.args){if(o=l.evaluate(e),o===null)return 0;const u=Number(o);if(!isNaN(u))return u}throw new Un(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?fr.fromString(No(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?ti.fromString(No(this.args[0].evaluate(e))):No(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new fa([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new gl(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(o=>{e.push(o.serialize())}),e}}const vm=["Unknown","Point","LineString","Polygon"];class iu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?vm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:l,y:u}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(l*o-e[0])+this.featureDistanceData.bearing[1]*(u*o-e[1])}return 0}parseColor(e){let o=this._parseColorCache[e];return o||(o=this._parseColorCache[e]=Ht.parse(e)),o}}class mr{constructor(e,o,l,u){this.name=e,this.type=o,this._evaluate=l,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,o){const l=e[0],u=mr.definitions[l];if(!u)return o.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(u)?u[0]:u.type,m=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,v=m.filter(([T])=>!Array.isArray(T)||T.length===e.length-1);let b=null;for(const[T,C]of v){b=new El(o.registry,o.path,null,o.scope);const k=[];let M=!1;for(let O=1;O<e.length;O++){const B=e[O],j=Array.isArray(T)?T[O-1]:T.type,J=b.parse(B,1+k.length,j);if(!J){M=!0;break}k.push(J)}if(!M)if(Array.isArray(T)&&T.length!==k.length)b.error(`Expected ${T.length} arguments, but found ${k.length} instead.`);else{for(let O=0;O<k.length;O++){const B=Array.isArray(T)?T[O]:T.type,j=k[O];b.concat(O+1).checkSubtype(B,j.type)}if(b.errors.length===0)return new mr(l,p,C,k)}}if(v.length===1)o.errors.push(...b.errors);else{const T=(v.length?v:m).map(([k])=>{return M=k,Array.isArray(M)?`(${M.map(xn).join(", ")})`:`(${xn(M.type)}...)`;var M}).join(" | "),C=[];for(let k=1;k<e.length;k++){const M=o.parse(e[k],1+C.length);if(!M)return null;C.push(xn(M.type))}o.error(`Expected arguments of type ${T}, but found (${C.join(", ")}) instead.`)}return null}static register(e,o){mr.definitions=o;for(const l in o)e[l]=mr}}class _l{constructor(e,o,l){this.type=dl,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=o}static parse(e,o){if(e.length!==2)return o.error("Expected one argument.");const l=e[1];if(typeof l!="object"||Array.isArray(l))return o.error("Collator options argument must be an object.");const u=o.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Dt);if(!u)return null;const p=o.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Dt);if(!p)return null;let m=null;return l.locale&&(m=o.parse(l.locale,1,Lt),!m)?null:new _l(u,p,m)}evaluate(e){return new fl(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const ao=8192;function ou(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function yl(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function xm(i,e){const o=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(o*u*ao),Math.round(l*u*ao)]}function bm(i,e,o){const l=i[0]-e[0],u=i[1]-e[1],p=i[0]-o[0],m=i[1]-o[1];return l*m-p*u==0&&l*p<=0&&u*m<=0}function vl(i,e){let o=!1;for(let m=0,v=e.length;m<v;m++){const b=e[m];for(let T=0,C=b.length;T<C-1;T++){if(bm(i,b[T],b[T+1]))return!1;(u=b[T])[1]>(l=i)[1]!=(p=b[T+1])[1]>l[1]&&l[0]<(p[0]-u[0])*(l[1]-u[1])/(p[1]-u[1])+u[0]&&(o=!o)}}var l,u,p;return o}function xl(i,e){for(let o=0;o<e.length;o++)if(vl(i,e[o]))return!0;return!1}function gd(i,e,o,l){const u=l[0]-o[0],p=l[1]-o[1],m=(i[0]-o[0])*p-u*(i[1]-o[1]),v=(e[0]-o[0])*p-u*(e[1]-o[1]);return m>0&&v<0||m<0&&v>0}function wm(i,e,o){for(const T of o)for(let C=0;C<T.length-1;++C)if((v=[(m=T[C+1])[0]-(p=T[C])[0],m[1]-p[1]])[0]*(b=[(u=e)[0]-(l=i)[0],u[1]-l[1]])[1]-v[1]*b[0]!=0&&gd(l,u,p,m)&&gd(p,m,l,u))return!0;var l,u,p,m,v,b;return!1}function _d(i,e){for(let o=0;o<i.length;++o)if(!vl(i[o],e))return!1;for(let o=0;o<i.length-1;++o)if(wm(i[o],i[o+1],e))return!1;return!0}function Em(i,e){for(let o=0;o<e.length;o++)if(_d(i,e[o]))return!0;return!1}function ni(i,e,o){const l=[];for(let u=0;u<i.length;u++){const p=[];for(let m=0;m<i[u].length;m++){const v=xm(i[u][m],o);ou(e,v),p.push(v)}l.push(p)}return l}function su(i,e,o){const l=[];for(let u=0;u<i.length;u++){const p=ni(i[u],e,o);l.push(p)}return l}function au(i,e,o,l){if(i[0]<o[0]||i[0]>o[2]){const u=.5*l;let p=i[0]-o[0]>u?-l:o[0]-i[0]>u?l:0;p===0&&(p=i[0]-o[2]>u?-l:o[2]-i[0]>u?l:0),i[0]+=p}ou(e,i)}function ma(i,e,o,l){const u=Math.pow(2,l.z)*ao,p=[l.x*ao,l.y*ao],m=[];for(const v of i)for(const b of v){const T=[b.x+p[0],b.y+p[1]];au(T,e,o,u),m.push(T)}return m}function gs(i,e,o,l){const u=Math.pow(2,l.z)*ao,p=[l.x*ao,l.y*ao],m=[];for(const b of i){const T=[];for(const C of b){const k=[C.x+p[0],C.y+p[1]];ou(e,k),T.push(k)}m.push(T)}if(e[2]-e[0]<=u/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const b of m)for(const T of b)au(T,e,o,u)}var v;return m}class lo{constructor(e,o){this.type=Dt,this.geojson=e,this.geometries=o}static parse(e,o){if(e.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ml(e[1])){const l=e[1];if(l.type==="FeatureCollection")for(let u=0;u<l.features.length;++u){const p=l.features[u].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new lo(l,l.features[u].geometry)}else if(l.type==="Feature"){const u=l.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new lo(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new lo(l,l)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(o,l){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=o.canonicalID();if(l.type==="Polygon"){const v=ni(l.coordinates,p,m),b=ma(o.geometry(),u,p,m);if(!yl(u,p))return!1;for(const T of b)if(!vl(T,v))return!1}if(l.type==="MultiPolygon"){const v=su(l.coordinates,p,m),b=ma(o.geometry(),u,p,m);if(!yl(u,p))return!1;for(const T of b)if(!xl(T,v))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(o,l){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=o.canonicalID();if(l.type==="Polygon"){const v=ni(l.coordinates,p,m),b=gs(o.geometry(),u,p,m);if(!yl(u,p))return!1;for(const T of b)if(!_d(T,v))return!1}if(l.type==="MultiPolygon"){const v=su(l.coordinates,p,m),b=gs(o.geometry(),u,p,m);if(!yl(u,p))return!1;for(const T of b)if(!Em(T,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function _s(i){if(i instanceof mr&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof lo)return!1;let e=!0;return i.eachChild(o=>{e&&!_s(o)&&(e=!1)}),e}function bl(i){if(i instanceof mr&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(o=>{e&&!bl(o)&&(e=!1)}),e}function Vt(i,e){if(i instanceof mr&&e.indexOf(i.name)>=0)return!1;let o=!0;return i.eachChild(l=>{o&&!Vt(l,e)&&(o=!1)}),o}class wl{constructor(e,o){this.type=o.type,this.name=e,this.boundExpression=o}static parse(e,o){if(e.length!==2||typeof e[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const l=e[1];return o.scope.has(l)?new wl(l,o.scope.get(l)):o.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class El{constructor(e,o=[],l,u=new Bo,p=[]){this.registry=e,this.path=o,this.key=o.map(m=>`[${m}]`).join(""),this.scope=u,this.errors=p,this.expectedType=l}parse(e,o,l,u,p={}){return o?this.concat(o,l,u)._parse(e,p):this._parse(e,p)}_parse(e,o){function l(u,p,m){return m==="assert"?new mi(p,[u]):m==="coerce"?new so(p,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[u];if(p){let m=p.parse(e,this);if(!m)return null;if(this.expectedType){const v=this.expectedType,b=m.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||b.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(v,b))return null}else m=l(m,v,o.typeAnnotation||"coerce");else m=l(m,v,o.typeAnnotation||"assert")}if(!(m instanceof Uo)&&m.type.kind!=="resolvedImage"&&lu(m)){const v=new iu;try{m=new Uo(m.type,m.evaluate(v))}catch(b){return this.error(b.message),null}}return m}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,o,l){const u=typeof e=="number"?this.path.concat(e):this.path,p=l?this.scope.concat(l):this.scope;return new El(this.registry,u,o||null,p,this.errors)}error(e,...o){const l=`${this.key}${o.map(u=>`[${u}]`).join("")}`;this.errors.push(new Wt(l,e))}checkSubtype(e,o){const l=oo(e,o);return l&&this.error(l),l}}function lu(i){if(i instanceof wl)return lu(i.boundExpression);if(i instanceof mr&&i.name==="error"||i instanceof _l||i instanceof lo)return!1;const e=i instanceof so||i instanceof mi;let o=!0;return i.eachChild(l=>{o=e?o&&lu(l):o&&l instanceof Uo}),!!o&&_s(i)&&Vt(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ga(i,e){const o=i.length-1;let l,u,p=0,m=o,v=0;for(;p<=m;)if(v=Math.floor((p+m)/2),l=i[v],u=i[v+1],l<=e){if(v===o||e<u)return v;p=v+1}else{if(!(l>e))throw new Un("Input is not a number.");m=v-1}return 0}class _a{constructor(e,o,l){this.type=e,this.input=o,this.labels=[],this.outputs=[];for(const[u,p]of l)this.labels.push(u),this.outputs.push(p)}static parse(e,o){if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");const l=o.parse(e[1],1,Qe);if(!l)return null;const u=[];let p=null;o.expectedType&&o.expectedType.kind!=="value"&&(p=o.expectedType);for(let m=1;m<e.length;m+=2){const v=m===1?-1/0:e[m],b=e[m+1],T=m,C=m+1;if(typeof v!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(u.length&&u[u.length-1][0]>=v)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const k=o.parse(b,C,p);if(!k)return null;p=p||k.type,u.push([v,k])}return new _a(p,l,u)}evaluate(e){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(e);const u=this.input.evaluate(e);if(u<=o[0])return l[0].evaluate(e);const p=o.length;return u>=o[p-1]?l[p-1].evaluate(e):l[ga(o,u)].evaluate(e)}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&e.push(this.labels[o]),e.push(this.outputs[o].serialize());return e}}function Xt(i,e,o){return i*(1-o)+e*o}var ya=Object.freeze({__proto__:null,number:Xt,color:function(i,e,o){return new Ht(Xt(i.r,e.r,o),Xt(i.g,e.g,o),Xt(i.b,e.b,o),Xt(i.a,e.a,o))},array:function(i,e,o){return i.map((l,u)=>Xt(l,e[u],o))}});const Tl=.95047,cu=1.08883,yd=4/29,va=6/29,uu=3*va*va,Tm=Math.PI/180,vd=180/Math.PI;function hu(i){return i>.008856451679035631?Math.pow(i,1/3):i/uu+yd}function Sl(i){return i>va?i*i*i:uu*(i-yd)}function Cl(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function kl(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function du(i){const e=kl(i.r),o=kl(i.g),l=kl(i.b),u=hu((.4124564*e+.3575761*o+.1804375*l)/Tl),p=hu((.2126729*e+.7151522*o+.072175*l)/1);return{l:116*p-16,a:500*(u-p),b:200*(p-hu((.0193339*e+.119192*o+.9503041*l)/cu)),alpha:i.a}}function xd(i){let e=(i.l+16)/116,o=isNaN(i.a)?e:e+i.a/500,l=isNaN(i.b)?e:e-i.b/200;return e=1*Sl(e),o=Tl*Sl(o),l=cu*Sl(l),new Ht(Cl(3.2404542*o-1.5371385*e-.4985314*l),Cl(-.969266*o+1.8760108*e+.041556*l),Cl(.0556434*o-.2040259*e+1.0572252*l),i.alpha)}function bd(i,e,o){const l=e-i;return i+o*(l>180||l<-180?l-360*Math.round(l/360):l)}const ys={forward:du,reverse:xd,interpolate:function(i,e,o){return{l:Xt(i.l,e.l,o),a:Xt(i.a,e.a,o),b:Xt(i.b,e.b,o),alpha:Xt(i.alpha,e.alpha,o)}}},xa={forward:function(i){const{l:e,a:o,b:l}=du(i),u=Math.atan2(l,o)*vd;return{h:u<0?u+360:u,c:Math.sqrt(o*o+l*l),l:e,alpha:i.a}},reverse:function(i){const e=i.h*Tm,o=i.c;return xd({l:i.l,a:Math.cos(e)*o,b:Math.sin(e)*o,alpha:i.alpha})},interpolate:function(i,e,o){return{h:bd(i.h,e.h,o),c:Xt(i.c,e.c,o),l:Xt(i.l,e.l,o),alpha:Xt(i.alpha,e.alpha,o)}}};var wd=Object.freeze({__proto__:null,lab:ys,hcl:xa});class jr{constructor(e,o,l,u,p){this.type=e,this.operator=o,this.interpolation=l,this.input=u,this.labels=[],this.outputs=[];for(const[m,v]of p)this.labels.push(m),this.outputs.push(v)}static interpolationFactor(e,o,l,u){let p=0;if(e.name==="exponential")p=pu(o,e.base,l,u);else if(e.name==="linear")p=pu(o,1,l,u);else if(e.name==="cubic-bezier"){const m=e.controlPoints;p=new D(m[0],m[1],m[2],m[3]).solve(pu(o,1,l,u))}return p}static parse(e,o){let[l,u,p,...m]=e;if(!Array.isArray(u)||u.length===0)return o.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const T=u[1];if(typeof T!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:T}}else{if(u[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const T=u.slice(1);if(T.length!==4||T.some(C=>typeof C!="number"||C<0||C>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:T}}}if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(p=o.parse(p,2,Qe),!p)return null;const v=[];let b=null;l==="interpolate-hcl"||l==="interpolate-lab"?b=Rn:o.expectedType&&o.expectedType.kind!=="value"&&(b=o.expectedType);for(let T=0;T<m.length;T+=2){const C=m[T],k=m[T+1],M=T+3,O=T+4;if(typeof C!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(v.length&&v[v.length-1][0]>=C)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',M);const B=o.parse(k,O,b);if(!B)return null;b=b||B.type,v.push([C,B])}return b.kind==="number"||b.kind==="color"||b.kind==="array"&&b.itemType.kind==="number"&&typeof b.N=="number"?new jr(b,l,u,p,v):o.error(`Type ${xn(b)} is not interpolatable.`)}evaluate(e){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(e);const u=this.input.evaluate(e);if(u<=o[0])return l[0].evaluate(e);const p=o.length;if(u>=o[p-1])return l[p-1].evaluate(e);const m=ga(o,u),v=jr.interpolationFactor(this.interpolation,u,o[m],o[m+1]),b=l[m].evaluate(e),T=l[m+1].evaluate(e);return this.operator==="interpolate"?ya[this.type.kind.toLowerCase()](b,T,v):this.operator==="interpolate-hcl"?xa.reverse(xa.interpolate(xa.forward(b),xa.forward(T),v)):ys.reverse(ys.interpolate(ys.forward(b),ys.forward(T),v))}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,e,this.input.serialize()];for(let l=0;l<this.labels.length;l++)o.push(this.labels[l],this.outputs[l].serialize());return o}}function pu(i,e,o,l){const u=l-o,p=i-o;return u===0?0:e===1?p/u:(Math.pow(e,p)-1)/(Math.pow(e,u)-1)}class Il{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expectected at least one argument.");let l=null;const u=o.expectedType;u&&u.kind!=="value"&&(l=u);const p=[];for(const v of e.slice(1)){const b=o.parse(v,1+p.length,l,void 0,{typeAnnotation:"omit"});if(!b)return null;l=l||b.type,p.push(b)}const m=u&&p.some(v=>oo(u,v.type));return new Il(m?Rt:l,p)}evaluate(e){let o,l=null,u=0;for(const p of this.args)if(u++,l=p.evaluate(e),l&&l instanceof ti&&!l.available&&(o||(o=l.name),l=null,u===this.args.length&&(l=o)),l!==null)break;return l}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(o=>{e.push(o.serialize())}),e}}class ba{constructor(e,o){this.type=o.type,this.bindings=[].concat(e),this.result=o}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const o of this.bindings)e(o[1]);e(this.result)}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const l=[];for(let p=1;p<e.length-1;p+=2){const m=e[p];if(typeof m!="string")return o.error(`Expected string, but found ${typeof m} instead.`,p);if(/[^a-zA-Z0-9_]/.test(m))return o.error("Variable names must contain only alphanumeric characters or '_'.",p);const v=o.parse(e[p+1],p+1);if(!v)return null;l.push([m,v])}const u=o.parse(e[e.length-1],e.length-1,o.expectedType,l);return u?new ba(l,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[o,l]of this.bindings)e.push(o,l.serialize());return e.push(this.result.serialize()),e}}class fu{constructor(e,o,l){this.type=e,this.index=o,this.input=l}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Qe),u=o.parse(e[2],2,Ur(o.expectedType||Rt));return l&&u?new fu(u.type.itemType,l,u):null}evaluate(e){const o=this.index.evaluate(e),l=this.input.evaluate(e);if(o<0)throw new Un(`Array index out of bounds: ${o} < 0.`);if(o>=l.length)throw new Un(`Array index out of bounds: ${o} > ${l.length-1}.`);if(o!==Math.floor(o))throw new Un(`Array index must be an integer, but found ${o} instead.`);return l[o]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class mu{constructor(e,o){this.type=Dt,this.needle=e,this.haystack=o}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Rt),u=o.parse(e[2],2,Rt);return l&&u?nu(l.type,[Dt,Lt,Qe,Ci,Rt])?new mu(l,u):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${xn(l.type)} instead`):null}evaluate(e){const o=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!l)return!1;if(!pi(o,["boolean","string","number","null"]))throw new Un(`Expected first argument to be of type boolean, string, number or null, but found ${xn(Ln(o))} instead.`);if(!pi(l,["string","array"]))throw new Un(`Expected second argument to be of type array or string, but found ${xn(Ln(l))} instead.`);return l.indexOf(o)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Al{constructor(e,o,l){this.type=Qe,this.needle=e,this.haystack=o,this.fromIndex=l}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Rt),u=o.parse(e[2],2,Rt);if(!l||!u)return null;if(!nu(l.type,[Dt,Lt,Qe,Ci,Rt]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${xn(l.type)} instead`);if(e.length===4){const p=o.parse(e[3],3,Qe);return p?new Al(l,u,p):null}return new Al(l,u)}evaluate(e){const o=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!pi(o,["boolean","string","number","null"]))throw new Un(`Expected first argument to be of type boolean, string, number or null, but found ${xn(Ln(o))} instead.`);if(!pi(l,["string","array"]))throw new Un(`Expected second argument to be of type array or string, but found ${xn(Ln(l))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return l.indexOf(o,u)}return l.indexOf(o)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Ml{constructor(e,o,l,u,p,m){this.inputType=e,this.type=o,this.input=l,this.cases=u,this.outputs=p,this.otherwise=m}static parse(e,o){if(e.length<5)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return o.error("Expected an even number of arguments.");let l,u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const p={},m=[];for(let T=2;T<e.length-1;T+=2){let C=e[T];const k=e[T+1];Array.isArray(C)||(C=[C]);const M=o.concat(T);if(C.length===0)return M.error("Expected at least one branch label.");for(const B of C){if(typeof B!="number"&&typeof B!="string")return M.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return M.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return M.error("Numeric branch labels must be integer values.");if(l){if(M.checkSubtype(l,Ln(B)))return null}else l=Ln(B);if(p[String(B)]!==void 0)return M.error("Branch labels must be unique.");p[String(B)]=m.length}const O=o.parse(k,T,u);if(!O)return null;u=u||O.type,m.push(O)}const v=o.parse(e[1],1,Rt);if(!v)return null;const b=o.parse(e[e.length-1],e.length-1,u);return b?v.type.kind!=="value"&&o.concat(1).checkSubtype(l,v.type)?null:new Ml(l,u,v,p,m,b):null}evaluate(e){const o=this.input.evaluate(e);return(Ln(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),l=[],u={};for(const m of o){const v=u[this.cases[m]];v===void 0?(u[this.cases[m]]=l.length,l.push([this.cases[m],[m]])):l[v][1].push(m)}const p=m=>this.inputType.kind==="number"?Number(m):m;for(const[m,v]of l)e.push(v.length===1?p(v[0]):v.map(p)),e.push(this.outputs[m].serialize());return e.push(this.otherwise.serialize()),e}}class Pl{constructor(e,o,l){this.type=e,this.branches=o,this.otherwise=l}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return o.error("Expected an odd number of arguments.");let l;o.expectedType&&o.expectedType.kind!=="value"&&(l=o.expectedType);const u=[];for(let m=1;m<e.length-1;m+=2){const v=o.parse(e[m],m,Dt);if(!v)return null;const b=o.parse(e[m+1],m+1,l);if(!b)return null;u.push([v,b]),l=l||b.type}const p=o.parse(e[e.length-1],e.length-1,l);return p?new Pl(l,u,p):null}evaluate(e){for(const[o,l]of this.branches)if(o.evaluate(e))return l.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[o,l]of this.branches)e(o),e(l);e(this.otherwise)}outputDefined(){return this.branches.every(([e,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(o=>{e.push(o.serialize())}),e}}class zl{constructor(e,o,l,u){this.type=e,this.input=o,this.beginIndex=l,this.endIndex=u}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Rt),u=o.parse(e[2],2,Qe);if(!l||!u)return null;if(!nu(l.type,[Ur(Rt),Lt,Rt]))return o.error(`Expected first argument to be of type array or string, but found ${xn(l.type)} instead`);if(e.length===4){const p=o.parse(e[3],3,Qe);return p?new zl(l.type,l,u,p):null}return new zl(l.type,l,u)}evaluate(e){const o=this.input.evaluate(e),l=this.beginIndex.evaluate(e);if(!pi(o,["string","array"]))throw new Un(`Expected first argument to be of type array or string, but found ${xn(Ln(o))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return o.slice(l,u)}return o.slice(l)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function gu(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Ed(i,e,o,l){return l.compare(e,o)===0}function vs(i,e,o){const l=i!=="=="&&i!=="!=";return class Uw{constructor(p,m,v){this.type=Dt,this.lhs=p,this.rhs=m,this.collator=v,this.hasUntypedArgument=p.type.kind==="value"||m.type.kind==="value"}static parse(p,m){if(p.length!==3&&p.length!==4)return m.error("Expected two or three arguments.");const v=p[0];let b=m.parse(p[1],1,Rt);if(!b)return null;if(!gu(v,b.type))return m.concat(1).error(`"${v}" comparisons are not supported for type '${xn(b.type)}'.`);let T=m.parse(p[2],2,Rt);if(!T)return null;if(!gu(v,T.type))return m.concat(2).error(`"${v}" comparisons are not supported for type '${xn(T.type)}'.`);if(b.type.kind!==T.type.kind&&b.type.kind!=="value"&&T.type.kind!=="value")return m.error(`Cannot compare types '${xn(b.type)}' and '${xn(T.type)}'.`);l&&(b.type.kind==="value"&&T.type.kind!=="value"?b=new mi(T.type,[b]):b.type.kind!=="value"&&T.type.kind==="value"&&(T=new mi(b.type,[T])));let C=null;if(p.length===4){if(b.type.kind!=="string"&&T.type.kind!=="string"&&b.type.kind!=="value"&&T.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(C=m.parse(p[3],3,dl),!C)return null}return new Uw(b,T,C)}evaluate(p){const m=this.lhs.evaluate(p),v=this.rhs.evaluate(p);if(l&&this.hasUntypedArgument){const b=Ln(m),T=Ln(v);if(b.kind!==T.kind||b.kind!=="string"&&b.kind!=="number")throw new Un(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${b.kind}, ${T.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const b=Ln(m),T=Ln(v);if(b.kind!=="string"||T.kind!=="string")return e(p,m,v)}return this.collator?o(p,m,v,this.collator.evaluate(p)):e(p,m,v)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[i];return this.eachChild(m=>{p.push(m.serialize())}),p}}}const Td=vs("==",function(i,e,o){return e===o},Ed),Sd=vs("!=",function(i,e,o){return e!==o},function(i,e,o,l){return!Ed(0,e,o,l)}),Sm=vs("<",function(i,e,o){return e<o},function(i,e,o,l){return l.compare(e,o)<0}),Cm=vs(">",function(i,e,o){return e>o},function(i,e,o,l){return l.compare(e,o)>0}),km=vs("<=",function(i,e,o){return e<=o},function(i,e,o,l){return l.compare(e,o)<=0}),Im=vs(">=",function(i,e,o){return e>=o},function(i,e,o,l){return l.compare(e,o)>=0});class xs{constructor(e,o,l,u,p){this.type=Lt,this.number=e,this.locale=o,this.currency=l,this.minFractionDigits=u,this.maxFractionDigits=p}static parse(e,o){if(e.length!==3)return o.error("Expected two arguments.");const l=o.parse(e[1],1,Qe);if(!l)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return o.error("NumberFormat options argument must be an object.");let p=null;if(u.locale&&(p=o.parse(u.locale,1,Lt),!p))return null;let m=null;if(u.currency&&(m=o.parse(u.currency,1,Lt),!m))return null;let v=null;if(u["min-fraction-digits"]&&(v=o.parse(u["min-fraction-digits"],1,Qe),!v))return null;let b=null;return u["max-fraction-digits"]&&(b=o.parse(u["max-fraction-digits"],1,Qe),!b)?null:new xs(l,p,m,v,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Dl{constructor(e){this.type=Qe,this.input=e}static parse(e,o){if(e.length!==2)return o.error(`Expected 1 argument, but found ${e.length-1} instead.`);const l=o.parse(e[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${xn(l.type)} instead.`):new Dl(l):null}evaluate(e){const o=this.input.evaluate(e);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Un(`Expected value to be of type string or array, but found ${xn(Ln(o))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(o=>{e.push(o.serialize())}),e}}const jo={"==":Td,"!=":Sd,">":Cm,"<":Sm,">=":Im,"<=":km,array:mi,at:fu,boolean:mi,case:Pl,coalesce:Il,collator:_l,format:fa,image:gl,in:mu,"index-of":Al,interpolate:jr,"interpolate-hcl":jr,"interpolate-lab":jr,length:Dl,let:ba,literal:Uo,match:Ml,number:mi,"number-format":xs,object:mi,slice:zl,step:_a,string:mi,"to-boolean":so,"to-color":so,"to-number":so,"to-string":so,var:wl,within:lo};function Cd(i,[e,o,l,u]){e=e.evaluate(i),o=o.evaluate(i),l=l.evaluate(i);const p=u?u.evaluate(i):1,m=md(e,o,l,p);if(m)throw new Un(m);return new Ht(e/255*p,o/255*p,l/255*p,p)}function kd(i,e){return i in e}function _u(i,e){const o=e[i];return o===void 0?null:o}function co(i){return{type:i}}function yu(i){return{result:"success",value:i}}function Vo(i){return{result:"error",value:i}}function uo(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Id(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function vu(i){return!!i.expression&&i.expression.interpolated}function Kt(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Rl(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Am(i){return i}function Ad(i,e){const o=e.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",u=l||!(l||i.property!==void 0),p=i.type||(vu(e)?"exponential":"interval");if(o&&((i=Jt({},i)).stops&&(i.stops=i.stops.map(T=>[T[0],Ht.parse(T[1])])),i.default=Ht.parse(i.default?i.default:e.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!wd[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let m,v,b;if(p==="exponential")m=Pd;else if(p==="interval")m=Ll;else if(p==="categorical"){m=Md,v=Object.create(null);for(const T of i.stops)v[T[0]]=T[1];b=typeof i.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);m=Mm}if(l){const T={},C=[];for(let O=0;O<i.stops.length;O++){const B=i.stops[O],j=B[0].zoom;T[j]===void 0&&(T[j]={zoom:j,type:i.type,property:i.property,default:i.default,stops:[]},C.push(j)),T[j].stops.push([B[0].value,B[1]])}const k=[];for(const O of C)k.push([T[O].zoom,Ad(T[O],e)]);const M={name:"linear"};return{kind:"composite",interpolationType:M,interpolationFactor:jr.interpolationFactor.bind(void 0,M),zoomStops:k.map(O=>O[0]),evaluate:({zoom:O},B)=>Pd({stops:k,base:i.base},e,O).evaluate(O,B)}}if(u){const T=p==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:jr.interpolationFactor.bind(void 0,T),zoomStops:i.stops.map(C=>C[0]),evaluate:({zoom:C})=>m(i,e,C,v,b)}}return{kind:"source",evaluate(T,C){const k=C&&C.properties?C.properties[i.property]:void 0;return k===void 0?bs(i.default,e.default):m(i,e,k,v,b)}}}function bs(i,e,o){return i!==void 0?i:e!==void 0?e:o!==void 0?o:void 0}function Md(i,e,o,l,u){return bs(typeof o===u?l[o]:void 0,i.default,e.default)}function Ll(i,e,o){if(Kt(o)!=="number")return bs(i.default,e.default);const l=i.stops.length;if(l===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[l-1][0])return i.stops[l-1][1];const u=ga(i.stops.map(p=>p[0]),o);return i.stops[u][1]}function Pd(i,e,o){const l=i.base!==void 0?i.base:1;if(Kt(o)!=="number")return bs(i.default,e.default);const u=i.stops.length;if(u===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[u-1][0])return i.stops[u-1][1];const p=ga(i.stops.map(C=>C[0]),o),m=function(C,k,M,O){const B=O-M,j=C-M;return B===0?0:k===1?j/B:(Math.pow(k,j)-1)/(Math.pow(k,B)-1)}(o,l,i.stops[p][0],i.stops[p+1][0]),v=i.stops[p][1],b=i.stops[p+1][1];let T=ya[e.type]||Am;if(i.colorSpace&&i.colorSpace!=="rgb"){const C=wd[i.colorSpace];T=(k,M)=>C.reverse(C.interpolate(C.forward(k),C.forward(M),m))}return typeof v.evaluate=="function"?{evaluate(...C){const k=v.evaluate.apply(void 0,C),M=b.evaluate.apply(void 0,C);if(k!==void 0&&M!==void 0)return T(k,M,m)}}:T(v,b,m)}function Mm(i,e,o){return e.type==="color"?o=Ht.parse(o):e.type==="formatted"?o=fr.fromString(o.toString()):e.type==="resolvedImage"?o=ti.fromString(o.toString()):Kt(o)===e.type||e.type==="enum"&&e.values[o]||(o=void 0),bs(o,i.default,e.default)}mr.register(jo,{error:[{kind:"error"},[Lt],(i,[e])=>{throw new Un(e.evaluate(i))}],typeof:[Lt,[Rt],(i,[e])=>xn(Ln(e.evaluate(i)))],"to-rgba":[Ur(Qe,4),[Rn],(i,[e])=>e.evaluate(i).toArray()],rgb:[Rn,[Qe,Qe,Qe],Cd],rgba:[Rn,[Qe,Qe,Qe,Qe],Cd],has:{type:Dt,overloads:[[[Lt],(i,[e])=>kd(e.evaluate(i),i.properties())],[[Lt,Fo],(i,[e,o])=>kd(e.evaluate(i),o.evaluate(i))]]},get:{type:Rt,overloads:[[[Lt],(i,[e])=>_u(e.evaluate(i),i.properties())],[[Lt,Fo],(i,[e,o])=>_u(e.evaluate(i),o.evaluate(i))]]},"feature-state":[Rt,[Lt],(i,[e])=>_u(e.evaluate(i),i.featureState||{})],properties:[Fo,[],i=>i.properties()],"geometry-type":[Lt,[],i=>i.geometryType()],id:[Rt,[],i=>i.id()],zoom:[Qe,[],i=>i.globals.zoom],pitch:[Qe,[],i=>i.globals.pitch||0],"distance-from-center":[Qe,[],i=>i.distanceFromCenter()],"heatmap-density":[Qe,[],i=>i.globals.heatmapDensity||0],"line-progress":[Qe,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[Qe,[],i=>i.globals.skyRadialProgress||0],accumulated:[Rt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Qe,co(Qe),(i,e)=>{let o=0;for(const l of e)o+=l.evaluate(i);return o}],"*":[Qe,co(Qe),(i,e)=>{let o=1;for(const l of e)o*=l.evaluate(i);return o}],"-":{type:Qe,overloads:[[[Qe,Qe],(i,[e,o])=>e.evaluate(i)-o.evaluate(i)],[[Qe],(i,[e])=>-e.evaluate(i)]]},"/":[Qe,[Qe,Qe],(i,[e,o])=>e.evaluate(i)/o.evaluate(i)],"%":[Qe,[Qe,Qe],(i,[e,o])=>e.evaluate(i)%o.evaluate(i)],ln2:[Qe,[],()=>Math.LN2],pi:[Qe,[],()=>Math.PI],e:[Qe,[],()=>Math.E],"^":[Qe,[Qe,Qe],(i,[e,o])=>Math.pow(e.evaluate(i),o.evaluate(i))],sqrt:[Qe,[Qe],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[Qe,[Qe],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[Qe,[Qe],(i,[e])=>Math.log(e.evaluate(i))],log2:[Qe,[Qe],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[Qe,[Qe],(i,[e])=>Math.sin(e.evaluate(i))],cos:[Qe,[Qe],(i,[e])=>Math.cos(e.evaluate(i))],tan:[Qe,[Qe],(i,[e])=>Math.tan(e.evaluate(i))],asin:[Qe,[Qe],(i,[e])=>Math.asin(e.evaluate(i))],acos:[Qe,[Qe],(i,[e])=>Math.acos(e.evaluate(i))],atan:[Qe,[Qe],(i,[e])=>Math.atan(e.evaluate(i))],min:[Qe,co(Qe),(i,e)=>Math.min(...e.map(o=>o.evaluate(i)))],max:[Qe,co(Qe),(i,e)=>Math.max(...e.map(o=>o.evaluate(i)))],abs:[Qe,[Qe],(i,[e])=>Math.abs(e.evaluate(i))],round:[Qe,[Qe],(i,[e])=>{const o=e.evaluate(i);return o<0?-Math.round(-o):Math.round(o)}],floor:[Qe,[Qe],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[Qe,[Qe],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Dt,[Lt,Rt],(i,[e,o])=>i.properties()[e.value]===o.value],"filter-id-==":[Dt,[Rt],(i,[e])=>i.id()===e.value],"filter-type-==":[Dt,[Lt],(i,[e])=>i.geometryType()===e.value],"filter-<":[Dt,[Lt,Rt],(i,[e,o])=>{const l=i.properties()[e.value],u=o.value;return typeof l==typeof u&&l<u}],"filter-id-<":[Dt,[Rt],(i,[e])=>{const o=i.id(),l=e.value;return typeof o==typeof l&&o<l}],"filter->":[Dt,[Lt,Rt],(i,[e,o])=>{const l=i.properties()[e.value],u=o.value;return typeof l==typeof u&&l>u}],"filter-id->":[Dt,[Rt],(i,[e])=>{const o=i.id(),l=e.value;return typeof o==typeof l&&o>l}],"filter-<=":[Dt,[Lt,Rt],(i,[e,o])=>{const l=i.properties()[e.value],u=o.value;return typeof l==typeof u&&l<=u}],"filter-id-<=":[Dt,[Rt],(i,[e])=>{const o=i.id(),l=e.value;return typeof o==typeof l&&o<=l}],"filter->=":[Dt,[Lt,Rt],(i,[e,o])=>{const l=i.properties()[e.value],u=o.value;return typeof l==typeof u&&l>=u}],"filter-id->=":[Dt,[Rt],(i,[e])=>{const o=i.id(),l=e.value;return typeof o==typeof l&&o>=l}],"filter-has":[Dt,[Rt],(i,[e])=>e.value in i.properties()],"filter-has-id":[Dt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Dt,[Ur(Lt)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Dt,[Ur(Rt)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Dt,[Lt,Ur(Rt)],(i,[e,o])=>o.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Dt,[Lt,Ur(Rt)],(i,[e,o])=>function(l,u,p,m){for(;p<=m;){const v=p+m>>1;if(u[v]===l)return!0;u[v]>l?m=v-1:p=v+1}return!1}(i.properties()[e.value],o.value,0,o.value.length-1)],all:{type:Dt,overloads:[[[Dt,Dt],(i,[e,o])=>e.evaluate(i)&&o.evaluate(i)],[co(Dt),(i,e)=>{for(const o of e)if(!o.evaluate(i))return!1;return!0}]]},any:{type:Dt,overloads:[[[Dt,Dt],(i,[e,o])=>e.evaluate(i)||o.evaluate(i)],[co(Dt),(i,e)=>{for(const o of e)if(o.evaluate(i))return!0;return!1}]]},"!":[Dt,[Dt],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Dt,[Lt],(i,[e])=>{const o=i.globals&&i.globals.isSupportedScript;return!o||o(e.evaluate(i))}],upcase:[Lt,[Lt],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[Lt,[Lt],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[Lt,co(Rt),(i,e)=>e.map(o=>No(o.evaluate(i))).join("")],"resolved-locale":[Lt,[dl],(i,[e])=>e.evaluate(i).resolvedLocale()]});class xu{constructor(e,o){this.expression=e,this._warningHistory={},this._evaluator=new iu,this._defaultValue=o?function(l){return l.type==="color"&&Rl(l.default)?new Ht(0,0,0,0):l.type==="color"?Ht.parse(l.default)||null:l.default===void 0?null:l.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(e,o,l,u,p,m,v,b){return this._evaluator.globals=e,this._evaluator.feature=o,this._evaluator.featureState=l,this._evaluator.canonical=u,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=b||null,this.expression.evaluate(this._evaluator)}evaluate(e,o,l,u,p,m,v,b){this._evaluator.globals=e,this._evaluator.feature=o||null,this._evaluator.featureState=l||null,this._evaluator.canonical=u,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=b||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Un(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console!="undefined"&&console.warn(T.message)),this._defaultValue}}}function gi(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in jo}function ws(i,e){const o=new El(jo,[],e?function(u){const p={color:Rn,string:Lt,number:Qe,enum:Lt,boolean:Dt,formatted:fs,resolvedImage:ms};return u.type==="array"?Ur(p[u.value]||Rt,u.length):p[u.type]}(e):void 0),l=o.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?yu(new xu(l,e)):Vo(o.errors)}class ho{constructor(e,o){this.kind=e,this._styleExpression=o,this.isStateDependent=e!=="constant"&&!bl(o.expression)}evaluateWithoutErrorHandling(e,o,l,u,p,m){return this._styleExpression.evaluateWithoutErrorHandling(e,o,l,u,p,m)}evaluate(e,o,l,u,p,m){return this._styleExpression.evaluate(e,o,l,u,p,m)}}class Ol{constructor(e,o,l,u){this.kind=e,this.zoomStops=l,this._styleExpression=o,this.isStateDependent=e!=="camera"&&!bl(o.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,o,l,u,p,m){return this._styleExpression.evaluateWithoutErrorHandling(e,o,l,u,p,m)}evaluate(e,o,l,u,p,m){return this._styleExpression.evaluate(e,o,l,u,p,m)}interpolationFactor(e,o,l){return this.interpolationType?jr.interpolationFactor(this.interpolationType,e,o,l):0}}function zd(i,e){if((i=ws(i,e)).result==="error")return i;const o=i.value.expression,l=_s(o);if(!l&&!uo(e))return Vo([new Wt("","data expressions not supported")]);const u=Vt(o,["zoom","pitch","distance-from-center"]);if(!u&&!Id(e))return Vo([new Wt("","zoom expressions not supported")]);const p=po(o);return p||u?p instanceof Wt?Vo([p]):p instanceof jr&&!vu(e)?Vo([new Wt("",'"interpolate" expressions cannot be used with this property')]):yu(p?new Ol(l?"camera":"composite",i.value,p.labels,p instanceof jr?p.interpolation:void 0):new ho(l?"constant":"source",i.value)):Vo([new Wt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Es{constructor(e,o){this._parameters=e,this._specification=o,Jt(this,Ad(this._parameters,this._specification))}static deserialize(e){return new Es(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function po(i){let e=null;if(i instanceof ba)e=po(i.result);else if(i instanceof Il){for(const o of i.args)if(e=po(o),e)break}else(i instanceof _a||i instanceof jr)&&i.input instanceof mr&&i.input.name==="zoom"&&(e=i);return e instanceof Wt||i.eachChild(o=>{const l=po(o);l instanceof Wt?e=l:!e&&l?e=new Wt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&l&&e!==l&&(e=new Wt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function ri(i){const e=i.key,o=i.value,l=i.valueSpec||{},u=i.objectElementValidators||{},p=i.style,m=i.styleSpec;let v=[];const b=Kt(o);if(b!=="object")return[new Ae(e,o,`object expected, ${b} found`)];for(const T in o){const C=T.split(".")[0],k=l[C]||l["*"];let M;if(u[C])M=u[C];else if(l[C])M=gr;else if(u["*"])M=u["*"];else{if(!l["*"]){v.push(new Ae(e,o[T],`unknown property "${T}"`));continue}M=gr}v=v.concat(M({key:(e&&`${e}.`)+T,value:o[T],valueSpec:k,style:p,styleSpec:m,object:o,objectKey:T},o))}for(const T in l)u[T]||l[T].required&&l[T].default===void 0&&o[T]===void 0&&v.push(new Ae(e,o,`missing required property "${T}"`));return v}function Bl(i){const e=i.value,o=i.valueSpec,l=i.style,u=i.styleSpec,p=i.key,m=i.arrayElementValidator||gr;if(Kt(e)!=="array")return[new Ae(p,e,`array expected, ${Kt(e)} found`)];if(o.length&&e.length!==o.length)return[new Ae(p,e,`array length ${o.length} expected, length ${e.length} found`)];if(o["min-length"]&&e.length<o["min-length"])return[new Ae(p,e,`array length at least ${o["min-length"]} expected, length ${e.length} found`)];let v={type:o.value,values:o.values,minimum:o.minimum,maximum:o.maximum};u.$version<7&&(v.function=o.function),Kt(o.value)==="object"&&(v=o.value);let b=[];for(let T=0;T<e.length;T++)b=b.concat(m({array:e,arrayIndex:T,value:e[T],valueSpec:v,style:l,styleSpec:u,key:`${p}[${T}]`}));return b}function bu(i){const e=i.key,o=i.value,l=i.valueSpec;let u=Kt(o);if(u==="number"&&o!=o&&(u="NaN"),u!=="number")return[new Ae(e,o,`number expected, ${u} found`)];if("minimum"in l){let p=l.minimum;if(Kt(l.minimum)==="array"&&(p=l.minimum[i.arrayIndex]),o<p)return[new Ae(e,o,`${o} is less than the minimum value ${p}`)]}if("maximum"in l){let p=l.maximum;if(Kt(l.maximum)==="array"&&(p=l.maximum[i.arrayIndex]),o>p)return[new Ae(e,o,`${o} is greater than the maximum value ${p}`)]}return[]}function Fl(i){const e=i.valueSpec,o=St(i.value.type);let l,u,p,m={};const v=o!=="categorical"&&i.value.property===void 0,b=!v,T=Kt(i.value.stops)==="array"&&Kt(i.value.stops[0])==="array"&&Kt(i.value.stops[0][0])==="object",C=ri({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(O){if(o==="identity")return[new Ae(O.key,O.value,'identity function may not have a "stops" property')];let B=[];const j=O.value;return B=B.concat(Bl({key:O.key,value:j,valueSpec:O.valueSpec,style:O.style,styleSpec:O.styleSpec,arrayElementValidator:k})),Kt(j)==="array"&&j.length===0&&B.push(new Ae(O.key,j,"array must have at least one stop")),B},default:function(O){return gr({key:O.key,value:O.value,valueSpec:e,style:O.style,styleSpec:O.styleSpec})}}});return o==="identity"&&v&&C.push(new Ae(i.key,i.value,'missing required property "property"')),o==="identity"||i.value.stops||C.push(new Ae(i.key,i.value,'missing required property "stops"')),o==="exponential"&&i.valueSpec.expression&&!vu(i.valueSpec)&&C.push(new Ae(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(b&&!uo(i.valueSpec)?C.push(new Ae(i.key,i.value,"property functions not supported")):v&&!Id(i.valueSpec)&&C.push(new Ae(i.key,i.value,"zoom functions not supported"))),o!=="categorical"&&!T||i.value.property!==void 0||C.push(new Ae(i.key,i.value,'"property" property is required')),C;function k(O){let B=[];const j=O.value,J=O.key;if(Kt(j)!=="array")return[new Ae(J,j,`array expected, ${Kt(j)} found`)];if(j.length!==2)return[new Ae(J,j,`array length 2 expected, length ${j.length} found`)];if(T){if(Kt(j[0])!=="object")return[new Ae(J,j,`object expected, ${Kt(j[0])} found`)];if(j[0].zoom===void 0)return[new Ae(J,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new Ae(J,j,"object stop key must have value")];if(p&&p>St(j[0].zoom))return[new Ae(J,j[0].zoom,"stop zoom values must appear in ascending order")];St(j[0].zoom)!==p&&(p=St(j[0].zoom),u=void 0,m={}),B=B.concat(ri({key:`${J}[0]`,value:j[0],valueSpec:{zoom:{}},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{zoom:bu,value:M}}))}else B=B.concat(M({key:`${J}[0]`,value:j[0],valueSpec:{},style:O.style,styleSpec:O.styleSpec},j));return gi(jt(j[1]))?B.concat([new Ae(`${J}[1]`,j[1],"expressions are not allowed in function stops.")]):B.concat(gr({key:`${J}[1]`,value:j[1],valueSpec:e,style:O.style,styleSpec:O.styleSpec}))}function M(O,B){const j=Kt(O.value),J=St(O.value),oe=O.value!==null?O.value:B;if(l){if(j!==l)return[new Ae(O.key,oe,`${j} stop domain type must match previous stop domain type ${l}`)]}else l=j;if(j!=="number"&&j!=="string"&&j!=="boolean")return[new Ae(O.key,oe,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&o!=="categorical"){let ce=`number expected, ${j} found`;return uo(e)&&o===void 0&&(ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ae(O.key,oe,ce)]}return o!=="categorical"||j!=="number"||isFinite(J)&&Math.floor(J)===J?o!=="categorical"&&j==="number"&&u!==void 0&&J<u?[new Ae(O.key,oe,"stop domain values must appear in ascending order")]:(u=J,o==="categorical"&&J in m?[new Ae(O.key,oe,"stop domain values must be unique")]:(m[J]=!0,[])):[new Ae(O.key,oe,`integer expected, found ${J}`)]}}function fo(i){const e=(i.expressionContext==="property"?zd:ws)(jt(i.value),i.valueSpec);if(e.result==="error")return e.value.map(l=>new Ae(`${i.key}${l.key}`,i.value,l.message));const o=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!o.outputDefined())return[new Ae(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!bl(o))return[new Ae(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return wu(o,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Vt(o,["zoom","feature-state"]))return[new Ae(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!_s(o))return[new Ae(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function wu(i,e){const o=new Set(["zoom","feature-state","pitch","distance-from-center"]);for(const u of e.valueSpec.expression.parameters)o.delete(u);if(o.size===0)return[];const l=[];return i instanceof mr&&o.has(i.name)?[new Ae(e.key,e.value,`["${i.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(i.eachChild(u=>{l.push(...wu(u,e))}),l)}function Ts(i){const e=i.key,o=i.value,l=i.valueSpec,u=[];return Array.isArray(l.values)?l.values.indexOf(St(o))===-1&&u.push(new Ae(e,o,`expected one of [${l.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(l.values).indexOf(St(o))===-1&&u.push(new Ae(e,o,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(o)} found`)),u}function $l(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!$l(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function wa(i,e="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};$l(i)||(i=Nl(i));const o=i;let l=!0;try{l=function(T){if(!Zo(T))return T;let C=jt(T);return Go(C),C=Eu(C),C}(o)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(o,null,2)}
        `)}const u=_e[`filter_${e}`],p=ws(l,u);let m=null;if(p.result==="error")throw new Error(p.value.map(T=>`${T.key}: ${T.message}`).join(", "));m=(T,C,k)=>p.value.evaluate(T,C,{},k);let v=null,b=null;if(l!==o){const T=ws(o,u);if(T.result==="error")throw new Error(T.value.map(C=>`${C.key}: ${C.message}`).join(", "));v=(C,k,M,O,B)=>T.value.evaluate(C,k,{},M,void 0,void 0,O,B),b=!_s(T.value.expression)}return m=m,{filter:m,dynamicFilter:v||void 0,needGeometry:Su(l),needFeature:!!b}}function Eu(i){if(!Array.isArray(i))return i;const e=function(o){if(Dd.has(o[0])){for(let l=1;l<o.length;l++)if(Zo(o[l]))return!0}return o}(i);return e===!0?e:e.map(o=>Eu(o))}function Go(i){let e=!1;const o=[];if(i[0]==="case"){for(let l=1;l<i.length-1;l+=2)e=e||Zo(i[l]),o.push(i[l+1]);o.push(i[i.length-1])}else if(i[0]==="match"){e=e||Zo(i[1]);for(let l=2;l<i.length-1;l+=2)o.push(i[l+1]);o.push(i[i.length-1])}else if(i[0]==="step"){e=e||Zo(i[1]);for(let l=1;l<i.length-1;l+=2)o.push(i[l+1])}e&&(i.length=0,i.push("any",...o));for(let l=1;l<i.length;l++)Go(i[l])}function Zo(i){if(!Array.isArray(i))return!1;if((e=i[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let o=1;o<i.length;o++)if(Zo(i[o]))return!0;return!1}const Dd=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Tu(i,e){return i<e?-1:i>e?1:0}function Su(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(Su(i[e]))return!0;return!1}function Nl(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?Ss(i[1],i[2],"=="):e==="!="?Ul(Ss(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Ss(i[1],i[2],e):e==="any"?(o=i.slice(1),["any"].concat(o.map(Nl))):e==="all"?["all"].concat(i.slice(1).map(Nl)):e==="none"?["all"].concat(i.slice(1).map(Nl).map(Ul)):e==="in"?Rd(i[1],i.slice(2)):e==="!in"?Ul(Rd(i[1],i.slice(2))):e==="has"?Ld(i[1]):e==="!has"?Ul(Ld(i[1])):e!=="within"||i;var o}function Ss(i,e,o){switch(i){case"$type":return[`filter-type-${o}`,e];case"$id":return[`filter-id-${o}`,e];default:return[`filter-${o}`,i,e]}}function Rd(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(o=>typeof o!=typeof e[0])?["filter-in-large",i,["literal",e.sort(Tu)]]:["filter-in-small",i,["literal",e]]}}function Ld(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Ul(i){return["!",i]}function Cu(i){if($l(jt(i.value))){const e=jt(i.layerType);return fo(Jt({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${e||"fill"}`]}))}return Od(i)}function Od(i){const e=i.value,o=i.key;if(Kt(e)!=="array")return[new Ae(o,e,`array expected, ${Kt(e)} found`)];const l=i.styleSpec;let u,p=[];if(e.length<1)return[new Ae(o,e,"filter array must have at least 1 element")];switch(p=p.concat(Ts({key:`${o}[0]`,value:e[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),St(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&St(e[1])==="$type"&&p.push(new Ae(o,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&p.push(new Ae(o,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Kt(e[1]),u!=="string"&&p.push(new Ae(`${o}[1]`,e[1],`string expected, ${u} found`)));for(let m=2;m<e.length;m++)u=Kt(e[m]),St(e[1])==="$type"?p=p.concat(Ts({key:`${o}[${m}]`,value:e[m],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&p.push(new Ae(`${o}[${m}]`,e[m],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let m=1;m<e.length;m++)p=p.concat(Od({key:`${o}[${m}]`,value:e[m],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":u=Kt(e[1]),e.length!==2?p.push(new Ae(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&p.push(new Ae(`${o}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=Kt(e[1]),e.length!==2?p.push(new Ae(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="object"&&p.push(new Ae(`${o}[1]`,e[1],`object expected, ${u} found`))}return p}function Ea(i,e){const o=i.key,l=i.style,u=i.styleSpec,p=i.value,m=i.objectKey,v=u[`${e}_${i.layerType}`];if(!v)return[];const b=m.match(/^(.*)-transition$/);if(e==="paint"&&b&&v[b[1]]&&v[b[1]].transition)return gr({key:o,value:p,valueSpec:u.transition,style:l,styleSpec:u});const T=i.valueSpec||v[m];if(!T)return[new Ae(o,p,`unknown property "${m}"`)];let C;if(Kt(p)==="string"&&uo(T)&&!T.tokens&&(C=/^{([^}]+)}$/.exec(p)))return[new Ae(o,p,`"${m}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(C[1])} }\`.`)];const k=[];return i.layerType==="symbol"&&(m==="text-field"&&l&&!l.glyphs&&k.push(new Ae(o,p,'use of "text-field" requires a style "glyphs" property')),m==="text-font"&&Rl(jt(p))&&St(p.type)==="identity"&&k.push(new Ae(o,p,'"text-font" does not support identity functions'))),k.concat(gr({key:i.key,value:p,valueSpec:T,style:l,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:m}))}function Ta(i){return Ea(i,"paint")}function Pr(i){return Ea(i,"layout")}function Sa(i){let e=[];const o=i.value,l=i.key,u=i.style,p=i.styleSpec;o.type||o.ref||e.push(new Ae(l,o,'either "type" or "ref" is required'));let m=St(o.type);const v=St(o.ref);if(o.id){const b=St(o.id);for(let T=0;T<i.arrayIndex;T++){const C=u.layers[T];St(C.id)===b&&e.push(new Ae(l,o.id,`duplicate layer id "${o.id}", previously used at line ${C.id.__line__}`))}}if("ref"in o){let b;["type","source","source-layer","filter","layout"].forEach(T=>{T in o&&e.push(new Ae(l,o[T],`"${T}" is prohibited for ref layers`))}),u.layers.forEach(T=>{St(T.id)===v&&(b=T)}),b?b.ref?e.push(new Ae(l,o.ref,"ref cannot reference another ref layer")):m=St(b.type):e.push(new Ae(l,o.ref,`ref layer "${v}" not found`))}else if(m!=="background"&&m!=="sky")if(o.source){const b=u.sources&&u.sources[o.source],T=b&&St(b.type);b?T==="vector"&&m==="raster"?e.push(new Ae(l,o.source,`layer "${o.id}" requires a raster source`)):T==="raster"&&m!=="raster"?e.push(new Ae(l,o.source,`layer "${o.id}" requires a vector source`)):T!=="vector"||o["source-layer"]?T==="raster-dem"&&m!=="hillshade"?e.push(new Ae(l,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):m!=="line"||!o.paint||!o.paint["line-gradient"]||T==="geojson"&&b.lineMetrics||e.push(new Ae(l,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Ae(l,o,`layer "${o.id}" must specify a "source-layer"`)):e.push(new Ae(l,o.source,`source "${o.source}" not found`))}else e.push(new Ae(l,o,'missing required property "source"'));return e=e.concat(ri({key:l,value:o,valueSpec:p.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>gr({key:`${l}.type`,value:o.type,valueSpec:p.layer.type,style:i.style,styleSpec:i.styleSpec,object:o,objectKey:"type"}),filter:b=>Cu(Jt({layerType:m},b)),layout:b=>ri({layer:o,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":T=>Pr(Jt({layerType:m},T))}}),paint:b=>ri({layer:o,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":T=>Ta(Jt({layerType:m},T))}})}})),e}function Cs(i){const e=i.value,o=i.key,l=Kt(e);return l!=="string"?[new Ae(o,e,`string expected, ${l} found`)]:[]}const Bd={promoteId:function({key:i,value:e}){if(Kt(e)==="string")return Cs({key:i,value:e});{const o=[];for(const l in e)o.push(...Cs({key:`${i}.${l}`,value:e[l]}));return o}}};function Fd(i){const e=i.value,o=i.key,l=i.styleSpec,u=i.style;if(!e.type)return[new Ae(o,e,'"type" is required')];const p=St(e.type);let m;switch(p){case"vector":case"raster":case"raster-dem":return m=ri({key:o,value:e,valueSpec:l[`source_${p.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:Bd}),m;case"geojson":if(m=ri({key:o,value:e,valueSpec:l.source_geojson,style:u,styleSpec:l,objectElementValidators:Bd}),e.cluster)for(const v in e.clusterProperties){const[b,T]=e.clusterProperties[v],C=typeof b=="string"?[b,["accumulated"],["get",v]]:b;m.push(...fo({key:`${o}.${v}.map`,value:T,expressionContext:"cluster-map"})),m.push(...fo({key:`${o}.${v}.reduce`,value:C,expressionContext:"cluster-reduce"}))}return m;case"video":return ri({key:o,value:e,valueSpec:l.source_video,style:u,styleSpec:l});case"image":return ri({key:o,value:e,valueSpec:l.source_image,style:u,styleSpec:l});case"canvas":return[new Ae(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ts({key:`${o}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:u,styleSpec:l})}}function $d(i){const e=i.value,o=i.styleSpec,l=o.light,u=i.style;let p=[];const m=Kt(e);if(e===void 0)return p;if(m!=="object")return p=p.concat([new Ae("light",e,`object expected, ${m} found`)]),p;for(const v in e){const b=v.match(/^(.*)-transition$/);p=p.concat(b&&l[b[1]]&&l[b[1]].transition?gr({key:v,value:e[v],valueSpec:o.transition,style:u,styleSpec:o}):l[v]?gr({key:v,value:e[v],valueSpec:l[v],style:u,styleSpec:o}):[new Ae(v,e[v],`unknown property "${v}"`)])}return p}function jl(i){const e=i.value,o=i.key,l=i.style,u=i.styleSpec,p=u.terrain;let m=[];const v=Kt(e);if(e===void 0)return m;if(v!=="object")return m=m.concat([new Ae("terrain",e,`object expected, ${v} found`)]),m;for(const b in e){const T=b.match(/^(.*)-transition$/);m=m.concat(T&&p[T[1]]&&p[T[1]].transition?gr({key:b,value:e[b],valueSpec:u.transition,style:l,styleSpec:u}):p[b]?gr({key:b,value:e[b],valueSpec:p[b],style:l,styleSpec:u}):[new Ae(b,e[b],`unknown property "${b}"`)])}if(e.source){const b=l.sources&&l.sources[e.source],T=b&&St(b.type);b?T!=="raster-dem"&&m.push(new Ae(o,e.source,`terrain cannot be used with a source of type ${T}, it only be used with a "raster-dem" source type`)):m.push(new Ae(o,e.source,`source "${e.source}" not found`))}else m.push(new Ae(o,e,'terrain is missing required property "source"'));return m}function Nd(i){const e=i.value,o=i.style,l=i.styleSpec,u=l.fog;let p=[];const m=Kt(e);if(e===void 0)return p;if(m!=="object")return p=p.concat([new Ae("fog",e,`object expected, ${m} found`)]),p;for(const v in e){const b=v.match(/^(.*)-transition$/);p=p.concat(b&&u[b[1]]&&u[b[1]].transition?gr({key:v,value:e[v],valueSpec:l.transition,style:o,styleSpec:l}):u[v]?gr({key:v,value:e[v],valueSpec:u[v],style:o,styleSpec:l}):[new Ae(v,e[v],`unknown property "${v}"`)])}return p}const Vl={"*":()=>[],array:Bl,boolean:function(i){const e=i.value,o=i.key,l=Kt(e);return l!=="boolean"?[new Ae(o,e,`boolean expected, ${l} found`)]:[]},number:bu,color:function(i){const e=i.key,o=i.value,l=Kt(o);return l!=="string"?[new Ae(e,o,`color expected, ${l} found`)]:fi.parseCSSColor(o)===null?[new Ae(e,o,`color expected, "${o}" found`)]:[]},constants:Bt,enum:Ts,filter:Cu,function:Fl,layer:Sa,object:ri,source:Fd,light:$d,terrain:jl,fog:Nd,string:Cs,formatted:function(i){return Cs(i).length===0?[]:fo(i)},resolvedImage:function(i){return Cs(i).length===0?[]:fo(i)},projection:function(i){const e=i.value,o=i.styleSpec,l=o.projection,u=i.style;let p=[];const m=Kt(e);if(m==="object")for(const v in e)p=p.concat(gr({key:v,value:e[v],valueSpec:l[v],style:u,styleSpec:o}));else m!=="string"&&(p=p.concat([new Ae("projection",e,`object or string expected, ${m} found`)]));return p}};function gr(i){const e=i.value,o=i.valueSpec,l=i.styleSpec;return o.expression&&Rl(St(e))?Fl(i):o.expression&&gi(jt(e))?fo(i):o.type&&Vl[o.type]?Vl[o.type](i):ri(Jt({},i,{valueSpec:o.type?l[o.type]:o}))}function Pm(i){const e=i.value,o=i.key,l=Cs(i);return l.length||(e.indexOf("{fontstack}")===-1&&l.push(new Ae(o,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&l.push(new Ae(o,e,'"glyphs" url must include a "{range}" token'))),l}function _i(i,e=_e){let o=[];return o=o.concat(gr({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,objectElementValidators:{glyphs:Pm,"*":()=>[]}})),i.constants&&(o=o.concat(Bt({key:"constants",value:i.constants,style:i,styleSpec:e}))),Ud(o)}function Ud(i){return[].concat(i).sort((e,o)=>e.line-o.line)}function Gi(i){return function(...e){return Ud(i.apply(this,e))}}_i.source=Gi(Fd),_i.light=Gi($d),_i.terrain=Gi(jl),_i.fog=Gi(Nd),_i.layer=Gi(Sa),_i.filter=Gi(Cu),_i.paintProperty=Gi(Ta),_i.layoutProperty=Gi(Pr);const qo=_i,zm=qo.light,ku=qo.fog,Gl=qo.paintProperty,jd=qo.layoutProperty;function Vd(i,e){let o=!1;if(e&&e.length)for(const l of e)i.fire(new pt(new Error(l.message))),o=!0;return o}var ks=ki;function ki(i,e,o){var l=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var u=new Int32Array(this.arrayBuffer);i=u[0],this.d=(e=u[1])+2*(o=u[2]);for(var p=0;p<this.d*this.d;p++){var m=u[3+p],v=u[3+p+1];l.push(m===v?null:u.subarray(m,v))}var b=u[3+l.length+1];this.keys=u.subarray(u[3+l.length],b),this.bboxes=u.subarray(b),this.insert=this._insertReadonly}else{this.d=e+2*o;for(var T=0;T<this.d*this.d;T++)l.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=i,this.padding=o,this.scale=e/i,this.uid=0;var C=o/e*i;this.min=-C,this.max=i+C}ki.prototype.insert=function(i,e,o,l,u){this._forEachCell(e,o,l,u,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(e),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(u)},ki.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ki.prototype._insertCell=function(i,e,o,l,u,p){this.cells[u].push(p)},ki.prototype.query=function(i,e,o,l,u){var p=this.min,m=this.max;if(i<=p&&e<=p&&m<=o&&m<=l&&!u)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(i,e,o,l,this._queryCell,v,{},u),v},ki.prototype._queryCell=function(i,e,o,l,u,p,m,v){var b=this.cells[u];if(b!==null)for(var T=this.keys,C=this.bboxes,k=0;k<b.length;k++){var M=b[k];if(m[M]===void 0){var O=4*M;(v?v(C[O+0],C[O+1],C[O+2],C[O+3]):i<=C[O+2]&&e<=C[O+3]&&o>=C[O+0]&&l>=C[O+1])?(m[M]=!0,p.push(T[M])):m[M]=!1}}},ki.prototype._forEachCell=function(i,e,o,l,u,p,m,v){for(var b=this._convertToCellCoord(i),T=this._convertToCellCoord(e),C=this._convertToCellCoord(o),k=this._convertToCellCoord(l),M=b;M<=C;M++)for(var O=T;O<=k;O++){var B=this.d*O+M;if((!v||v(this._convertFromCellCoord(M),this._convertFromCellCoord(O),this._convertFromCellCoord(M+1),this._convertFromCellCoord(O+1)))&&u.call(this,i,e,o,l,B,p,m,v))return}},ki.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},ki.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},ki.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,e=3+this.cells.length+1+1,o=0,l=0;l<this.cells.length;l++)o+=this.cells[l].length;var u=new Int32Array(e+o+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var p=e,m=0;m<i.length;m++){var v=i[m];u[3+m]=p,u.set(v,p),p+=v.length}return u[3+i.length]=p,u.set(this.keys,p),u[3+i.length+1]=p+=this.keys.length,u.set(this.bboxes,p),p+=this.bboxes.length,u.buffer};const{ImageData:Zl,ImageBitmap:Gd}=ae,Ca={};function at(i,e,o={}){Object.defineProperty(e,"_classRegistryKey",{value:i,writeable:!1}),Ca[i]={klass:e,omit:o.omit||[],shallow:o.shallow||[]}}at("Object",Object),ks.serialize=function(i,e){const o=i.toArrayBuffer();return e&&e.push(o),{buffer:o}},ks.deserialize=function(i){return new ks(i.buffer)},at("Grid",ks),at("Color",Ht),at("Error",Error),at("ResolvedImage",ti),at("StylePropertyFunction",Es),at("StyleExpression",xu,{omit:["_evaluator"]}),at("ZoomDependentExpression",Ol),at("ZoomConstantExpression",ho),at("CompoundExpression",mr,{omit:["_evaluate"]});for(const i in jo)jo[i]._classRegistryKey||at(`Expression_${i}`,jo[i]);function Zd(i){return i&&typeof ArrayBuffer!="undefined"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Iu(i){return Gd&&i instanceof Gd}function ka(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(Zd(i)||Iu(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const o=i;return e&&e.push(o.buffer),o}if(i instanceof Zl)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const o=[];for(const l of i)o.push(ka(l,e));return o}if(typeof i=="object"){const o=i.constructor,l=o._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");const u=o.serialize?o.serialize(i,e):{};if(!o.serialize){for(const p in i){if(!i.hasOwnProperty(p)||Ca[l].omit.indexOf(p)>=0)continue;const m=i[p];u[p]=Ca[l].shallow.indexOf(p)>=0?m:ka(m,e)}i instanceof Error&&(u.message=i.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(u.$name=l),u}throw new Error("can't serialize object of type "+typeof i)}function Ia(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||Zd(i)||Iu(i)||ArrayBuffer.isView(i)||i instanceof Zl)return i;if(Array.isArray(i))return i.map(Ia);if(typeof i=="object"){const e=i.$name||"Object",{klass:o}=Ca[e];if(!o)throw new Error(`can't deserialize unregistered class ${e}`);if(o.deserialize)return o.deserialize(i);const l=Object.create(o.prototype);for(const u of Object.keys(i)){if(u==="$name")continue;const p=i[u];l[u]=Ca[e].shallow.indexOf(u)>=0?p:Ia(p)}return l}throw new Error("can't deserialize object of type "+typeof i)}class qd{constructor(){this.first=!0}update(e,o){const l=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=o),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=l,!0))}}const Wd=i=>i>=1536&&i<=1791,Hd=i=>i>=1872&&i<=1919,Xd=i=>i>=2208&&i<=2303,Kd=i=>i>=11904&&i<=12031,Aa=i=>i>=12032&&i<=12255,Yd=i=>i>=12272&&i<=12287,ql=i=>i>=12288&&i<=12351,Is=i=>i>=12352&&i<=12447,Wl=i=>i>=12448&&i<=12543,Au=i=>i>=12544&&i<=12591,Jd=i=>i>=12704&&i<=12735,Mu=i=>i>=12736&&i<=12783,Pu=i=>i>=12784&&i<=12799,zu=i=>i>=12800&&i<=13055,Du=i=>i>=13056&&i<=13311,Hl=i=>i>=13312&&i<=19903,Ma=i=>i>=19968&&i<=40959,Qd=i=>i>=40960&&i<=42127,ep=i=>i>=42128&&i<=42191,Pa=i=>i>=44032&&i<=55215,tp=i=>i>=63744&&i<=64255,mo=i=>i>=64336&&i<=65023,np=i=>i>=65040&&i<=65055,za=i=>i>=65072&&i<=65103,rp=i=>i>=65104&&i<=65135,Ru=i=>i>=65136&&i<=65279,Lu=i=>i>=65280&&i<=65519;function go(i){for(const e of i)if(Ou(e.charCodeAt(0)))return!0;return!1}function Xl(i){for(const e of i)if(!Da(e.charCodeAt(0)))return!1;return!0}function Da(i){return!(Wd(i)||Hd(i)||Xd(i)||mo(i)||Ru(i))}function Ou(i){return!(i!==746&&i!==747&&(i<4352||!(Jd(i)||Au(i)||za(i)&&!(i>=65097&&i<=65103)||tp(i)||Du(i)||Kd(i)||Mu(i)||!(!ql(i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Hl(i)||Ma(i)||zu(i)||(e=>e>=12592&&e<=12687)(i)||(e=>e>=43360&&e<=43391)(i)||(e=>e>=55216&&e<=55295)(i)||(e=>e>=4352&&e<=4607)(i)||Pa(i)||Is(i)||Yd(i)||(e=>e>=12688&&e<=12703)(i)||Aa(i)||Pu(i)||Wl(i)&&i!==12540||!(!Lu(i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!rp(i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||(e=>e>=5120&&e<=5759)(i)||(e=>e>=6320&&e<=6399)(i)||np(i)||(e=>e>=19904&&e<=19967)(i)||Qd(i)||ep(i))))}function Bu(i){return!(Ou(i)||function(e){return!!((o=>o>=128&&o<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(o=>o>=8192&&o<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(o=>o>=8448&&o<=8527)(e)||(o=>o>=8528&&o<=8591)(e)||(o=>o>=8960&&o<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(o=>o>=9216&&o<=9279)(e)&&e!==9251||(o=>o>=9280&&o<=9311)(e)||(o=>o>=9312&&o<=9471)(e)||(o=>o>=9632&&o<=9727)(e)||(o=>o>=9728&&o<=9983)(e)&&!(e>=9754&&e<=9759)||(o=>o>=11008&&o<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ql(e)||Wl(e)||(o=>o>=57344&&o<=63743)(e)||za(e)||rp(e)||Lu(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function As(i){return i>=1424&&i<=2303||mo(i)||Ru(i)}function Dm(i,e){return!(!e&&As(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||(o=>o>=6016&&o<=6143)(i))}function Rm(i){for(const e of i)if(As(e.charCodeAt(0)))return!0;return!1}const Ms="deferred",d="loading",r="loaded";let c=null,f="unavailable",_=null;const y=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(f="error"),c&&c(i)};function w(){S.fire(new Ne("pluginStateChange",{pluginStatus:f,pluginURL:_}))}const S=new Xe,I=function(){return f},P=function(){if(f!==Ms||!_)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");f=d,w(),_&&$({url:_},i=>{i?y(i):(f=r,w())})},z={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>f===r||z.applyArabicShaping!=null,isLoading:()=>f===d,setState(i){f=i.pluginStatus,_=i.pluginURL},isParsed:()=>z.applyArabicShaping!=null&&z.processBidirectionalText!=null&&z.processStyledBidirectionalText!=null,getPluginURL:()=>_};class R{constructor(e,o){this.zoom=e,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition,this.pitch=o.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new qd,this.transition={},this.pitch=0)}isSupportedScript(e){return function(o,l){for(const u of o)if(!Dm(u.charCodeAt(0),l))return!1;return!0}(e,z.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,o=e-Math.floor(e),l=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*o}}}class U{constructor(e,o){this.property=e,this.value=o,this.expression=function(l,u){if(Rl(l))return new Es(l,u);if(gi(l)){const p=zd(l,u);if(p.result==="error")throw new Error(p.value.map(m=>`${m.key}: ${m.message}`).join(", "));return p.value}{let p=l;return typeof l=="string"&&u.type==="color"&&(p=Ht.parse(l)),{kind:"constant",evaluate:()=>p}}}(o===void 0?e.specification.default:o,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,o,l){return this.property.possiblyEvaluate(this,e,o,l)}}class W{constructor(e){this.property=e,this.value=new U(e,void 0)}transitioned(e,o){return new Z(this.property,this.value,o,st({},e.transition,this.transition),e.now)}untransitioned(){return new Z(this.property,this.value,null,{},0)}}class K{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Ze(this._values[e].value.value)}setValue(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new W(this._values[e].property)),this._values[e].value=new U(this._values[e].property,o===null?void 0:Ze(o))}getTransition(e){return Ze(this._values[e].transition)}setTransition(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new W(this._values[e].property)),this._values[e].transition=Ze(o)||void 0}serialize(){const e={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(e[o]=l);const u=this.getTransition(o);u!==void 0&&(e[`${o}-transition`]=u)}return e}transitioned(e,o){const l=new ne(this._properties);for(const u of Object.keys(this._values))l._values[u]=this._values[u].transitioned(e,o._values[u]);return l}untransitioned(){const e=new ne(this._properties);for(const o of Object.keys(this._values))e._values[o]=this._values[o].untransitioned();return e}}class Z{constructor(e,o,l,u,p){const m=u.delay||0,v=u.duration||0;p=p||0,this.property=e,this.value=o,this.begin=p+m,this.end=this.begin+v,e.specification.transition&&(u.delay||u.duration)&&(this.prior=l)}possiblyEvaluate(e,o,l){const u=e.now||0,p=this.value.possiblyEvaluate(e,o,l),m=this.prior;if(m){if(u>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(u<this.begin)return m.possiblyEvaluate(e,o,l);{const v=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,o,l),p,Te(v))}}return p}}class ne{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,o,l){const u=new se(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(e,o,l);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class q{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Ze(this._values[e].value)}setValue(e,o){this._values[e]=new U(this._values[e].property,o===null?void 0:Ze(o))}serialize(){const e={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(e[o]=l)}return e}possiblyEvaluate(e,o,l){const u=new se(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(e,o,l);return u}}class re{constructor(e,o,l){this.property=e,this.value=o,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,o,l,u){return this.property.evaluate(this.value,this.parameters,e,o,l,u)}}class se{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class H{constructor(e){this.specification=e}possiblyEvaluate(e,o){return e.expression.evaluate(o)}interpolate(e,o,l){const u=ya[this.specification.type];return u?u(e,o,l):e}}class le{constructor(e,o){this.specification=e,this.overrides=o}possiblyEvaluate(e,o,l,u){return new re(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(o,null,{},l,u)}:e.expression,o)}interpolate(e,o,l){if(e.value.kind!=="constant"||o.value.kind!=="constant")return e;if(e.value.value===void 0||o.value.value===void 0)return new re(this,{kind:"constant",value:void 0},e.parameters);const u=ya[this.specification.type];return u?new re(this,{kind:"constant",value:u(e.value.value,o.value.value,l)},e.parameters):e}evaluate(e,o,l,u,p,m){return e.kind==="constant"?e.value:e.evaluate(o,l,u,p,m)}}class he extends le{possiblyEvaluate(e,o,l,u){if(e.value===void 0)return new re(this,{kind:"constant",value:void 0},o);if(e.expression.kind==="constant"){const p=e.expression.evaluate(o,null,{},l,u),m=e.property.specification.type==="resolvedImage"&&typeof p!="string"?p.name:p,v=this._calculate(m,m,m,o);return new re(this,{kind:"constant",value:v},o)}if(e.expression.kind==="camera"){const p=this._calculate(e.expression.evaluate({zoom:o.zoom-1}),e.expression.evaluate({zoom:o.zoom}),e.expression.evaluate({zoom:o.zoom+1}),o);return new re(this,{kind:"constant",value:p},o)}return new re(this,e.expression,o)}evaluate(e,o,l,u,p,m){if(e.kind==="source"){const v=e.evaluate(o,l,u,p,m);return this._calculate(v,v,v,o)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(o.zoom)-1},l,u),e.evaluate({zoom:Math.floor(o.zoom)},l,u),e.evaluate({zoom:Math.floor(o.zoom)+1},l,u),o):e.value}_calculate(e,o,l,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:o,other:l}:{from:l,to:o,other:e}}interpolate(e){return e}}class ke{constructor(e){this.specification=e}possiblyEvaluate(e,o,l,u){if(e.value!==void 0){if(e.expression.kind==="constant"){const p=e.expression.evaluate(o,null,{},l,u);return this._calculate(p,p,p,o)}return this._calculate(e.expression.evaluate(new R(Math.floor(o.zoom-1),o)),e.expression.evaluate(new R(Math.floor(o.zoom),o)),e.expression.evaluate(new R(Math.floor(o.zoom+1),o)),o)}}_calculate(e,o,l,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:o}:{from:l,to:o}}interpolate(e){return e}}class Ce{constructor(e){this.specification=e}possiblyEvaluate(e,o,l,u){return!!e.expression.evaluate(o,null,{},l,u)}interpolate(){return!1}}class ze{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in e){const l=e[o];l.specification.overridable&&this.overridableProperties.push(o);const u=this.defaultPropertyValues[o]=new U(l,void 0),p=this.defaultTransitionablePropertyValues[o]=new W(l);this.defaultTransitioningPropertyValues[o]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=u.possiblyEvaluate({})}}}function De(i,e){return 256*(i=Le(Math.floor(i),0,255))+Le(Math.floor(e),0,255)}at("DataDrivenProperty",le),at("DataConstantProperty",H),at("CrossFadedDataDrivenProperty",he),at("CrossFadedProperty",ke),at("ColorRampProperty",Ce);const Ge={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Me{constructor(e,o){this._structArray=e,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class qe{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,o){return e._trim(),o&&(e.isTransferred=!0,o.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const o=Object.create(this.prototype);return o.arrayBuffer=e.arrayBuffer,o.length=e.length,o.capacity=e.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Se(i,e=1){let o=0,l=0;return{members:i.map(u=>{const p=Ge[u.type].BYTES_PER_ELEMENT,m=o=He(o,Math.max(e,p)),v=u.components||1;return l=Math.max(l,p),o+=p*v,{name:u.name,type:u.type,components:v,offset:m}}),size:He(o,Math.max(l,e)),alignment:e}}function He(i,e){return Math.ceil(i/e)*e}class lt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const u=2*e;return this.int16[u+0]=o,this.int16[u+1]=l,e}}lt.prototype.bytesPerElement=4,at("StructArrayLayout2i4",lt);class yt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,o,l,u)}emplace(e,o,l,u,p){const m=4*e;return this.int16[m+0]=o,this.int16[m+1]=l,this.int16[m+2]=u,this.int16[m+3]=p,e}}yt.prototype.bytesPerElement=8,at("StructArrayLayout4i8",yt);class vt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,u,p,m,v){const b=this.length;return this.resize(b+1),this.emplace(b,e,o,l,u,p,m,v)}emplace(e,o,l,u,p,m,v,b){const T=6*e,C=12*e,k=3*e;return this.int16[T+0]=o,this.int16[T+1]=l,this.uint8[C+4]=u,this.uint8[C+5]=p,this.uint8[C+6]=m,this.uint8[C+7]=v,this.float32[k+2]=b,e}}vt.prototype.bytesPerElement=12,at("StructArrayLayout2i4ub1f12",vt);class wt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,o,l)}emplace(e,o,l,u){const p=3*e;return this.float32[p+0]=o,this.float32[p+1]=l,this.float32[p+2]=u,e}}wt.prototype.bytesPerElement=12,at("StructArrayLayout3f12",wt);class Et extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,p,m,v,b,T,C){const k=this.length;return this.resize(k+1),this.emplace(k,e,o,l,u,p,m,v,b,T,C)}emplace(e,o,l,u,p,m,v,b,T,C,k){const M=10*e;return this.uint16[M+0]=o,this.uint16[M+1]=l,this.uint16[M+2]=u,this.uint16[M+3]=p,this.uint16[M+4]=m,this.uint16[M+5]=v,this.uint16[M+6]=b,this.uint16[M+7]=T,this.uint16[M+8]=C,this.uint16[M+9]=k,e}}Et.prototype.bytesPerElement=20,at("StructArrayLayout10ui20",Et);class gt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,p,m,v,b){const T=this.length;return this.resize(T+1),this.emplace(T,e,o,l,u,p,m,v,b)}emplace(e,o,l,u,p,m,v,b,T){const C=8*e;return this.uint16[C+0]=o,this.uint16[C+1]=l,this.uint16[C+2]=u,this.uint16[C+3]=p,this.uint16[C+4]=m,this.uint16[C+5]=v,this.uint16[C+6]=b,this.uint16[C+7]=T,e}}gt.prototype.bytesPerElement=16,at("StructArrayLayout8ui16",gt);class At extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,p,m,v,b,T,C,k,M,O,B,j,J){const oe=this.length;return this.resize(oe+1),this.emplace(oe,e,o,l,u,p,m,v,b,T,C,k,M,O,B,j,J)}emplace(e,o,l,u,p,m,v,b,T,C,k,M,O,B,j,J,oe){const ce=16*e;return this.int16[ce+0]=o,this.int16[ce+1]=l,this.int16[ce+2]=u,this.int16[ce+3]=p,this.uint16[ce+4]=m,this.uint16[ce+5]=v,this.uint16[ce+6]=b,this.uint16[ce+7]=T,this.int16[ce+8]=C,this.int16[ce+9]=k,this.int16[ce+10]=M,this.int16[ce+11]=O,this.int16[ce+12]=B,this.int16[ce+13]=j,this.int16[ce+14]=J,this.int16[ce+15]=oe,e}}At.prototype.bytesPerElement=32,at("StructArrayLayout4i4ui4i4i32",At);class Qt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint32[1*e+0]=o,e}}Qt.prototype.bytesPerElement=4,at("StructArrayLayout1ul4",Qt);class jn extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,p,m,v,b,T,C,k,M,O){const B=this.length;return this.resize(B+1),this.emplace(B,e,o,l,u,p,m,v,b,T,C,k,M,O)}emplace(e,o,l,u,p,m,v,b,T,C,k,M,O,B){const j=20*e,J=10*e;return this.int16[j+0]=o,this.int16[j+1]=l,this.int16[j+2]=u,this.int16[j+3]=p,this.int16[j+4]=m,this.float32[J+3]=v,this.float32[J+4]=b,this.float32[J+5]=T,this.float32[J+6]=C,this.int16[j+14]=k,this.uint32[J+8]=M,this.uint16[j+18]=O,this.uint16[j+19]=B,e}}jn.prototype.bytesPerElement=40,at("StructArrayLayout5i4f1i1ul2ui40",jn);class ir extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,p,m,v){const b=this.length;return this.resize(b+1),this.emplace(b,e,o,l,u,p,m,v)}emplace(e,o,l,u,p,m,v,b){const T=8*e;return this.int16[T+0]=o,this.int16[T+1]=l,this.int16[T+2]=u,this.int16[T+4]=p,this.int16[T+5]=m,this.int16[T+6]=v,this.int16[T+7]=b,e}}ir.prototype.bytesPerElement=16,at("StructArrayLayout3i2i2i16",ir);class _r extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,p){const m=this.length;return this.resize(m+1),this.emplace(m,e,o,l,u,p)}emplace(e,o,l,u,p,m){const v=4*e,b=8*e;return this.float32[v+0]=o,this.float32[v+1]=l,this.float32[v+2]=u,this.int16[b+6]=p,this.int16[b+7]=m,e}}_r.prototype.bytesPerElement=16,at("StructArrayLayout2f1f2i16",_r);class Tr extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,o,l,u)}emplace(e,o,l,u,p){const m=12*e,v=3*e;return this.uint8[m+0]=o,this.uint8[m+1]=l,this.float32[v+1]=u,this.float32[v+2]=p,e}}Tr.prototype.bytesPerElement=12,at("StructArrayLayout2ub2f12",Tr);class Vn extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,o,l)}emplace(e,o,l,u){const p=3*e;return this.uint16[p+0]=o,this.uint16[p+1]=l,this.uint16[p+2]=u,e}}Vn.prototype.bytesPerElement=6,at("StructArrayLayout3ui6",Vn);class Zi extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,l,u,p,m,v,b,T,C,k,M,O,B,j,J,oe,ce,pe,ye,ge){const ve=this.length;return this.resize(ve+1),this.emplace(ve,e,o,l,u,p,m,v,b,T,C,k,M,O,B,j,J,oe,ce,pe,ye,ge)}emplace(e,o,l,u,p,m,v,b,T,C,k,M,O,B,j,J,oe,ce,pe,ye,ge,ve){const Re=30*e,Ie=15*e,et=60*e;return this.int16[Re+0]=o,this.int16[Re+1]=l,this.int16[Re+2]=u,this.float32[Ie+2]=p,this.float32[Ie+3]=m,this.uint16[Re+8]=v,this.uint16[Re+9]=b,this.uint32[Ie+5]=T,this.uint32[Ie+6]=C,this.uint32[Ie+7]=k,this.uint16[Re+16]=M,this.uint16[Re+17]=O,this.uint16[Re+18]=B,this.float32[Ie+10]=j,this.float32[Ie+11]=J,this.uint8[et+48]=oe,this.uint8[et+49]=ce,this.uint8[et+50]=pe,this.uint32[Ie+13]=ye,this.int16[Re+28]=ge,this.uint8[et+58]=ve,e}}Zi.prototype.bytesPerElement=60,at("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",Zi);class Ii extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,l,u,p,m,v,b,T,C,k,M,O,B,j,J,oe,ce,pe,ye,ge,ve,Re,Ie,et,Ue,Oe,je,Ve,$e){const tt=this.length;return this.resize(tt+1),this.emplace(tt,e,o,l,u,p,m,v,b,T,C,k,M,O,B,j,J,oe,ce,pe,ye,ge,ve,Re,Ie,et,Ue,Oe,je,Ve,$e)}emplace(e,o,l,u,p,m,v,b,T,C,k,M,O,B,j,J,oe,ce,pe,ye,ge,ve,Re,Ie,et,Ue,Oe,je,Ve,$e,tt){const ot=38*e,Mt=19*e;return this.int16[ot+0]=o,this.int16[ot+1]=l,this.int16[ot+2]=u,this.float32[Mt+2]=p,this.float32[Mt+3]=m,this.int16[ot+8]=v,this.int16[ot+9]=b,this.int16[ot+10]=T,this.int16[ot+11]=C,this.int16[ot+12]=k,this.int16[ot+13]=M,this.uint16[ot+14]=O,this.uint16[ot+15]=B,this.uint16[ot+16]=j,this.uint16[ot+17]=J,this.uint16[ot+18]=oe,this.uint16[ot+19]=ce,this.uint16[ot+20]=pe,this.uint16[ot+21]=ye,this.uint16[ot+22]=ge,this.uint16[ot+23]=ve,this.uint16[ot+24]=Re,this.uint16[ot+25]=Ie,this.uint16[ot+26]=et,this.uint16[ot+27]=Ue,this.uint16[ot+28]=Oe,this.uint32[Mt+15]=je,this.float32[Mt+16]=Ve,this.float32[Mt+17]=$e,this.float32[Mt+18]=tt,e}}Ii.prototype.bytesPerElement=76,at("StructArrayLayout3i2f6i15ui1ul3f76",Ii);class fn extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.float32[1*e+0]=o,e}}fn.prototype.bytesPerElement=4,at("StructArrayLayout1f4",fn);class Mn extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,o,l)}emplace(e,o,l,u){const p=3*e;return this.int16[p+0]=o,this.int16[p+1]=l,this.int16[p+2]=u,e}}Mn.prototype.bytesPerElement=6,at("StructArrayLayout3i6",Mn);class Zt extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,o,l,u)}emplace(e,o,l,u,p){const m=6*e;return this.uint32[3*e+0]=o,this.uint16[m+2]=l,this.uint16[m+3]=u,this.uint16[m+4]=p,e}}Zt.prototype.bytesPerElement=12,at("StructArrayLayout1ul3ui12",Zt);class gn extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const u=2*e;return this.uint16[u+0]=o,this.uint16[u+1]=l,e}}gn.prototype.bytesPerElement=4,at("StructArrayLayout2ui4",gn);class or extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint16[1*e+0]=o,e}}or.prototype.bytesPerElement=2,at("StructArrayLayout1ui2",or);class mn extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const u=2*e;return this.float32[u+0]=o,this.float32[u+1]=l,e}}mn.prototype.bytesPerElement=8,at("StructArrayLayout2f8",mn);class Vr extends qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,o,l,u)}emplace(e,o,l,u,p){const m=4*e;return this.float32[m+0]=o,this.float32[m+1]=l,this.float32[m+2]=u,this.float32[m+3]=p,e}}Vr.prototype.bytesPerElement=16,at("StructArrayLayout4f16",Vr);class Ra extends Me{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ra.prototype.size=40;class zr extends jn{get(e){return new Ra(this,e)}}at("CollisionBoxArray",zr);class _o extends Me{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}_o.prototype.size=60;class ip extends Zi{get(e){return new _o(this,e)}}at("PlacedSymbolArray",ip);class Kl extends Me{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Kl.prototype.size=76;class Ps extends Ii{get(e){return new Kl(this,e)}}at("SymbolInstanceArray",Ps);class op extends fn{getoffsetX(e){return this.float32[1*e+0]}}at("GlyphOffsetArray",op);class La extends Mn{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}at("SymbolLineVertexArray",La);class Yl extends Me{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Yl.prototype.size=12;class I0 extends Zt{get(e){return new Yl(this,e)}}at("FeatureIndexArray",I0);class A0 extends Me{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}A0.prototype.size=4;class M0 extends gn{get(e){return new A0(this,e)}}at("FillExtrusionCentroidArray",M0);const GT=Se([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),ZT=Se([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var P0=pl(function(i){i.exports=function(e,o){var l,u,p,m,v,b,T,C;for(u=e.length-(l=3&e.length),p=o,v=3432918353,b=461845907,C=0;C<u;)T=255&e.charCodeAt(C)|(255&e.charCodeAt(++C))<<8|(255&e.charCodeAt(++C))<<16|(255&e.charCodeAt(++C))<<24,++C,p=27492+(65535&(m=5*(65535&(p=(p^=T=(65535&(T=(T=(65535&T)*v+(((T>>>16)*v&65535)<<16)&4294967295)<<15|T>>>17))*b+(((T>>>16)*b&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(T=0,l){case 3:T^=(255&e.charCodeAt(C+2))<<16;case 2:T^=(255&e.charCodeAt(C+1))<<8;case 1:p^=T=(65535&(T=(T=(65535&(T^=255&e.charCodeAt(C)))*v+(((T>>>16)*v&65535)<<16)&4294967295)<<15|T>>>17))*b+(((T>>>16)*b&65535)<<16)&4294967295}return p^=e.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}),qT=pl(function(i){i.exports=function(e,o){for(var l,u=e.length,p=o^u,m=0;u>=4;)l=1540483477*(65535&(l=255&e.charCodeAt(m)|(255&e.charCodeAt(++m))<<8|(255&e.charCodeAt(++m))<<16|(255&e.charCodeAt(++m))<<24))+((1540483477*(l>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),u-=4,++m;switch(u){case 3:p^=(255&e.charCodeAt(m+2))<<16;case 2:p^=(255&e.charCodeAt(m+1))<<8;case 1:p=1540483477*(65535&(p^=255&e.charCodeAt(m)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}}),Fu=P0,WT=qT;Fu.murmur3=P0,Fu.murmur2=WT;class sp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,o,l,u){this.ids.push(z0(e)),this.positions.push(o,l,u)}getPositions(e){const o=z0(e);let l=0,u=this.ids.length-1;for(;l<u;){const m=l+u>>1;this.ids[m]>=o?u=m:l=m+1}const p=[];for(;this.ids[l]===o;)p.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return p}static serialize(e,o){const l=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Lm(l,u,0,l.length-1),o&&o.push(l.buffer,u.buffer),{ids:l,positions:u}}static deserialize(e){const o=new sp;return o.ids=e.ids,o.positions=e.positions,o.indexed=!0,o}}function z0(i){const e=+i;return!isNaN(e)&&e<=be?e:Fu(String(i))}function Lm(i,e,o,l){for(;o<l;){const u=i[o+l>>1];let p=o-1,m=l+1;for(;;){do p++;while(i[p]<u);do m--;while(i[m]>u);if(p>=m)break;ap(i,p,m),ap(e,3*p,3*m),ap(e,3*p+1,3*m+1),ap(e,3*p+2,3*m+2)}m-o<l-m?(Lm(i,e,o,m),o=m+1):(Lm(i,e,m+1,l),l=m)}}function ap(i,e,o){const l=i[e];i[e]=i[o],i[o]=l}at("FeaturePositionMap",sp);class Wo{constructor(e,o){this.gl=e.gl,this.location=o}}class lp extends Wo{constructor(e,o){super(e,o),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class D0 extends Wo{constructor(e,o){super(e,o),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class R0 extends Wo{constructor(e,o){super(e,o),this.current=Ht.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const HT=new Float32Array(16),XT=new Float32Array(9),KT=new Float32Array(4);function Om(i){return[De(255*i.r,255*i.g),De(255*i.b,255*i.a)]}class $u{constructor(e,o,l){this.value=e,this.uniformNames=o.map(u=>`u_${u}`),this.type=l}setUniform(e,o,l){e.set(l.constantOr(this.value))}getBinding(e,o,l){return this.type==="color"?new R0(e,o):new lp(e,o)}}class Jl{constructor(e,o){this.uniformNames=o.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=o.tl.concat(o.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,o,l,u){const p=u==="u_pattern_to"||u==="u_dash_to"?this.patternTo:u==="u_pattern_from"||u==="u_dash_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;p&&e.set(p)}getBinding(e,o,l){return l==="u_pattern_from"||l==="u_pattern_to"||l==="u_dash_from"||l==="u_dash_to"?new D0(e,o):new lp(e,o)}}class Ho{constructor(e,o,l,u){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=o.map(p=>({name:`a_${p}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,o,l,u,p,m){const v=this.paintVertexArray.length,b=this.expression.evaluate(new R(0),o,{},p,u,m);this.paintVertexArray.resize(e),this._setPaintValue(v,e,b)}updatePaintArray(e,o,l,u,p){const m=this.expression.evaluate({zoom:0},l,u,void 0,p);this._setPaintValue(e,o,m)}_setPaintValue(e,o,l){if(this.type==="color"){const u=Om(l);for(let p=e;p<o;p++)this.paintVertexArray.emplace(p,u[0],u[1])}else{for(let u=e;u<o;u++)this.paintVertexArray.emplace(u,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qi{constructor(e,o,l,u,p,m){this.expression=e,this.uniformNames=o.map(v=>`u_${v}_t`),this.type=l,this.useIntegerZoom=u,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=o.map(v=>({name:`a_${v}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(e,o,l,u,p,m){const v=this.expression.evaluate(new R(this.zoom),o,{},p,u,m),b=this.expression.evaluate(new R(this.zoom+1),o,{},p,u,m),T=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(T,e,v,b)}updatePaintArray(e,o,l,u,p){const m=this.expression.evaluate({zoom:this.zoom},l,u,void 0,p),v=this.expression.evaluate({zoom:this.zoom+1},l,u,void 0,p);this._setPaintValue(e,o,m,v)}_setPaintValue(e,o,l,u){if(this.type==="color"){const p=Om(l),m=Om(u);for(let v=e;v<o;v++)this.paintVertexArray.emplace(v,p[0],p[1],m[0],m[1])}else{for(let p=e;p<o;p++)this.paintVertexArray.emplace(p,l,u);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,o){const l=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,u=Le(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);e.set(u)}getBinding(e,o,l){return new lp(e,o)}}class zs{constructor(e,o,l,u,p,m,v){this.expression=e,this.type=l,this.useIntegerZoom=u,this.zoom=p,this.layerId=v,this.paintVertexAttributes=(l==="array"?ZT:GT).members;for(let b=0;b<o.length;++b);this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,o,l){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,o.patterns&&o.patterns[this.layerId],l)}updatePaintArray(e,o,l,u,p,m){this._setPaintValues(e,o,l.patterns&&l.patterns[this.layerId],m)}_setPaintValues(e,o,l,u){if(!u||!l)return;const{min:p,mid:m,max:v}=l,b=u[p],T=u[m],C=u[v];if(b&&T&&C)for(let k=e;k<o;k++)this._setPaintValue(this.zoomInPaintVertexArray,k,T,b),this._setPaintValue(this.zoomOutPaintVertexArray,k,T,C)}_setPaintValue(e,o,l,u){e.emplace(o,l.tl[0],l.tl[1],l.br[0],l.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],l.pixelRatio,u.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Xo{constructor(e,o,l=()=>!0){this.binders={},this._buffers=[];const u=[];for(const p in e.paint._values){if(!l(p))continue;const m=e.paint.get(p);if(!(m instanceof re&&uo(m.property.specification)))continue;const v=JT(p,e.type),b=m.value,T=m.property.specification.type,C=m.property.useIntegerZoom,k=m.property.specification["property-type"],M=k==="cross-faded"||k==="cross-faded-data-driven",O=String(p)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(b.kind!=="constant"||O)if(b.kind==="source"||O||M){const B=L0(p,T,"source");this.binders[p]=M?new zs(b,v,T,C,o,B,e.id):new Ho(b,v,T,B),u.push(`/a_${p}`)}else{const B=L0(p,T,"composite");this.binders[p]=new qi(b,v,T,C,o,B),u.push(`/z_${p}`)}else this.binders[p]=M?new Jl(b.value,v):new $u(b.value,v,T),u.push(`/u_${p}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const o=this.binders[e];return o instanceof Ho||o instanceof qi?o.maxValue:0}populatePaintArrays(e,o,l,u,p,m){for(const v in this.binders){const b=this.binders[v];(b instanceof Ho||b instanceof qi||b instanceof zs)&&b.populatePaintArray(e,o,l,u,p,m)}}setConstantPatternPositions(e,o){for(const l in this.binders){const u=this.binders[l];u instanceof Jl&&u.setConstantPatternPositions(e,o)}}updatePaintArrays(e,o,l,u,p,m){let v=!1;for(const b in e){const T=o.getPositions(b);for(const C of T){const k=l.feature(C.index);for(const M in this.binders){const O=this.binders[M];if((O instanceof Ho||O instanceof qi||O instanceof zs)&&O.expression.isStateDependent===!0){const B=u.paint.get(M);O.expression=B.value,O.updatePaintArray(C.start,C.end,k,e[b],p,m),v=!0}}}}return v}defines(){const e=[];for(const o in this.binders){const l=this.binders[o];(l instanceof $u||l instanceof Jl)&&e.push(...l.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof Ho||l instanceof qi||l instanceof zs)for(let u=0;u<l.paintVertexAttributes.length;u++)e.push(l.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof $u||l instanceof Jl||l instanceof qi)for(const u of l.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,o){const l=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof $u||p instanceof Jl||p instanceof qi){for(const m of p.uniformNames)if(o[m]){const v=p.getBinding(e,o[m],m);l.push({name:m,property:u,binding:v})}}}return l}setUniforms(e,o,l,u){for(const{name:p,property:m,binding:v}of o)this.binders[m].setUniform(v,u,l.get(m),p)}updatePaintBuffers(e){this._buffers=[];for(const o in this.binders){const l=this.binders[o];if(e&&l instanceof zs){const u=e.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(l instanceof Ho||l instanceof qi)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(e){for(const o in this.binders){const l=this.binders[o];(l instanceof Ho||l instanceof qi||l instanceof zs)&&l.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const o=this.binders[e];(o instanceof Ho||o instanceof qi||o instanceof zs)&&o.destroy()}}}class Oa{constructor(e,o,l=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new Xo(u,o,l);this.needsUpload=!1,this._featureMap=new sp,this._bufferOffset=0}populatePaintArrays(e,o,l,u,p,m,v){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(e,o,u,p,m,v);o.id!==void 0&&this._featureMap.add(o.id,l,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,o,l,u,p){for(const m of l)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,o,m,u,p)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const YT={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function JT(i,e){return YT[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}const QT={"line-pattern":{source:Et,composite:Et},"fill-pattern":{source:Et,composite:Et},"fill-extrusion-pattern":{source:Et,composite:Et},"line-dasharray":{source:gt,composite:gt}},eS={color:{source:mn,composite:Vr},number:{source:fn,composite:mn}};function L0(i,e,o){const l=QT[i];return l&&l[o]||eS[e][o]}at("ConstantBinder",$u),at("CrossFadedConstantBinder",Jl),at("SourceExpressionBinder",Ho),at("CrossFadedCompositeBinder",zs),at("CompositeExpressionBinder",qi),at("ProgramConfiguration",Xo,{omit:["_buffers"]}),at("ProgramConfigurationSet",Oa);const cp="-transition";class Wi extends Xe{constructor(e,o){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),o.layout&&(this._unevaluatedLayout=new q(o.layout)),o.paint)){this._transitionablePaint=new K(o.paint);for(const l in e.paint)this.setPaintProperty(l,e.paint[l],{validate:!1});for(const l in e.layout)this.setLayoutProperty(l,e.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new se(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,o,l={}){o!=null&&this._validate(jd,`layers.${this.id}.layout.${e}`,e,o,l)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,o):this.visibility=o)}getPaintProperty(e){return an(e,cp)?this._transitionablePaint.getTransition(e.slice(0,-cp.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,o,l={}){if(o!=null&&this._validate(Gl,`layers.${this.id}.paint.${e}`,e,o,l))return!1;if(an(e,cp))return this._transitionablePaint.setTransition(e.slice(0,-cp.length),o||void 0),!1;{const u=this._transitionablePaint._values[e],p=u.property.specification["property-type"]==="cross-faded-data-driven",m=u.value.isDataDriven(),v=u.value;this._transitionablePaint.setValue(e,o),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value;return b.isDataDriven()||m||p||this._handleOverridablePaintPropertyUpdate(e,v,b)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,o,l){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,o){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,o)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),er(e,(o,l)=>!(o===void 0||l==="layout"&&!Object.keys(o).length||l==="paint"&&!Object.keys(o).length))}_validate(e,o,l,u,p={}){return(!p||p.validate!==!1)&&Vd(this,e.call(qo,{key:o,layerType:this.type,objectKey:l,value:u,styleSpec:_e,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const o=this.paint.get(e);if(o instanceof re&&uo(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=wa(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const tS=Se([{name:"a_pos",components:2,type:"Int16"}],4),{members:nS}=tS;class sr{constructor(e=[]){this.segments=e}prepareSegment(e,o,l,u){let p=this.segments[this.segments.length-1];return e>sr.MAX_VERTEX_ARRAY_LENGTH&&dt(`Max vertices per segment is ${sr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!p||p.vertexLength+e>sr.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==u)&&(p={vertexOffset:o.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},u!==void 0&&(p.sortKey=u),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const e of this.segments)for(const o in e.vaos)e.vaos[o].destroy()}static simpleSegment(e,o,l,u){return new sr([{vertexOffset:e,primitiveOffset:o,vertexLength:l,primitiveLength:u,vaos:{},sortKey:0}])}}sr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,at("SegmentVector",sr);var qt=8192;class Ba{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof on?new on(e.lng,e.lat):on.convert(e),this}setSouthWest(e){return this._sw=e instanceof on?new on(e.lng,e.lat):on.convert(e),this}extend(e){const o=this._sw,l=this._ne;let u,p;if(e instanceof on)u=e,p=e;else{if(!(e instanceof Ba))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ba.convert(e)):this.extend(on.convert(e)):this;if(u=e._sw,p=e._ne,!u||!p)return this}return o||l?(o.lng=Math.min(u.lng,o.lng),o.lat=Math.min(u.lat,o.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new on(u.lng,u.lat),this._ne=new on(p.lng,p.lat)),this}getCenter(){return new on((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new on(this.getWest(),this.getNorth())}getSouthEast(){return new on(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:l}=on.convert(e);let u=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(e){return!e||e instanceof Ba?e:new Ba(e)}}const O0=63710088e-1;class on{constructor(e,o){if(isNaN(e)||isNaN(o))throw new Error(`Invalid LngLat object: (${e}, ${o})`);if(this.lng=+e,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new on(Ke(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const o=Math.PI/180,l=this.lat*o,u=e.lat*o,p=Math.sin(l)*Math.sin(u)+Math.cos(l)*Math.cos(u)*Math.cos((e.lng-this.lng)*o);return O0*Math.acos(Math.min(p,1))}toBounds(e=0){const o=360*e/40075017,l=o/Math.cos(Math.PI/180*this.lat);return new Ba(new on(this.lng-l,this.lat-o),new on(this.lng+l,this.lat+o))}static convert(e){if(e instanceof on)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new on(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new on(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const B0=2*Math.PI*O0;function F0(i){return B0*Math.cos(i*Math.PI/180)}function Bm(i){return(180+i)/360}function Fm(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function $m(i,e){return i/F0(e)}function Fa(i){return 360*i-180}function yo(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Nm(i,e){return i*F0(yo(e))}const Ds=85.051129;class up{constructor(e,o,l=0){this.x=+e,this.y=+o,this.z=+l}static fromLngLat(e,o=0){const l=on.convert(e);return new up(Bm(l.lng),Fm(l.lat),$m(o,l.lat))}toLngLat(){return new on(Fa(this.x),yo(this.y))}toAltitude(){return Nm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/B0*(e=yo(this.y),1/Math.cos(e*Math.PI/180));var e}}function Um(i,e,o,l,u,p,m,v,b){const T=(e+l)/2,C=(o+u)/2,k=new N(T,C);v(k),function(M,O,B,j,J,oe){const ce=B-J,pe=j-oe;return Math.abs((j-O)*ce-(B-M)*pe)/Math.hypot(ce,pe)}(k.x,k.y,p.x,p.y,m.x,m.y)>=b?(Um(i,e,o,T,C,p,k,v,b),Um(i,T,C,l,u,k,m,v,b)):i.push(m)}function rS(i,e,o){const l=[];let u,p,m;for(const v of i){const{x:b,y:T}=v;e(v),m?Um(l,u,p,b,T,m,v,e,o):l.push(v),u=b,p=T,m=v}return l}const jm=Math.pow(2,14)-1,$0=-jm-1;function iS(i,e){const o=Math.round(i.x*e),l=Math.round(i.y*e);return i.x=Le(o,$0,jm),i.y=Le(l,$0,jm),(o<i.x||o>i.x+1||l<i.y||l>i.y+1)&&dt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function Ko(i,e,o){const l=i.loadGeometry(),u=i.extent,p=qt/u;if(e&&o&&o.projection.name!=="mercator"){const m=1<<e.z,{scale:v,x:b,y:T,projection:C}=o,k=M=>{const O=Fa((e.x+M.x/u)/m),B=yo((e.y+M.y/u)/m),j=C.project(O,B);M.x=(j.x*v-b)*u,M.y=(j.y*v-T)*u};for(let M=0;M<l.length;M++)if(i.type!==1)l[M]=rS(l[M],k,1);else{const O=[];for(const B of l[M])B.x<0||B.x>=u||B.y<0||B.y>=u||(k(B),O.push(B));l[M]=O}}for(const m of l)for(const v of m)iS(v,p);return l}function $a(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?Ko(i):[]}}function hp(i,e,o,l,u){i.emplaceBack(2*e+(l+1)/2,2*o+(u+1)/2)}class Vm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new lt,this.indexArray=new Vn,this.segments=new sr,this.programConfigurations=new Oa(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l,u){const p=this.layers[0],m=[];let v=null;p.type==="circle"&&(v=p.layout.get("circle-sort-key"));for(const{feature:b,id:T,index:C,sourceLayerIndex:k}of e){const M=this.layers[0]._featureFilter.needGeometry,O=$a(b,M);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),O,l))continue;const B=v?v.evaluate(O,{},l):void 0,j={id:T,properties:b.properties,type:b.type,sourceLayerIndex:k,index:C,geometry:M?O.geometry:Ko(b,l,u),patterns:{},sortKey:B};m.push(j)}v&&m.sort((b,T)=>b.sortKey-T.sortKey);for(const b of m){const{geometry:T,index:C,sourceLayerIndex:k}=b,M=e[C].feature;this.addFeature(b,T,C,o.availableImages,l),o.featureIndex.insert(M,T,C,k,this.index)}}update(e,o,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nS),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,o,l,u,p){for(const m of o)for(const v of m){const b=v.x,T=v.y;if(b<0||b>=qt||T<0||T>=qt)continue;const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),k=C.vertexLength;hp(this.layoutVertexArray,b,T,-1,-1),hp(this.layoutVertexArray,b,T,1,-1),hp(this.layoutVertexArray,b,T,1,1),hp(this.layoutVertexArray,b,T,-1,1),this.indexArray.emplaceBack(k,k+1,k+2),this.indexArray.emplaceBack(k,k+3,k+2),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},u,p)}}function N0(i,e){for(let o=0;o<i.length;o++)if(Ql(e,i[o]))return!0;for(let o=0;o<e.length;o++)if(Ql(i,e[o]))return!0;return!!Gm(i,e)}function oS(i,e,o){return!!Ql(i,e)||!!Zm(e,i,o)}function U0(i,e){if(i.length===1)return V0(e,i[0]);for(let o=0;o<e.length;o++){const l=e[o];for(let u=0;u<l.length;u++)if(Ql(i,l[u]))return!0}for(let o=0;o<i.length;o++)if(V0(e,i[o]))return!0;for(let o=0;o<e.length;o++)if(Gm(i,e[o]))return!0;return!1}function sS(i,e,o){if(i.length>1){if(Gm(i,e))return!0;for(let l=0;l<e.length;l++)if(Zm(e[l],i,o))return!0}for(let l=0;l<i.length;l++)if(Zm(i[l],e,o))return!0;return!1}function Gm(i,e){if(i.length===0||e.length===0)return!1;for(let o=0;o<i.length-1;o++){const l=i[o],u=i[o+1];for(let p=0;p<e.length-1;p++)if(aS(l,u,e[p],e[p+1]))return!0}return!1}function aS(i,e,o,l){return Ut(i,o,l)!==Ut(e,o,l)&&Ut(i,e,o)!==Ut(i,e,l)}function Zm(i,e,o){const l=o*o;if(e.length===1)return i.distSqr(e[0])<l;for(let u=1;u<e.length;u++)if(j0(i,e[u-1],e[u])<l)return!0;return!1}function j0(i,e,o){const l=e.distSqr(o);if(l===0)return i.distSqr(e);const u=((i.x-e.x)*(o.x-e.x)+(i.y-e.y)*(o.y-e.y))/l;return i.distSqr(u<0?e:u>1?o:o.sub(e)._mult(u)._add(e))}function V0(i,e){let o,l,u,p=!1;for(let m=0;m<i.length;m++){o=i[m];for(let v=0,b=o.length-1;v<o.length;b=v++)l=o[v],u=o[b],l.y>e.y!=u.y>e.y&&e.x<(u.x-l.x)*(e.y-l.y)/(u.y-l.y)+l.x&&(p=!p)}return p}function Ql(i,e){let o=!1;for(let l=0,u=i.length-1;l<i.length;u=l++){const p=i[l],m=i[u];p.y>e.y!=m.y>e.y&&e.x<(m.x-p.x)*(e.y-p.y)/(m.y-p.y)+p.x&&(o=!o)}return o}function G0(i,e,o,l,u){for(const m of i)if(e<=m.x&&o<=m.y&&l>=m.x&&u>=m.y)return!0;const p=[new N(e,o),new N(e,u),new N(l,u),new N(l,o)];if(i.length>2){for(const m of p)if(Ql(i,m))return!0}for(let m=0;m<i.length-1;m++)if(lS(i[m],i[m+1],p))return!0;return!1}function lS(i,e,o){const l=o[0],u=o[2];if(i.x<l.x&&e.x<l.x||i.x>u.x&&e.x>u.x||i.y<l.y&&e.y<l.y||i.y>u.y&&e.y>u.y)return!1;const p=Ut(i,e,o[0]);return p!==Ut(i,e,o[1])||p!==Ut(i,e,o[2])||p!==Ut(i,e,o[3])}function ec(i,e,o){const l=e.paint.get(i).value;return l.kind==="constant"?l.value:o.programConfigurations.get(e.id).getMaxValue(i)}function dp(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Z0(i,e,o,l,u){if(!e[0]&&!e[1])return i;const p=N.convert(e)._mult(u);o==="viewport"&&p._rotate(-l);const m=[];for(let v=0;v<i.length;v++)m.push(i[v].sub(p));return m}function q0(i,e,o,l){const u=N.convert(i)._mult(l);return e==="viewport"&&u._rotate(-o),u}at("CircleBucket",Vm,{omit:["layers"]});const cS=new ze({"circle-sort-key":new le(_e.layout_circle["circle-sort-key"])});var uS={paint:new ze({"circle-radius":new le(_e.paint_circle["circle-radius"]),"circle-color":new le(_e.paint_circle["circle-color"]),"circle-blur":new le(_e.paint_circle["circle-blur"]),"circle-opacity":new le(_e.paint_circle["circle-opacity"]),"circle-translate":new H(_e.paint_circle["circle-translate"]),"circle-translate-anchor":new H(_e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new H(_e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new H(_e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new le(_e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new le(_e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new le(_e.paint_circle["circle-stroke-opacity"])}),layout:cS},Dr=typeof Float32Array!="undefined"?Float32Array:Array;function W0(){var i=new Dr(9);return Dr!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function qm(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function H0(i,e,o){var l=e[0],u=e[1],p=e[2],m=e[3],v=e[4],b=e[5],T=e[6],C=e[7],k=e[8],M=e[9],O=e[10],B=e[11],j=e[12],J=e[13],oe=e[14],ce=e[15],pe=o[0],ye=o[1],ge=o[2],ve=o[3];return i[0]=pe*l+ye*v+ge*k+ve*j,i[1]=pe*u+ye*b+ge*M+ve*J,i[2]=pe*p+ye*T+ge*O+ve*oe,i[3]=pe*m+ye*C+ge*B+ve*ce,i[4]=(pe=o[4])*l+(ye=o[5])*v+(ge=o[6])*k+(ve=o[7])*j,i[5]=pe*u+ye*b+ge*M+ve*J,i[6]=pe*p+ye*T+ge*O+ve*oe,i[7]=pe*m+ye*C+ge*B+ve*ce,i[8]=(pe=o[8])*l+(ye=o[9])*v+(ge=o[10])*k+(ve=o[11])*j,i[9]=pe*u+ye*b+ge*M+ve*J,i[10]=pe*p+ye*T+ge*O+ve*oe,i[11]=pe*m+ye*C+ge*B+ve*ce,i[12]=(pe=o[12])*l+(ye=o[13])*v+(ge=o[14])*k+(ve=o[15])*j,i[13]=pe*u+ye*b+ge*M+ve*J,i[14]=pe*p+ye*T+ge*O+ve*oe,i[15]=pe*m+ye*C+ge*B+ve*ce,i}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var hS=H0;function pp(){var i=new Dr(3);return Dr!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function X0(i){return Math.hypot(i[0],i[1],i[2])}function tc(i,e,o){var l=new Dr(3);return l[0]=i,l[1]=e,l[2]=o,l}function K0(i,e,o){return i[0]=e[0]-o[0],i[1]=e[1]-o[1],i[2]=e[2]-o[2],i}function Y0(i,e,o){return i[0]=e[0]*o[0],i[1]=e[1]*o[1],i[2]=e[2]*o[2],i}function J0(i,e,o,l){return i[0]=e[0]+o[0]*l,i[1]=e[1]+o[1]*l,i[2]=e[2]+o[2]*l,i}function Q0(i,e){var o=e[0],l=e[1],u=e[2],p=o*o+l*l+u*u;return p>0&&(p=1/Math.sqrt(p)),i[0]=e[0]*p,i[1]=e[1]*p,i[2]=e[2]*p,i}function ev(i,e,o){var l=o[0],u=o[1],p=o[2],m=e[0],v=e[1],b=e[2],T=u*b-p*v,C=p*m-l*b,k=l*v-u*m,M=u*k-p*C,O=p*T-l*k,B=l*C-u*T,j=2*o[3];return C*=j,k*=j,O*=2,B*=2,i[0]=m+(T*=j)+(M*=2),i[1]=v+C+O,i[2]=b+k+B,i}var Nu,dS=K0,pS=Y0,fS=X0;function Uu(i,e,o){var l=e[0],u=e[1],p=e[2],m=e[3];return i[0]=o[0]*l+o[4]*u+o[8]*p+o[12]*m,i[1]=o[1]*l+o[5]*u+o[9]*p+o[13]*m,i[2]=o[2]*l+o[6]*u+o[10]*p+o[14]*m,i[3]=o[3]*l+o[7]*u+o[11]*p+o[15]*m,i}function Wm(){var i=new Dr(4);return Dr!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function tv(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function nv(i,e,o){o*=.5;var l=e[0],u=e[1],p=e[2],m=e[3],v=Math.sin(o),b=Math.cos(o);return i[0]=l*b+m*v,i[1]=u*b+p*v,i[2]=p*b-u*v,i[3]=m*b-l*v,i}function rv(i,e){return i[0]===e[0]&&i[1]===e[1]}function iv(i,e,o,l,u,p,m,v,b){if(p&&i.queryGeometry.isAboveHorizon)return!1;p&&(b*=i.pixelToTileUnitsFactor);for(const T of e)for(const C of T){const k=C.add(v),M=u&&o.elevation?o.elevation.exaggeration()*u.getElevationAt(k.x,k.y,!0):0,O=p?k:mS(k,M,l),B=p?i.tilespaceRays.map(J=>_S(J,M)):i.queryGeometry.screenGeometry,j=Uu([],[C.x,C.y,M,1],l);if(!m&&p?b*=j[3]/o.cameraToCenterDistance:m&&!p&&(b*=o.cameraToCenterDistance/j[3]),oS(B,O,b))return!0}return!1}function mS(i,e,o){const l=Uu([],[i.x,i.y,e,1],o);return new N(l[0]/l[3],l[1]/l[3])}pp(),Nu=new Dr(4),Dr!=Float32Array&&(Nu[0]=0,Nu[1]=0,Nu[2]=0,Nu[3]=0),pp(),tc(1,0,0),tc(0,1,0),Wm(),Wm(),W0(),function(){var i;i=new Dr(2),Dr!=Float32Array&&(i[0]=0,i[1]=0)}();const ov=tc(0,0,0),gS=tc(0,0,1);function _S(i,e){const o=pp();return ov[2]=e,i.intersectsPlane(ov,gS,o),new N(o[0],o[1])}class sv extends Vm{}function Hm(i,{width:e,height:o},l,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*o*l)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*o*l);return i.width=e,i.height=o,i.data=u,i}function av(i,{width:e,height:o},l){if(e===i.width&&o===i.height)return;const u=Hm({},{width:e,height:o},l);Xm(i,u,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,e),height:Math.min(i.height,o)},l),i.width=e,i.height=o,i.data=u.data}function Xm(i,e,o,l,u,p){if(u.width===0||u.height===0)return e;if(u.width>i.width||u.height>i.height||o.x>i.width-u.width||o.y>i.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||l.x>e.width-u.width||l.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const m=i.data,v=e.data;for(let b=0;b<u.height;b++){const T=((o.y+b)*i.width+o.x)*p,C=((l.y+b)*e.width+l.x)*p;for(let k=0;k<u.width*p;k++)v[C+k]=m[T+k]}return e}at("HeatmapBucket",sv,{omit:["layers"]});class Rs{constructor(e,o){Hm(this,e,1,o)}resize(e){av(this,e,1)}clone(){return new Rs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,l,u,p){Xm(e,o,l,u,p,1)}}class yi{constructor(e,o){Hm(this,e,4,o)}resize(e){av(this,e,4)}replace(e,o){o?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new yi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,l,u,p){Xm(e,o,l,u,p,4)}}at("AlphaImage",Rs),at("RGBAImage",yi);var yS={paint:new ze({"heatmap-radius":new le(_e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new le(_e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new H(_e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ce(_e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new H(_e.paint_heatmap["heatmap-opacity"])})};function Km(i){const e={},o=i.resolution||256,l=i.clips?i.clips.length:1,u=i.image||new yi({width:o,height:l}),p=(m,v,b)=>{e[i.evaluationKey]=b;const T=i.expression.evaluate(e);u.data[m+v+0]=Math.floor(255*T.r/T.a),u.data[m+v+1]=Math.floor(255*T.g/T.a),u.data[m+v+2]=Math.floor(255*T.b/T.a),u.data[m+v+3]=Math.floor(255*T.a)};if(i.clips)for(let m=0,v=0;m<l;++m,v+=4*o)for(let b=0,T=0;b<o;b++,T+=4){const C=b/(o-1),{start:k,end:M}=i.clips[m];p(v,T,k*(1-C)+M*C)}else for(let m=0,v=0;m<o;m++,v+=4)p(0,v,m/(o-1));return u}var vS={paint:new ze({"hillshade-illumination-direction":new H(_e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new H(_e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new H(_e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new H(_e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new H(_e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new H(_e.paint_hillshade["hillshade-accent-color"])})};const xS=Se([{name:"a_pos",components:2,type:"Int16"}],4),{members:bS}=xS;var fp=mp,wS=mp;function mp(i,e,o){o=o||2;var l,u,p,m,v,b,T,C=e&&e.length,k=C?e[0]*o:i.length,M=lv(i,0,k,o,!0),O=[];if(!M||M.next===M.prev)return O;if(C&&(M=function(j,J,oe,ce){var pe,ye,ge,ve=[];for(pe=0,ye=J.length;pe<ye;pe++)(ge=lv(j,J[pe]*ce,pe<ye-1?J[pe+1]*ce:j.length,ce,!1))===ge.next&&(ge.steiner=!0),ve.push(MS(ge));for(ve.sort(kS),pe=0;pe<ve.length;pe++)oe=Ls(oe=IS(ve[pe],oe),oe.next);return oe}(i,e,M,o)),i.length>80*o){l=p=i[0],u=m=i[1];for(var B=o;B<k;B+=o)(v=i[B])<l&&(l=v),(b=i[B+1])<u&&(u=b),v>p&&(p=v),b>m&&(m=b);T=(T=Math.max(p-l,m-u))!==0?1/T:0}return ju(M,O,o,l,u,T),O}function lv(i,e,o,l,u){var p,m;if(u===Qm(i,e,o,l)>0)for(p=e;p<o;p+=l)m=hv(p,i[p],i[p+1],m);else for(p=o-l;p>=e;p-=l)m=hv(p,i[p],i[p+1],m);return m&&gp(m,m.next)&&(Gu(m),m=m.next),m}function Ls(i,e){if(!i)return i;e||(e=i);var o,l=i;do if(o=!1,l.steiner||!gp(l,l.next)&&On(l.prev,l,l.next)!==0)l=l.next;else{if(Gu(l),(l=e=l.prev)===l.next)break;o=!0}while(o||l!==e);return e}function ju(i,e,o,l,u,p,m){if(i){!m&&p&&function(C,k,M,O){var B=C;do B.z===null&&(B.z=Ym(B.x,B.y,k,M,O)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==C);B.prevZ.nextZ=null,B.prevZ=null,function(j){var J,oe,ce,pe,ye,ge,ve,Re,Ie=1;do{for(oe=j,j=null,ye=null,ge=0;oe;){for(ge++,ce=oe,ve=0,J=0;J<Ie&&(ve++,ce=ce.nextZ);J++);for(Re=Ie;ve>0||Re>0&&ce;)ve!==0&&(Re===0||!ce||oe.z<=ce.z)?(pe=oe,oe=oe.nextZ,ve--):(pe=ce,ce=ce.nextZ,Re--),ye?ye.nextZ=pe:j=pe,pe.prevZ=ye,ye=pe;oe=ce}ye.nextZ=null,Ie*=2}while(ge>1)}(B)}(i,l,u,p);for(var v,b,T=i;i.prev!==i.next;)if(v=i.prev,b=i.next,p?TS(i,l,u,p):ES(i))e.push(v.i/o),e.push(i.i/o),e.push(b.i/o),Gu(i),i=b.next,T=b.next;else if((i=b)===T){m?m===1?ju(i=SS(Ls(i),e,o),e,o,l,u,p,2):m===2&&CS(i,e,o,l,u,p):ju(Ls(i),e,o,l,u,p,1);break}}}function ES(i){var e=i.prev,o=i,l=i.next;if(On(e,o,l)>=0)return!1;for(var u=i.next.next;u!==i.prev;){if(nc(e.x,e.y,o.x,o.y,l.x,l.y,u.x,u.y)&&On(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function TS(i,e,o,l){var u=i.prev,p=i,m=i.next;if(On(u,p,m)>=0)return!1;for(var v=u.x>p.x?u.x>m.x?u.x:m.x:p.x>m.x?p.x:m.x,b=u.y>p.y?u.y>m.y?u.y:m.y:p.y>m.y?p.y:m.y,T=Ym(u.x<p.x?u.x<m.x?u.x:m.x:p.x<m.x?p.x:m.x,u.y<p.y?u.y<m.y?u.y:m.y:p.y<m.y?p.y:m.y,e,o,l),C=Ym(v,b,e,o,l),k=i.prevZ,M=i.nextZ;k&&k.z>=T&&M&&M.z<=C;){if(k!==i.prev&&k!==i.next&&nc(u.x,u.y,p.x,p.y,m.x,m.y,k.x,k.y)&&On(k.prev,k,k.next)>=0||(k=k.prevZ,M!==i.prev&&M!==i.next&&nc(u.x,u.y,p.x,p.y,m.x,m.y,M.x,M.y)&&On(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;k&&k.z>=T;){if(k!==i.prev&&k!==i.next&&nc(u.x,u.y,p.x,p.y,m.x,m.y,k.x,k.y)&&On(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;M&&M.z<=C;){if(M!==i.prev&&M!==i.next&&nc(u.x,u.y,p.x,p.y,m.x,m.y,M.x,M.y)&&On(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function SS(i,e,o){var l=i;do{var u=l.prev,p=l.next.next;!gp(u,p)&&cv(u,l,l.next,p)&&Vu(u,p)&&Vu(p,u)&&(e.push(u.i/o),e.push(l.i/o),e.push(p.i/o),Gu(l),Gu(l.next),l=i=p),l=l.next}while(l!==i);return Ls(l)}function CS(i,e,o,l,u,p){var m=i;do{for(var v=m.next.next;v!==m.prev;){if(m.i!==v.i&&PS(m,v)){var b=uv(m,v);return m=Ls(m,m.next),b=Ls(b,b.next),ju(m,e,o,l,u,p),void ju(b,e,o,l,u,p)}v=v.next}m=m.next}while(m!==i)}function kS(i,e){return i.x-e.x}function IS(i,e){var o=function(p,m){var v,b=m,T=p.x,C=p.y,k=-1/0;do{if(C<=b.y&&C>=b.next.y&&b.next.y!==b.y){var M=b.x+(C-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(M<=T&&M>k){if(k=M,M===T){if(C===b.y)return b;if(C===b.next.y)return b.next}v=b.x<b.next.x?b:b.next}}b=b.next}while(b!==m);if(!v)return null;if(T===k)return v;var O,B=v,j=v.x,J=v.y,oe=1/0;b=v;do T>=b.x&&b.x>=j&&T!==b.x&&nc(C<J?T:k,C,j,J,C<J?k:T,C,b.x,b.y)&&(O=Math.abs(C-b.y)/(T-b.x),Vu(b,p)&&(O<oe||O===oe&&(b.x>v.x||b.x===v.x&&AS(v,b)))&&(v=b,oe=O)),b=b.next;while(b!==B);return v}(i,e);if(!o)return e;var l=uv(o,i),u=Ls(o,o.next);return Ls(l,l.next),e===o?u:e}function AS(i,e){return On(i.prev,i,e.prev)<0&&On(e.next,i,i.next)<0}function Ym(i,e,o,l,u){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-o)*u)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-l)*u)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function MS(i){var e=i,o=i;do(e.x<o.x||e.x===o.x&&e.y<o.y)&&(o=e),e=e.next;while(e!==i);return o}function nc(i,e,o,l,u,p,m,v){return(u-m)*(e-v)-(i-m)*(p-v)>=0&&(i-m)*(l-v)-(o-m)*(e-v)>=0&&(o-m)*(p-v)-(u-m)*(l-v)>=0}function PS(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(o,l){var u=o;do{if(u.i!==o.i&&u.next.i!==o.i&&u.i!==l.i&&u.next.i!==l.i&&cv(u,u.next,o,l))return!0;u=u.next}while(u!==o);return!1}(i,e)&&(Vu(i,e)&&Vu(e,i)&&function(o,l){var u=o,p=!1,m=(o.x+l.x)/2,v=(o.y+l.y)/2;do u.y>v!=u.next.y>v&&u.next.y!==u.y&&m<(u.next.x-u.x)*(v-u.y)/(u.next.y-u.y)+u.x&&(p=!p),u=u.next;while(u!==o);return p}(i,e)&&(On(i.prev,i,e.prev)||On(i,e.prev,e))||gp(i,e)&&On(i.prev,i,i.next)>0&&On(e.prev,e,e.next)>0)}function On(i,e,o){return(e.y-i.y)*(o.x-e.x)-(e.x-i.x)*(o.y-e.y)}function gp(i,e){return i.x===e.x&&i.y===e.y}function cv(i,e,o,l){var u=yp(On(i,e,o)),p=yp(On(i,e,l)),m=yp(On(o,l,i)),v=yp(On(o,l,e));return u!==p&&m!==v||!(u!==0||!_p(i,o,e))||!(p!==0||!_p(i,l,e))||!(m!==0||!_p(o,i,l))||!(v!==0||!_p(o,e,l))}function _p(i,e,o){return e.x<=Math.max(i.x,o.x)&&e.x>=Math.min(i.x,o.x)&&e.y<=Math.max(i.y,o.y)&&e.y>=Math.min(i.y,o.y)}function yp(i){return i>0?1:i<0?-1:0}function Vu(i,e){return On(i.prev,i,i.next)<0?On(i,e,i.next)>=0&&On(i,i.prev,e)>=0:On(i,e,i.prev)<0||On(i,i.next,e)<0}function uv(i,e){var o=new Jm(i.i,i.x,i.y),l=new Jm(e.i,e.x,e.y),u=i.next,p=e.prev;return i.next=e,e.prev=i,o.next=u,u.prev=o,l.next=o,o.prev=l,p.next=l,l.prev=p,l}function hv(i,e,o,l){var u=new Jm(i,e,o);return l?(u.next=l.next,u.prev=l,l.next.prev=u,l.next=u):(u.prev=u,u.next=u),u}function Gu(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Jm(i,e,o){this.i=i,this.x=e,this.y=o,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qm(i,e,o,l){for(var u=0,p=e,m=o-l;p<o;p+=l)u+=(i[m]-i[p])*(i[p+1]+i[m+1]),m=p;return u}function zS(i,e,o,l,u){dv(i,e,o||0,l||i.length-1,u||DS)}function dv(i,e,o,l,u){for(;l>o;){if(l-o>600){var p=l-o+1,m=e-o+1,v=Math.log(p),b=.5*Math.exp(2*v/3),T=.5*Math.sqrt(v*b*(p-b)/p)*(m-p/2<0?-1:1);dv(i,e,Math.max(o,Math.floor(e-m*b/p+T)),Math.min(l,Math.floor(e+(p-m)*b/p+T)),u)}var C=i[e],k=o,M=l;for(Zu(i,o,e),u(i[l],C)>0&&Zu(i,o,l);k<M;){for(Zu(i,k,M),k++,M--;u(i[k],C)<0;)k++;for(;u(i[M],C)>0;)M--}u(i[o],C)===0?Zu(i,o,M):Zu(i,++M,l),M<=e&&(o=M+1),e<=M&&(l=M-1)}}function Zu(i,e,o){var l=i[e];i[e]=i[o],i[o]=l}function DS(i,e){return i<e?-1:i>e?1:0}function eg(i,e){const o=i.length;if(o<=1)return[i];const l=[];let u,p;for(let m=0;m<o;m++){const v=vn(i[m]);v!==0&&(i[m].area=Math.abs(v),p===void 0&&(p=v<0),p===v<0?(u&&l.push(u),u=[i[m]]):u.push(i[m]))}if(u&&l.push(u),e>1)for(let m=0;m<l.length;m++)l[m].length<=e||(zS(l[m],e,1,l[m].length-1,RS),l[m]=l[m].slice(0,e));return l}function RS(i,e){return e.area-i.area}function tg(i,e,o){const l=o.patternDependencies;let u=!1;for(const p of e){const m=p.paint.get(`${i}-pattern`);m.isConstant()||(u=!0);const v=m.constantOr(null);v&&(u=!0,l[v.to]=!0,l[v.from]=!0)}return u}function ng(i,e,o,l,u){const p=u.patternDependencies;for(const m of e){const v=m.paint.get(`${i}-pattern`).value;if(v.kind!=="constant"){let b=v.evaluate({zoom:l-1},o,{},u.availableImages),T=v.evaluate({zoom:l},o,{},u.availableImages),C=v.evaluate({zoom:l+1},o,{},u.availableImages);b=b&&b.name?b.name:b,T=T&&T.name?T.name:T,C=C&&C.name?C.name:C,p[b]=!0,p[T]=!0,p[C]=!0,o.patterns[m.id]={min:b,mid:T,max:C}}}return o}mp.deviation=function(i,e,o,l){var u=e&&e.length,p=Math.abs(Qm(i,0,u?e[0]*o:i.length,o));if(u)for(var m=0,v=e.length;m<v;m++)p-=Math.abs(Qm(i,e[m]*o,m<v-1?e[m+1]*o:i.length,o));var b=0;for(m=0;m<l.length;m+=3){var T=l[m]*o,C=l[m+1]*o,k=l[m+2]*o;b+=Math.abs((i[T]-i[k])*(i[C+1]-i[T+1])-(i[T]-i[C])*(i[k+1]-i[T+1]))}return p===0&&b===0?0:Math.abs((b-p)/p)},mp.flatten=function(i){for(var e=i[0][0].length,o={vertices:[],holes:[],dimensions:e},l=0,u=0;u<i.length;u++){for(var p=0;p<i[u].length;p++)for(var m=0;m<e;m++)o.vertices.push(i[u][p][m]);u>0&&o.holes.push(l+=i[u-1].length)}return o},fp.default=wS;class vp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new lt,this.indexArray=new Vn,this.indexArray2=new gn,this.programConfigurations=new Oa(e.layers,e.zoom),this.segments=new sr,this.segments2=new sr,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l,u){this.hasPattern=tg("fill",this.layers,o);const p=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:v,id:b,index:T,sourceLayerIndex:C}of e){const k=this.layers[0]._featureFilter.needGeometry,M=$a(v,k);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),M,l))continue;const O=p?p.evaluate(M,{},l,o.availableImages):void 0,B={id:b,properties:v.properties,type:v.type,sourceLayerIndex:C,index:T,geometry:k?M.geometry:Ko(v,l,u),patterns:{},sortKey:O};m.push(B)}p&&m.sort((v,b)=>v.sortKey-b.sortKey);for(const v of m){const{geometry:b,index:T,sourceLayerIndex:C}=v;if(this.hasPattern){const k=ng("fill",this.layers,v,this.zoom,o);this.patternFeatures.push(k)}else this.addFeature(v,b,T,l,{},o.availableImages);o.featureIndex.insert(e[T].feature,b,T,C,this.index)}}update(e,o,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,u)}addFeatures(e,o,l,u){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,o,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,bS),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,o,l,u,p,m=[]){for(const v of eg(o,500)){let b=0;for(const B of v)b+=B.length;const T=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),C=T.vertexLength,k=[],M=[];for(const B of v){if(B.length===0)continue;B!==v[0]&&M.push(k.length/2);const j=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),J=j.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(J+B.length-1,J),k.push(B[0].x),k.push(B[0].y);for(let oe=1;oe<B.length;oe++)this.layoutVertexArray.emplaceBack(B[oe].x,B[oe].y),this.indexArray2.emplaceBack(J+oe-1,J+oe),k.push(B[oe].x),k.push(B[oe].y);j.vertexLength+=B.length,j.primitiveLength+=B.length}const O=fp(k,M);for(let B=0;B<O.length;B+=3)this.indexArray.emplaceBack(C+O[B],C+O[B+1],C+O[B+2]);T.vertexLength+=b,T.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,p,m,u)}}at("FillBucket",vp,{omit:["layers","patternFeatures"]});const LS=new ze({"fill-sort-key":new le(_e.layout_fill["fill-sort-key"])});var OS={paint:new ze({"fill-antialias":new H(_e.paint_fill["fill-antialias"]),"fill-opacity":new le(_e.paint_fill["fill-opacity"]),"fill-color":new le(_e.paint_fill["fill-color"]),"fill-outline-color":new le(_e.paint_fill["fill-outline-color"]),"fill-translate":new H(_e.paint_fill["fill-translate"]),"fill-translate-anchor":new H(_e.paint_fill["fill-translate-anchor"]),"fill-pattern":new he(_e.paint_fill["fill-pattern"])}),layout:LS};const BS=Se([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),FS=Se([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:$S}=BS;var pv=rc;function rc(i,e,o,l,u){this.properties={},this.extent=o,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=u,i.readFields(NS,this,e)}function NS(i,e,o){i==1?e.id=o.readVarint():i==2?function(l,u){for(var p=l.readVarint()+l.pos;l.pos<p;){var m=u._keys[l.readVarint()],v=u._values[l.readVarint()];u.properties[m]=v}}(o,e):i==3?e.type=o.readVarint():i==4&&(e._geometry=o.pos)}function US(i){for(var e,o,l=0,u=0,p=i.length,m=p-1;u<p;m=u++)l+=((o=i[m]).x-(e=i[u]).x)*(e.y+o.y);return l}rc.types=["Unknown","Point","LineString","Polygon"],rc.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,o=i.readVarint()+i.pos,l=1,u=0,p=0,m=0,v=[];i.pos<o;){if(u<=0){var b=i.readVarint();l=7&b,u=b>>3}if(u--,l===1||l===2)p+=i.readSVarint(),m+=i.readSVarint(),l===1&&(e&&v.push(e),e=[]),e.push(new N(p,m));else{if(l!==7)throw new Error("unknown command "+l);e&&e.push(e[0].clone())}}return e&&v.push(e),v},rc.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,o=1,l=0,u=0,p=0,m=1/0,v=-1/0,b=1/0,T=-1/0;i.pos<e;){if(l<=0){var C=i.readVarint();o=7&C,l=C>>3}if(l--,o===1||o===2)(u+=i.readSVarint())<m&&(m=u),u>v&&(v=u),(p+=i.readSVarint())<b&&(b=p),p>T&&(T=p);else if(o!==7)throw new Error("unknown command "+o)}return[m,b,v,T]},rc.prototype.toGeoJSON=function(i,e,o){var l,u,p=this.extent*Math.pow(2,o),m=this.extent*i,v=this.extent*e,b=this.loadGeometry(),T=rc.types[this.type];function C(O){for(var B=0;B<O.length;B++){var j=O[B];O[B]=[360*(j.x+m)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(j.y+v)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var k=[];for(l=0;l<b.length;l++)k[l]=b[l][0];C(b=k);break;case 2:for(l=0;l<b.length;l++)C(b[l]);break;case 3:for(b=function(O){var B=O.length;if(B<=1)return[O];for(var j,J,oe=[],ce=0;ce<B;ce++){var pe=US(O[ce]);pe!==0&&(J===void 0&&(J=pe<0),J===pe<0?(j&&oe.push(j),j=[O[ce]]):j.push(O[ce]))}return j&&oe.push(j),oe}(b),l=0;l<b.length;l++)for(u=0;u<b[l].length;u++)C(b[l][u])}b.length===1?b=b[0]:T="Multi"+T;var M={type:"Feature",geometry:{type:T,coordinates:b},properties:this.properties};return"id"in this&&(M.id=this.id),M};var fv=mv;function mv(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(jS,this,e),this.length=this._features.length}function jS(i,e,o){i===15?e.version=o.readVarint():i===1?e.name=o.readString():i===5?e.extent=o.readVarint():i===2?e._features.push(o.pos):i===3?e._keys.push(o.readString()):i===4&&e._values.push(function(l){for(var u=null,p=l.readVarint()+l.pos;l.pos<p;){var m=l.readVarint()>>3;u=m===1?l.readString():m===2?l.readFloat():m===3?l.readDouble():m===4?l.readVarint64():m===5?l.readVarint():m===6?l.readSVarint():m===7?l.readBoolean():null}return u}(o))}function VS(i,e,o){if(i===3){var l=new fv(o,o.readVarint()+o.pos);l.length&&(e[l.name]=l)}}mv.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new pv(this._pbf,e,this.extent,this._keys,this._values)};var Na={VectorTile:function(i,e){this.layers=i.readFields(VS,{},e)},VectorTileFeature:pv,VectorTileLayer:fv};const GS=Na.VectorTileFeature.types,ZS=Math.pow(2,13);function qu(i,e,o,l,u,p,m,v){i.emplaceBack((e<<1)+m,(o<<1)+p,(Math.floor(l*ZS)<<1)+u,Math.round(v))}class gv{constructor(){this.acc=new N(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new N(e.x,e.y),this.max=new N(e.x,e.y))}append(e,o){this.currentPolyCount.edges++,this.acc._add(e);let l=!!this.borders;const u=this.min,p=this.max;e.x<u.x?(u.x=e.x,l=!0):e.x>p.x&&(p.x=e.x,l=!0),e.y<u.y?(u.y=e.y,l=!0):e.y>p.y&&(p.y=e.y,l=!0),((e.x===0||e.x===qt)&&e.x===o.x)!=((e.y===0||e.y===qt)&&e.y===o.y)&&this.processBorderOverlap(e,o),l&&this.checkBorderIntersection(e,o)}checkBorderIntersection(e,o){o.x<0!=e.x<0&&this.addBorderIntersection(0,Xt(o.y,e.y,(0-o.x)/(e.x-o.x))),o.x>qt!=e.x>qt&&this.addBorderIntersection(1,Xt(o.y,e.y,(qt-o.x)/(e.x-o.x))),o.y<0!=e.y<0&&this.addBorderIntersection(2,Xt(o.x,e.x,(0-o.y)/(e.y-o.y))),o.y>qt!=e.y>qt&&this.addBorderIntersection(3,Xt(o.x,e.x,(qt-o.y)/(e.y-o.y)))}addBorderIntersection(e,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[e];o<l[0]&&(l[0]=o),o>l[1]&&(l[1]=o)}processBorderOverlap(e,o){if(e.x===o.x){if(e.y===o.y)return;const l=e.x===0?0:1;this.addBorderIntersection(l,o.y),this.addBorderIntersection(l,e.y)}else{const l=e.y===0?2:3;this.addBorderIntersection(l,o.x),this.addBorderIntersection(l,e.x)}}centroid(){const e=this.polyCount.reduce((o,l)=>o+l.edges,0);return e!==0?this.acc.div(e)._round():new N(0,0)}span(){return new N(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,o)=>e+ +(o[0]!==Number.MAX_VALUE),0)}}class rg{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new yt,this.centroidVertexArray=new M0,this.indexArray=new Vn,this.programConfigurations=new Oa(e.layers,e.zoom),this.segments=new sr,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.enableTerrain=e.enableTerrain}populate(e,o,l,u){this.features=[],this.hasPattern=tg("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(p){const m=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*m/(m*m+1)/qt/(1<<p.z)}(l);for(const{feature:p,id:m,index:v,sourceLayerIndex:b}of e){const T=this.layers[0]._featureFilter.needGeometry,C=$a(p,T);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),C,l))continue;const k={id:m,sourceLayerIndex:b,index:v,geometry:T?C.geometry:Ko(p,l,u),properties:p.properties,type:p.type,patterns:{}},M=this.layoutVertexArray.length;this.hasPattern?this.features.push(ng("fill-extrusion",this.layers,k,this.zoom,o)):this.addFeature(k,k.geometry,v,l,{},o.availableImages),o.featureIndex.insert(p,k.geometry,v,b,this.index,M)}this.sortBorders()}addFeatures(e,o,l,u){for(const p of this.features){const{geometry:m}=p;this.addFeature(p,m,p.index,o,l,u)}this.sortBorders()}update(e,o,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$S),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,FS.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,o,l,u,p,m){const v=this.enableTerrain?new gv:null;for(const T of eg(o,500)){let C=0,k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(T.length===0||(b=T[0]).every(J=>J.x<=0)||b.every(J=>J.x>=qt)||b.every(J=>J.y<=0)||b.every(J=>J.y>=qt))continue;for(let J=0;J<T.length;J++){const oe=T[J];if(oe.length===0)continue;C+=oe.length;let ce=0;v&&v.startRing(oe[0]);for(let pe=0;pe<oe.length;pe++){const ye=oe[pe];if(pe>=1){const ge=oe[pe-1];if(!qS(ye,ge)){v&&v.append(ye,ge),k.vertexLength+4>sr.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ve=ye.sub(ge)._perp(),Re=ve.x/(Math.abs(ve.x)+Math.abs(ve.y)),Ie=ve.y>0?1:0,et=ge.dist(ye);ce+et>32768&&(ce=0),qu(this.layoutVertexArray,ye.x,ye.y,Re,Ie,0,0,ce),qu(this.layoutVertexArray,ye.x,ye.y,Re,Ie,0,1,ce),ce+=et,qu(this.layoutVertexArray,ge.x,ge.y,Re,Ie,0,0,ce),qu(this.layoutVertexArray,ge.x,ge.y,Re,Ie,0,1,ce);const Ue=k.vertexLength;this.indexArray.emplaceBack(Ue,Ue+2,Ue+1),this.indexArray.emplaceBack(Ue+1,Ue+2,Ue+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+C>sr.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray)),GS[e.type]!=="Polygon")continue;const M=[],O=[],B=k.vertexLength;for(let J=0;J<T.length;J++){const oe=T[J];if(oe.length!==0){oe!==T[0]&&O.push(M.length/2);for(let ce=0;ce<oe.length;ce++){const pe=oe[ce];qu(this.layoutVertexArray,pe.x,pe.y,0,0,1,1,0),M.push(pe.x),M.push(pe.y),v&&v.currentPolyCount.top++}}}const j=fp(M,O);for(let J=0;J<j.length;J+=3)this.indexArray.emplaceBack(B+j[J],B+j[J+2],B+j[J+1]);k.primitiveLength+=j.length/3,k.vertexLength+=C}var b;if(v&&v.polyCount.length>0){if(v.borders){v.vertexArrayOffset=this.centroidVertexArray.length;const T=v.borders,C=this.featuresOnBorder.push(v)-1;for(let k=0;k<4;k++)T[k][0]!==Number.MAX_VALUE&&this.borders[k].push(C)}this.encodeCentroid(v.borders?void 0:v.centroid(),v)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,p,m,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((o,l)=>this.featuresOnBorder[o].borders[e][0]-this.featuresOnBorder[l].borders[e][0])}encodeCentroid(e,o,l=!0){let u,p;if(e)if(e.y!==0){const v=o.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(v.x/10)),p=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(v.y/10))}else u=Math.ceil(7*(e.x+450)),p=0;else u=0,p=+l;let m=l?this.centroidVertexArray.length:o.vertexArrayOffset;for(const v of o.polyCount){l&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*v.edges+v.top);for(let b=0;b<2*v.edges;b++)this.centroidVertexArray.emplace(m++,0,p),this.centroidVertexArray.emplace(m++,u,p);for(let b=0;b<v.top;b++)this.centroidVertexArray.emplace(m++,u,p)}}}function qS(i,e){return i.x===e.x&&(i.x<0||i.x>qt)||i.y===e.y&&(i.y<0||i.y>qt)}at("FillExtrusionBucket",rg,{omit:["layers","features"]}),at("PartMetadata",gv);var WS={paint:new ze({"fill-extrusion-opacity":new H(_e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new le(_e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new H(_e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new H(_e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new he(_e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new le(_e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new le(_e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new H(_e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Wu(i,e){return i.x*e.x+i.y*e.y}function _v(i,e){if(i.length===1){let o=0;const l=e[o++];let u;for(;!u||l.equals(u);)if(u=e[o++],!u)return 1/0;for(;o<e.length;o++){const p=e[o],m=i[0],v=u.sub(l),b=p.sub(l),T=m.sub(l),C=Wu(v,v),k=Wu(v,b),M=Wu(b,b),O=Wu(T,v),B=Wu(T,b),j=C*M-k*k,J=(M*O-k*B)/j,oe=(C*B-k*O)/j,ce=l.z*(1-J-oe)+u.z*J+p.z*oe;if(isFinite(ce))return ce}return 1/0}{let o=1/0;for(const l of e)o=Math.min(o,l.z);return o}}function yv(i){const e=new N(i[0],i[1]);return e.z=i[2],e}function HS(i,e,o,l,u,p,m,v){const b=m*u.getElevationAt(i,e,!0,!0),T=p[0]!==0,C=T?p[1]===0?m*(p[0]/7-450):m*function(k,M,O){const B=Math.floor(M[0]/8),j=Math.floor(M[1]/8),J=10*(M[0]-8*B),oe=10*(M[1]-8*j),ce=k.getElevationAt(B,j,!0,!0),pe=k.getMeterToDEM(O),ye=Math.floor(.5*(J*pe-1)),ge=Math.floor(.5*(oe*pe-1)),ve=k.tileCoordToPixel(B,j),Re=2*ye+1,Ie=2*ge+1,et=function(tt,ot,Mt,un,xt){return[tt.getElevationAtPixel(ot,Mt,!0),tt.getElevationAtPixel(ot+xt,Mt,!0),tt.getElevationAtPixel(ot,Mt+xt,!0),tt.getElevationAtPixel(ot+un,Mt+xt,!0)]}(k,ve.x-ye,ve.y-ge,Re,Ie),Ue=Math.abs(et[0]-et[1]),Oe=Math.abs(et[2]-et[3]),je=Math.abs(et[0]-et[2])+Math.abs(et[1]-et[3]),Ve=Math.min(.25,.5*pe*(Ue+Oe)/Re),$e=Math.min(.25,.5*pe*je/Ie);return ce+Math.max(Ve*J,$e*oe)}(u,p,v):b;return{base:b+(o===0)?-1:o,top:T?Math.max(C+l,b+o+2):b+l}}const XS=Se([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:KS}=XS,YS=Se([{name:"a_packed",components:3,type:"Float32"}]),{members:JS}=YS,QS=Na.VectorTileFeature.types,eC=Math.cos(Math.PI/180*37.5);class xp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new vt,this.layoutVertexArray2=new wt,this.indexArray=new Vn,this.programConfigurations=new Oa(e.layers,e.zoom),this.segments=new sr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l,u){this.hasPattern=tg("line",this.layers,o);const p=this.layers[0].layout.get("line-sort-key"),m=[];for(const{feature:C,id:k,index:M,sourceLayerIndex:O}of e){const B=this.layers[0]._featureFilter.needGeometry,j=$a(C,B);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),j,l))continue;const J=p?p.evaluate(j,{},l):void 0,oe={id:k,properties:C.properties,type:C.type,sourceLayerIndex:O,index:M,geometry:B?j.geometry:Ko(C,l,u),patterns:{},sortKey:J};m.push(oe)}p&&m.sort((C,k)=>C.sortKey-k.sortKey);const{lineAtlas:v,featureIndex:b}=o,T=this.addConstantDashes(v);for(const C of m){const{geometry:k,index:M,sourceLayerIndex:O}=C;if(T&&this.addFeatureDashes(C,v),this.hasPattern){const B=ng("line",this.layers,C,this.zoom,o);this.patternFeatures.push(B)}else this.addFeature(C,k,M,l,v.positions,o.availableImages);b.insert(e[M].feature,k,M,O,this.index)}}addConstantDashes(e){let o=!1;for(const l of this.layers){const u=l.paint.get("line-dasharray").value,p=l.layout.get("line-cap").value;if(u.kind!=="constant"||p.kind!=="constant")o=!0;else{const m=p.value,v=u.value;if(!v)continue;e.addDash(v.from,m),e.addDash(v.to,m),v.other&&e.addDash(v.other,m)}}return o}addFeatureDashes(e,o){const l=this.zoom;for(const u of this.layers){const p=u.paint.get("line-dasharray").value,m=u.layout.get("line-cap").value;if(p.kind==="constant"&&m.kind==="constant")continue;let v,b,T,C,k,M;if(p.kind==="constant"){const J=p.value;if(!J)continue;v=J.other||J.to,b=J.to,T=J.from}else v=p.evaluate({zoom:l-1},e),b=p.evaluate({zoom:l},e),T=p.evaluate({zoom:l+1},e);m.kind==="constant"?C=k=M=m.value:(C=m.evaluate({zoom:l-1},e),k=m.evaluate({zoom:l},e),M=m.evaluate({zoom:l+1},e)),o.addDash(v,C),o.addDash(b,k),o.addDash(T,M);const O=o.getKey(v,C),B=o.getKey(b,k),j=o.getKey(T,M);e.patterns[u.id]={min:O,mid:B,max:j}}}update(e,o,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,u)}addFeatures(e,o,l,u){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,o,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,JS)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,KS),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,o,l,u,p,m){const v=this.layers[0].layout,b=v.get("line-join").evaluate(e,{}),T=v.get("line-cap").evaluate(e,{}),C=v.get("line-miter-limit"),k=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const M of o)this.addLine(M,e,b,T,C,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,p,m,u)}addLine(e,o,l,u,p,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<e.length-1;oe++)this.totalDistance+=e[oe].dist(e[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=QS[o.type]==="Polygon";let b=e.length;for(;b>=2&&e[b-1].equals(e[b-2]);)b--;let T=0;for(;T<b-1&&e[T].equals(e[T+1]);)T++;if(b<(v?3:2))return;l==="bevel"&&(p=1.05);const C=this.overscaling<=16?122880/(512*this.overscaling):0,k=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let M,O,B,j,J;this.e1=this.e2=-1,v&&(M=e[b-2],J=e[T].sub(M)._unit()._perp());for(let oe=T;oe<b;oe++){if(B=oe===b-1?v?e[T+1]:void 0:e[oe+1],B&&e[oe].equals(B))continue;J&&(j=J),M&&(O=M),M=e[oe],J=B?B.sub(M)._unit()._perp():j,j=j||J;let ce=j.add(J);ce.x===0&&ce.y===0||ce._unit();const pe=j.x*J.x+j.y*J.y,ye=ce.x*J.x+ce.y*J.y,ge=ye!==0?1/ye:1/0,ve=2*Math.sqrt(2-2*ye),Re=ye<eC&&O&&B,Ie=j.x*J.y-j.y*J.x>0;if(Re&&oe>T){const Oe=M.dist(O);if(Oe>2*C){const je=M.sub(M.sub(O)._mult(C/Oe)._round());this.updateDistance(O,je),this.addCurrentVertex(je,j,0,0,k),O=je}}const et=O&&B;let Ue=et?l:v?"butt":u;if(et&&Ue==="round"&&(ge<m?Ue="miter":ge<=2&&(Ue="fakeround")),Ue==="miter"&&ge>p&&(Ue="bevel"),Ue==="bevel"&&(ge>2&&(Ue="flipbevel"),ge<p&&(Ue="miter")),O&&this.updateDistance(O,M),Ue==="miter")ce._mult(ge),this.addCurrentVertex(M,ce,0,0,k);else if(Ue==="flipbevel"){if(ge>100)ce=J.mult(-1);else{const Oe=ge*j.add(J).mag()/j.sub(J).mag();ce._perp()._mult(Oe*(Ie?-1:1))}this.addCurrentVertex(M,ce,0,0,k),this.addCurrentVertex(M,ce.mult(-1),0,0,k)}else if(Ue==="bevel"||Ue==="fakeround"){const Oe=-Math.sqrt(ge*ge-1),je=Ie?Oe:0,Ve=Ie?0:Oe;if(O&&this.addCurrentVertex(M,j,je,Ve,k),Ue==="fakeround"){const $e=Math.round(180*ve/Math.PI/20);for(let tt=1;tt<$e;tt++){let ot=tt/$e;if(ot!==.5){const un=ot-.5;ot+=ot*un*(ot-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*un*un+(.848013+pe*(.215638*pe-1.06021)))}const Mt=J.sub(j)._mult(ot)._add(j)._unit()._mult(Ie?-1:1);this.addHalfVertex(M,Mt.x,Mt.y,!1,Ie,0,k)}}B&&this.addCurrentVertex(M,J,-je,-Ve,k)}else if(Ue==="butt")this.addCurrentVertex(M,ce,0,0,k);else if(Ue==="square"){const Oe=O?1:-1;O||this.addCurrentVertex(M,ce,Oe,Oe,k),this.addCurrentVertex(M,ce,0,0,k),O&&this.addCurrentVertex(M,ce,Oe,Oe,k)}else Ue==="round"&&(O&&(this.addCurrentVertex(M,j,0,0,k),this.addCurrentVertex(M,j,1,1,k,!0)),B&&(this.addCurrentVertex(M,J,-1,-1,k,!0),this.addCurrentVertex(M,J,0,0,k)));if(Re&&oe<b-1){const Oe=M.dist(B);if(Oe>2*C){const je=M.add(B.sub(M)._mult(C/Oe)._round());this.updateDistance(M,je),this.addCurrentVertex(je,J,0,0,k),M=je}}}}addCurrentVertex(e,o,l,u,p,m=!1){const v=o.y*u-o.x,b=-o.y-o.x*u;this.addHalfVertex(e,o.x+o.y*l,o.y-o.x*l,m,!1,l,p),this.addHalfVertex(e,v,b,m,!0,-u,p)}addHalfVertex({x:e,y:o},l,u,p,m,v,b){this.layoutVertexArray.emplaceBack((e<<1)+(p?1:0),(o<<1)+(m?1:0),Math.round(63*l)+128,Math.round(63*u)+128,1+(v===0?0:v<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const T=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),b.primitiveLength++),m?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,o){this.distance+=e.dist(o),this.updateScaledDistance()}}at("LineBucket",xp,{omit:["layers","patternFeatures"]});const tC=new ze({"line-cap":new le(_e.layout_line["line-cap"]),"line-join":new le(_e.layout_line["line-join"]),"line-miter-limit":new H(_e.layout_line["line-miter-limit"]),"line-round-limit":new H(_e.layout_line["line-round-limit"]),"line-sort-key":new le(_e.layout_line["line-sort-key"])});var vv={paint:new ze({"line-opacity":new le(_e.paint_line["line-opacity"]),"line-color":new le(_e.paint_line["line-color"]),"line-translate":new H(_e.paint_line["line-translate"]),"line-translate-anchor":new H(_e.paint_line["line-translate-anchor"]),"line-width":new le(_e.paint_line["line-width"]),"line-gap-width":new le(_e.paint_line["line-gap-width"]),"line-offset":new le(_e.paint_line["line-offset"]),"line-blur":new le(_e.paint_line["line-blur"]),"line-dasharray":new he(_e.paint_line["line-dasharray"]),"line-pattern":new he(_e.paint_line["line-pattern"]),"line-gradient":new Ce(_e.paint_line["line-gradient"])}),layout:tC};const xv=new class extends le{possiblyEvaluate(i,e){return e=new R(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(i,e)}evaluate(i,e,o,l){return e=st({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(i,e,o,l)}}(vv.paint.properties["line-width"].specification);function bv(i,e){return e>0?e+2*i:i}xv.useIntegerZoom=!0;const nC=Se([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),rC=Se([{name:"a_projected_pos",components:3,type:"Float32"}],4);Se([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const iC=Se([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),oC=Se([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Se([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const wv=Se([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),sC=Se([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Se([{name:"triangle",components:3,type:"Uint16"}]),Se([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Se([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Se([{type:"Float32",name:"offsetX"}]),Se([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var yr=24;const vo=128;function ig(i,e){const{expression:o}=e;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new R(i+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:u}=o;let p=0;for(;p<l.length&&l[p]<=i;)p++;p=Math.max(0,p-1);let m=p;for(;m<l.length&&l[m]<i+1;)m++;m=Math.min(l.length-1,m);const v=l[p],b=l[m];return o.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:b,interpolationType:u}:{kind:"camera",minZoom:v,maxZoom:b,minSize:o.evaluate(new R(v)),maxSize:o.evaluate(new R(b)),interpolationType:u}}}function bp(i,{uSize:e,uSizeT:o},{lowerSize:l,upperSize:u}){return i.kind==="source"?l/vo:i.kind==="composite"?Xt(l/vo,u/vo,o):e}function ic(i,e){let o=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:u,minZoom:p,maxZoom:m}=i,v=u?Le(jr.interpolationFactor(u,e,p,m),0,1):0;i.kind==="camera"?l=Xt(i.minSize,i.maxSize,v):o=v}return{uSizeT:o,uSize:l}}var aC=Object.freeze({__proto__:null,getSizeData:ig,evaluateSizeForFeature:bp,evaluateSizeForZoom:ic,SIZE_PACK_FACTOR:vo});function lC(i,e,o){return i.sections.forEach(l=>{l.text=function(u,p,m){const v=p.layout.get("text-transform").evaluate(m,{});return v==="uppercase"?u=u.toLocaleUpperCase():v==="lowercase"&&(u=u.toLocaleLowerCase()),z.applyArabicShaping&&(u=z.applyArabicShaping(u)),u}(l.text,e,o)}),i}const Hu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function cC(i){return i==="\uFE36"||i==="\uFE48"||i==="\uFE38"||i==="\uFE44"||i==="\uFE42"||i==="\uFE3E"||i==="\uFE3C"||i==="\uFE3A"||i==="\uFE18"||i==="\uFE40"||i==="\uFE10"||i==="\uFE13"||i==="\uFE14"||i==="\uFF40"||i==="\uFFE3"||i==="\uFE11"||i==="\uFE12"}function uC(i){return i==="\uFE35"||i==="\uFE47"||i==="\uFE37"||i==="\uFE43"||i==="\uFE41"||i==="\uFE3D"||i==="\uFE3B"||i==="\uFE39"||i==="\uFE17"||i==="\uFE3F"}var Ev=function(i,e,o,l,u){var p,m,v=8*u-l-1,b=(1<<v)-1,T=b>>1,C=-7,k=o?u-1:0,M=o?-1:1,O=i[e+k];for(k+=M,p=O&(1<<-C)-1,O>>=-C,C+=v;C>0;p=256*p+i[e+k],k+=M,C-=8);for(m=p&(1<<-C)-1,p>>=-C,C+=l;C>0;m=256*m+i[e+k],k+=M,C-=8);if(p===0)p=1-T;else{if(p===b)return m?NaN:1/0*(O?-1:1);m+=Math.pow(2,l),p-=T}return(O?-1:1)*m*Math.pow(2,p-l)},Tv=function(i,e,o,l,u,p){var m,v,b,T=8*p-u-1,C=(1<<T)-1,k=C>>1,M=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=l?0:p-1,B=l?1:-1,j=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,m=C):(m=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-m))<1&&(m--,b*=2),(e+=m+k>=1?M/b:M*Math.pow(2,1-k))*b>=2&&(m++,b/=2),m+k>=C?(v=0,m=C):m+k>=1?(v=(e*b-1)*Math.pow(2,u),m+=k):(v=e*Math.pow(2,k-1)*Math.pow(2,u),m=0));u>=8;i[o+O]=255&v,O+=B,v/=256,u-=8);for(m=m<<u|v,T+=u;T>0;i[o+O]=255&m,O+=B,m/=256,T-=8);i[o+O-B]|=128*j},Xu=ln;function ln(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}ln.Varint=0,ln.Fixed64=1,ln.Bytes=2,ln.Fixed32=5;var og=4294967296,Sv=1/og,Cv=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Yo(i){return i.type===ln.Bytes?i.readVarint()+i.pos:i.pos+1}function oc(i,e,o){return o?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function kv(i,e,o){var l=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));o.realloc(l);for(var u=o.pos-1;u>=i;u--)o.buf[u+l]=o.buf[u]}function hC(i,e){for(var o=0;o<i.length;o++)e.writeVarint(i[o])}function dC(i,e){for(var o=0;o<i.length;o++)e.writeSVarint(i[o])}function pC(i,e){for(var o=0;o<i.length;o++)e.writeFloat(i[o])}function fC(i,e){for(var o=0;o<i.length;o++)e.writeDouble(i[o])}function mC(i,e){for(var o=0;o<i.length;o++)e.writeBoolean(i[o])}function gC(i,e){for(var o=0;o<i.length;o++)e.writeFixed32(i[o])}function _C(i,e){for(var o=0;o<i.length;o++)e.writeSFixed32(i[o])}function yC(i,e){for(var o=0;o<i.length;o++)e.writeFixed64(i[o])}function vC(i,e){for(var o=0;o<i.length;o++)e.writeSFixed64(i[o])}function wp(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function sc(i,e,o){i[o]=e,i[o+1]=e>>>8,i[o+2]=e>>>16,i[o+3]=e>>>24}function Iv(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}function xC(i,e,o){e.glyphs=[],i===1&&o.readMessage(bC,e)}function bC(i,e,o){if(i===3){const{id:l,bitmap:u,width:p,height:m,left:v,top:b,advance:T}=o.readMessage(wC,{});e.glyphs.push({id:l,bitmap:new Rs({width:p+6,height:m+6},u),metrics:{width:p,height:m,left:v,top:b,advance:T}})}else i===4?e.ascender=o.readSVarint():i===5&&(e.descender=o.readSVarint())}function wC(i,e,o){i===1?e.id=o.readVarint():i===2?e.bitmap=o.readBytes():i===3?e.width=o.readVarint():i===4?e.height=o.readVarint():i===5?e.left=o.readSVarint():i===6?e.top=o.readSVarint():i===7&&(e.advance=o.readVarint())}function sg(i){let e=0,o=0;for(const m of i)e+=m.w*m.h,o=Math.max(o,m.w);i.sort((m,v)=>v.h-m.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),o),h:1/0}];let u=0,p=0;for(const m of i)for(let v=l.length-1;v>=0;v--){const b=l[v];if(!(m.w>b.w||m.h>b.h)){if(m.x=b.x,m.y=b.y,p=Math.max(p,m.y+m.h),u=Math.max(u,m.x+m.w),m.w===b.w&&m.h===b.h){const T=l.pop();v<l.length&&(l[v]=T)}else m.h===b.h?(b.x+=m.w,b.w-=m.w):m.w===b.w?(b.y+=m.h,b.h-=m.h):(l.push({x:b.x+m.w,y:b.y,w:b.w-m.w,h:m.h}),b.y+=m.h,b.h-=m.h);break}}return{w:u,h:p,fill:e/(u*p)||0}}ln.prototype={destroy:function(){this.buf=null},readFields:function(i,e,o){for(o=o||this.length;this.pos<o;){var l=this.readVarint(),u=l>>3,p=this.pos;this.type=7&l,i(u,e,this),this.pos===p&&this.skip(l)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=wp(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Iv(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=wp(this.buf,this.pos)+wp(this.buf,this.pos+4)*og;return this.pos+=8,i},readSFixed64:function(){var i=wp(this.buf,this.pos)+Iv(this.buf,this.pos+4)*og;return this.pos+=8,i},readFloat:function(){var i=Ev(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Ev(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,o,l=this.buf;return e=127&(o=l[this.pos++]),o<128?e:(e|=(127&(o=l[this.pos++]))<<7,o<128?e:(e|=(127&(o=l[this.pos++]))<<14,o<128?e:(e|=(127&(o=l[this.pos++]))<<21,o<128?e:function(u,p,m){var v,b,T=m.buf;if(v=(112&(b=T[m.pos++]))>>4,b<128||(v|=(127&(b=T[m.pos++]))<<3,b<128)||(v|=(127&(b=T[m.pos++]))<<10,b<128)||(v|=(127&(b=T[m.pos++]))<<17,b<128)||(v|=(127&(b=T[m.pos++]))<<24,b<128)||(v|=(1&(b=T[m.pos++]))<<31,b<128))return oc(u,v,p);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(o=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&Cv?function(o,l,u){return Cv.decode(o.subarray(l,u))}(this.buf,e,i):function(o,l,u){for(var p="",m=l;m<u;){var v,b,T,C=o[m],k=null,M=C>239?4:C>223?3:C>191?2:1;if(m+M>u)break;M===1?C<128&&(k=C):M===2?(192&(v=o[m+1]))==128&&(k=(31&C)<<6|63&v)<=127&&(k=null):M===3?(b=o[m+2],(192&(v=o[m+1]))==128&&(192&b)==128&&((k=(15&C)<<12|(63&v)<<6|63&b)<=2047||k>=55296&&k<=57343)&&(k=null)):M===4&&(b=o[m+2],T=o[m+3],(192&(v=o[m+1]))==128&&(192&b)==128&&(192&T)==128&&((k=(15&C)<<18|(63&v)<<12|(63&b)<<6|63&T)<=65535||k>=1114112)&&(k=null)),k===null?(k=65533,M=1):k>65535&&(k-=65536,p+=String.fromCharCode(k>>>10&1023|55296),k=56320|1023&k),p+=String.fromCharCode(k),m+=M}return p}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==ln.Bytes)return i.push(this.readVarint(e));var o=Yo(this);for(i=i||[];this.pos<o;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==ln.Bytes)return i.push(this.readSVarint());var e=Yo(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==ln.Bytes)return i.push(this.readBoolean());var e=Yo(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==ln.Bytes)return i.push(this.readFloat());var e=Yo(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==ln.Bytes)return i.push(this.readDouble());var e=Yo(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==ln.Bytes)return i.push(this.readFixed32());var e=Yo(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==ln.Bytes)return i.push(this.readSFixed32());var e=Yo(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==ln.Bytes)return i.push(this.readFixed64());var e=Yo(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==ln.Bytes)return i.push(this.readSFixed64());var e=Yo(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===ln.Varint)for(;this.buf[this.pos++]>127;);else if(e===ln.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ln.Fixed32)this.pos+=4;else{if(e!==ln.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var o=new Uint8Array(e);o.set(this.buf),this.buf=o,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),sc(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),sc(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),sc(this.buf,-1&i,this.pos),sc(this.buf,Math.floor(i*Sv),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),sc(this.buf,-1&i,this.pos),sc(this.buf,Math.floor(i*Sv),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,o){var l,u;if(e>=0?(l=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(l=~(-e%4294967296))?l=l+1|0:(l=0,u=u+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(p,m,v){v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,v.buf[v.pos]=127&(p>>>=7)}(l,0,o),function(p,m){var v=(7&p)<<4;m.buf[m.pos++]|=v|((p>>>=3)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p)))))}(u,o)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(l,u,p){for(var m,v,b=0;b<u.length;b++){if((m=u.charCodeAt(b))>55295&&m<57344){if(!v){m>56319||b+1===u.length?(l[p++]=239,l[p++]=191,l[p++]=189):v=m;continue}if(m<56320){l[p++]=239,l[p++]=191,l[p++]=189,v=m;continue}m=v-55296<<10|m-56320|65536,v=null}else v&&(l[p++]=239,l[p++]=191,l[p++]=189,v=null);m<128?l[p++]=m:(m<2048?l[p++]=m>>6|192:(m<65536?l[p++]=m>>12|224:(l[p++]=m>>18|240,l[p++]=m>>12&63|128),l[p++]=m>>6&63|128),l[p++]=63&m|128)}return p}(this.buf,i,this.pos);var o=this.pos-e;o>=128&&kv(e,o,this),this.pos=e-1,this.writeVarint(o),this.pos+=o},writeFloat:function(i){this.realloc(4),Tv(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Tv(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var o=0;o<e;o++)this.buf[this.pos++]=i[o]},writeRawMessage:function(i,e){this.pos++;var o=this.pos;i(e,this);var l=this.pos-o;l>=128&&kv(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,e,o){this.writeTag(i,ln.Bytes),this.writeRawMessage(e,o)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,hC,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,dC,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,mC,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,pC,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,fC,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,gC,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,_C,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,yC,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,vC,e)},writeBytesField:function(i,e){this.writeTag(i,ln.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,ln.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,ln.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,ln.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,ln.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,ln.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,ln.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,ln.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,ln.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,ln.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,Boolean(e))}};class ag{constructor(e,{pixelRatio:o,version:l,stretchX:u,stretchY:p,content:m}){this.paddedRect=e,this.pixelRatio=o,this.stretchX=u,this.stretchY=p,this.content=m,this.version=l}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Av{constructor(e,o){const l={},u={};this.haveRenderCallbacks=[];const p=[];this.addImages(e,l,p),this.addImages(o,u,p);const{w:m,h:v}=sg(p),b=new yi({width:m||1,height:v||1});for(const T in e){const C=e[T],k=l[T].paddedRect;yi.copy(C.data,b,{x:0,y:0},{x:k.x+1,y:k.y+1},C.data)}for(const T in o){const C=o[T],k=u[T].paddedRect,M=k.x+1,O=k.y+1,B=C.data.width,j=C.data.height;yi.copy(C.data,b,{x:0,y:0},{x:M,y:O},C.data),yi.copy(C.data,b,{x:0,y:j-1},{x:M,y:O-1},{width:B,height:1}),yi.copy(C.data,b,{x:0,y:0},{x:M,y:O+j},{width:B,height:1}),yi.copy(C.data,b,{x:B-1,y:0},{x:M-1,y:O},{width:1,height:j}),yi.copy(C.data,b,{x:0,y:0},{x:M+B,y:O},{width:1,height:j})}this.image=b,this.iconPositions=l,this.patternPositions=u}addImages(e,o,l){for(const u in e){const p=e[u],m={x:0,y:0,w:p.data.width+2,h:p.data.height+2};l.push(m),o[u]=new ag(m,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,o){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in e.updatedImages)this.patchUpdatedImage(this.iconPositions[l],e.getImage(l),o),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l),o)}patchUpdatedImage(e,o,l){if(!e||!o||e.version===o.version)return;e.version=o.version;const[u,p]=e.tl;l.update(o.data,void 0,{x:u,y:p})}}at("ImagePosition",ag),at("ImageAtlas",Av);const vi={horizontal:1,vertical:2,horizontalOnly:3};class Ku{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,o){const l=new Ku;return l.scale=e||1,l.fontStack=o,l}static forImage(e){const o=new Ku;return o.imageName=e,o}}class ac{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,o){const l=new ac;for(let u=0;u<e.sections.length;u++){const p=e.sections[u];p.image?l.addImageSection(p):l.addTextSection(p,o)}return l}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(o,l){let u="";for(let p=0;p<o.length;p++){const m=o.charCodeAt(p+1)||null,v=o.charCodeAt(p-1)||null;u+=!l&&(m&&Bu(m)&&!Hu[o[p+1]]||v&&Bu(v)&&!Hu[o[p-1]])||!Hu[o[p]]?o[p]:Hu[o[p]]}return u}(this.text,e)}trim(){let e=0;for(let l=0;l<this.text.length&&Ep[this.text.charCodeAt(l)];l++)e++;let o=this.text.length;for(let l=this.text.length-1;l>=0&&l>=e&&Ep[this.text.charCodeAt(l)];l--)o--;this.text=this.text.substring(e,o),this.sectionIndex=this.sectionIndex.slice(e,o)}substring(e,o){const l=new ac;return l.text=this.text.substring(e,o),l.sectionIndex=this.sectionIndex.slice(e,o),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,o)=>Math.max(e,this.sections[o].scale),0)}addTextSection(e,o){this.text+=e.text,this.sections.push(Ku.forText(e.scale,e.fontStack||o));const l=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(l)}addImageSection(e){const o=e.image?e.image.name:"";if(o.length===0)return void dt("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Ku.forImage(o)),this.sectionIndex.push(this.sections.length-1)):dt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function lg(i,e,o,l,u,p,m,v,b,T,C,k,M,O,B,j){const J=ac.fromFeature(i,u);let oe;k===vi.vertical&&J.verticalizePunctuation(M);const{processBidirectionalText:ce,processStyledBidirectionalText:pe}=z;if(ce&&J.sections.length===1){oe=[];const ve=ce(J.toString(),cg(J,T,p,e,l,O,B));for(const Re of ve){const Ie=new ac;Ie.text=Re,Ie.sections=J.sections;for(let et=0;et<Re.length;et++)Ie.sectionIndex.push(0);oe.push(Ie)}}else if(pe){oe=[];const ve=pe(J.text,J.sectionIndex,cg(J,T,p,e,l,O,B));for(const Re of ve){const Ie=new ac;Ie.text=Re[0],Ie.sectionIndex=Re[1],Ie.sections=J.sections,oe.push(Ie)}}else oe=function(ve,Re){const Ie=[],et=ve.text;let Ue=0;for(const Oe of Re)Ie.push(ve.substring(Ue,Oe)),Ue=Oe;return Ue<et.length&&Ie.push(ve.substring(Ue,et.length)),Ie}(J,cg(J,T,p,e,l,O,B));const ye=[],ge={positionedLines:ye,text:J.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:k,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ve,Re,Ie,et,Ue,Oe,je,Ve,$e,tt,ot,Mt){let un=0,xt=0,en=0;const nt=Ve==="right"?1:Ve==="left"?0:.5;let hn=!1;for(const sn of Ue){const tn=sn.getSections();for(const bn of tn){if(bn.imageName)continue;const vr=Re[bn.fontStack];if(vr&&(hn=vr.ascender!==void 0&&vr.descender!==void 0,!hn))break}if(!hn)break}let Yt=0;for(const sn of Ue){sn.trim();const tn=sn.getMaxScale(),bn=(tn-1)*yr,vr={positionedGlyphs:[],lineOffset:0};ve.positionedLines[Yt]=vr;const qn=vr.positionedGlyphs;let nr=0;if(!sn.length()){xt+=Oe,++Yt;continue}let xr=0,Tn=0;for(let dn=0;dn<sn.length();dn++){const Wn=sn.getSection(dn),Hn=sn.getSectionIndex(dn),Bn=sn.getCharCode(dn);let Pn=Wn.scale,Jn=null,pn=null,Sr=null,Xi=yr,xi=0;const Mi=!($e===vi.horizontal||!ot&&!Ou(Bn)||ot&&(Ep[Bn]||(Gn=Bn,Wd(Gn)||Hd(Gn)||Xd(Gn)||mo(Gn)||Ru(Gn))));if(Wn.imageName){const bi=et[Wn.imageName];if(!bi)continue;Sr=Wn.imageName,ve.iconsInText=ve.iconsInText||!0,pn=bi.paddedRect;const Cr=bi.displaySize;Pn=Pn*yr/Mt,Jn={width:Cr[0],height:Cr[1],left:1,top:-3,advance:Mi?Cr[1]:Cr[0],localGlyph:!1},xi=hn?-Jn.height*Pn:tn*yr-17-Cr[1]*Pn,Xi=Jn.advance;const Jo=(Mi?Cr[0]:Cr[1])*Pn-yr*tn;Jo>0&&Jo>nr&&(nr=Jo)}else{const bi=Ie[Wn.fontStack];if(!bi)continue;bi[Bn]&&(pn=bi[Bn]);const Cr=Re[Wn.fontStack];if(!Cr)continue;const Jo=Cr.glyphs[Bn];if(!Jo)continue;if(Jn=Jo.metrics,Xi=Bn!==8203?yr:0,hn){const dc=Cr.ascender!==void 0?Math.abs(Cr.ascender):0,pc=Cr.descender!==void 0?Math.abs(Cr.descender):0,fc=(dc+pc)*Pn;xr<fc&&(xr=fc,Tn=(dc-pc)/2*Pn),xi=-dc*Pn}else xi=(tn-Pn)*yr-17}Mi?(ve.verticalizable=!0,qn.push({glyph:Bn,imageName:Sr,x:un,y:xt+xi,vertical:Mi,scale:Pn,localGlyph:Jn.localGlyph,fontStack:Wn.fontStack,sectionIndex:Hn,metrics:Jn,rect:pn}),un+=Xi*Pn+tt):(qn.push({glyph:Bn,imageName:Sr,x:un,y:xt+xi,vertical:Mi,scale:Pn,localGlyph:Jn.localGlyph,fontStack:Wn.fontStack,sectionIndex:Hn,metrics:Jn,rect:pn}),un+=Jn.advance*Pn+tt)}qn.length!==0&&(en=Math.max(un-tt,en),hn?Rv(qn,nt,nr,Tn,Oe*tn/2):Rv(qn,nt,nr,0,Oe/2)),un=0;const Zr=Oe*tn+nr;vr.lineOffset=Math.max(nr,bn),xt+=Zr,++Yt}var Gn;const Zn=xt,{horizontalAlign:Yn,verticalAlign:ar}=ug(je);(function(sn,tn,bn,vr,qn,nr){const xr=(tn-bn)*qn,Tn=-nr*vr;for(const Zr of sn)for(const dn of Zr.positionedGlyphs)dn.x+=xr,dn.y+=Tn})(ve.positionedLines,nt,Yn,ar,en,Zn),ve.top+=-ar*Zn,ve.bottom=ve.top+Zn,ve.left+=-Yn*en,ve.right=ve.left+en,ve.hasBaseline=hn}(ge,e,o,l,oe,m,v,b,k,T,M,j),!function(ve){for(const Re of ve)if(Re.positionedGlyphs.length!==0)return!1;return!0}(ye)&&ge}const Ep={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},EC={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Mv(i,e,o,l,u,p){if(e.imageName){const m=l[e.imageName];return m?m.displaySize[0]*e.scale*yr/p+u:0}{const m=o[e.fontStack],v=m&&m.glyphs[i];return v?v.metrics.advance*e.scale+u:0}}function Pv(i,e,o,l){const u=Math.pow(i-e,2);return l?i<e?u/2:2*u:u+Math.abs(o)*o}function TC(i,e,o){let l=0;return i===10&&(l-=1e4),o&&(l+=150),i!==40&&i!==65288||(l+=50),e!==41&&e!==65289||(l+=50),l}function zv(i,e,o,l,u,p){let m=null,v=Pv(e,o,u,p);for(const b of l){const T=Pv(e-b.x,o,u,p)+b.badness;T<=v&&(m=b,v=T)}return{index:i,x:e,priorBreak:m,badness:v}}function Dv(i){return i?Dv(i.priorBreak).concat(i.index):[]}function cg(i,e,o,l,u,p,m){if(p!=="point")return[];if(!i)return[];const v=[],b=function(M,O,B,j,J,oe){let ce=0;for(let pe=0;pe<M.length();pe++){const ye=M.getSection(pe);ce+=Mv(M.getCharCode(pe),ye,j,J,O,oe)}return ce/Math.max(1,Math.ceil(ce/B))}(i,e,o,l,u,m),T=i.text.indexOf("\u200B")>=0;let C=0;for(let M=0;M<i.length();M++){const O=i.getSection(M),B=i.getCharCode(M);if(Ep[B]||(C+=Mv(B,O,l,u,e,m)),M<i.length()-1){const j=!((k=B)<11904||!(Jd(k)||Au(k)||za(k)||tp(k)||Du(k)||Kd(k)||Mu(k)||ql(k)||Hl(k)||Ma(k)||zu(k)||Lu(k)||Is(k)||Yd(k)||Aa(k)||Pu(k)||Wl(k)||np(k)||ep(k)||Qd(k)));(EC[B]||j||O.imageName)&&v.push(zv(M+1,C,b,v,TC(B,i.getCharCode(M+1),j&&T),!1))}}var k;return Dv(zv(i.length(),C,b,v,0,!0))}function ug(i){let e=.5,o=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:e,verticalAlign:o}}function Rv(i,e,o,l,u){if(!(e||o||l||u))return;const p=i.length-1,m=i[p],v=(m.x+m.metrics.advance*m.scale)*e;for(let b=0;b<=p;b++)i[b].x-=v,i[b].y+=o+l+u}function SC(i,e,o){const{horizontalAlign:l,verticalAlign:u}=ug(o),p=e[0]-i.displaySize[0]*l,m=e[1]-i.displaySize[1]*u;return{image:i,top:m,bottom:m+i.displaySize[1],left:p,right:p+i.displaySize[0]}}function Lv(i,e,o,l,u,p){const m=i.image;let v;if(m.content){const J=m.content,oe=m.pixelRatio||1;v=[J[0]/oe,J[1]/oe,m.displaySize[0]-J[2]/oe,m.displaySize[1]-J[3]/oe]}const b=e.left*p,T=e.right*p;let C,k,M,O;o==="width"||o==="both"?(O=u[0]+b-l[3],k=u[0]+T+l[1]):(O=u[0]+(b+T-m.displaySize[0])/2,k=O+m.displaySize[0]);const B=e.top*p,j=e.bottom*p;return o==="height"||o==="both"?(C=u[1]+B-l[0],M=u[1]+j+l[2]):(C=u[1]+(B+j-m.displaySize[1])/2,M=C+m.displaySize[1]),{image:m,top:C,right:k,bottom:M,left:O,collisionPadding:v}}class Os extends N{constructor(e,o,l,u,p){super(e,o),this.angle=u,this.z=l,p!==void 0&&(this.segment=p)}clone(){return new Os(this.x,this.y,this.z,this.angle,this.segment)}}function Ov(i,e,o,l,u){if(e.segment===void 0)return!0;let p=e,m=e.segment+1,v=0;for(;v>-o/2;){if(m--,m<0)return!1;v-=i[m].dist(p),p=i[m]}v+=i[m].dist(i[m+1]),m++;const b=[];let T=0;for(;v<o/2;){const C=i[m],k=i[m+1];if(!k)return!1;let M=i[m-1].angleTo(C)-C.angleTo(k);for(M=Math.abs((M+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:v,angleDelta:M}),T+=M;v-b[0].distance>l;)T-=b.shift().angleDelta;if(T>u)return!1;m++,v+=C.dist(k)}return!0}function Bv(i){let e=0;for(let o=0;o<i.length-1;o++)e+=i[o].dist(i[o+1]);return e}function Fv(i,e,o){return i?.6*e*o:0}function $v(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function CC(i,e,o,l,u,p){const m=Fv(o,u,p),v=$v(o,l)*p;let b=0;const T=Bv(i)/2;for(let C=0;C<i.length-1;C++){const k=i[C],M=i[C+1],O=k.dist(M);if(b+O>T){const B=(T-b)/O,j=Xt(k.x,M.x,B),J=Xt(k.y,M.y,B),oe=new Os(j,J,0,M.angleTo(k),C);return!m||Ov(i,oe,v,m,e)?oe:void 0}b+=O}}function kC(i,e,o,l,u,p,m,v,b){const T=Fv(l,p,m),C=$v(l,u),k=C*m,M=i[0].x===0||i[0].x===b||i[0].y===0||i[0].y===b;return e-k<e/4&&(e=k+e/4),Nv(i,M?e/2*v%e:(C/2+2*p)*m*v%e,e,T,o,k,M,!1,b)}function Nv(i,e,o,l,u,p,m,v,b){const T=p/2,C=Bv(i);let k=0,M=e-o,O=[];for(let B=0;B<i.length-1;B++){const j=i[B],J=i[B+1],oe=j.dist(J),ce=J.angleTo(j);for(;M+o<k+oe;){M+=o;const pe=(M-k)/oe,ye=Xt(j.x,J.x,pe),ge=Xt(j.y,J.y,pe);if(ye>=0&&ye<b&&ge>=0&&ge<b&&M-T>=0&&M+T<=C){const ve=new Os(ye,ge,0,ce,B);ve._round(),l&&!Ov(i,ve,p,l,u)||O.push(ve)}}k+=oe}return v||O.length||m||(O=Nv(i,k/2,o,l,u,p,m,!0,b)),O}function Uv(i,e,o,l,u){const p=[];for(let m=0;m<i.length;m++){const v=i[m];let b;for(let T=0;T<v.length-1;T++){let C=v[T],k=v[T+1];C.x<e&&k.x<e||(C.x<e?C=new N(e,C.y+(e-C.x)/(k.x-C.x)*(k.y-C.y))._round():k.x<e&&(k=new N(e,C.y+(e-C.x)/(k.x-C.x)*(k.y-C.y))._round()),C.y<o&&k.y<o||(C.y<o?C=new N(C.x+(o-C.y)/(k.y-C.y)*(k.x-C.x),o)._round():k.y<o&&(k=new N(C.x+(o-C.y)/(k.y-C.y)*(k.x-C.x),o)._round()),C.x>=l&&k.x>=l||(C.x>=l?C=new N(l,C.y+(l-C.x)/(k.x-C.x)*(k.y-C.y))._round():k.x>=l&&(k=new N(l,C.y+(l-C.x)/(k.x-C.x)*(k.y-C.y))._round()),C.y>=u&&k.y>=u||(C.y>=u?C=new N(C.x+(u-C.y)/(k.y-C.y)*(k.x-C.x),u)._round():k.y>=u&&(k=new N(C.x+(u-C.y)/(k.y-C.y)*(k.x-C.x),u)._round()),b&&C.equals(b[b.length-1])||(b=[C],p.push(b)),b.push(k)))))}}return p}at("Anchor",Os);const Yu=1e20;function jv(i,e,o,l,u,p,m,v,b){for(let T=e;T<e+l;T++)Vv(i,o*p+T,p,u,m,v,b);for(let T=o;T<o+u;T++)Vv(i,T*p+e,1,l,m,v,b)}function Vv(i,e,o,l,u,p,m){p[0]=0,m[0]=-Yu,m[1]=Yu,u[0]=i[e];for(let v=1,b=0,T=0;v<l;v++){u[v]=i[e+v*o];const C=v*v;do{const k=p[b];T=(u[v]-u[k]+C-k*k)/(v-k)/2}while(T<=m[b]&&--b>-1);b++,p[b]=v,m[b]=T,m[b+1]=Yu}for(let v=0,b=0;v<l;v++){for(;m[b+1]<v;)b++;const T=p[b],C=v-T;i[e+v*o]=u[T]+C*C}}const hg={none:0,ideographs:1,all:2};class lc{constructor(e,o,l){this.requestManager=e,this.localGlyphMode=o,this.localFontFamily=l,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,o){const l=[];for(const u in e)for(const p of e[u])l.push({stack:u,id:p});Ye(l,({stack:u,id:p},m)=>{let v=this.entries[u];v||(v=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let b=v.glyphs[p];if(b!==void 0)return void m(null,{stack:u,id:p,glyph:b});if(b=this._tinySDF(v,u,p),b)return v.glyphs[p]=b,void m(null,{stack:u,id:p,glyph:b});const T=Math.floor(p/256);if(256*T>65535)return void m(new Error("glyphs > 65535 not supported"));if(v.ranges[T])return void m(null,{stack:u,id:p,glyph:b});let C=v.requests[T];C||(C=v.requests[T]=[],lc.loadGlyphRange(u,T,this.url,this.requestManager,(k,M)=>{if(M){v.ascender=M.ascender,v.descender=M.descender;for(const O in M.glyphs)this._doesCharSupportLocalGlyph(+O)||(v.glyphs[+O]=M.glyphs[+O]);v.ranges[T]=!0}for(const O of C)O(k,M);delete v.requests[T]})),C.push((k,M)=>{k?m(k):M&&m(null,{stack:u,id:p,glyph:M.glyphs[p]||null})})},(u,p)=>{if(u)o(u);else if(p){const m={};for(const{stack:v,id:b,glyph:T}of p)m[v]===void 0&&(m[v]={}),m[v].glyphs===void 0&&(m[v].glyphs={}),m[v].glyphs[b]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics},m[v].ascender=this.entries[v].ascender,m[v].descender=this.entries[v].descender;o(null,m)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==hg.none&&(this.localGlyphMode===hg.all?!!this.localFontFamily:!!this.localFontFamily&&(Ma(e)||Pa(e)||Is(e)||Wl(e))||ql(e))}_tinySDF(e,o,l){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let p=e.tinySDF;if(!p){let j="400";/bold/i.test(o)?j="900":/medium/i.test(o)?j="500":/light/i.test(o)&&(j="200"),p=e.tinySDF=new lc.TinySDF({fontFamily:u,fontWeight:j,fontSize:48,buffer:6,radius:16}),p.fontWeight=j}if(this.localGlyphs[p.fontWeight][l])return this.localGlyphs[p.fontWeight][l];const m=String.fromCharCode(l),{data:v,width:b,height:T,glyphWidth:C,glyphHeight:k,glyphLeft:M,glyphTop:O,glyphAdvance:B}=p.draw(m);return this.localGlyphs[p.fontWeight][l]={id:l,bitmap:new Rs({width:b,height:T},v),metrics:{width:C/2,height:k/2,left:M/2,top:O/2-27,advance:B/2,localGlyph:!0}}}}function Gv(i,e,o,l){const u=[],p=i.image,m=p.pixelRatio,v=p.paddedRect.w-2,b=p.paddedRect.h-2,T=i.right-i.left,C=i.bottom-i.top,k=p.stretchX||[[0,v]],M=p.stretchY||[[0,b]],O=(Oe,je)=>Oe+je[1]-je[0],B=k.reduce(O,0),j=M.reduce(O,0),J=v-B,oe=b-j;let ce=0,pe=B,ye=0,ge=j,ve=0,Re=J,Ie=0,et=oe;if(p.content&&l){const Oe=p.content;ce=Tp(k,0,Oe[0]),ye=Tp(M,0,Oe[1]),pe=Tp(k,Oe[0],Oe[2]),ge=Tp(M,Oe[1],Oe[3]),ve=Oe[0]-ce,Ie=Oe[1]-ye,Re=Oe[2]-Oe[0]-pe,et=Oe[3]-Oe[1]-ge}const Ue=(Oe,je,Ve,$e)=>{const tt=Sp(Oe.stretch-ce,pe,T,i.left),ot=Cp(Oe.fixed-ve,Re,Oe.stretch,B),Mt=Sp(je.stretch-ye,ge,C,i.top),un=Cp(je.fixed-Ie,et,je.stretch,j),xt=Sp(Ve.stretch-ce,pe,T,i.left),en=Cp(Ve.fixed-ve,Re,Ve.stretch,B),nt=Sp($e.stretch-ye,ge,C,i.top),hn=Cp($e.fixed-Ie,et,$e.stretch,j),Yt=new N(tt,Mt),Gn=new N(xt,Mt),Zn=new N(xt,nt),Yn=new N(tt,nt),ar=new N(ot/m,un/m),sn=new N(en/m,hn/m),tn=e*Math.PI/180;if(tn){const qn=Math.sin(tn),nr=Math.cos(tn),xr=[nr,-qn,qn,nr];Yt._matMult(xr),Gn._matMult(xr),Yn._matMult(xr),Zn._matMult(xr)}const bn=Oe.stretch+Oe.fixed,vr=je.stretch+je.fixed;return{tl:Yt,tr:Gn,bl:Yn,br:Zn,tex:{x:p.paddedRect.x+1+bn,y:p.paddedRect.y+1+vr,w:Ve.stretch+Ve.fixed-bn,h:$e.stretch+$e.fixed-vr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ar,pixelOffsetBR:sn,minFontScaleX:Re/m/T,minFontScaleY:et/m/C,isSDF:o}};if(l&&(p.stretchX||p.stretchY)){const Oe=Zv(k,J,B),je=Zv(M,oe,j);for(let Ve=0;Ve<Oe.length-1;Ve++){const $e=Oe[Ve],tt=Oe[Ve+1];for(let ot=0;ot<je.length-1;ot++)u.push(Ue($e,je[ot],tt,je[ot+1]))}}else u.push(Ue({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:b+1}));return u}function Tp(i,e,o){let l=0;for(const u of i)l+=Math.max(e,Math.min(o,u[1]))-Math.max(e,Math.min(o,u[0]));return l}function Zv(i,e,o){const l=[{fixed:-1,stretch:0}];for(const[u,p]of i){const m=l[l.length-1];l.push({fixed:u-m.stretch,stretch:m.stretch}),l.push({fixed:u-m.stretch,stretch:m.stretch+(p-u)})}return l.push({fixed:e+1,stretch:o}),l}function Sp(i,e,o,l){return i/e*o+l}function Cp(i,e,o,l){return i-e*o/l}function IC(i,e,o,l){const u=e+i.positionedLines[l].lineOffset;return l===0?o+u/2:o+(u+(e+i.positionedLines[l-1].lineOffset))/2}lc.loadGlyphRange=function(i,e,o,l,u){const p=256*e,m=p+255,v=l.transformRequest(l.normalizeGlyphsURL(o).replace("{fontstack}",i).replace("{range}",`${p}-${m}`),Lo.Glyphs);$(v,(b,T)=>{if(b)u(b);else if(T){const C={},k=function(M){return new Xu(M).readFields(xC,{})}(T);for(const M of k.glyphs)C[M.id]=M;u(null,{glyphs:C,ascender:k.ascender,descender:k.descender})}})},lc.TinySDF=class{constructor({fontSize:i=24,buffer:e=3,radius:o=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:p="normal",fontStyle:m="normal"}){this.buffer=e,this.cutoff=l,this.radius=o;const v=this.size=i+4*e,b=this._createCanvas(v),T=this.ctx=b.getContext("2d",{willReadFrequently:!0});T.font=`${m} ${p} ${i}px ${u}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}_createCanvas(i){const e=document.createElement("canvas");return e.width=e.height=i,e}draw(i){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:p}=this.ctx.measureText(i),m=Math.floor(o),v=Math.min(this.size-this.buffer,Math.ceil(p-u)),b=Math.min(this.size-this.buffer,Math.ceil(o)+Math.ceil(l)),T=v+2*this.buffer,C=b+2*this.buffer,k=T*C,M=new Uint8ClampedArray(k),O={data:M,width:T,height:C,glyphWidth:v,glyphHeight:b,glyphTop:m,glyphLeft:0,glyphAdvance:e};if(v===0||b===0)return O;const{ctx:B,buffer:j,gridInner:J,gridOuter:oe}=this;B.clearRect(j,j,v,b),B.fillText(i,j,j+m+1);const ce=B.getImageData(j,j,v,b);oe.fill(Yu,0,k),J.fill(0,0,k);for(let pe=0;pe<b;pe++)for(let ye=0;ye<v;ye++){const ge=ce.data[4*(pe*v+ye)+3]/255;if(ge===0)continue;const ve=(pe+j)*T+ye+j;if(ge===1)oe[ve]=0,J[ve]=Yu;else{const Re=.5-ge;oe[ve]=Re>0?Re*Re:0,J[ve]=Re<0?Re*Re:0}}jv(oe,0,0,T,C,T,this.f,this.v,this.z),jv(J,j,j,v,b,T,this.f,this.v,this.z);for(let pe=0;pe<k;pe++){const ye=Math.sqrt(oe[pe])-Math.sqrt(J[pe]);M[pe]=Math.round(255-255*(ye/this.radius+this.cutoff))}return O}};class AC{constructor(e=[],o=MC){if(this.data=e,this.length=this.data.length,this.compare=o,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:o,compare:l}=this,u=o[e];for(;e>0;){const p=e-1>>1,m=o[p];if(l(u,m)>=0)break;o[e]=m,e=p}o[e]=u}_down(e){const{data:o,compare:l}=this,u=this.length>>1,p=o[e];for(;e<u;){let m=1+(e<<1),v=o[m];const b=m+1;if(b<this.length&&l(o[b],v)<0&&(m=b,v=o[b]),l(v,p)>=0)break;o[e]=v,e=m}o[e]=p}}function MC(i,e){return i<e?-1:i>e?1:0}function PC(i,e=1,o=!1){let l=1/0,u=1/0,p=-1/0,m=-1/0;const v=i[0];for(let O=0;O<v.length;O++){const B=v[O];(!O||B.x<l)&&(l=B.x),(!O||B.y<u)&&(u=B.y),(!O||B.x>p)&&(p=B.x),(!O||B.y>m)&&(m=B.y)}const b=Math.min(p-l,m-u);let T=b/2;const C=new AC([],zC);if(b===0)return new N(l,u);for(let O=l;O<p;O+=b)for(let B=u;B<m;B+=b)C.push(new cc(O+T,B+T,T,i));let k=function(O){let B=0,j=0,J=0;const oe=O[0];for(let ce=0,pe=oe.length,ye=pe-1;ce<pe;ye=ce++){const ge=oe[ce],ve=oe[ye],Re=ge.x*ve.y-ve.x*ge.y;j+=(ge.x+ve.x)*Re,J+=(ge.y+ve.y)*Re,B+=3*Re}return new cc(j/B,J/B,0,O)}(i),M=C.length;for(;C.length;){const O=C.pop();(O.d>k.d||!k.d)&&(k=O,o&&console.log("found best %d after %d probes",Math.round(1e4*O.d)/1e4,M)),O.max-k.d<=e||(T=O.h/2,C.push(new cc(O.p.x-T,O.p.y-T,T,i)),C.push(new cc(O.p.x+T,O.p.y-T,T,i)),C.push(new cc(O.p.x-T,O.p.y+T,T,i)),C.push(new cc(O.p.x+T,O.p.y+T,T,i)),M+=4)}return o&&(console.log(`num probes: ${M}`),console.log(`best distance: ${k.d}`)),k.p}function zC(i,e){return e.max-i.max}function cc(i,e,o,l){this.p=new N(i,e),this.h=o,this.d=function(u,p){let m=!1,v=1/0;for(let b=0;b<p.length;b++){const T=p[b];for(let C=0,k=T.length,M=k-1;C<k;M=C++){const O=T[C],B=T[M];O.y>u.y!=B.y>u.y&&u.x<(B.x-O.x)*(u.y-O.y)/(B.y-O.y)+O.x&&(m=!m),v=Math.min(v,j0(u,O,B))}}return(m?1:-1)*Math.sqrt(v)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}const dg=Number.POSITIVE_INFINITY,DC=Math.sqrt(2);function qv(i,e){return e[1]!==dg?function(o,l,u){let p=0,m=0;switch(l=Math.abs(l),u=Math.abs(u),o){case"top-right":case"top-left":case"top":m=u-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-u}switch(o){case"top-right":case"bottom-right":case"right":p=-l;break;case"top-left":case"bottom-left":case"left":p=l}return[p,m]}(i,e[0],e[1]):function(o,l){let u=0,p=0;l<0&&(l=0);const m=l/DC;switch(o){case"top-right":case"top-left":p=m-7;break;case"bottom-right":case"bottom-left":p=7-m;break;case"bottom":p=7-l;break;case"top":p=l-7}switch(o){case"top-right":case"bottom-right":u=-m;break;case"top-left":case"bottom-left":u=m;break;case"left":u=l;break;case"right":u=-l}return[u,p]}(i,e[0])}function RC(i,e,o,l,u,p,m,v,b){i.createArrays(),i.tilePixelRatio=qt/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const T=i.layers[0].layout,C=i.layers[0]._unevaluatedLayout._values,k={};if(i.textSizeData.kind==="composite"){const{minZoom:B,maxZoom:j}=i.textSizeData;k.compositeTextSizes=[C["text-size"].possiblyEvaluate(new R(B),v),C["text-size"].possiblyEvaluate(new R(j),v)]}if(i.iconSizeData.kind==="composite"){const{minZoom:B,maxZoom:j}=i.iconSizeData;k.compositeIconSizes=[C["icon-size"].possiblyEvaluate(new R(B),v),C["icon-size"].possiblyEvaluate(new R(j),v)]}k.layoutTextSize=C["text-size"].possiblyEvaluate(new R(b+1),v),k.layoutIconSize=C["icon-size"].possiblyEvaluate(new R(b+1),v),k.textMaxSize=C["text-size"].possiblyEvaluate(new R(18),v);const M=T.get("text-rotation-alignment")==="map"&&T.get("symbol-placement")!=="point",O=T.get("text-size");for(const B of i.features){const j=T.get("text-font").evaluate(B,{},v).join(","),J=O.evaluate(B,{},v),oe=k.layoutTextSize.evaluate(B,{},v),ce=(k.layoutIconSize.evaluate(B,{},v),{horizontal:{},vertical:void 0}),pe=B.text;let ye,ge=[0,0];if(pe){const Ie=pe.toString(),et=T.get("text-letter-spacing").evaluate(B,{},v)*yr,Ue=T.get("text-line-height").evaluate(B,{},v)*yr,Oe=Xl(Ie)?et:0,je=T.get("text-anchor").evaluate(B,{},v),Ve=T.get("text-variable-anchor");if(!Ve){const xt=T.get("text-radial-offset").evaluate(B,{},v);ge=xt?qv(je,[xt*yr,dg]):T.get("text-offset").evaluate(B,{},v).map(en=>en*yr)}let $e=M?"center":T.get("text-justify").evaluate(B,{},v);const tt=T.get("symbol-placement"),ot=tt==="point",Mt=tt==="point"?T.get("text-max-width").evaluate(B,{},v)*yr:0,un=xt=>{i.allowVerticalPlacement&&go(Ie)&&(ce.vertical=lg(pe,e,o,u,j,Mt,Ue,je,xt,Oe,ge,vi.vertical,!0,tt,oe,J))};if(!M&&Ve){const xt=$e==="auto"?Ve.map(nt=>pg(nt)):[$e];let en=!1;for(let nt=0;nt<xt.length;nt++){const hn=xt[nt];if(!ce.horizontal[hn])if(en)ce.horizontal[hn]=ce.horizontal[0];else{const Yt=lg(pe,e,o,u,j,Mt,Ue,"center",hn,Oe,ge,vi.horizontal,!1,tt,oe,J);Yt&&(ce.horizontal[hn]=Yt,en=Yt.positionedLines.length===1)}}un("left")}else{if($e==="auto"&&($e=pg(je)),ot||T.get("text-writing-mode").indexOf("horizontal")>=0||!go(Ie)){const xt=lg(pe,e,o,u,j,Mt,Ue,je,$e,Oe,ge,vi.horizontal,!1,tt,oe,J);xt&&(ce.horizontal[$e]=xt)}un(tt==="point"?"left":$e)}}let ve=!1;if(B.icon&&B.icon.name){const Ie=l[B.icon.name];Ie&&(ye=SC(u[B.icon.name],T.get("icon-offset").evaluate(B,{},v),T.get("icon-anchor").evaluate(B,{},v)),ve=Ie.sdf,i.sdfIcons===void 0?i.sdfIcons=Ie.sdf:i.sdfIcons!==Ie.sdf&&dt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ie.pixelRatio!==i.pixelRatio||T.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const Re=Hv(ce.horizontal)||ce.vertical;i.iconsInText||(i.iconsInText=!!Re&&Re.iconsInText),(Re||ye)&&LC(i,B,ce,ye,l,k,oe,0,ge,ve,m,v)}p&&i.generateCollisionDebugBuffers(b,i.collisionBoxArray)}function pg(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function LC(i,e,o,l,u,p,m,v,b,T,C,k){let M=p.textMaxSize.evaluate(e,{},k);M===void 0&&(M=m);const O=i.layers[0].layout,B=O.get("icon-offset").evaluate(e,{},k),j=Hv(o.horizontal)||o.vertical,J=m/24,oe=i.tilePixelRatio*M/24,ce=i.tilePixelRatio*O.get("symbol-spacing"),pe=O.get("text-padding")*i.tilePixelRatio,ye=O.get("icon-padding")*i.tilePixelRatio,ge=G(O.get("text-max-angle")),ve=O.get("text-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",Re=O.get("icon-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",Ie=O.get("symbol-placement"),et=ce/2,Ue=O.get("icon-text-fit");let Oe;l&&Ue!=="none"&&(i.allowVerticalPlacement&&o.vertical&&(Oe=Lv(l,o.vertical,Ue,O.get("icon-text-fit-padding"),B,J)),j&&(l=Lv(l,j,Ue,O.get("icon-text-fit-padding"),B,J)));const je=(Ve,$e)=>{$e.x<0||$e.x>=qt||$e.y<0||$e.y>=qt||function(tt,ot,Mt,un,xt,en,nt,hn,Yt,Gn,Zn,Yn,ar,sn,tn,bn,vr,qn,nr,xr,Tn,Zr,dn,Wn,Hn){const Bn=tt.addToLineVertexArray(ot,un);let Pn,Jn,pn,Sr,Xi,xi,Mi,bi=0,Cr=0,Jo=0,dc=0,pc=-1,fc=-1;const Eo={};let Cx=Fu(""),Ig=0,Ag=0;if(Yt._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Ig,Ag]=Yt.layout.get("text-offset").evaluate(Tn,{},Hn).map(ii=>ii*yr):(Ig=Yt.layout.get("text-radial-offset").evaluate(Tn,{},Hn)*yr,Ag=dg),tt.allowVerticalPlacement&&xt.vertical){const ii=xt.vertical;if(tn)xi=fg(ii),hn&&(Mi=fg(hn));else{const oi=Yt.layout.get("text-rotate").evaluate(Tn,{},Hn)+90;pn=kp(Gn,Mt,ot,Zn,Yn,ar,ii,sn,oi,bn),hn&&(Sr=kp(Gn,Mt,ot,Zn,Yn,ar,hn,qn,oi))}}if(en){const ii=Yt.layout.get("icon-rotate").evaluate(Tn,{},Hn),oi=Yt.layout.get("icon-text-fit")!=="none",rh=Gv(en,ii,dn,oi),Pg=hn?Gv(hn,ii,dn,oi):void 0;Jn=kp(Gn,Mt,ot,Zn,Yn,ar,en,qn,ii),bi=4*rh.length;const kx=tt.iconSizeData;let ja=null;kx.kind==="source"?(ja=[vo*Yt.layout.get("icon-size").evaluate(Tn,{},Hn)],ja[0]>Bs&&dt(`${tt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):kx.kind==="composite"&&(ja=[vo*Zr.compositeIconSizes[0].evaluate(Tn,{},Hn),vo*Zr.compositeIconSizes[1].evaluate(Tn,{},Hn)],(ja[0]>Bs||ja[1]>Bs)&&dt(`${tt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),tt.addSymbols(tt.icon,rh,ja,xr,nr,Tn,!1,Mt,ot,Bn.lineStartIndex,Bn.lineLength,-1,Wn,Hn),pc=tt.icon.placedSymbolArray.length-1,Pg&&(Cr=4*Pg.length,tt.addSymbols(tt.icon,Pg,ja,xr,nr,Tn,vi.vertical,Mt,ot,Bn.lineStartIndex,Bn.lineLength,-1,Wn,Hn),fc=tt.icon.placedSymbolArray.length-1)}for(const ii in xt.horizontal){const oi=xt.horizontal[ii];Pn||(Cx=Fu(oi.text),tn?Xi=fg(oi):Pn=kp(Gn,Mt,ot,Zn,Yn,ar,oi,sn,Yt.layout.get("text-rotate").evaluate(Tn,{},Hn),bn));const rh=oi.positionedLines.length===1;if(Jo+=Wv(tt,Mt,ot,oi,nt,Yt,tn,Tn,bn,Bn,xt.vertical?vi.horizontal:vi.horizontalOnly,rh?Object.keys(xt.horizontal):[ii],Eo,pc,Zr,Wn,Hn),rh)break}xt.vertical&&(dc+=Wv(tt,Mt,ot,xt.vertical,nt,Yt,tn,Tn,bn,Bn,vi.vertical,["vertical"],Eo,fc,Zr,Wn,Hn));let js=-1;const Mg=(ii,oi)=>ii?Math.max(ii,oi):oi;js=Mg(Xi,js),js=Mg(xi,js),js=Mg(Mi,js);const sk=js>-1?1:0;tt.glyphOffsetArray.length>=Fs.MAX_GLYPHS&&dt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Tn.sortKey!==void 0&&tt.addToSortKeyRanges(tt.symbolInstances.length,Tn.sortKey),tt.symbolInstances.emplaceBack(Mt.x,Mt.y,Mt.z,ot.x,ot.y,Eo.right>=0?Eo.right:-1,Eo.center>=0?Eo.center:-1,Eo.left>=0?Eo.left:-1,Eo.vertical>=0?Eo.vertical:-1,pc,fc,Cx,Pn!==void 0?Pn:tt.collisionBoxArray.length,Pn!==void 0?Pn+1:tt.collisionBoxArray.length,pn!==void 0?pn:tt.collisionBoxArray.length,pn!==void 0?pn+1:tt.collisionBoxArray.length,Jn!==void 0?Jn:tt.collisionBoxArray.length,Jn!==void 0?Jn+1:tt.collisionBoxArray.length,Sr||tt.collisionBoxArray.length,Sr?Sr+1:tt.collisionBoxArray.length,Zn,Jo,dc,bi,Cr,sk,0,Ig,Ag,js)}(i,$e,$e,Ve,o,l,u,Oe,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,pe,ve,b,0,ye,Re,B,e,p,T,C,k)};if(Ie==="line")for(const Ve of Uv(e.geometry,0,0,qt,qt)){const $e=kC(Ve,ce,ge,o.vertical||j,l,24,oe,i.overscaling,qt);for(const tt of $e){const ot=j;ot&&OC(i,ot.text,et,tt)||je(Ve,tt)}}else if(Ie==="line-center"){for(const Ve of e.geometry)if(Ve.length>1){const $e=CC(Ve,ge,o.vertical||j,l,24,oe);$e&&je(Ve,$e)}}else if(e.type==="Polygon")for(const Ve of eg(e.geometry,0)){const $e=PC(Ve,16);je(Ve[0],new Os($e.x,$e.y,0,0,void 0))}else if(e.type==="LineString")for(const Ve of e.geometry)je(Ve,new Os(Ve[0].x,Ve[0].y,0,0,void 0));else if(e.type==="Point")for(const Ve of e.geometry)for(const $e of Ve)je([$e],new Os($e.x,$e.y,0,0,void 0))}const Bs=32640;function Wv(i,e,o,l,u,p,m,v,b,T,C,k,M,O,B,j,J){const oe=function(ye,ge,ve,Re,Ie,et,Ue,Oe){const je=[];if(ge.positionedLines.length===0)return je;const Ve=Re.layout.get("text-rotate").evaluate(et,{})*Math.PI/180,$e=function(xt){const en=xt[0],nt=xt[1],hn=en*nt;return hn>0?[en,-nt]:hn<0?[-en,nt]:en===0?[nt,en]:[nt,-en]}(ve);let tt=Math.abs(ge.top-ge.bottom);for(const xt of ge.positionedLines)tt-=xt.lineOffset;const ot=ge.positionedLines.length,Mt=tt/ot;let un=ge.top-ve[1];for(let xt=0;xt<ot;++xt){const en=ge.positionedLines[xt];un=IC(ge,Mt,un,xt);for(const nt of en.positionedGlyphs){if(!nt.rect)continue;const hn=nt.rect||{};let Yt=4,Gn=!0,Zn=1,Yn=0;if(nt.imageName){const pn=Ue[nt.imageName];if(!pn)continue;if(pn.sdf){dt("SDF images are not supported in formatted text and will be ignored.");continue}Gn=!1,Zn=pn.pixelRatio,Yt=1/Zn}const ar=(Ie||Oe)&&nt.vertical,sn=nt.metrics.advance*nt.scale/2,tn=nt.metrics,bn=nt.rect;if(bn===null)continue;Oe&&ge.verticalizable&&(Yn=nt.imageName?sn-nt.metrics.width*nt.scale/2:0);const vr=Ie?[nt.x+sn,nt.y]:[0,0];let qn=[0,0],nr=[0,0],xr=!1;Ie||(ar?(nr=[nt.x+sn+$e[0],nt.y+$e[1]-Yn],xr=!0):qn=[nt.x+sn+ve[0],nt.y+ve[1]-Yn]);const Tn=bn.w*nt.scale/(Zn*(nt.localGlyph?2:1)),Zr=bn.h*nt.scale/(Zn*(nt.localGlyph?2:1));let dn,Wn,Hn,Bn;if(ar){const pn=nt.y-un,Sr=new N(-sn,sn-pn),Xi=-Math.PI/2,xi=new N(...nr);dn=new N(-sn+qn[0],qn[1]),dn._rotateAround(Xi,Sr)._add(xi),dn.x+=-pn+sn,dn.y-=(tn.left-Yt)*nt.scale;const Mi=nt.imageName?tn.advance*nt.scale:yr*nt.scale,bi=String.fromCharCode(nt.glyph);cC(bi)?dn.x+=(1-Yt)*nt.scale:uC(bi)?dn.x+=Mi-tn.height*nt.scale+(-Yt-1)*nt.scale:dn.x+=nt.imageName||tn.width+2*Yt===bn.w&&tn.height+2*Yt===bn.h?(Mi-Zr)/2:(Mi-(tn.height+2*Yt)*nt.scale)/2,Wn=new N(dn.x,dn.y-Tn),Hn=new N(dn.x+Zr,dn.y),Bn=new N(dn.x+Zr,dn.y-Tn)}else{const pn=(tn.left-Yt)*nt.scale-sn+qn[0],Sr=(-tn.top-Yt)*nt.scale+qn[1],Xi=pn+Tn,xi=Sr+Zr;dn=new N(pn,Sr),Wn=new N(Xi,Sr),Hn=new N(pn,xi),Bn=new N(Xi,xi)}if(Ve){let pn;pn=Ie?new N(0,0):xr?new N($e[0],$e[1]):new N(ve[0],ve[1]),dn._rotateAround(Ve,pn),Wn._rotateAround(Ve,pn),Hn._rotateAround(Ve,pn),Bn._rotateAround(Ve,pn)}const Pn=new N(0,0),Jn=new N(0,0);je.push({tl:dn,tr:Wn,bl:Hn,br:Bn,tex:hn,writingMode:ge.writingMode,glyphOffset:vr,sectionIndex:nt.sectionIndex,isSDF:Gn,pixelOffsetTL:Pn,pixelOffsetBR:Jn,minFontScaleX:0,minFontScaleY:0})}}return je}(0,l,b,p,m,v,u,i.allowVerticalPlacement),ce=i.textSizeData;let pe=null;ce.kind==="source"?(pe=[vo*p.layout.get("text-size").evaluate(v,{},J)],pe[0]>Bs&&dt(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ce.kind==="composite"&&(pe=[vo*B.compositeTextSizes[0].evaluate(v,{},J),vo*B.compositeTextSizes[1].evaluate(v,{},J)],(pe[0]>Bs||pe[1]>Bs)&&dt(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,oe,pe,b,m,v,C,e,o,T.lineStartIndex,T.lineLength,O,j,J);for(const ye of k)M[ye]=i.text.placedSymbolArray.length-1;return 4*oe.length}function Hv(i){for(const e in i)return i[e];return null}function kp(i,e,o,l,u,p,m,v,b,T){let C=m.top,k=m.bottom,M=m.left,O=m.right;const B=m.collisionPadding;if(B&&(M-=B[0],C-=B[1],O+=B[2],k+=B[3]),b){const j=new N(M,C),J=new N(O,C),oe=new N(M,k),ce=new N(O,k),pe=G(b);let ye=new N(0,0);T&&(ye=new N(T[0],T[1])),j._rotateAround(pe,ye),J._rotateAround(pe,ye),oe._rotateAround(pe,ye),ce._rotateAround(pe,ye),M=Math.min(j.x,J.x,oe.x,ce.x),O=Math.max(j.x,J.x,oe.x,ce.x),C=Math.min(j.y,J.y,oe.y,ce.y),k=Math.max(j.y,J.y,oe.y,ce.y)}return i.emplaceBack(e.x,e.y,e.z,o.x,o.y,M,C,O,k,v,l,u,p),i.length-1}function fg(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const e=i.bottom-i.top;return e>0?Math.max(10,e):null}function OC(i,e,o,l){const u=i.compareText;if(e in u){const p=u[e];for(let m=p.length-1;m>=0;m--)if(l.dist(p[m])<o)return!0}else u[e]=[];return u[e].push(l),!1}const BC=Na.VectorTileFeature.types,FC=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ip(i,e,o,l,u,p,m,v,b,T,C,k,M,O,B,j){const J=C?Math.min(Bs,Math.round(C[0])):0,oe=C?Math.min(Bs,Math.round(C[1])):0;i.emplaceBack(e,o,Math.round(32*m),Math.round(32*v),b,T,(J<<1)+(k?1:0),oe,16*M,16*O,256*B,256*j,l,u,p,0)}function mg(i,e,o){i.emplaceBack(e.x,e.y,o),i.emplaceBack(e.x,e.y,o),i.emplaceBack(e.x,e.y,o),i.emplaceBack(e.x,e.y,o)}function $C(i){for(const e of i.sections)if(Rm(e.text))return!0;return!1}class gg{constructor(e){this.layoutVertexArray=new At,this.indexArray=new Vn,this.programConfigurations=e,this.segments=new sr,this.dynamicLayoutVertexArray=new wt,this.opacityVertexArray=new Qt,this.placedSymbolArray=new ip}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,o,l,u){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nC.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,rC.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,FC,!0),this.opacityVertexBuffer.itemSize=1),(l||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}at("SymbolBuffers",gg);class _g{constructor(e,o,l){this.layoutVertexArray=new e,this.layoutAttributes=o,this.indexArray=new l,this.segments=new sr,this.collisionVertexArray=new Tr,this.collisionVertexArrayExt=new wt}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,iC.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,oC.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}at("CollisionBuffers",_g);class Fs{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(m=>m.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=qm([]),this.placementViewportMatrix=qm([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ig(this.zoom,o["text-size"]),this.iconSizeData=ig(this.zoom,o["icon-size"]);const l=this.layers[0].layout,u=l.get("symbol-sort-key"),p=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(m=>vi[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=e.sourceID}createArrays(){this.text=new gg(new Oa(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new gg(new Oa(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new op,this.lineVertexArray=new La,this.symbolInstances=new Ps}calculateGlyphDependencies(e,o,l,u,p){for(let m=0;m<e.length;m++)if(o[e.charCodeAt(m)]=!0,u&&p){const v=Hu[e.charAt(m)];v&&(o[v.charCodeAt(0)]=!0)}}populate(e,o,l,u){const p=this.layers[0],m=p.layout,v=m.get("text-font"),b=m.get("text-field"),T=m.get("icon-image"),C=(b.value.kind!=="constant"||b.value.value instanceof fr&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),k=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,M=m.get("symbol-sort-key");if(this.features=[],!C&&!k)return;const O=o.iconDependencies,B=o.glyphDependencies,j=o.availableImages,J=new R(this.zoom);for(const{feature:oe,id:ce,index:pe,sourceLayerIndex:ye}of e){const ge=p._featureFilter.needGeometry,ve=$a(oe,ge);if(!p._featureFilter.filter(J,ve,l))continue;let Re,Ie;if(ge||(ve.geometry=Ko(oe,l,u)),C){const Ue=p.getValueAndResolveTokens("text-field",ve,l,j),Oe=fr.factory(Ue);$C(Oe)&&(this.hasRTLText=!0),(!this.hasRTLText||I()==="unavailable"||this.hasRTLText&&z.isParsed())&&(Re=lC(Oe,p,ve))}if(k){const Ue=p.getValueAndResolveTokens("icon-image",ve,l,j);Ie=Ue instanceof ti?Ue:ti.fromString(Ue)}if(!Re&&!Ie)continue;const et=this.sortFeaturesByKey?M.evaluate(ve,{},l):void 0;if(this.features.push({id:ce,text:Re,icon:Ie,index:pe,sourceLayerIndex:ye,geometry:ve.geometry,properties:oe.properties,type:BC[oe.type],sortKey:et}),Ie&&(O[Ie.name]=!0),Re){const Ue=v.evaluate(ve,{},l).join(","),Oe=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(vi.vertical)>=0;for(const je of Re.sections)if(je.image)O[je.image.name]=!0;else{const Ve=go(Re.toString()),$e=je.fontStack||Ue,tt=B[$e]=B[$e]||{};this.calculateGlyphDependencies(je.text,tt,Oe,this.allowVerticalPlacement,Ve)}}}m.get("symbol-placement")==="line"&&(this.features=function(oe){const ce={},pe={},ye=[];let ge=0;function ve(Ue){ye.push(oe[Ue]),ge++}function Re(Ue,Oe,je){const Ve=pe[Ue];return delete pe[Ue],pe[Oe]=Ve,ye[Ve].geometry[0].pop(),ye[Ve].geometry[0]=ye[Ve].geometry[0].concat(je[0]),Ve}function Ie(Ue,Oe,je){const Ve=ce[Oe];return delete ce[Oe],ce[Ue]=Ve,ye[Ve].geometry[0].shift(),ye[Ve].geometry[0]=je[0].concat(ye[Ve].geometry[0]),Ve}function et(Ue,Oe,je){const Ve=je?Oe[0][Oe[0].length-1]:Oe[0][0];return`${Ue}:${Ve.x}:${Ve.y}`}for(let Ue=0;Ue<oe.length;Ue++){const Oe=oe[Ue],je=Oe.geometry,Ve=Oe.text?Oe.text.toString():null;if(!Ve){ve(Ue);continue}const $e=et(Ve,je),tt=et(Ve,je,!0);if($e in pe&&tt in ce&&pe[$e]!==ce[tt]){const ot=Ie($e,tt,je),Mt=Re($e,tt,ye[ot].geometry);delete ce[$e],delete pe[tt],pe[et(Ve,ye[Mt].geometry,!0)]=Mt,ye[ot].geometry=null}else $e in pe?Re($e,tt,je):tt in ce?Ie($e,tt,je):(ve(Ue),ce[$e]=ge-1,pe[tt]=ge-1)}return ye.filter(Ue=>Ue.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((oe,ce)=>oe.sortKey-ce.sortKey)}update(e,o,l,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,o,this.layers,l,u),this.icon.programConfigurations.updatePaintArrays(e,o,this.layers,l,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,o){const l=this.lineVertexArray.length;if(e.segment!==void 0){let u=e.dist(o[e.segment+1]),p=e.dist(o[e.segment]);const m={};for(let v=e.segment+1;v<o.length;v++)m[v]={x:o[v].x,y:o[v].y,tileUnitDistanceFromAnchor:u},v<o.length-1&&(u+=o[v+1].dist(o[v]));for(let v=e.segment||0;v>=0;v--)m[v]={x:o[v].x,y:o[v].y,tileUnitDistanceFromAnchor:p},v>0&&(p+=o[v-1].dist(o[v]));for(let v=0;v<o.length;v++){const b=m[v];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(e,o,l,u,p,m,v,b,T,C,k,M,O,B){const j=e.indexArray,J=e.layoutVertexArray,oe=e.segments.prepareSegment(4*o.length,J,j,this.canOverlap?m.sortKey:void 0),ce=this.glyphOffsetArray.length,pe=oe.vertexLength,ye=this.allowVerticalPlacement&&v===vi.vertical?Math.PI/2:0,ge=m.text&&m.text.sections;for(let ve=0;ve<o.length;ve++){const{tl:Re,tr:Ie,bl:et,br:Ue,tex:Oe,pixelOffsetTL:je,pixelOffsetBR:Ve,minFontScaleX:$e,minFontScaleY:tt,glyphOffset:ot,isSDF:Mt,sectionIndex:un}=o[ve],xt=oe.vertexLength,en=ot[1];Ip(J,b.x,b.y,b.z,T.x,T.y,Re.x,en+Re.y,Oe.x,Oe.y,l,Mt,je.x,je.y,$e,tt),Ip(J,b.x,b.y,b.z,T.x,T.y,Ie.x,en+Ie.y,Oe.x+Oe.w,Oe.y,l,Mt,Ve.x,je.y,$e,tt),Ip(J,b.x,b.y,b.z,T.x,T.y,et.x,en+et.y,Oe.x,Oe.y+Oe.h,l,Mt,je.x,Ve.y,$e,tt),Ip(J,b.x,b.y,b.z,T.x,T.y,Ue.x,en+Ue.y,Oe.x+Oe.w,Oe.y+Oe.h,l,Mt,Ve.x,Ve.y,$e,tt),mg(e.dynamicLayoutVertexArray,b,ye),j.emplaceBack(xt,xt+1,xt+2),j.emplaceBack(xt+1,xt+2,xt+3),oe.vertexLength+=4,oe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ot[0]),ve!==o.length-1&&un===o[ve+1].sectionIndex||e.programConfigurations.populatePaintArrays(J.length,m,m.index,{},O,B,ge&&ge[un])}e.placedSymbolArray.emplaceBack(b.x,b.y,b.z,T.x,T.y,ce,this.glyphOffsetArray.length-ce,pe,C,k,T.segment,l?l[0]:0,l?l[1]:0,u[0],u[1],v,0,!1,0,M,0)}_commitLayoutVertex(e,o,l,u,p,m,v){e.emplaceBack(o,l,u,p,m,Math.round(v.x),Math.round(v.y))}_addCollisionDebugVertices(e,o,l,u,p,m,v){const b=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),T=b.vertexLength,C=v.tileAnchorX,k=v.tileAnchorY;for(let O=0;O<4;O++)l.collisionVertexArray.emplaceBack(0,0,0,0);l.collisionVertexArrayExt.emplaceBack(o,-e.padding,-e.padding),l.collisionVertexArrayExt.emplaceBack(o,e.padding,-e.padding),l.collisionVertexArrayExt.emplaceBack(o,e.padding,e.padding),l.collisionVertexArrayExt.emplaceBack(o,-e.padding,e.padding),this._commitLayoutVertex(l.layoutVertexArray,u,p,m,C,k,new N(e.x1,e.y1)),this._commitLayoutVertex(l.layoutVertexArray,u,p,m,C,k,new N(e.x2,e.y1)),this._commitLayoutVertex(l.layoutVertexArray,u,p,m,C,k,new N(e.x2,e.y2)),this._commitLayoutVertex(l.layoutVertexArray,u,p,m,C,k,new N(e.x1,e.y2)),b.vertexLength+=4;const M=l.indexArray;M.emplaceBack(T,T+1),M.emplaceBack(T+1,T+2),M.emplaceBack(T+2,T+3),M.emplaceBack(T+3,T),b.primitiveLength+=4}_addTextDebugCollisionBoxes(e,o,l,u,p,m){for(let v=u;v<p;v++){const b=l.get(v),T=this.getSymbolInstanceTextSize(e,m,o,v);this._addCollisionDebugVertices(b,T,this.textCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(e,o,l,u,p,m){for(let v=u;v<p;v++){const b=l.get(v),T=this.getSymbolInstanceIconSize(e,o,v);this._addCollisionDebugVertices(b,T,this.iconCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,m)}}generateCollisionDebugBuffers(e,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _g(ir,wv.members,gn),this.iconCollisionBox=new _g(ir,wv.members,gn);const l=ic(this.iconSizeData,e),u=ic(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const m=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(u,e,o,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(u,e,o,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(l,e,o,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(l,e,o,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(e,o,l,u){const p=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:u),m=bp(this.textSizeData,e,p)/yr;return this.tilePixelRatio*m}getSymbolInstanceIconSize(e,o,l){const u=this.icon.placedSymbolArray.get(l),p=bp(this.iconSizeData,e,u);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(e,o,l){e.emplaceBack(o,-l,-l),e.emplaceBack(o,l,-l),e.emplaceBack(o,l,l),e.emplaceBack(o,-l,l)}_updateTextDebugCollisionBoxes(e,o,l,u,p,m){for(let v=u;v<p;v++){const b=l.get(v),T=this.getSymbolInstanceTextSize(e,m,o,v);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,b.padding)}}_updateIconDebugCollisionBoxes(e,o,l,u,p){for(let m=u;m<p;m++){const v=l.get(m),b=this.getSymbolInstanceIconSize(e,o,m);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,v.padding)}}updateCollisionDebugBuffers(e,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=ic(this.iconSizeData,e),u=ic(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const m=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(u,e,o,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(u,e,o,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(l,e,o,m.iconBoxStartIndex,m.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(l,e,o,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,o,l,u,p,m,v,b,T){const C={};for(let k=o;k<l;k++){const M=e.get(k);C.textBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},C.textFeatureIndex=M.featureIndex;break}for(let k=u;k<p;k++){const M=e.get(k);C.verticalTextBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},C.verticalTextFeatureIndex=M.featureIndex;break}for(let k=m;k<v;k++){const M=e.get(k);C.iconBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},C.iconFeatureIndex=M.featureIndex;break}for(let k=b;k<T;k++){const M=e.get(k);C.verticalIconBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},C.verticalIconFeatureIndex=M.featureIndex;break}return C}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const l=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,o){const l=e.placedSymbolArray.get(o),u=l.vertexStartIndex+4*l.numGlyphs;for(let p=l.vertexStartIndex;p<u;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(e),l=Math.cos(e),u=[],p=[],m=[];for(let v=0;v<this.symbolInstances.length;++v){m.push(v);const b=this.symbolInstances.get(v);u.push(0|Math.round(o*b.tileAnchorX+l*b.tileAnchorY)),p.push(b.featureIndex)}return m.sort((v,b)=>u[v]-u[b]||p[b]-p[v]),m}addToSortKeyRanges(e,o){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===o?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const l=this.symbolInstances.get(o);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((u,p,m)=>{u>=0&&m.indexOf(u)===p&&this.addIndicesForPlacedSymbol(this.text,u)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}at("SymbolBucket",Fs,{omit:["layers","collisionBoxArray","features","compareText"]}),Fs.MAX_GLYPHS=65535,Fs.addDynamicAttributes=mg;const NC=new ze({"symbol-placement":new H(_e.layout_symbol["symbol-placement"]),"symbol-spacing":new H(_e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new H(_e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new le(_e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new H(_e.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new H(_e.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new H(_e.layout_symbol["icon-ignore-placement"]),"icon-optional":new H(_e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new H(_e.layout_symbol["icon-rotation-alignment"]),"icon-size":new le(_e.layout_symbol["icon-size"]),"icon-text-fit":new H(_e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new H(_e.layout_symbol["icon-text-fit-padding"]),"icon-image":new le(_e.layout_symbol["icon-image"]),"icon-rotate":new le(_e.layout_symbol["icon-rotate"]),"icon-padding":new H(_e.layout_symbol["icon-padding"]),"icon-keep-upright":new H(_e.layout_symbol["icon-keep-upright"]),"icon-offset":new le(_e.layout_symbol["icon-offset"]),"icon-anchor":new le(_e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new H(_e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new H(_e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new H(_e.layout_symbol["text-rotation-alignment"]),"text-field":new le(_e.layout_symbol["text-field"]),"text-font":new le(_e.layout_symbol["text-font"]),"text-size":new le(_e.layout_symbol["text-size"]),"text-max-width":new le(_e.layout_symbol["text-max-width"]),"text-line-height":new le(_e.layout_symbol["text-line-height"]),"text-letter-spacing":new le(_e.layout_symbol["text-letter-spacing"]),"text-justify":new le(_e.layout_symbol["text-justify"]),"text-radial-offset":new le(_e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new H(_e.layout_symbol["text-variable-anchor"]),"text-anchor":new le(_e.layout_symbol["text-anchor"]),"text-max-angle":new H(_e.layout_symbol["text-max-angle"]),"text-writing-mode":new H(_e.layout_symbol["text-writing-mode"]),"text-rotate":new le(_e.layout_symbol["text-rotate"]),"text-padding":new H(_e.layout_symbol["text-padding"]),"text-keep-upright":new H(_e.layout_symbol["text-keep-upright"]),"text-transform":new le(_e.layout_symbol["text-transform"]),"text-offset":new le(_e.layout_symbol["text-offset"]),"text-allow-overlap":new H(_e.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new H(_e.layout_symbol["text-ignore-placement"]),"text-optional":new H(_e.layout_symbol["text-optional"])});var yg={paint:new ze({"icon-opacity":new le(_e.paint_symbol["icon-opacity"]),"icon-color":new le(_e.paint_symbol["icon-color"]),"icon-halo-color":new le(_e.paint_symbol["icon-halo-color"]),"icon-halo-width":new le(_e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new le(_e.paint_symbol["icon-halo-blur"]),"icon-translate":new H(_e.paint_symbol["icon-translate"]),"icon-translate-anchor":new H(_e.paint_symbol["icon-translate-anchor"]),"text-opacity":new le(_e.paint_symbol["text-opacity"]),"text-color":new le(_e.paint_symbol["text-color"],{runtimeType:Rn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new le(_e.paint_symbol["text-halo-color"]),"text-halo-width":new le(_e.paint_symbol["text-halo-width"]),"text-halo-blur":new le(_e.paint_symbol["text-halo-blur"]),"text-translate":new H(_e.paint_symbol["text-translate"]),"text-translate-anchor":new H(_e.paint_symbol["text-translate-anchor"])}),layout:NC};class Xv{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Ci,this.defaultValue=e}evaluate(e){if(e.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(e.formattedSection))return o.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}at("FormatSectionOverride",Xv,{omit:["defaultValue"]});class Ap extends Wi{constructor(e){super(e,yg)}recalculate(e,o){super.recalculate(e,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const u=[];for(const p of l)u.indexOf(p)<0&&u.push(p);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,o,l,u){const p=this.layout.get(e).evaluate(o,{},l,u),m=this._unevaluatedLayout._values[e];return m.isDataDriven()||gi(m.value)||!p?p:function(v,b){return b.replace(/{([^{}]+)}/g,(T,C)=>C in v?String(v[C]):"")}(o.properties,p)}createBucket(e){return new Fs(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of yg.paint.overridableProperties){if(!Ap.hasPaintOverride(this.layout,e))continue;const o=this.paint.get(e),l=new Xv(o),u=new xu(l,o.property.specification);let p=null;p=o.value.kind==="constant"||o.value.kind==="source"?new ho("source",u):new Ol("composite",u,o.value.zoomStops,o.value._interpolationType),this.paint._values[e]=new re(o.property,p,o.parameters)}}_handleOverridablePaintPropertyUpdate(e,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven())&&Ap.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,o){const l=e.get("text-field"),u=yg.paint.properties[o];let p=!1;const m=v=>{for(const b of v)if(u.overrides&&u.overrides.hasOverride(b))return void(p=!0)};if(l.value.kind==="constant"&&l.value.value instanceof fr)m(l.value.value.sections);else if(l.value.kind==="source"){const v=T=>{p||(T instanceof Uo&&Ln(T.value)===fs?m(T.value.sections):T instanceof fa?m(T.sections):T.eachChild(v))},b=l.value;b._styleExpression&&v(b._styleExpression.expression)}return p}getProgramConfiguration(e){return new Xo(this,e)}}var UC={paint:new ze({"background-color":new H(_e.paint_background["background-color"]),"background-pattern":new ke(_e.paint_background["background-pattern"]),"background-opacity":new H(_e.paint_background["background-opacity"])})},jC={paint:new ze({"raster-opacity":new H(_e.paint_raster["raster-opacity"]),"raster-hue-rotate":new H(_e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new H(_e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new H(_e.paint_raster["raster-brightness-max"]),"raster-saturation":new H(_e.paint_raster["raster-saturation"]),"raster-contrast":new H(_e.paint_raster["raster-contrast"]),"raster-resampling":new H(_e.paint_raster["raster-resampling"]),"raster-fade-duration":new H(_e.paint_raster["raster-fade-duration"])})};class VC extends Wi{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var GC={paint:new ze({"sky-type":new H(_e.paint_sky["sky-type"]),"sky-atmosphere-sun":new H(_e.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new H(_e.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new H(_e.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new H(_e.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ce(_e.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new H(_e.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new H(_e.paint_sky["sky-atmosphere-color"]),"sky-opacity":new H(_e.paint_sky["sky-opacity"])})};function vg(i,e,o){const l=tc(0,0,1),u=tv(Wm());return function(p,m,v){v*=.5;var b=m[0],T=m[1],C=m[2],k=m[3],M=Math.sin(v),O=Math.cos(v);p[0]=b*O-C*M,p[1]=T*O+k*M,p[2]=C*O+b*M,p[3]=k*O-T*M}(u,u,o?-G(i)+Math.PI:G(i)),nv(u,u,-G(e)),ev(l,l,u),Q0(l,l)}const ZC={circle:class extends Wi{constructor(i){super(i,uS)}createBucket(i){return new Vm(i)}queryRadius(i){const e=i;return ec("circle-radius",this,e)+ec("circle-stroke-width",this,e)+dp(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,o,l,u,p,m,v){const b=q0(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(e,o)+this.paint.get("circle-stroke-width").evaluate(e,o);return iv(i,l,p,m,v,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",b,T)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new Xo(this,i)}},heatmap:class extends Wi{createBucket(i){return new sv(i)}constructor(i){super(i,yS),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Km({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return ec("heatmap-radius",this,i)}queryIntersectsFeature(i,e,o,l,u,p,m,v){const b=this.paint.get("heatmap-radius").evaluate(e,o);return iv(i,l,p,m,v,!0,!0,new N(0,0),b)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new Xo(this,i)}},hillshade:class extends Wi{constructor(i){super(i,vS)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(i){return new Xo(this,i)}},fill:class extends Wi{constructor(i){super(i,OS)}getProgramIds(){const i=this.paint.get("fill-pattern"),e=i&&i.constantOr(1),o=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getProgramConfiguration(i){return new Xo(this,i)}recalculate(i,e){super.recalculate(i,e);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new vp(i)}queryRadius(){return dp(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,o,l,u,p){return!i.queryGeometry.isAboveHorizon&&U0(Z0(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends Wi{constructor(i){super(i,WS)}createBucket(i){return new rg(i)}queryRadius(){return dp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new Xo(this,i)}queryIntersectsFeature(i,e,o,l,u,p,m,v,b){const T=q0(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),C=this.paint.get("fill-extrusion-height").evaluate(e,o),k=this.paint.get("fill-extrusion-base").evaluate(e,o),M=[0,0],O=v&&p.elevation,B=p.elevation?p.elevation.exaggeration():1;if(O){const oe=i.tile.getBucket(this).centroidVertexArray,ce=b+1;if(ce<oe.length){const pe=oe.get(ce);M[0]=pe.a_centroid_pos0,M[1]=pe.a_centroid_pos1}}if(M[0]===0&&M[1]===1)return!1;const j=function(oe,ce,pe,ye,ge,ve,Re,Ie,et){return ve?function(Ue,Oe,je,Ve,$e,tt,ot,Mt,un){const xt=[],en=[],nt=[0,0,0,1];for(const hn of Ue){const Yt=[],Gn=[];for(const Zn of hn){const Yn=Zn.x+Ve.x,ar=Zn.y+Ve.y,sn=HS(Yn,ar,Oe,je,tt,ot,Mt,un);nt[0]=Yn,nt[1]=ar,nt[2]=sn.base,nt[3]=1,Uu(nt,nt,$e),nt[3]=Math.max(nt[3],1e-5);const tn=yv([nt[0]/nt[3],nt[1]/nt[3],nt[2]/nt[3]]);nt[0]=Yn,nt[1]=ar,nt[2]=sn.top,nt[3]=1,Uu(nt,nt,$e),nt[3]=Math.max(nt[3],1e-5);const bn=yv([nt[0]/nt[3],nt[1]/nt[3],nt[2]/nt[3]]);Yt.push(tn),Gn.push(bn)}xt.push(Yt),en.push(Gn)}return[xt,en]}(oe,ce,pe,ye,ge,ve,Re,Ie,et):function(Ue,Oe,je,Ve,$e){const tt=[],ot=[],Mt=$e[8]*Oe,un=$e[9]*Oe,xt=$e[10]*Oe,en=$e[11]*Oe,nt=$e[8]*je,hn=$e[9]*je,Yt=$e[10]*je,Gn=$e[11]*je;for(const Zn of Ue){const Yn=[],ar=[];for(const sn of Zn){const tn=sn.x+Ve.x,bn=sn.y+Ve.y,vr=$e[0]*tn+$e[4]*bn+$e[12],qn=$e[1]*tn+$e[5]*bn+$e[13],nr=$e[2]*tn+$e[6]*bn+$e[14],xr=$e[3]*tn+$e[7]*bn+$e[15],Tn=vr+Mt,Zr=qn+un,dn=nr+xt,Wn=Math.max(xr+en,1e-5),Hn=vr+nt,Bn=qn+hn,Pn=nr+Yt,Jn=Math.max(xr+Gn,1e-5),pn=new N(Tn/Wn,Zr/Wn);pn.z=dn/Wn,Yn.push(pn);const Sr=new N(Hn/Jn,Bn/Jn);Sr.z=Pn/Jn,ar.push(Sr)}tt.push(Yn),ot.push(ar)}return[tt,ot]}(oe,ce,pe,ye,ge)}(l,k,C,T,m,O?v:null,M,B,p.center.lat),J=i.queryGeometry;return function(oe,ce,pe){let ye=1/0;U0(pe,ce)&&(ye=_v(pe,ce[0]));for(let ge=0;ge<ce.length;ge++){const ve=ce[ge],Re=oe[ge];for(let Ie=0;Ie<ve.length-1;Ie++){const et=ve[Ie],Ue=[et,ve[Ie+1],Re[Ie+1],Re[Ie],et];N0(pe,Ue)&&(ye=Math.min(ye,_v(pe,Ue)))}}return ye!==1/0&&ye}(j[0],j[1],J.isPointQuery()?J.screenBounds:J.screenGeometry)}},line:class extends Wi{constructor(i){super(i,vv),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof _a,this.gradientVersion=(this.gradientVersion+1)%be}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=xv.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new xp(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new Xo(this,i)}queryRadius(i){const e=i,o=bv(ec("line-width",this,e),ec("line-gap-width",this,e)),l=ec("line-offset",this,e);return o/2+Math.abs(l)+dp(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,o,l,u,p){if(i.queryGeometry.isAboveHorizon)return!1;const m=Z0(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),v=i.pixelToTileUnitsFactor/2*bv(this.paint.get("line-width").evaluate(e,o),this.paint.get("line-gap-width").evaluate(e,o)),b=this.paint.get("line-offset").evaluate(e,o);return b&&(l=function(T,C){const k=[],M=new N(0,0);for(let O=0;O<T.length;O++){const B=T[O],j=[];for(let J=0;J<B.length;J++){const oe=B[J-1],ce=B[J],pe=B[J+1],ye=J===0?M:ce.sub(oe)._unit()._perp(),ge=J===B.length-1?M:pe.sub(ce)._unit()._perp(),ve=ye._add(ge)._unit();ve._mult(1/(ve.x*ge.x+ve.y*ge.y)),j.push(ve._mult(C)._add(ce))}k.push(j)}return k}(l,b*i.pixelToTileUnitsFactor)),function(T,C,k){for(let M=0;M<C.length;M++){const O=C[M];if(T.length>=3){for(let B=0;B<O.length;B++)if(Ql(T,O[B]))return!0}if(sS(T,O,k))return!0}return!1}(m,l,v)}isTileClipped(){return!0}},symbol:Ap,background:class extends Wi{constructor(i){super(i,UC)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Wi{constructor(i){super(i,jC)}getProgramIds(){return["raster"]}},sky:class extends Wi{constructor(i){super(i,GC),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Km({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(i,e){const o=this.paint.get("sky-type");if(o==="atmosphere"){const l=this.paint.get("sky-atmosphere-sun"),u=!l,p=i.style.light,m=p.properties.get("position");return u&&p.properties.get("anchor")==="viewport"&&dt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?vg(m.azimuthal,90-m.polar,e):vg(l[0],90-l[1],e)}if(o==="gradient"){const l=this.paint.get("sky-gradient-center");return vg(l[0],90-l[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}},{HTMLImageElement:Kv,HTMLCanvasElement:Yv,HTMLVideoElement:Jv,ImageData:Qv,ImageBitmap:Mp}=ae;class Pp{constructor(e,o,l,u){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(o,u)}update(e,o,l){const{width:u,height:p}=e,{context:m}=this,{gl:v}=m;if(v.bindTexture(v.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!o||o.premultiply!==!1)),l||this.size&&this.size[0]===u&&this.size[1]===p){const{x:b,y:T}=l||{x:0,y:0};e instanceof Kv||e instanceof Yv||e instanceof Jv||e instanceof Qv||Mp&&e instanceof Mp?v.texSubImage2D(v.TEXTURE_2D,0,b,T,v.RGBA,v.UNSIGNED_BYTE,e):v.texSubImage2D(v.TEXTURE_2D,0,b,T,u,p,v.RGBA,v.UNSIGNED_BYTE,e.data)}else this.size=[u,p],e instanceof Kv||e instanceof Yv||e instanceof Jv||e instanceof Qv||Mp&&e instanceof Mp?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,e):v.texImage2D(v.TEXTURE_2D,0,this.format,u,p,0,this.format,v.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(o&&o.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(e,o){const{context:l}=this,{gl:u}=l;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),o!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,o),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class xg{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.image=new Rs({width:e,height:o}),this.positions={},this.uploaded=!1}getDash(e,o){const l=this.getKey(e,o);return this.positions[l]}trim(){const e=this.width,o=this.height=Tt(this.nextRow);this.image.resize({width:e,height:o})}getKey(e,o){return e.join(",")+o}getDashRanges(e,o,l){const u=[];let p=e.length%2==1?-e[e.length-1]*l:0,m=e[0]*l,v=!0;u.push({left:p,right:m,isDash:v,zeroLength:e[0]===0});let b=e[0];for(let T=1;T<e.length;T++){v=!v;const C=e[T];p=b*l,b+=C,m=b*l,u.push({left:p,right:m,isDash:v,zeroLength:C===0})}return u}addRoundDash(e,o,l){const u=o/2;for(let p=-l;p<=l;p++){const m=this.width*(this.nextRow+l+p);let v=0,b=e[v];for(let T=0;T<this.width;T++){T/b.right>1&&(b=e[++v]);const C=Math.abs(T-b.left),k=Math.abs(T-b.right),M=Math.min(C,k);let O;const B=p/l*(u+1);if(b.isDash){const j=u-Math.abs(B);O=Math.sqrt(M*M+j*j)}else O=u-Math.sqrt(M*M+B*B);this.image.data[m+T]=Math.max(0,Math.min(255,O+128))}}}addRegularDash(e,o){for(let b=e.length-1;b>=0;--b){const T=e[b],C=e[b+1];T.zeroLength?e.splice(b,1):C&&C.isDash===T.isDash&&(C.left=T.left,e.splice(b,1))}const l=e[0],u=e[e.length-1];l.isDash===u.isDash&&(l.left=u.left-this.width,u.right=l.right+this.width);const p=this.width*this.nextRow;let m=0,v=e[m];for(let b=0;b<this.width;b++){b/v.right>1&&(v=e[++m]);const T=Math.abs(b-v.left),C=Math.abs(b-v.right),k=Math.min(T,C);this.image.data[p+b]=Math.max(0,Math.min(255,(v.isDash?k:-k)+o+128))}}addDash(e,o){const l=this.getKey(e,o);if(this.positions[l])return this.positions[l];const u=o==="round",p=u?7:0,m=2*p+1;if(this.nextRow+m>this.height)return dt("LineAtlas out of space"),null;e.length===0&&e.push(1);let v=0;for(let C=0;C<e.length;C++)e[C]<0&&(dt("Negative value is found in line dasharray, replacing values with 0"),e[C]=0),v+=e[C];if(v!==0){const C=this.width/v,k=this.getDashRanges(e,this.width,C);u?this.addRoundDash(k,C,p):this.addRegularDash(k,o==="square"?.5*C:0)}const b=this.nextRow+p;this.nextRow+=m;const T={tl:[b,p],br:[v,0]};return this.positions[l]=T,T}}at("LineAtlas",xg);class qC{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const WC=ae.performance;function ex(i){const e=i?i.url.toString():void 0;return WC.getEntriesByName(e)}class HC{constructor(){this.tasks={},this.taskQueue=[],nn(["process"],this),this.invoker=new qC(this.process),this.nextId=0}add(e,o){const l=this.nextId++,u=function({type:p,isSymbolTile:m,zoom:v}){return v=v||0,p==="message"?0:p!=="maybePrepare"||m?p!=="parseTile"||m?p==="parseTile"&&m?300-v:p==="maybePrepare"&&m?400-v:500:200-v:100-v}(o);if(u===0){wn();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[l]={fn:e,metadata:o,priority:u,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){wn();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const o=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let e=null,o=1/0;for(let u=0;u<this.taskQueue.length;u++){const p=this.tasks[this.taskQueue[u]];p.priority<o&&(o=p.priority,e=u)}if(e===null)return null;const l=this.taskQueue[e];return this.taskQueue.splice(e,1),l}remove(){this.invoker.remove()}}function zp(i,e){const o=Math.pow(2,-i.z),l=i.x*o,u=(i.x+1)*o,p=i.y*o,m=(i.y+1)*o;if(e.name==="mercator")return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:e};const v=Fa(l),b=Fa(u),T=yo(p),C=yo(m),k=e.project(v,T),M=e.project(b,T),O=e.project(b,C),B=e.project(v,C);let j=Math.min(k.x,M.x,O.x,B.x),J=Math.min(k.y,M.y,O.y,B.y),oe=Math.max(k.x,M.x,O.x,B.x),ce=Math.max(k.y,M.y,O.y,B.y);const pe=o/16;function ye(ve,Re,Ie,et,Ue,Oe){const je=(Ie+Ue)/2,Ve=(et+Oe)/2,$e=e.project(Fa(je),yo(Ve)),tt=Math.max(0,j-$e.x,J-$e.y,$e.x-oe,$e.y-ce);j=Math.min(j,$e.x),oe=Math.max(oe,$e.x),J=Math.min(J,$e.y),ce=Math.max(ce,$e.y),tt>pe&&(ye(ve,$e,Ie,et,je,Ve),ye($e,Re,je,Ve,Ue,Oe))}ye(k,M,l,p,u,p),ye(M,O,u,p,u,m),ye(O,B,u,m,l,m),ye(B,k,l,m,l,p),j-=pe,J-=pe,oe+=pe,ce+=pe;const ge=1/Math.max(oe-j,ce-J);return{scale:ge,x:j*ge,y:J*ge,x2:oe*ge,y2:ce*ge,projection:e}}function tx(i,e,o){var l=2*Math.PI*6378137/256/Math.pow(2,o);return[i*l-2*Math.PI*6378137/2,e*l-2*Math.PI*6378137/2]}class bg{constructor(e,o,l){this.z=e,this.x=o,this.y=l,this.key=Ju(0,e,e,o,l)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,o){const l=(p=this.y,m=this.z,v=tx(256*(u=this.x),256*(p=Math.pow(2,m)-p-1),m),b=tx(256*(u+1),256*(p+1),m),v[0]+","+v[1]+","+b[0]+","+b[1]);var u,p,m,v,b;const T=function(C,k,M){let O,B="";for(let j=C;j>0;j--)O=1<<j-1,B+=(k&O?1:0)+(M&O?2:0);return B}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",T).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class nx{constructor(e,o){this.wrap=e,this.canonical=o,this.key=Ju(e,o.z,o.z,o.x,o.y)}}class Gr{constructor(e,o,l,u,p){this.overscaledZ=e,this.wrap=o,this.canonical=new bg(l,+u,+p),this.key=o===0&&e===l?this.canonical.key:Ju(o,e,l,u,p)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const o=this.canonical.z-e;return e>this.canonical.z?new Gr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Gr(e,this.wrap,e,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(e,o=!0){if(this.overscaledZ===e&&o)return this.key;if(e>this.canonical.z)return Ju(this.wrap*+o,e,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-e;return Ju(this.wrap*+o,e,e,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const o=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>o&&e.canonical.y===this.canonical.y>>o}children(e){if(this.overscaledZ>=e)return[new Gr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,l=2*this.canonical.x,u=2*this.canonical.y;return[new Gr(o,this.wrap,o,l,u),new Gr(o,this.wrap,o,l+1,u),new Gr(o,this.wrap,o,l,u+1),new Gr(o,this.wrap,o,l+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Gr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Gr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new nx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ju(i,e,o,l,u){const p=1<<Math.min(o,22);let m=p*(u%p)+l%p;return i&&o<22&&(m+=p*p*((i<0?-2*i-1:2*i)%(1<<2*(22-o)))),16*(32*m+o)+(e-o)}at("CanonicalTileID",bg),at("OverscaledTileID",Gr,{omit:["projMatrix"]});class rx{constructor(e){this._stringToNumber={},this._numberToString=[];for(let o=0;o<e.length;o++){const l=e[o];this._stringToNumber[l]=o,this._numberToString[o]=l}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}class ix{constructor(e,o,l,u,p){this.type="Feature",this._vectorTileFeature=e,e._z=o,e._x=l,e._y=u,this.properties=e.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(e[o]=this[o]);return e}}var XC=Se([{name:"a_pos",type:"Int16",components:2}]);const Ai=32,xo=33,$s=new Uint16Array(8184);for(let i=0;i<2046;i++){let e=i+2,o=0,l=0,u=0,p=0,m=0,v=0;for(1&e?u=p=m=Ai:o=l=v=Ai;(e>>=1)>1;){const T=o+u>>1,C=l+p>>1;1&e?(u=o,p=l,o=m,l=v):(o=u,l=p,u=m,p=v),m=T,v=C}const b=4*i;$s[b+0]=o,$s[b+1]=l,$s[b+2]=u,$s[b+3]=p}const bo=new Uint16Array(2178),Ns=new Uint8Array(1089),Dp=new Uint16Array(1089);function ox(i){return i===0?-.03125:i===32?.03125:0}var wg=Se([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const sx={type:2,extent:qt,loadGeometry:()=>[[new N(0,0),new N(8193,0),new N(8193,8193),new N(0,8193),new N(0,0)]]};class ax{constructor(e,o,l,u,p){this.tileID=e,this.uid=ht(),this.uses=0,this.tileSize=o,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const o=e+this.timeAdded;o<hr.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=zp(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,o,l){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,p){const m={};if(!p)return m;for(const v of u){const b=v.layerIds.map(T=>p.getLayer(T)).filter(Boolean);if(b.length!==0){v.layers=b,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(T=>b.filter(C=>C.id===T)[0]));for(const T of b)m[T.id]=v}}return m}(e.buckets,o.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const p=this.buckets[u];if(p instanceof Fs){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const p=this.buckets[u];if(p instanceof Fs&&p.hasRTLText){this.hasRTLText=!0,z.isLoading()||z.isLoaded()||I()!=="deferred"||P();break}}this.queryPadding=0;for(const u in this.buckets){const p=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(u).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new zr}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Pp(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Pp(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Pp(e,this.lineAtlas.image,o.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,l,u,p,m,v,b){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:v,transform:m,params:p,tileTransform:this.tileTransform},e,o,l):{}}querySourceFeatures(e,o){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),p=o?o.sourceLayer:"",m=u._geojsonTileLayer||u[p];if(!m)return;const v=wa(o&&o.filter),{z:b,x:T,y:C}=this.tileID.canonical,k={z:b,x:T,y:C};for(let M=0;M<m.length;M++){const O=m.feature(M);if(v.needGeometry){const J=$a(O,!0);if(!v.filter(new R(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!v.filter(new R(this.tileID.overscaledZ),O))continue;const B=l.getId(O,p),j=new ix(O,b,T,C,B);j.tile=k,e.push(j)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const l=An(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(o)if(this.expirationTime<o)u=!0;else{const p=this.expirationTime-o;p?this.expirationTime=l+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!o)return;const l=this.latestFeatureIndex.loadVTLayers(),u=o.style.listImages();for(const p in this.buckets){if(!o.style.hasLayer(p))continue;const m=this.buckets[p],v=m.layers[0].sourceLayer||"_geojsonTileLayer",b=l[v],T=e[v];if(!b||!T||Object.keys(T).length===0)continue;if(m.update(T,b,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),m instanceof xp||m instanceof vp){const k=o.style._getSourceCache(m.layers[0].source);o._terrain&&o._terrain.enabled&&k&&m.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(k.id,this.tileID)}const C=o&&o.style&&o.style.getLayer(p);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<hr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=hr.now()+e}setDependencies(e,o){const l={};for(const u of o)l[u]=!0;this.dependencies[e]=l}hasDependency(e,o){for(const l of e){const u=this.dependencies[l];if(u){for(const p of o)if(u[p])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,o){if(!o||o.name==="mercator"||this._tileDebugBuffer)return;const l=Ko(sx,this.tileID.canonical,this.tileTransform)[0],u=new lt,p=new or;for(let m=0;m<l.length;m++){const{x:v,y:b}=l[m];u.emplaceBack(v,b),p.emplaceBack(m)}p.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(p),this._tileDebugBuffer=e.createVertexBuffer(u,wg.members),this._tileDebugSegments=sr.simpleSegment(0,0,u.length,p.length)}_makeTileBoundsBuffers(e,o){if(this._tileBoundsBuffer||!o||o.name==="mercator")return;const l=Ko(sx,this.tileID.canonical,this.tileTransform)[0];let u,p;if(this.isRaster){const m=function(v,b){const T=zp(v,b),C=Math.pow(2,v.z);for(let J=0;J<xo;J++)for(let oe=0;oe<xo;oe++){const ce=Fa((v.x+(oe+ox(oe))/Ai)/C),pe=yo((v.y+(J+ox(J))/Ai)/C),ye=b.project(ce,pe),ge=J*xo+oe;bo[2*ge+0]=Math.round((ye.x*T.scale-T.x)*qt),bo[2*ge+1]=Math.round((ye.y*T.scale-T.y)*qt)}Ns.fill(0),Dp.fill(0);for(let J=2045;J>=0;J--){const oe=4*J,ce=$s[oe+0],pe=$s[oe+1],ye=$s[oe+2],ge=$s[oe+3],ve=ce+ye>>1,Re=pe+ge>>1,Ie=ve+Re-pe,et=Re+ce-ve,Ue=pe*xo+ce,Oe=ge*xo+ye,je=Re*xo+ve,Ve=Math.hypot((bo[2*Ue+0]+bo[2*Oe+0])/2-bo[2*je+0],(bo[2*Ue+1]+bo[2*Oe+1])/2-bo[2*je+1])>=16;if(Ns[je]=Ns[je]||(Ve?1:0),J<1022){const $e=(pe+et>>1)*xo+(ce+Ie>>1),tt=(ge+et>>1)*xo+(ye+Ie>>1);Ns[je]=Ns[je]||Ns[$e]||Ns[tt]}}const k=new yt,M=new Vn;let O=0;function B(J,oe){const ce=oe*xo+J;return Dp[ce]===0&&(k.emplaceBack(bo[2*ce+0],bo[2*ce+1],J*qt/Ai,oe*qt/Ai),Dp[ce]=++O),Dp[ce]-1}function j(J,oe,ce,pe,ye,ge){const ve=J+ce>>1,Re=oe+pe>>1;if(Math.abs(J-ye)+Math.abs(oe-ge)>1&&Ns[Re*xo+ve])j(ye,ge,J,oe,ve,Re),j(ce,pe,ye,ge,ve,Re);else{const Ie=B(J,oe),et=B(ce,pe),Ue=B(ye,ge);M.emplaceBack(Ie,et,Ue)}}return j(0,0,Ai,Ai,Ai,0),j(Ai,Ai,0,0,0,Ai),{vertices:k,indices:M}}(this.tileID.canonical,o);u=m.vertices,p=m.indices}else{u=new yt,p=new Vn;for(const{x:v,y:b}of l)u.emplaceBack(v,b,0,0);const m=fp(u.int16,void 0,4);for(let v=0;v<m.length;v+=3)p.emplaceBack(m[v],m[v+1],m[v+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,wg.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(p),this._tileBoundsSegments=sr.simpleSegment(0,0,u.length,p.length)}}class KC{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,l){const u=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},st(this.stateChanges[e][u],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const p in this.state[e])p!==u&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const p in this.state[e][u])l[p]||(this.deletedStates[e][u][p]=null)}else for(const p in l)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][p]===null&&delete this.deletedStates[e][u][p]}removeFeatureState(e,o,l){if(this.deletedStates[e]===null)return;const u=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&o!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][l]=null);else if(o!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(l in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][l]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,o){const l=String(o),u=st({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const p=this.deletedStates[e][o];if(p===null)return{};for(const m in p)delete u[m]}return u}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const p={};for(const m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),st(this.state[u][m],this.stateChanges[u][m]),p[m]=this.state[u][m];l[u]=p}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const p={};if(this.deletedStates[u]===null)for(const m in this.state[u])p[m]={},this.state[u][m]={};else for(const m in this.deletedStates[u]){if(this.deletedStates[u][m]===null)this.state[u][m]={};else for(const v of Object.keys(this.deletedStates[u][m]))delete this.state[u][m][v];p[m]=this.state[u][m]}l[u]=l[u]||{},st(l[u],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in e)e[u].setFeatureState(l,o)}}class lx{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,o){const l=this.toIdx(e,o);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(e,o){return this.leaves[this.toIdx(e,o)]}toIdx(e,o){return o*this.size+e}}function cx(i,e,o,l){let u=0,p=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(l[m])<1e-15){if(o[m]<i[m]||o[m]>e[m])return null}else{const v=1/l[m];let b=(i[m]-o[m])*v,T=(e[m]-o[m])*v;if(b>T){const C=b;b=T,T=C}if(b>u&&(u=b),T<p&&(p=T),u>p)return null}return u}function ux(i,e,o,l,u,p,m,v,b,T,C){const k=l-i,M=u-e,O=p-o,B=m-i,j=v-e,J=b-o,oe=C[1]*J-C[2]*j,ce=C[2]*B-C[0]*J,pe=C[0]*j-C[1]*B,ye=k*oe+M*ce+O*pe;if(Math.abs(ye)<1e-15)return null;const ge=1/ye,ve=T[0]-i,Re=T[1]-e,Ie=T[2]-o,et=(ve*oe+Re*ce+Ie*pe)*ge;if(et<0||et>1)return null;const Ue=Re*O-Ie*M,Oe=Ie*k-ve*O,je=ve*M-Re*k,Ve=(C[0]*Ue+C[1]*Oe+C[2]*je)*ge;return Ve<0||et+Ve>1?null:(B*Ue+j*Oe+J*je)*ge}function hx(i,e,o){return(i-e)/(o-e)}function dx(i,e,o,l,u,p,m,v,b){const T=1<<o,C=p-l,k=m-u,M=(i+1)/T*C+l,O=(e+0)/T*k+u,B=(e+1)/T*k+u;v[0]=(i+0)/T*C+l,v[1]=O,b[0]=M,b[1]=B}class px{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(p){const m=Math.ceil(Math.log2(p.dim/8)),v=[];let b=Math.ceil(Math.pow(2,m));const T=1/b,C=(O,B,j,J,oe)=>{const ce=J?1:0,pe=(O+1)*j-ce,ye=B*j,ge=(B+1)*j-ce;oe[0]=O*j,oe[1]=ye,oe[2]=pe,oe[3]=ge};let k=new lx(b);const M=[];for(let O=0;O<b*b;O++){C(O%b,Math.floor(O/b),T,!1,M);const B=Us(M[0],M[1],p),j=Us(M[2],M[1],p),J=Us(M[2],M[3],p),oe=Us(M[0],M[3],p);k.minimums.push(Math.min(B,j,J,oe)),k.maximums.push(Math.max(B,j,J,oe)),k.leaves.push(1)}for(v.push(k),b/=2;b>=1;b/=2){const O=v[v.length-1];k=new lx(b);for(let B=0;B<b*b;B++){C(B%b,Math.floor(B/b),2,!0,M);const j=O.getElevation(M[0],M[1]),J=O.getElevation(M[2],M[1]),oe=O.getElevation(M[2],M[3]),ce=O.getElevation(M[0],M[3]),pe=O.isLeaf(M[0],M[1]),ye=O.isLeaf(M[2],M[1]),ge=O.isLeaf(M[2],M[3]),ve=O.isLeaf(M[0],M[3]),Re=Math.min(j.min,J.min,oe.min,ce.min),Ie=Math.max(j.max,J.max,oe.max,ce.max),et=pe&&ye&&ge&&ve;k.maximums.push(Ie),k.minimums.push(Re),k.leaves.push(Ie-Re<=5&&et?1:0)}v.push(k)}return v}(this.dem),l=o.length-1,u=o[l];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(o,0,0,l,0)}raycastRoot(e,o,l,u,p,m,v=1){return cx([e,o,-100],[l,u,this.maximums[0]*v],p,m)}raycast(e,o,l,u,p,m,v=1){if(!this.nodeCount)return null;const b=this.raycastRoot(e,o,l,u,p,m,v);if(b==null)return null;const T=[],C=[],k=[],M=[],O=[{idx:0,t:b,nodex:0,nodey:0,depth:0}];for(;O.length>0;){const{idx:B,t:j,nodex:J,nodey:oe,depth:ce}=O.pop();if(this.leaves[B]){dx(J,oe,ce,e,o,l,u,k,M);const ye=1<<ce,ge=(J+0)/ye,ve=(J+1)/ye,Re=(oe+0)/ye,Ie=(oe+1)/ye,et=Us(ge,Re,this.dem)*v,Ue=Us(ve,Re,this.dem)*v,Oe=Us(ve,Ie,this.dem)*v,je=Us(ge,Ie,this.dem)*v,Ve=ux(k[0],k[1],et,M[0],k[1],Ue,M[0],M[1],Oe,p,m),$e=ux(M[0],M[1],Oe,k[0],M[1],je,k[0],k[1],et,p,m),tt=Math.min(Ve!==null?Ve:Number.MAX_VALUE,$e!==null?$e:Number.MAX_VALUE);if(tt!==Number.MAX_VALUE)return tt;{const ot=J0([],p,m,j);if(fx(et,Ue,je,Oe,hx(ot[0],k[0],M[0]),hx(ot[1],k[1],M[1]))>=ot[2])return j}continue}let pe=0;for(let ye=0;ye<this._siblingOffset.length;ye++){dx((J<<1)+this._siblingOffset[ye][0],(oe<<1)+this._siblingOffset[ye][1],ce+1,e,o,l,u,k,M),k[2]=-100,M[2]=this.maximums[this.childOffsets[B]+ye]*v;const ge=cx(k,M,p,m);if(ge!=null){const ve=ge;T[ye]=ve;let Re=!1;for(let Ie=0;Ie<pe&&!Re;Ie++)ve>=T[C[Ie]]&&(C.splice(Ie,0,ye),Re=!0);Re||(C[pe]=ye),pe++}}for(let ye=0;ye<pe;ye++){const ge=C[ye];O.push({idx:this.childOffsets[B]+ge,t:T[ge],nodex:(J<<1)+this._siblingOffset[ge][0],nodey:(oe<<1)+this._siblingOffset[ge][1],depth:ce+1})}}return null}_addNode(e,o,l){return this.minimums.push(e),this.maximums.push(o),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(e,o,l,u,p){if(e[u].isLeaf(o,l)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const m=u-1,v=e[m];let b,T=0;for(let C=0;C<this._siblingOffset.length;C++){const k=2*o+this._siblingOffset[C][0],M=2*l+this._siblingOffset[C][1],O=v.getElevation(k,M),B=v.isLeaf(k,M),j=this._addNode(O.min,O.max,B);B&&(T|=1<<C),b||(b=j)}for(let C=0;C<this._siblingOffset.length;C++)T&1<<C||this._construct(e,2*o+this._siblingOffset[C][0],2*l+this._siblingOffset[C][1],m,b+C)}}function fx(i,e,o,l,u,p){return Xt(Xt(i,o,p),Xt(e,l,p),u)}function Us(i,e,o){const l=o.dim,u=Le(i*l-.5,0,l-1),p=Le(e*l-.5,0,l-1),m=Math.floor(u),v=Math.floor(p),b=Math.min(m+1,l-1),T=Math.min(v+1,l-1);return fx(o.get(m,v),o.get(b,v),o.get(m,T),o.get(b,T),u-m,p-v)}const mx={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Rp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,o,l,u=!1,p=!1){if(this.uid=e,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return dt(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const m=this.dim=o.height-2;if(this.data=new Uint32Array(o.data.buffer),this.encoding=l||"mapbox",this.borderReady=u,!u){for(let v=0;v<m;v++)this.data[this._idx(-1,v)]=this.data[this._idx(0,v)],this.data[this._idx(m,v)]=this.data[this._idx(m-1,v)],this.data[this._idx(v,-1)]=this.data[this._idx(v,0)],this.data[this._idx(v,m)]=this.data[this._idx(v,m-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(m,-1)]=this.data[this._idx(m-1,0)],this.data[this._idx(-1,m)]=this.data[this._idx(0,m-1)],this.data[this._idx(m,m)]=this.data[this._idx(m-1,m-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new px(this)}get(e,o,l=!1){const u=new Uint8Array(this.data.buffer);l&&(e=Le(e,-1,this.dim),o=Le(o,-1,this.dim));const p=4*this._idx(e,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(u[p],u[p+1],u[p+2])}static getUnpackVector(e){return mx[e]}get unpackVector(){return mx[this.encoding]}_idx(e,o){if(e<-1||e>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(e+1)}_unpackMapbox(e,o,l){return(256*e*256+256*o+l)/10-1e4}_unpackTerrarium(e,o,l){return 256*e+o+l/256-32768}static pack(e,o){const l=[0,0,0,0],u=Rp.getUnpackVector(o);let p=Math.floor((e+u[3])/u[2]);return l[2]=p%256,p=Math.floor(p/256),l[1]=p%256,p=Math.floor(p/256),l[0]=p,l}getPixels(){return new yi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,o,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=o*this.dim,p=o*this.dim+this.dim,m=l*this.dim,v=l*this.dim+this.dim;switch(o){case-1:u=p-1;break;case 1:p=u+1}switch(l){case-1:m=v-1;break;case 1:v=m+1}const b=-o*this.dim,T=-l*this.dim;for(let C=m;C<v;C++)for(let k=u;k<p;k++)this.data[this._idx(k,C)]=e.data[this._idx(k+b,C+T)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}at("DEMData",Rp),at("DemMinMaxQuadTree",px,{omit:["dem"]});class YC{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,l){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const p={value:o,timeout:void 0};if(l!==void 0&&(p.timeout=setTimeout(()=>{this.remove(e,p)},l)),this.data[u].push(p),this.order.push(u),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const l=e.wrapped().key,u=o===void 0?0:this.data[l].indexOf(o),p=this.data[l][u];return this.data[l].splice(u,1),p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const l in this.data)for(const u of this.data[l])e(u.value)||o.push(u);for(const l of o)this.remove(l.value.tileID,l)}}class uc{constructor(e,o,l){this.func=e,this.mask=o,this.range=l}}uc.ReadOnly=!1,uc.ReadWrite=!0,uc.disabled=new uc(519,uc.ReadOnly,[0,1]);const Eg=7680;class Tg{constructor(e,o,l,u,p,m){this.test=e,this.ref=o,this.mask=l,this.fail=u,this.depthFail=p,this.pass=m}}Tg.disabled=new Tg({func:519,mask:0},0,0,Eg,Eg,Eg);class wo{constructor(e,o,l){this.blendFunction=e,this.blendColor=o,this.mask=l}}wo.Replace=[1,0],wo.disabled=new wo(wo.Replace,Ht.transparent,[!1,!1,!1,!1]),wo.unblended=new wo(wo.Replace,Ht.transparent,[!0,!0,!0,!0]),wo.alphaBlended=new wo([1,771],Ht.transparent,[!0,!0,!0,!0]);const Sg=1029,Cg=2305;class Hi{constructor(e,o,l){this.enable=e,this.mode=o,this.frontFace=l}}Hi.disabled=new Hi(!1,Sg,Cg),Hi.backCCW=new Hi(!0,Sg,Cg),Hi.backCW=new Hi(!0,Sg,2304),Hi.frontCW=new Hi(!0,1028,2304),Hi.frontCCW=new Hi(!0,1028,Cg);class Ua extends Xe{constructor(e,o,l){super(),this.id=e,this._onlySymbols=l,o.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),o.on("error",()=>{this._sourceErrored=!0}),this._source=o,this._tiles={},this._cache=new YC(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new KC}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const o=this._tiles[e];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,o){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,o)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const l=this._tiles[o];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return it(this._tiles).map(e=>e.tileID).sort(gx).map(e=>e.key)}getRenderableIds(e){const o=[];for(const l in this._tiles)this._isIdRenderable(+l,e)&&o.push(this._tiles[l]);return e?o.sort((l,u)=>{const p=l.tileID,m=u.tileID,v=new N(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),b=new N(m.canonical.x,m.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-m.overscaledZ||b.y-v.y||b.x-v.x}).map(l=>l.tileID.key):o.map(l=>l.tileID).sort(gx).map(l=>l.key)}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,o){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=o),this._loadTile(l,this._tileLoaded.bind(this,l,e,o)))}_tileLoaded(e,o,l,u){if(u)return e.state="errored",void(u.status!==404?this._source.fire(new pt(u,{tile:e})):this.update(this.transform));e.timeAdded=hr.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Ne("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const o=this.getRenderableIds();for(let u=0;u<o.length;u++){const p=o[u];if(e.neighboringTiles&&e.neighboringTiles[p]){const m=this.getTileByID(p);l(e,m),l(m,e)}}function l(u,p){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let m=p.tileID.canonical.x-u.tileID.canonical.x;const v=p.tileID.canonical.y-u.tileID.canonical.y,b=Math.pow(2,u.tileID.canonical.z),T=p.tileID.key;m===0&&v===0||Math.abs(v)>1||(Math.abs(m)>1&&(Math.abs(m+b)===1?m+=b:Math.abs(m-b)===1&&(m-=b)),p.dem&&u.dem&&(u.dem.backfillBorder(p.dem,m,v),u.neighboringTiles&&u.neighboringTiles[T]&&(u.neighboringTiles[T].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,l,u){for(const p in this._tiles){let m=this._tiles[p];if(u[p]||!m.hasData()||m.tileID.overscaledZ<=o||m.tileID.overscaledZ>l)continue;let v=m.tileID;for(;m&&m.tileID.overscaledZ>o+1;){const T=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[T.key],m&&m.hasData()&&(v=T)}let b=v;for(;b.overscaledZ>o;)if(b=b.scaledTo(b.overscaledZ-1),e[b.key]){u[v.key]=v;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=o?l:null}for(let l=e.overscaledZ-1;l>=o;l--){const u=e.scaledTo(l),p=this._getLoadedTile(u);if(p)return p}}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,o){o=o||this._source.tileSize;const l=Math.ceil(e.width/o)+1,u=Math.ceil(e.height/o)+1,p=Math.floor(l*u*5),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(m)}handleWrapJump(e){const o=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,o){const l={};for(const u in this._tiles){const p=this._tiles[u];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+o),l[p.tileID.key]=p}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,o,l){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let u;this.updateCacheSize(e,o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new Gr(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(u=e.coveringTiles({tileSize:o||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(v=>this._source.hasTile(v)))):u=[];const p=this._updateRetainedTiles(u);if(_x(this._source.type)&&u.length!==0){const v={},b={},T=Object.keys(p);for(const k of T){const M=p[k],O=this._tiles[k];if(!O||O.fadeEndTime&&O.fadeEndTime<=hr.now())continue;const B=this.findLoadedParent(M,Math.max(M.overscaledZ-Ua.maxOverzooming,this._source.minzoom));B&&(this._addTile(B.tileID),v[B.tileID.key]=B.tileID),b[k]=M}const C=u[u.length-1].overscaledZ;for(const k in this._tiles){const M=this._tiles[k];if(p[k]||!M.hasData())continue;let O=M.tileID;for(;O.overscaledZ>C;){O=O.scaledTo(O.overscaledZ-1);const B=this._tiles[O.key];if(B&&B.hasData()&&b[O.key]){p[k]=M.tileID;break}}}for(const k in v)p[k]||(this._coveredTiles[k]=!0,p[k]=v[k])}for(const v in p)this._tiles[v].clearFadeHold();const m=function(v,b){const T=[];for(const C in v)C in b||T.push(C);return T}(this._tiles,p);for(const v of m){const b=this._tiles[v];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const o={};if(e.length===0)return o;const l={},u=e.reduce((T,C)=>Math.min(T,C.overscaledZ),1/0),p=e[0].overscaledZ,m=Math.max(p-Ua.maxOverzooming,this._source.minzoom),v=Math.max(p+Ua.maxUnderzooming,this._source.minzoom),b={};for(const T of e){const C=this._addTile(T);o[T.key]=T,C.hasData()||u<this._source.maxzoom&&(b[T.key]=T)}this._retainLoadedChildren(b,u,v,o);for(const T of e){let C=this._tiles[T.key];if(C.hasData())continue;if(T.canonical.z>=this._source.maxzoom){const M=T.children(this._source.maxzoom)[0],O=this.getTile(M);if(O&&O.hasData()){o[M.key]=M;continue}}else{const M=T.children(this._source.maxzoom);if(o[M[0].key]&&o[M[1].key]&&o[M[2].key]&&o[M[3].key])continue}let k=C.wasRequested();for(let M=T.overscaledZ-1;M>=m;--M){const O=T.scaledTo(M);if(l[O.key]||(l[O.key]=!0,C=this.getTile(O),!C&&k&&(C=this._addTile(O)),C&&(o[O.key]=O,k=C.wasRequested(),C.hasData())))break}}return o}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let l,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}o.push(u.key);const p=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;u=p}for(const p of o)this._loadedParentTiles[p]=l}}_addTile(e){let o=this._tiles[e.key];if(o)return o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const l=Boolean(o);if(!l){const u=this.map?this.map.painter:null;o=new ax(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._source.type==="raster"||this._source.type==="raster-dem"),this._loadTile(o,this._tileLoaded.bind(this,o,e.key,o.state))}return o?(o.uses++,this._tiles[e.key]=o,l||this._source.fire(new Ne("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o):null}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=o.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset()}tilesIn(e,o,l){const u=[],p=this.transform;if(!p)return u;for(const m in this._tiles){const v=this._tiles[m];if(l&&v.clearQueryDebugViz(),v.holdingForFade())continue;const b=e.containsTile(v,p,o);b&&u.push(b)}return u}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);for(const l of o)l.projMatrix=this.transform.calculateProjMatrix(l.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(_x(this._source.type))for(const e in this._tiles){const o=this._tiles[e];if(o.fadeEndTime!==void 0&&o.fadeEndTime>=hr.now())return!0}return!1}setFeatureState(e,o,l){this._state.updateState(e=e||"_geojsonTileLayer",o,l)}removeFeatureState(e,o,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,l)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,l){const u=this._tiles[e];u&&u.setDependencies(o,l)}reloadTilesForDependencies(e,o){for(const l in this._tiles)this._tiles[l].hasDependency(e,o)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(e,o))}}function gx(i,e){const o=Math.abs(2*i.wrap)-+(i.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||l-o||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}function _x(i){return i==="raster"||i==="image"||i==="video"}Ua.maxOverzooming=10,Ua.maxUnderzooming=3;class Lp{constructor(e,o,l){this._demTile=e,this._dem=this._demTile.dem,this._scale=o,this._offset=l}static create(e,o,l){const u=l||e.findDEMTileFor(o);if(!u||!u.dem)return;const p=u.dem,m=u.tileID,v=1<<o.canonical.z-m.canonical.z;return new Lp(u,u.tileSize/qt/v,[(o.canonical.x/v-m.canonical.x)*p.dim,(o.canonical.y/v-m.canonical.y)*p.dim])}tileCoordToPixel(e,o){const l=o*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),p=Math.floor(l);return new N(u,p)}getElevationAt(e,o,l,u){const p=e*this._scale+this._offset[0],m=o*this._scale+this._offset[1],v=Math.floor(p),b=Math.floor(m),T=this._dem;return u=!!u,l?Xt(Xt(T.get(v,b,u),T.get(v,b+1,u),m-b),Xt(T.get(v+1,b,u),T.get(v+1,b+1,u),m-b),p-v):T.get(v,b,u)}getElevationAtPixel(e,o,l){return this._dem.get(e,o,!!l)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*$m(1,e)*this._dem.stride}}class yx{constructor(e,o){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ks(qt,16,0),this.featureIndexArray=new I0,this.promoteId=o}insert(e,o,l,u,p,m=0){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,u,p,m);const b=this.grid;for(let T=0;T<o.length;T++){const C=o[T],k=[1/0,1/0,-1/0,-1/0];for(let M=0;M<C.length;M++){const O=C[M];k[0]=Math.min(k[0],O.x),k[1]=Math.min(k[1],O.y),k[2]=Math.max(k[2],O.x),k[3]=Math.max(k[3],O.y)}k[0]<qt&&k[1]<qt&&k[2]>=0&&k[3]>=0&&b.insert(v,k[0],k[1],k[2],k[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Na.VectorTile(new Xu(this.rawTileData)).layers,this.sourceLayerCoder=new rx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,o,l,u){this.loadVTLayers();const p=e.params||{},m=wa(p.filter),v=e.tileResult,b=e.transform,T=v.bufferedTilespaceBounds,C=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(B,j,J,oe)=>G0(v.bufferedTilespaceGeometry,B,j,J,oe));C.sort(JC);let k=null;b.elevation&&C.length>0&&(k=Lp.create(b.elevation,this.tileID));const M={};let O;for(let B=0;B<C.length;B++){const j=C[B];if(j===O)continue;O=j;const J=this.featureIndexArray.get(j);let oe=null;this.loadMatchingFeature(M,J,m,p.layers,p.availableImages,o,l,u,(ce,pe,ye,ge=0)=>(oe||(oe=Ko(ce,this.tileID.canonical,e.tileTransform)),pe.queryIntersectsFeature(v,ce,ye,oe,this.z,e.transform,e.pixelPosMatrix,k,ge)))}return M}loadMatchingFeature(e,o,l,u,p,m,v,b,T){const{featureIndex:C,bucketIndex:k,sourceLayerIndex:M,layoutVertexArrayOffset:O}=o,B=this.bucketLayerIDs[k];if(u&&!function(ce,pe){for(let ye=0;ye<ce.length;ye++)if(pe.indexOf(ce[ye])>=0)return!0;return!1}(u,B))return;const j=this.sourceLayerCoder.decode(M),J=this.vtLayers[j].feature(C);if(l.needGeometry){const ce=$a(J,!0);if(!l.filter(new R(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!l.filter(new R(this.tileID.overscaledZ),J))return;const oe=this.getId(J,j);for(let ce=0;ce<B.length;ce++){const pe=B[ce];if(u&&u.indexOf(pe)<0)continue;const ye=m[pe];if(!ye)continue;let ge={};oe!==void 0&&b&&(ge=b.getState(ye.sourceLayer||"_geojsonTileLayer",oe));const ve=st({},v[pe]);ve.paint=vx(ve.paint,ye.paint,J,ge,p),ve.layout=vx(ve.layout,ye.layout,J,ge,p);const Re=!T||T(J,ye,ge,O);if(!Re)continue;const Ie=new ix(J,this.z,this.x,this.y,oe);Ie.layer=ve;let et=e[pe];et===void 0&&(et=e[pe]=[]),et.push({featureIndex:C,feature:Ie,intersectionZ:Re})}}lookupSymbolFeatures(e,o,l,u,p,m,v,b){const T={};this.loadVTLayers();const C=wa(p);for(const k of e)this.loadMatchingFeature(T,{bucketIndex:l,sourceLayerIndex:u,featureIndex:k,layoutVertexArrayOffset:0},C,m,v,b,o);return T}loadFeature(e){const{featureIndex:o,sourceLayerIndex:l}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(l),p=this.vtFeatures[u];if(p[o])return p[o];const m=this.vtLayers[u].feature(o);return p[o]=m,m}hasLayer(e){for(const o of this.bucketLayerIDs)for(const l of o)if(e===l)return!0;return!1}getId(e,o){let l=e.id;return this.promoteId&&(l=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof l=="boolean"&&(l=Number(l))),l}}function vx(i,e,o,l,u){return In(i,(p,m)=>{const v=e instanceof se?e.get(m):null;return v&&v.evaluate?v.evaluate(o,l,u):v})}function JC(i,e){return e-i}at("FeatureIndex",yx,{omit:["rawTileData","sourceLayerCoder"]});class xx{constructor(e){const o={},l=[];for(const v in e){const b=e[v],T=o[v]={};for(const C in b.glyphs){const k=b.glyphs[+C];if(!k||k.bitmap.width===0||k.bitmap.height===0)continue;const M=k.metrics.localGlyph?2:1,O={x:0,y:0,w:k.bitmap.width+2*M,h:k.bitmap.height+2*M};l.push(O),T[C]=O}}const{w:u,h:p}=sg(l),m=new Rs({width:u||1,height:p||1});for(const v in e){const b=e[v];for(const T in b.glyphs){const C=b.glyphs[+T];if(!C||C.bitmap.width===0||C.bitmap.height===0)continue;const k=o[v][T],M=C.metrics.localGlyph?2:1;Rs.copy(C.bitmap,m,{x:0,y:0},{x:k.x+M,y:k.y+M},C.bitmap)}}this.image=m,this.positions=o}}at("GlyphAtlas",xx);class QC{constructor(e){this.tileID=new Gr(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,e.projection&&(this.tileTransform=zp(e.tileID.canonical,e.projection))}parse(e,o,l,u,p){this.status="parsing",this.data=e,this.collisionBoxArray=new zr;const m=new rx(Object.keys(e.layers).sort()),v=new yx(this.tileID,this.promoteId);v.bucketLayerIDs=[];const b={},T=new xg(256,256),C={featureIndex:v,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:T,availableImages:l},k=o.familiesBySource[this.source];for(const ge in k){const ve=e.layers[ge];if(!ve)continue;let Re=!1,Ie=!1;for(const Oe of k[ge])Oe[0].type==="symbol"?Re=!0:Ie=!0;if(this.isSymbolTile===!0&&!Re||this.isSymbolTile===!1&&!Ie)continue;ve.version===1&&dt(`Vector tile source "${this.source}" layer "${ge}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const et=m.encode(ge),Ue=[];for(let Oe=0;Oe<ve.length;Oe++){const je=ve.feature(Oe),Ve=v.getId(je,ge);Ue.push({feature:je,id:Ve,index:Oe,sourceLayerIndex:et})}for(const Oe of k[ge]){const je=Oe[0];this.isSymbolTile!==void 0&&je.type==="symbol"!==this.isSymbolTile||je.minzoom&&this.zoom<Math.floor(je.minzoom)||je.maxzoom&&this.zoom>=je.maxzoom||je.visibility!=="none"&&(kg(Oe,this.zoom,l),(b[je.id]=je.createBucket({index:v.bucketLayerIDs.length,layers:Oe,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:et,sourceID:this.source,enableTerrain:this.enableTerrain,availableImages:l})).populate(Ue,C,this.tileID.canonical,this.tileTransform),v.bucketLayerIDs.push(Oe.map(Ve=>Ve.id)))}}let M,O,B,j;T.trim();const J={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},oe=In(C.glyphDependencies,ge=>Object.keys(ge).map(Number));Object.keys(oe).length?u.send("getGlyphs",{uid:this.uid,stacks:oe},(ge,ve)=>{M||(M=ge,O=ve,ye.call(this))},void 0,!1,J):O={};const ce=Object.keys(C.iconDependencies);ce.length?u.send("getImages",{icons:ce,source:this.source,tileID:this.tileID,type:"icons"},(ge,ve)=>{M||(M=ge,B=ve,ye.call(this))},void 0,!1,J):B={};const pe=Object.keys(C.patternDependencies);function ye(){if(M)return p(M);if(O&&B&&j){const ge=new xx(O),ve=new Av(B,j);for(const Re in b){const Ie=b[Re];Ie instanceof Fs?(kg(Ie.layers,this.zoom,l),RC(Ie,O,ge.positions,B,ve.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom)):Ie.hasPattern&&(Ie instanceof xp||Ie instanceof vp||Ie instanceof rg)&&(kg(Ie.layers,this.zoom,l),Ie.addFeatures(C,this.tileID.canonical,ve.patternPositions,l))}this.status="done",p(null,{buckets:it(b).filter(Re=>!Re.isEmpty()),featureIndex:v,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ge.image,lineAtlas:T,imageAtlas:ve,glyphMap:this.returnDependencies?O:null,iconMap:this.returnDependencies?B:null,glyphPositions:this.returnDependencies?ge.positions:null})}}pe.length?u.send("getImages",{icons:pe,source:this.source,tileID:this.tileID,type:"patterns"},(ge,ve)=>{M||(M=ge,j=ve,ye.call(this))},void 0,!1,J):j={},ye.call(this)}}function kg(i,e,o){const l=new R(e);for(const u of i)u.recalculate(l,o)}class bx{constructor(e){this.entries={},this.scheduler=e}request(e,o,l,u){const p=this.entries[e]=this.entries[e]||{callbacks:[]};if(p.result){const[m,v]=p.result;return this.scheduler?this.scheduler.add(()=>{u(m,v)},o):u(m,v),()=>{}}return p.callbacks.push(u),p.cancel||(p.cancel=l((m,v)=>{p.result=[m,v];for(const b of p.callbacks)this.scheduler?this.scheduler.add(()=>{b(m,v)},o):b(m,v);setTimeout(()=>delete this.entries[e],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(m=>m!==u),p.callbacks.length||(p.cancel(),delete this.entries[e]))}}}function wx(i,e,o){const l=JSON.stringify(i.request);return i.data&&(this.deduped.entries[l]={result:[null,i.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},u=>{const p=$(i.request,(m,v,b,T)=>{m?u(m):v&&u(null,{vectorTile:o?void 0:new Na.VectorTile(new Xu(v)),rawData:v,cacheControl:b,expires:T})});return()=>{p.cancel(),u()}},e)}var ek={name:"albers",range:[4,7],center:[-96,37.5],parallels:[29.5,45.5],conic:!0,initializeConstants(){if(this.constants&&rv(this.parallels,this.constants.parallels))return;const i=Math.sin(G(this.parallels[0])),e=(i+Math.sin(G(this.parallels[1])))/2,o=1+i*(2*e-i),l=Math.sqrt(o)/e;this.constants={n:e,c:o,r0:l,parallels:this.parallels}},project(i,e){this.initializeConstants();const o=G(i-this.center[0]),l=G(e),{n:u,c:p,r0:m}=this.constants,v=Math.sqrt(p-2*u*Math.sin(l))/u;return{x:v*Math.sin(o*u),y:v*Math.cos(o*u)-m}},unproject(i,e){this.initializeConstants();const{n:o,c:l,r0:u}=this.constants,p=u+e;let m=Math.atan2(i,Math.abs(p))*Math.sign(p);p*o<0&&(m-=Math.PI*Math.sign(i)*Math.sign(p));const v=G(this.center[0])*o;m=Ke(m,-Math.PI-v,Math.PI-v);const b=X(m/o)+this.center[0],T=Math.asin(Le((l-(i*i+p*p)*o*o)/(2*o),-1,1)),C=Le(X(T),-85.051129,Ds);return new on(b,C)}};const Qu=1.340264,eh=-.081106,th=893e-6,nh=.003796,Op=Math.sqrt(3)/2;var tk={name:"equalEarth",center:[0,0],range:[3.5,7],project(i,e){e=e/180*Math.PI,i=i/180*Math.PI;const o=Math.asin(Op*Math.sin(e)),l=o*o,u=l*l*l;return{x:.5*(i*Math.cos(o)/(Op*(Qu+3*eh*l+u*(7*th+9*nh*l)))/Math.PI+.5),y:1-.5*(o*(Qu+eh*l+u*(th+nh*l))/Math.PI+1)}},unproject(i,e){i=(2*i-.5)*Math.PI;let o=e=(2*(1-e)-1)*Math.PI,l=o*o,u=l*l*l;for(let T,C,k,M=0;M<12&&(C=o*(Qu+eh*l+u*(th+nh*l))-e,k=Qu+3*eh*l+u*(7*th+9*nh*l),T=C/k,o=Le(o-T,-Math.PI/3,Math.PI/3),l=o*o,u=l*l*l,!(Math.abs(T)<1e-12));++M);const p=Op*i*(Qu+3*eh*l+u*(7*th+9*nh*l))/Math.cos(o),m=Math.asin(Math.sin(o)/Op),v=Le(180*p/Math.PI,-180,180),b=Le(180*m/Math.PI,-85.051129,Ds);return new on(v,b)}},nk={name:"equirectangular",wrap:!0,center:[0,0],range:[3.5,7],project:(i,e)=>({x:.5+i/360,y:.5-e/360}),unproject(i,e){const o=360*(i-.5),l=Le(360*(.5-e),-85.051129,Ds);return new on(o,l)}};const hc=Math.PI/2;function Bp(i){return Math.tan((hc+i)/2)}var rk={name:"lambertConformalConic",range:[3.5,7],center:[0,30],parallels:[30,30],conic:!0,initializeConstants(){if(this.constants&&rv(this.parallels,this.constants.parallels))return;const i=G(this.parallels[0]),e=G(this.parallels[1]),o=Math.cos(i),l=i===e?Math.sin(i):Math.log(o/Math.cos(e))/Math.log(Bp(e)/Bp(i)),u=o*Math.pow(Bp(i),l)/l;this.constants={n:l,f:u,parallels:this.parallels}},project(i,e){this.initializeConstants(),e=G(e),i=G(i-this.center[0]);const o=1e-6,{n:l,f:u}=this.constants;u>0?e<-hc+o&&(e=-hc+o):e>hc-o&&(e=hc-o);const p=u/Math.pow(Bp(e),l),m=p*Math.sin(l*i),v=u-p*Math.cos(l*i);return{x:.5*(m/Math.PI+.5),y:1-.5*(v/Math.PI+.5)}},unproject(i,e){this.initializeConstants(),i=(2*i-.5)*Math.PI,e=(2*(1-e)-.5)*Math.PI;const{n:o,f:l}=this.constants,u=l-e,p=Math.sign(u),m=Math.sign(o)*Math.sqrt(i*i+u*u);let v=Math.atan2(i,Math.abs(u))*p;u*o<0&&(v-=Math.PI*Math.sign(i)*p);const b=Le(X(v/o)+this.center[0],-180,180),T=Le(X(2*Math.atan(Math.pow(l/m,1/o))-hc),-85.051129,Ds);return new on(b,T)}},ik={name:"mercator",wrap:!0,center:[0,0],project:(i,e)=>({x:Bm(i),y:Fm(e)}),unproject(i,e){const o=Fa(i),l=yo(e);return new on(o,l)}};const Ex=G(Ds);var ok={name:"naturalEarth",center:[0,0],range:[3.5,7],project(i,e){const o=(e=G(e))*e,l=o*o;return{x:.5*((i=G(i))*(.8707-.131979*o+l*(l*(.003971*o-.001529*l)-.013791))/Math.PI+.5),y:1-.5*(e*(1.007226+o*(.015085+l*(.028874*o-.044475-.005916*l)))/Math.PI+1)}},unproject(i,e){i=(2*i-.5)*Math.PI;let o=e=(2*(1-e)-1)*Math.PI,l=25,u=0,p=o*o;do{p=o*o;const b=p*p;u=(o*(1.007226+p*(.015085+b*(.028874*p-.044475-.005916*b)))-e)/(1.007226+p*(.045255+b*(.259866*p-.311325-.005916*11*b))),o=Le(o-u,-Ex,Ex)}while(Math.abs(u)>1e-6&&--l>0);p=o*o;const m=Le(X(i/(.8707+p*(p*(p*p*p*(.003971-.001529*p)-.013791)-.131979))),-180,180),v=X(o);return new on(m,v)}};const Tx=G(Ds),Sx={albers:ek,equalEarth:tk,equirectangular:nk,lambertConformalConic:rk,mercator:ik,naturalEarth:ok,winkelTripel:{name:"winkelTripel",center:[0,0],range:[3.5,7],project(i,e){e=G(e),i=G(i);const o=Math.cos(e),l=2/Math.PI,u=Math.acos(o*Math.cos(i/2)),p=Math.sin(u)/u,m=.5*(i*l+2*o*Math.sin(i/2)/p)||0,v=.5*(e+Math.sin(e)/p)||0;return{x:.5*(m/Math.PI+.5),y:1-.5*(v/Math.PI+1)}},unproject(i,e){let o=i=(2*i-.5)*Math.PI,l=e=(2*(1-e)-1)*Math.PI,u=25;const p=1e-6;let m=0,v=0;do{const b=Math.cos(l),T=Math.sin(l),C=2*T*b,k=T*T,M=b*b,O=Math.cos(o/2),B=Math.sin(o/2),j=2*O*B,J=B*B,oe=1-M*O*O,ce=oe?1/oe:0,pe=oe?Math.acos(b*O)*Math.sqrt(1/oe):0,ye=.5*(2*pe*b*B+2*o/Math.PI)-i,ge=.5*(pe*T+l)-e,ve=.5*ce*(M*J+pe*b*O*k)+1/Math.PI,Re=ce*(j*C/4-pe*T*B),Ie=.125*ce*(C*B-pe*T*M*j),et=.5*ce*(k*O+pe*J*b)+.5,Ue=Re*Ie-et*ve;m=(ge*Re-ye*et)/Ue,v=(ye*Ie-ge*ve)/Ue,o=Le(o-m,-Math.PI,Math.PI),l=Le(l-v,-Tx,Tx)}while((Math.abs(m)>p||Math.abs(v)>p)&&--u>0);return new on(X(o),X(l))}}};a.ARRAY_TYPE=Dr,a.AUTH_ERR_MSG=Ti,a.Actor=class{constructor(i,e,o){this.target=i,this.parent=e,this.mapId=o,this.callbacks={},this.cancelCallbacks={},nn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=wn()?i:ae,this.scheduler=new HC}send(i,e,o,l,u=!1,p){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=p,this.callbacks[m]=o);const v=Po(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:i,hasCallback:!!o,targetMapId:l,mustQueue:u,sourceMapId:this.mapId,data:ka(e,v)},v),{cancel:()=>{o&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(i){const e=i.data,o=e.id;if(o&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const l=this.cancelCallbacks[o];delete this.cancelCallbacks[o],l&&l.cancel()}else if(e.mustQueue||wn()){const l=this.callbacks[o];this.cancelCallbacks[o]=this.scheduler.add(()=>this.processTask(o,e),l&&l.metadata||{type:"message"})}else this.processTask(o,e)}processTask(i,e){if(e.type==="<response>"){const o=this.callbacks[i];delete this.callbacks[i],o&&(e.error?o(Ia(e.error)):o(null,Ia(e.data)))}else{const o=Po(this.globalScope)?void 0:[],l=e.hasCallback?(p,m)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:p?ka(p):null,data:ka(m,o)},o)}:p=>{},u=Ia(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,l);else if(this.parent.getWorkerSource){const p=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,p[0],u.source)[p[1]](u,l)}else l(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=bg,a.Color=Ht,a.ColorMode=wo,a.CullFaceMode=Hi,a.DEMData=Rp,a.DataConstantProperty=H,a.DedupedRequest=bx,a.DepthMode=uc,a.EXTENT=qt,a.Elevation=class{getAtPointOrZero(i,e=0){return this.getAtPoint(i,e)||0}getAtPoint(i,e,o=!0){e==null&&(e=null);const l=this._source();if(!l||i.y<0||i.y>1)return e;const u=l.getSource().maxzoom,p=1<<u,m=Math.floor(i.x),v=i.x-m,b=new Gr(u,m,u,Math.floor(v*p),Math.floor(i.y*p)),T=this.findDEMTileFor(b);if(!T||!T.dem)return e;const C=T.dem,k=1<<T.tileID.canonical.z,M=(v*k-T.tileID.canonical.x)*C.dim,O=(i.y*k-T.tileID.canonical.y)*C.dim,B=Math.floor(M),j=Math.floor(O);return(o?this.exaggeration():1)*Xt(Xt(C.get(B,j),C.get(B,j+1),O-j),Xt(C.get(B+1,j),C.get(B+1,j+1),O-j),M-B)}getAtTileOffset(i,e,o){const l=1<<i.canonical.z;return this.getAtPointOrZero(new up(i.wrap+(i.canonical.x+e/qt)/l,(i.canonical.y+o/qt)/l))}getForTilePoints(i,e,o,l){const u=Lp.create(this,i,l);return!!u&&(e.forEach(p=>{p[2]=this.exaggeration()*u.getElevationAt(p[0],p[1],o)}),!0)}getMinMaxForTile(i){const e=this.findDEMTileFor(i);if(!e||!e.dem)return null;const o=e.dem.tree,l=e.tileID,u=1<<i.canonical.z-l.canonical.z;let p=i.canonical.x/u-l.canonical.x,m=i.canonical.y/u-l.canonical.y,v=0;for(let b=0;b<i.canonical.z-l.canonical.z&&!o.leaves[v];b++){p*=2,m*=2;const T=2*Math.floor(m)+Math.floor(p);v=o.childOffsets[v]+T,p%=1,m%=1}return{min:this.exaggeration()*o.minimums[v],max:this.exaggeration()*o.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,e,o){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=pt,a.EvaluationParameters=R,a.Event=Ne,a.Evented=Xe,a.GlyphManager=lc,a.ImagePosition=ag,a.LineAtlas=xg,a.LngLat=on,a.LngLatBounds=Ba,a.LocalGlyphMode=hg,a.MAX_MERCATOR_LATITUDE=Ds,a.MAX_SAFE_INTEGER=be,a.MercatorCoordinate=up,a.ONE_EM=yr,a.OverscaledTileID=Gr,a.Properties=ze,a.RGBAImage=yi,a.RequestManager=class{constructor(i,e,o){this._transformRequestFn=i,this._customAccessToken=e,this._silenceAuthErrors=!!o,this._createSkuToken()}_createSkuToken(){const i=function(){let e="";for(let o=0;o<10;o++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Nr,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,e){return this._transformRequestFn&&this._transformRequestFn(i,e)||{url:i}}normalizeStyleURL(i,e){if(!dr(i))return i;const o=pr(i);return o.path=`/styles/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||e)}normalizeGlyphsURL(i,e){if(!dr(i))return i;const o=pr(i);return o.path=`/fonts/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||e)}normalizeSourceURL(i,e){if(!dr(i))return i;const o=pr(i);return o.path=`/v4/${o.authority}.json`,o.params.push("secure"),this._makeAPIURL(o,this._customAccessToken||e)}normalizeSpriteURL(i,e,o,l){const u=pr(i);return dr(i)?(u.path=`/styles/v1${u.path}/sprite${e}${o}`,this._makeAPIURL(u,this._customAccessToken||l)):(u.path+=`${e}${o}`,rr(u))}normalizeTileURL(i,e,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!dr(i))return i;const l=pr(i);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||o&&l.authority!=="raster"&&o===512?"@2x":""}${ct.supported?".webp":"$1"}`),l.authority==="raster"?l.path=`/${Ot.RASTER_URL_PREFIX}${l.path}`:(l.path=l.path.replace(/^.+\/v4\//,"/"),l.path=`/${Ot.TILE_URL_VERSION}${l.path}`);const u=this._customAccessToken||function(p){for(const m of p){const v=m.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(l.params)||Ot.ACCESS_TOKEN;return Ot.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&l.params.push(`sku=${this._skuToken}`),this._makeAPIURL(l,u)}canonicalizeTileURL(i,e){const o=pr(i);if(!o.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!o.path.match(/\.[\w]+$/))return i;let l="mapbox://";o.path.match(/^\/raster\/v1\//)?l+=`raster/${o.path.replace(`/${Ot.RASTER_URL_PREFIX}/`,"")}`:l+=`tiles/${o.path.replace(`/${Ot.TILE_URL_VERSION}/`,"")}`;let u=o.params;return e&&(u=u.filter(p=>!p.match(/^access_token=/))),u.length&&(l+=`?${u.join("&")}`),l}canonicalizeTileset(i,e){const o=!!e&&dr(e),l=[];for(const u of i.tiles||[])Qr(u)?l.push(this.canonicalizeTileURL(u,o)):l.push(u);return l}_makeAPIURL(i,e){const o="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=pr(Ot.API_URL);if(i.protocol=l.protocol,i.authority=l.authority,i.protocol==="http"){const u=i.params.indexOf("secure");u>=0&&i.params.splice(u,1)}if(l.path!=="/"&&(i.path=`${l.path}${i.path}`),!Ot.REQUIRE_ACCESS_TOKEN)return rr(i);if(e=e||Ot.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${o}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${o}`)}return i.params=i.params.filter(u=>u.indexOf("access_token")===-1),i.params.push(`access_token=${e||""}`),rr(i)}},a.ResourceType=Lo,a.SegmentVector=sr,a.SourceCache=Ua,a.StencilMode=Tg,a.StructArrayLayout1ui2=or,a.StructArrayLayout2f1f2i16=_r,a.StructArrayLayout2i4=lt,a.StructArrayLayout2ui4=gn,a.StructArrayLayout3f12=wt,a.StructArrayLayout3ui6=Vn,a.StructArrayLayout4i8=yt,a.Texture=Pp,a.Tile=ax,a.Transitionable=K,a.Uniform1f=lp,a.Uniform1i=class extends Wo{constructor(i,e){super(i,e),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},a.Uniform2f=class extends Wo{constructor(i,e){super(i,e),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},a.Uniform3f=class extends Wo{constructor(i,e){super(i,e),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},a.Uniform4f=D0,a.UniformColor=R0,a.UniformMatrix2f=class extends Wo{constructor(i,e){super(i,e),this.current=KT}set(i){for(let e=0;e<4;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},a.UniformMatrix3f=class extends Wo{constructor(i,e){super(i,e),this.current=XT}set(i){for(let e=0;e<9;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},a.UniformMatrix4f=class extends Wo{constructor(i,e){super(i,e),this.current=HT}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},a.UnwrappedTileID=nx,a.ValidationError=Ae,a.VectorTileWorkerSource=class extends Xe{constructor(i,e,o,l,u){super(),this.actor=i,this.layerIndex=e,this.availableImages=o,this.loadVectorData=u||wx,this.loading={},this.loaded={},this.deduped=new bx(i.scheduler),this.isSpriteLoaded=l,this.scheduler=i.scheduler}loadTile(i,e){const o=i.uid,l=i&&i.request,u=l&&l.collectResourceTiming,p=this.loading[o]=new QC(i);p.abort=this.loadVectorData(i,(m,v)=>{const b=!this.loading[o];if(delete this.loading[o],b||m||!v)return p.status="done",b||(this.loaded[o]=p),e(m);const T=v.rawData,C={};v.expires&&(C.expires=v.expires),v.cacheControl&&(C.cacheControl=v.cacheControl),p.vectorTile=v.vectorTile||new Na.VectorTile(new Xu(T));const k=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(M,O)=>{if(M||!O)return e(M);const B={};if(u){const j=ex(l);j.length>0&&(B.resourceTiming=JSON.parse(JSON.stringify(j)))}e(null,st({rawTileData:T.slice(0)},O,C,B))})};this.isSpriteLoaded?k():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(k,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):k()}),this.loaded=this.loaded||{},this.loaded[o]=p})}reloadTile(i,e){const o=this.loaded,l=i.uid,u=this;if(o&&o[l]){const p=o[l];p.showCollisionBoxes=i.showCollisionBoxes,p.enableTerrain=!!i.enableTerrain;const m=(v,b)=>{const T=p.reloadCallback;T&&(delete p.reloadCallback,p.parse(p.vectorTile,u.layerIndex,this.availableImages,u.actor,T)),e(v,b)};p.status==="parsing"?p.reloadCallback=m:p.status==="done"&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,m):m())}}abortTile(i,e){const o=i.uid,l=this.loading[o];l&&(l.abort&&l.abort(),delete this.loading[o]),e()}removeTile(i,e){const o=this.loaded,l=i.uid;o&&o[l]&&delete o[l],e()}},a.WritingMode=vi,a.ZoomHistory=qd,a.add=function(i,e,o){return i[0]=e[0]+o[0],i[1]=e[1]+o[1],i[2]=e[2]+o[2],i},a.addDynamicAttributes=mg,a.altitudeFromMercatorZ=Nm,a.asyncAll=Ye,a.bezier=We,a.bindAll=nn,a.boundsAttributes=wg,a.bufferConvexPolygon=function(i,e){const o=[];for(let l=0;l<i.length;l++){const u=Ke(l-1,-1,i.length-1),p=Ke(l+1,-1,i.length-1),m=i[l],v=i[p],b=i[u].sub(m).unit(),T=v.sub(m).unit(),C=T.angleWithSep(b.x,b.y),k=b.add(T).unit().mult(-1*e/Math.sin(C/2));o.push(m.add(k))}return o},a.cacheEntryPossiblyAdded=function(i){pa++,pa>Ro&&(i.getActor().send("enforceCacheSizeLimit",hl),pa=0)},a.clamp=Le,a.clearTileCache=function(i){const e=ae.caches.delete(da);i&&e.catch(i).then(()=>i())},a.clipLine=Uv,a.clone=function(i){var e=new Dr(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e},a.clone$1=function(i){var e=new Dr(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},a.clone$2=Ze,a.collisionCircleLayout=sC,a.config=Ot,a.conjugate=function(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i},a.copy=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i},a.create=pp,a.create$1=function(){var i=new Dr(16);return Dr!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},a.create$2=W0,a.createExpression=ws,a.createLayout=Se,a.createStyleLayer=function(i){return i.type==="custom"?new VC(i):new ZC[i.type](i)},a.cross=function(i,e,o){var l=e[0],u=e[1],p=e[2],m=o[0],v=o[1],b=o[2];return i[0]=u*b-p*v,i[1]=p*m-l*b,i[2]=l*v-u*m,i},a.degToRad=G,a.div=function(i,e,o){return i[0]=e[0]/o[0],i[1]=e[1]/o[1],i[2]=e[2]/o[2],i},a.dot=function(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]},a.dot$1=function(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]*e[3]},a.ease=Pe,a.easeCubicInOut=Te,a.emitValidationErrors=Vd,a.endsWith=an,a.enforceCacheSizeLimit=function(i){Vi(),ei&&ei.then(e=>{e.keys().then(o=>{for(let l=0;l<o.length-i;l++)e.delete(o[l])})})},a.evaluateSizeForFeature=bp,a.evaluateSizeForZoom=ic,a.evaluateVariableOffset=qv,a.evented=S,a.exactEquals=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]},a.exactEquals$1=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]},a.exported=hr,a.exported$1=ct,a.extend=st,a.filterObject=er,a.fromMat4=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i},a.fromQuat=function(i,e){var o=e[0],l=e[1],u=e[2],p=e[3],m=o+o,v=l+l,b=u+u,T=o*m,C=l*m,k=l*v,M=u*m,O=u*v,B=u*b,j=p*m,J=p*v,oe=p*b;return i[0]=1-k-B,i[1]=C+oe,i[2]=M-J,i[3]=0,i[4]=C-oe,i[5]=1-T-B,i[6]=O+j,i[7]=0,i[8]=M+J,i[9]=O-j,i[10]=1-T-k,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.fromRotation=function(i,e){var o=Math.sin(e),l=Math.cos(e);return i[0]=l,i[1]=o,i[2]=0,i[3]=-o,i[4]=l,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},a.fromScaling=function(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.furthestTileCorner=function(i){const e=Math.round((i+45+360)%360/90)%4;return me[e]},a.getAABBPointSquareDist=function(i,e,o){let l=0;for(let u=0;u<2;++u){const p=o?o[u]:0;i[u]>p&&(l+=(i[u]-p)*(i[u]-p)),e[u]<p&&(l+=(p-e[u])*(p-e[u]))}return l},a.getAnchorAlignment=ug,a.getAnchorJustification=pg,a.getBounds=function(i){let e=1/0,o=1/0,l=-1/0,u=-1/0;for(const p of i)e=Math.min(e,p.x),o=Math.min(o,p.y),l=Math.max(l,p.x),u=Math.max(u,p.y);return{min:new N(e,o),max:new N(l,u)}},a.getImage=Ee,a.getJSON=function(i,e){return L(st(i,{type:"json"}),e)},a.getMapSessionAPI=ul,a.getPerformanceMeasurement=ex,a.getProjection=function(i){const e=Sx[i.name];if(!e)throw new Error(`Invalid projection name: ${i.name}`);return e.conic?function(o,l){if(l.parallels&&Math.abs(l.parallels[0]+l.parallels[1])<.01){let u=function(p){const m=Math.max(.01,Math.cos(G(p))),v=1/(2*Math.max(Math.PI*m,1/m));return{wrap:!0,project(b,T){const C=G(b)*m,k=Math.sin(G(T))/m;return{x:C*v+.5,y:-k*v+.5}},unproject(b,T){const C=-(T-.5)/v,k=Le(X((b-.5)/v)/m,-180,180),M=Math.asin(Le(C*m,-1,1)),O=Le(X(M),-85.051129,Ds);return new on(k,O)}}}(l.parallels[0]);if(l.name==="lambertConformalConic"){const{project:p,unproject:m}=Sx.mercator;u={wrap:!0,project:p,unproject:m}}return st({},o,l,u)}return st({},o,l)}(e,i):e},a.getRTLTextPluginStatus=I,a.getReferrer=Q,a.getTilePoint=function(i,{x:e,y:o},l=0){return new N(((e-l)*i.scale-i.x)*qt,(o*i.scale-i.y)*qt)},a.getTileVec3=function(i,e,o=0){return tc(((e.x-o)*i.scale-i.x)*qt,(e.y*i.scale-i.y)*qt,Nm(e.z,e.y))},a.getVideo=function(i,e){const o=ae.document.createElement("video");o.muted=!0,o.onloadstart=function(){e(null,o)};for(let l=0;l<i.length;l++){const u=ae.document.createElement("source");ue(i[l])||(o.crossOrigin="Anonymous"),u.src=i[l],o.appendChild(u)}return{cancel:()=>{}}},a.identity=qm,a.identity$1=tv,a.invert=function(i,e){var o=e[0],l=e[1],u=e[2],p=e[3],m=e[4],v=e[5],b=e[6],T=e[7],C=e[8],k=e[9],M=e[10],O=e[11],B=e[12],j=e[13],J=e[14],oe=e[15],ce=o*v-l*m,pe=o*b-u*m,ye=o*T-p*m,ge=l*b-u*v,ve=l*T-p*v,Re=u*T-p*b,Ie=C*j-k*B,et=C*J-M*B,Ue=C*oe-O*B,Oe=k*J-M*j,je=k*oe-O*j,Ve=M*oe-O*J,$e=ce*Ve-pe*je+ye*Oe+ge*Ue-ve*et+Re*Ie;return $e?(i[0]=(v*Ve-b*je+T*Oe)*($e=1/$e),i[1]=(u*je-l*Ve-p*Oe)*$e,i[2]=(j*Re-J*ve+oe*ge)*$e,i[3]=(M*ve-k*Re-O*ge)*$e,i[4]=(b*Ue-m*Ve-T*et)*$e,i[5]=(o*Ve-u*Ue+p*et)*$e,i[6]=(J*ye-B*Re-oe*pe)*$e,i[7]=(C*Re-M*ye+O*pe)*$e,i[8]=(m*je-v*Ue+T*Ie)*$e,i[9]=(l*Ue-o*je-p*Ie)*$e,i[10]=(B*ve-j*ye+oe*ce)*$e,i[11]=(k*ye-C*ve-O*ce)*$e,i[12]=(v*et-m*Oe-b*Ie)*$e,i[13]=(o*Oe-l*et+u*Ie)*$e,i[14]=(j*pe-B*ge-J*ce)*$e,i[15]=(C*ge-k*pe+M*ce)*$e,i):null},a.isMapAuthenticated=function(i){return io.has(i)},a.isMapboxURL=dr,a.latFromMercatorY=yo,a.len=fS,a.length=X0,a.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},a.loadVectorTile=wx,a.makeRequest=L,a.mercatorXfromLng=Bm,a.mercatorYfromLat=Fm,a.mercatorZfromAltitude=$m,a.mul=function(i,e,o){return i[0]=e[0]*o[0],i[1]=e[1]*o[1],i[2]=e[2]*o[2],i[3]=e[3]*o[3],i},a.mul$1=hS,a.mul$2=pS,a.multiply=H0,a.multiply$1=Y0,a.nextPowerOfTwo=Tt,a.normalize=Q0,a.normalize$1=function(i,e){var o=e[0],l=e[1],u=e[2],p=e[3],m=o*o+l*l+u*u+p*p;return m>0&&(m=1/Math.sqrt(m)),i[0]=o*m,i[1]=l*m,i[2]=u*m,i[3]=p*m,i},a.number=Xt,a.ortho=function(i,e,o,l,u,p,m){var v=1/(e-o),b=1/(l-u),T=1/(p-m);return i[0]=-2*v,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*b,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*T,i[11]=0,i[12]=(e+o)*v,i[13]=(u+l)*b,i[14]=(m+p)*T,i[15]=1,i},a.pbf=Xu,a.perspective=function(i,e,o,l,u){var p,m=1/Math.tan(e/2);return i[0]=m/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=m,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,u!=null&&u!==1/0?(i[10]=(u+l)*(p=1/(l-u)),i[14]=2*u*l*p):(i[10]=-1,i[14]=-2*l),i},a.pick=function(i,e){const o={};for(let l=0;l<e.length;l++){const u=e[l];u in i&&(o[u]=i[u])}return o},a.plugin=z,a.pointGeometry=N,a.polygonIntersectsBox=G0,a.polygonIntersectsPolygon=N0,a.polygonizeBounds=function(i,e,o=0,l=!0){const u=new N(o,o),p=i.sub(u),m=e.add(u),v=[p,new N(m.x,p.y),m,new N(p.x,m.y)];return l&&v.push(p),v},a.posAttributes=XC,a.postMapLoadEvent=tu,a.postTurnstileEvent=ha,a.potpack=sg,a.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},a.radToDeg=X,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(i){return i({pluginStatus:f,pluginURL:_}),S.on("pluginStateChange",i),i},a.removeAuthState=function(i){io.delete(i)},a.renderColorRamp=Km,a.rotateX=function(i,e,o){var l=Math.sin(o),u=Math.cos(o),p=e[4],m=e[5],v=e[6],b=e[7],T=e[8],C=e[9],k=e[10],M=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=p*u+T*l,i[5]=m*u+C*l,i[6]=v*u+k*l,i[7]=b*u+M*l,i[8]=T*u-p*l,i[9]=C*u-m*l,i[10]=k*u-v*l,i[11]=M*u-b*l,i},a.rotateX$1=nv,a.rotateY=function(i,e,o){var l=Math.sin(o),u=Math.cos(o),p=e[0],m=e[1],v=e[2],b=e[3],T=e[8],C=e[9],k=e[10],M=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=p*u-T*l,i[1]=m*u-C*l,i[2]=v*u-k*l,i[3]=b*u-M*l,i[8]=p*l+T*u,i[9]=m*l+C*u,i[10]=v*l+k*u,i[11]=b*l+M*u,i},a.rotateZ=function(i,e,o){var l=Math.sin(o),u=Math.cos(o),p=e[0],m=e[1],v=e[2],b=e[3],T=e[4],C=e[5],k=e[6],M=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=p*u+T*l,i[1]=m*u+C*l,i[2]=v*u+k*l,i[3]=b*u+M*l,i[4]=T*u-p*l,i[5]=C*u-m*l,i[6]=k*u-v*l,i[7]=M*u-b*l,i},a.rotateZ$1=function(i,e,o){o*=.5;var l=e[0],u=e[1],p=e[2],m=e[3],v=Math.sin(o),b=Math.cos(o);return i[0]=l*b+u*v,i[1]=u*b-l*v,i[2]=p*b+m*v,i[3]=m*b-p*v,i},a.scale=function(i,e,o){return i[0]=e[0]*o,i[1]=e[1]*o,i[2]=e[2]*o,i},a.scale$1=function(i,e,o){var l=o[0],u=o[1],p=o[2];return i[0]=e[0]*l,i[1]=e[1]*l,i[2]=e[2]*l,i[3]=e[3]*l,i[4]=e[4]*u,i[5]=e[5]*u,i[6]=e[6]*u,i[7]=e[7]*u,i[8]=e[8]*p,i[9]=e[9]*p,i[10]=e[10]*p,i[11]=e[11]*p,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},a.scale$2=function(i,e,o){return i[0]=e[0]*o,i[1]=e[1]*o,i[2]=e[2]*o,i[3]=e[3]*o,i},a.scaleAndAdd=J0,a.setCacheLimits=function(i,e){hl=i,Ro=e},a.setRTLTextPlugin=function(i,e,o=!1){if(f===Ms||f===d||f===r)throw new Error("setRTLTextPlugin cannot be called multiple times.");_=hr.resolveURL(i),f=Ms,c=e,w(),o||P()},a.smoothstep=function(i,e,o){return(o=Le((o-i)/(e-i),0,1))*o*(3-2*o)},a.spec=_e,a.storeAuthState=function(i,e){e?io.add(i):io.delete(i)},a.sub=dS,a.subtract=K0,a.symbolSize=aC,a.tileTransform=zp,a.transformMat3=function(i,e,o){var l=e[0],u=e[1],p=e[2];return i[0]=l*o[0]+u*o[3]+p*o[6],i[1]=l*o[1]+u*o[4]+p*o[7],i[2]=l*o[2]+u*o[5]+p*o[8],i},a.transformMat4=Uu,a.transformMat4$1=function(i,e,o){var l=e[0],u=e[1],p=e[2],m=o[3]*l+o[7]*u+o[11]*p+o[15];return i[0]=(o[0]*l+o[4]*u+o[8]*p+o[12])/(m=m||1),i[1]=(o[1]*l+o[5]*u+o[9]*p+o[13])/m,i[2]=(o[2]*l+o[6]*u+o[10]*p+o[14])/m,i},a.transformQuat=ev,a.translate=function(i,e,o){var l,u,p,m,v,b,T,C,k,M,O,B,j=o[0],J=o[1],oe=o[2];return e===i?(i[12]=e[0]*j+e[4]*J+e[8]*oe+e[12],i[13]=e[1]*j+e[5]*J+e[9]*oe+e[13],i[14]=e[2]*j+e[6]*J+e[10]*oe+e[14],i[15]=e[3]*j+e[7]*J+e[11]*oe+e[15]):(u=e[1],p=e[2],m=e[3],v=e[4],b=e[5],T=e[6],C=e[7],k=e[8],M=e[9],O=e[10],B=e[11],i[0]=l=e[0],i[1]=u,i[2]=p,i[3]=m,i[4]=v,i[5]=b,i[6]=T,i[7]=C,i[8]=k,i[9]=M,i[10]=O,i[11]=B,i[12]=l*j+v*J+k*oe+e[12],i[13]=u*j+b*J+M*oe+e[13],i[14]=p*j+T*J+O*oe+e[14],i[15]=m*j+C*J+B*oe+e[15]),i},a.triggerPluginCompletionEvent=y,a.uniqueId=ht,a.validateCustomStyleLayer=function(i){const e=[],o=i.id;return o===void 0&&e.push({message:`layers.${o}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${o}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateFog=ku,a.validateLight=zm,a.validateStyle=qo,a.values=it,a.vectorTile=Na,a.version=A,a.warnOnce=dt,a.window=ae,a.wrap=Ke}),x(["./shared"],function(a){function A(Q){const L=typeof Q;if(L==="number"||L==="boolean"||L==="string"||Q==null)return JSON.stringify(Q);if(Array.isArray(Q)){let ie="[";for(const ue of Q)ie+=`${A(ue)},`;return`${ie}]`}const $=Object.keys(Q).sort();let Y="{";for(let ie=0;ie<$.length;ie++)Y+=`${JSON.stringify($[ie])}:${A(Q[$[ie]])},`;return`${Y}}`}function D(Q){let L="";for(const $ of a.refProperties)L+=`/${A(Q[$])}`;return L}class V{constructor(L){this.keyCache={},L&&this.replace(L)}replace(L){this._layerConfigs={},this._layers={},this.update(L,[])}update(L,$){for(const ie of L)this._layerConfigs[ie.id]=ie,(this._layers[ie.id]=a.createStyleLayer(ie)).compileFilter(),this.keyCache[ie.id]&&delete this.keyCache[ie.id];for(const ie of $)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const Y=function(ie,ue){const we={};for(let de=0;de<ie.length;de++){const Ee=ue&&ue[ie[de].id]||D(ie[de]);ue&&(ue[ie[de].id]=Ee);let Fe=we[Ee];Fe||(Fe=we[Ee]=[]),Fe.push(ie[de])}const xe=[];for(const de in we)xe.push(we[de]);return xe}(a.values(this._layerConfigs),this.keyCache);for(const ie of Y){const ue=ie.map(Je=>this._layers[Je.id]),we=ue[0];if(we.visibility==="none")continue;const xe=we.source||"";let de=this.familiesBySource[xe];de||(de=this.familiesBySource[xe]={});const Ee=we.sourceLayer||"_geojsonTileLayer";let Fe=de[Ee];Fe||(Fe=de[Ee]=[]),Fe.push(ue)}}}const{ImageBitmap:N}=a.window;class F{loadTile(L,$){const{uid:Y,encoding:ie,rawImageData:ue,padding:we,buildQuadTree:xe}=L,de=N&&ue instanceof N?this.getImageData(ue,we):ue;$(null,new a.DEMData(Y,de,ie,we<1,xe))}getImageData(L,$){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(L.width,L.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=L.width,this.offscreenCanvas.height=L.height,this.offscreenCanvasContext.drawImage(L,0,0,L.width,L.height);const Y=this.offscreenCanvasContext.getImageData(-$,-$,L.width+2*$,L.height+2*$);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:Y.width,height:Y.height},Y.data)}}var ae=function Q(L,$){var Y,ie=L&&L.type;if(ie==="FeatureCollection")for(Y=0;Y<L.features.length;Y++)Q(L.features[Y],$);else if(ie==="GeometryCollection")for(Y=0;Y<L.geometries.length;Y++)Q(L.geometries[Y],$);else if(ie==="Feature")Q(L.geometry,$);else if(ie==="Polygon")be(L.coordinates,$);else if(ie==="MultiPolygon")for(Y=0;Y<L.coordinates.length;Y++)be(L.coordinates[Y],$);return L};function be(Q,L){if(Q.length!==0){fe(Q[0],L);for(var $=1;$<Q.length;$++)fe(Q[$],!L)}}function fe(Q,L){for(var $=0,Y=0,ie=0,ue=Q.length,we=ue-1;ie<ue;we=ie++){var xe=(Q[ie][0]-Q[we][0])*(Q[we][1]+Q[ie][1]),de=$+xe;Y+=Math.abs($)>=Math.abs(xe)?$-de+xe:xe-de+$,$=de}$+Y>=0!=!!L&&Q.reverse()}const ee=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class G{constructor(L){this._feature=L,this.extent=a.EXTENT,this.type=L.type,this.properties=L.tags,"id"in L&&!isNaN(L.id)&&(this.id=parseInt(L.id,10))}loadGeometry(){if(this._feature.type===1){const L=[];for(const $ of this._feature.geometry)L.push([new a.pointGeometry($[0],$[1])]);return L}{const L=[];for(const $ of this._feature.geometry){const Y=[];for(const ie of $)Y.push(new a.pointGeometry(ie[0],ie[1]));L.push(Y)}return L}}toGeoJSON(L,$,Y){return ee.call(this,L,$,Y)}}class X{constructor(L){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=L.length,this._features=L}feature(L){return new G(this._features[L])}}var me=a.vectorTile.VectorTileFeature,Te=We;function We(Q,L){this.options=L||{},this.features=Q,this.length=Q.length}function Pe(Q,L){this.id=typeof Q.id=="number"?Q.id:void 0,this.type=Q.type,this.rawGeometry=Q.type===1?[Q.geometry]:Q.geometry,this.properties=Q.tags,this.extent=L||4096}We.prototype.feature=function(Q){return new Pe(this.features[Q],this.options.extent)},Pe.prototype.loadGeometry=function(){var Q=this.rawGeometry;this.geometry=[];for(var L=0;L<Q.length;L++){for(var $=Q[L],Y=[],ie=0;ie<$.length;ie++)Y.push(new a.pointGeometry($[ie][0],$[ie][1]));this.geometry.push(Y)}return this.geometry},Pe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Q=this.geometry,L=1/0,$=-1/0,Y=1/0,ie=-1/0,ue=0;ue<Q.length;ue++)for(var we=Q[ue],xe=0;xe<we.length;xe++){var de=we[xe];L=Math.min(L,de.x),$=Math.max($,de.x),Y=Math.min(Y,de.y),ie=Math.max(ie,de.y)}return[L,Y,$,ie]},Pe.prototype.toGeoJSON=me.prototype.toGeoJSON;var Le=Ye,Ke=Te;function Ye(Q){var L=new a.pbf;return function($,Y){for(var ie in $.layers)Y.writeMessage(3,it,$.layers[ie])}(Q,L),L.finish()}function it(Q,L){var $;L.writeVarintField(15,Q.version||1),L.writeStringField(1,Q.name||""),L.writeVarintField(5,Q.extent||4096);var Y={keys:[],values:[],keycache:{},valuecache:{}};for($=0;$<Q.length;$++)Y.feature=Q.feature($),L.writeMessage(2,st,Y);var ie=Y.keys;for($=0;$<ie.length;$++)L.writeStringField(3,ie[$]);var ue=Y.values;for($=0;$<ue.length;$++)L.writeMessage(4,Gt,ue[$])}function st(Q,L){var $=Q.feature;$.id!==void 0&&L.writeVarintField(1,$.id),L.writeMessage(2,ut,Q),L.writeVarintField(3,$.type),L.writeMessage(4,Tt,$)}function ut(Q,L){var $=Q.feature,Y=Q.keys,ie=Q.values,ue=Q.keycache,we=Q.valuecache;for(var xe in $.properties){var de=$.properties[xe],Ee=ue[xe];if(de!==null){Ee===void 0&&(Y.push(xe),ue[xe]=Ee=Y.length-1),L.writeVarint(Ee);var Fe=typeof de;Fe!=="string"&&Fe!=="boolean"&&Fe!=="number"&&(de=JSON.stringify(de));var Je=Fe+":"+de,Ne=we[Je];Ne===void 0&&(ie.push(de),we[Je]=Ne=ie.length-1),L.writeVarint(Ne)}}}function ht(Q,L){return(L<<3)+(7&Q)}function kt(Q){return Q<<1^Q>>31}function Tt(Q,L){for(var $=Q.loadGeometry(),Y=Q.type,ie=0,ue=0,we=$.length,xe=0;xe<we;xe++){var de=$[xe],Ee=1;Y===1&&(Ee=de.length),L.writeVarint(ht(1,Ee));for(var Fe=Y===3?de.length-1:de.length,Je=0;Je<Fe;Je++){Je===1&&Y!==1&&L.writeVarint(ht(2,Fe-1));var Ne=de[Je].x-ie,pt=de[Je].y-ue;L.writeVarint(kt(Ne)),L.writeVarint(kt(pt)),ie+=Ne,ue+=pt}Y===3&&L.writeVarint(ht(7,1))}}function Gt(Q,L){var $=typeof Q;$==="string"?L.writeStringField(1,Q):$==="boolean"?L.writeBooleanField(7,Q):$==="number"&&(Q%1!=0?L.writeDoubleField(3,Q):Q<0?L.writeSVarintField(6,Q):L.writeVarintField(5,Q))}function nn(Q,L,$,Y,ie,ue){if(ie-Y<=$)return;const we=Y+ie>>1;an(Q,L,we,Y,ie,ue%2),nn(Q,L,$,Y,we-1,ue+1),nn(Q,L,$,we+1,ie,ue+1)}function an(Q,L,$,Y,ie,ue){for(;ie>Y;){if(ie-Y>600){const Ee=ie-Y+1,Fe=$-Y+1,Je=Math.log(Ee),Ne=.5*Math.exp(2*Je/3),pt=.5*Math.sqrt(Je*Ne*(Ee-Ne)/Ee)*(Fe-Ee/2<0?-1:1);an(Q,L,$,Math.max(Y,Math.floor($-Fe*Ne/Ee+pt)),Math.min(ie,Math.floor($+(Ee-Fe)*Ne/Ee+pt)),ue)}const we=L[2*$+ue];let xe=Y,de=ie;for(In(Q,L,Y,$),L[2*ie+ue]>we&&In(Q,L,Y,ie);xe<de;){for(In(Q,L,xe,de),xe++,de--;L[2*xe+ue]<we;)xe++;for(;L[2*de+ue]>we;)de--}L[2*Y+ue]===we?In(Q,L,Y,de):(de++,In(Q,L,de,ie)),de<=$&&(Y=de+1),$<=de&&(ie=de-1)}}function In(Q,L,$,Y){er(Q,$,Y),er(L,2*$,2*Y),er(L,2*$+1,2*Y+1)}function er(Q,L,$){const Y=Q[L];Q[L]=Q[$],Q[$]=Y}function Ze(Q,L,$,Y){const ie=Q-$,ue=L-Y;return ie*ie+ue*ue}Le.fromVectorTileJs=Ye,Le.fromGeojsonVt=function(Q,L){L=L||{};var $={};for(var Y in Q)$[Y]=new Te(Q[Y].features,L),$[Y].name=Y,$[Y].version=L.version,$[Y].extent=L.extent;return Ye({layers:$})},Le.GeoJSONWrapper=Ke;const _t=Q=>Q[0],dt=Q=>Q[1];class Ut{constructor(L,$=_t,Y=dt,ie=64,ue=Float64Array){this.nodeSize=ie,this.points=L;const we=L.length<65536?Uint16Array:Uint32Array,xe=this.ids=new we(L.length),de=this.coords=new ue(2*L.length);for(let Ee=0;Ee<L.length;Ee++)xe[Ee]=Ee,de[2*Ee]=$(L[Ee]),de[2*Ee+1]=Y(L[Ee]);nn(xe,de,ie,0,xe.length-1,0)}range(L,$,Y,ie){return function(ue,we,xe,de,Ee,Fe,Je){const Ne=[0,ue.length-1,0],pt=[];let Xe,_e;for(;Ne.length;){const Ae=Ne.pop(),Bt=Ne.pop(),Jt=Ne.pop();if(Bt-Jt<=Je){for(let Wt=Jt;Wt<=Bt;Wt++)Xe=we[2*Wt],_e=we[2*Wt+1],Xe>=xe&&Xe<=Ee&&_e>=de&&_e<=Fe&&pt.push(ue[Wt]);continue}const St=Math.floor((Jt+Bt)/2);Xe=we[2*St],_e=we[2*St+1],Xe>=xe&&Xe<=Ee&&_e>=de&&_e<=Fe&&pt.push(ue[St]);const jt=(Ae+1)%2;(Ae===0?xe<=Xe:de<=_e)&&(Ne.push(Jt),Ne.push(St-1),Ne.push(jt)),(Ae===0?Ee>=Xe:Fe>=_e)&&(Ne.push(St+1),Ne.push(Bt),Ne.push(jt))}return pt}(this.ids,this.coords,L,$,Y,ie,this.nodeSize)}within(L,$,Y){return function(ie,ue,we,xe,de,Ee){const Fe=[0,ie.length-1,0],Je=[],Ne=de*de;for(;Fe.length;){const pt=Fe.pop(),Xe=Fe.pop(),_e=Fe.pop();if(Xe-_e<=Ee){for(let jt=_e;jt<=Xe;jt++)Ze(ue[2*jt],ue[2*jt+1],we,xe)<=Ne&&Je.push(ie[jt]);continue}const Ae=Math.floor((_e+Xe)/2),Bt=ue[2*Ae],Jt=ue[2*Ae+1];Ze(Bt,Jt,we,xe)<=Ne&&Je.push(ie[Ae]);const St=(pt+1)%2;(pt===0?we-de<=Bt:xe-de<=Jt)&&(Fe.push(_e),Fe.push(Ae-1),Fe.push(St)),(pt===0?we+de>=Bt:xe+de>=Jt)&&(Fe.push(Ae+1),Fe.push(Xe),Fe.push(St))}return Je}(this.ids,this.coords,L,$,Y,this.nodeSize)}}const vn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Q=>Q},wn=Math.fround||(An=new Float32Array(1),Q=>(An[0]=+Q,An[0]));var An;class ur{constructor(L){this.options=Ot(Object.create(vn),L),this.trees=new Array(this.options.maxZoom+1)}load(L){const{log:$,minZoom:Y,maxZoom:ie,nodeSize:ue}=this.options;$&&console.time("total time");const we=`prepare ${L.length} points`;$&&console.time(we),this.points=L;let xe=[];for(let de=0;de<L.length;de++)L[de].geometry&&xe.push(di(L[de],de));this.trees[ie+1]=new Ut(xe,ct,$t,ue,Float32Array),$&&console.timeEnd(we);for(let de=ie;de>=Y;de--){const Ee=+Date.now();xe=this._cluster(xe,de),this.trees[de]=new Ut(xe,ct,$t,ue,Float32Array),$&&console.log("z%d: %d clusters in %dms",de,xe.length,+Date.now()-Ee)}return $&&console.timeEnd("total time"),this}getClusters(L,$){let Y=((L[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,L[1]));let ue=L[2]===180?180:((L[2]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)Y=-180,ue=180;else if(Y>ue){const Fe=this.getClusters([Y,ie,180,we],$),Je=this.getClusters([-180,ie,ue,we],$);return Fe.concat(Je)}const xe=this.trees[this._limitZoom($)],de=xe.range(Ni(Y),hr(we),Ni(ue),hr(ie)),Ee=[];for(const Fe of de){const Je=xe.points[Fe];Ee.push(Je.numPoints?no(Je):this.points[Je.index])}return Ee}getChildren(L){const $=this._getOriginId(L),Y=this._getOriginZoom(L),ie="No cluster with the specified id.",ue=this.trees[Y];if(!ue)throw new Error(ie);const we=ue.points[$];if(!we)throw new Error(ie);const xe=this.options.radius/(this.options.extent*Math.pow(2,Y-1)),de=ue.within(we.x,we.y,xe),Ee=[];for(const Fe of de){const Je=ue.points[Fe];Je.parentId===L&&Ee.push(Je.numPoints?no(Je):this.points[Je.index])}if(Ee.length===0)throw new Error(ie);return Ee}getLeaves(L,$,Y){const ie=[];return this._appendLeaves(ie,L,$=$||10,Y=Y||0,0),ie}getTile(L,$,Y){const ie=this.trees[this._limitZoom(L)],ue=Math.pow(2,L),{extent:we,radius:xe}=this.options,de=xe/we,Ee=(Y-de)/ue,Fe=(Y+1+de)/ue,Je={features:[]};return this._addTileFeatures(ie.range(($-de)/ue,Ee,($+1+de)/ue,Fe),ie.points,$,Y,ue,Je),$===0&&this._addTileFeatures(ie.range(1-de/ue,Ee,1,Fe),ie.points,ue,Y,ue,Je),$===ue-1&&this._addTileFeatures(ie.range(0,Ee,de/ue,Fe),ie.points,-1,Y,ue,Je),Je.features.length?Je:null}getClusterExpansionZoom(L){let $=this._getOriginZoom(L)-1;for(;$<=this.options.maxZoom;){const Y=this.getChildren(L);if($++,Y.length!==1)break;L=Y[0].properties.cluster_id}return $}_appendLeaves(L,$,Y,ie,ue){const we=this.getChildren($);for(const xe of we){const de=xe.properties;if(de&&de.cluster?ue+de.point_count<=ie?ue+=de.point_count:ue=this._appendLeaves(L,de.cluster_id,Y,ie,ue):ue<ie?ue++:L.push(xe),L.length===Y)break}return ue}_addTileFeatures(L,$,Y,ie,ue,we){for(const xe of L){const de=$[xe],Ee=de.numPoints;let Fe,Je,Ne;if(Ee)Fe=Po(de),Je=de.x,Ne=de.y;else{const _e=this.points[de.index];Fe=_e.properties,Je=Ni(_e.geometry.coordinates[0]),Ne=hr(_e.geometry.coordinates[1])}const pt={type:1,geometry:[[Math.round(this.options.extent*(Je*ue-Y)),Math.round(this.options.extent*(Ne*ue-ie))]],tags:Fe};let Xe;Ee?Xe=de.id:this.options.generateId?Xe=de.index:this.points[de.index].id&&(Xe=this.points[de.index].id),Xe!==void 0&&(pt.id=Xe),we.features.push(pt)}}_limitZoom(L){return Math.max(this.options.minZoom,Math.min(+L,this.options.maxZoom+1))}_cluster(L,$){const Y=[],{radius:ie,extent:ue,reduce:we,minPoints:xe}=this.options,de=ie/(ue*Math.pow(2,$));for(let Ee=0;Ee<L.length;Ee++){const Fe=L[Ee];if(Fe.zoom<=$)continue;Fe.zoom=$;const Je=this.trees[$+1],Ne=Je.within(Fe.x,Fe.y,de),pt=Fe.numPoints||1;let Xe=pt;for(const _e of Ne){const Ae=Je.points[_e];Ae.zoom>$&&(Xe+=Ae.numPoints||1)}if(Xe>pt&&Xe>=xe){let _e=Fe.x*pt,Ae=Fe.y*pt,Bt=we&&pt>1?this._map(Fe,!0):null;const Jt=(Ee<<5)+($+1)+this.points.length;for(const St of Ne){const jt=Je.points[St];if(jt.zoom<=$)continue;jt.zoom=$;const Wt=jt.numPoints||1;_e+=jt.x*Wt,Ae+=jt.y*Wt,jt.parentId=Jt,we&&(Bt||(Bt=this._map(Fe,!0)),we(Bt,this._map(jt)))}Fe.parentId=Jt,Y.push(It(_e/Xe,Ae/Xe,Jt,Xe,Bt))}else if(Y.push(Fe),Xe>1)for(const _e of Ne){const Ae=Je.points[_e];Ae.zoom<=$||(Ae.zoom=$,Y.push(Ae))}}return Y}_getOriginId(L){return L-this.points.length>>5}_getOriginZoom(L){return(L-this.points.length)%32}_map(L,$){if(L.numPoints)return $?Ot({},L.properties):L.properties;const Y=this.points[L.index].properties,ie=this.options.map(Y);return $&&ie===Y?Ot({},ie):ie}}function It(Q,L,$,Y,ie){return{x:wn(Q),y:wn(L),zoom:1/0,id:$,parentId:-1,numPoints:Y,properties:ie}}function di(Q,L){const[$,Y]=Q.geometry.coordinates;return{x:wn(Ni($)),y:wn(hr(Y)),zoom:1/0,index:L,parentId:-1}}function no(Q){return{type:"Feature",id:Q.id,properties:Po(Q),geometry:{type:"Point",coordinates:[(L=Q.x,360*(L-.5)),Ui(Q.y)]}};var L}function Po(Q){const L=Q.numPoints,$=L>=1e4?`${Math.round(L/1e3)}k`:L>=1e3?Math.round(L/100)/10+"k":L;return Ot(Ot({},Q.properties),{cluster:!0,cluster_id:Q.id,point_count:L,point_count_abbreviated:$})}function Ni(Q){return Q/360+.5}function hr(Q){const L=Math.sin(Q*Math.PI/180),$=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return $<0?0:$>1?1:$}function Ui(Q){const L=(180-360*Q)*Math.PI/180;return 360*Math.atan(Math.exp(L))/Math.PI-90}function Ot(Q,L){for(const $ in L)Q[$]=L[$];return Q}function ct(Q){return Q.x}function $t(Q){return Q.y}function cn(Q,L,$,Y){for(var ie,ue=Y,we=$-L>>1,xe=$-L,de=Q[L],Ee=Q[L+1],Fe=Q[$],Je=Q[$+1],Ne=L+3;Ne<$;Ne+=3){var pt=tr(Q[Ne],Q[Ne+1],de,Ee,Fe,Je);if(pt>ue)ie=Ne,ue=pt;else if(pt===ue){var Xe=Math.abs(Ne-we);Xe<xe&&(ie=Ne,xe=Xe)}}ue>Y&&(ie-L>3&&cn(Q,L,ie,Y),Q[ie+2]=ue,$-ie>3&&cn(Q,ie,$,Y))}function tr(Q,L,$,Y,ie,ue){var we=ie-$,xe=ue-Y;if(we!==0||xe!==0){var de=((Q-$)*we+(L-Y)*xe)/(we*we+xe*xe);de>1?($=ie,Y=ue):de>0&&($+=we*de,Y+=xe*de)}return(we=Q-$)*we+(xe=L-Y)*xe}function Nn(Q,L,$,Y){var ie={id:Q===void 0?null:Q,type:L,geometry:$,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ue){var we=ue.geometry,xe=ue.type;if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")Jr(ue,we);else if(xe==="Polygon"||xe==="MultiLineString")for(var de=0;de<we.length;de++)Jr(ue,we[de]);else if(xe==="MultiPolygon")for(de=0;de<we.length;de++)for(var Ee=0;Ee<we[de].length;Ee++)Jr(ue,we[de][Ee])}(ie),ie}function Jr(Q,L){for(var $=0;$<L.length;$+=3)Q.minX=Math.min(Q.minX,L[$]),Q.minY=Math.min(Q.minY,L[$+1]),Q.maxX=Math.max(Q.maxX,L[$]),Q.maxY=Math.max(Q.maxY,L[$+1])}function Nr(Q,L,$,Y){if(L.geometry){var ie=L.geometry.coordinates,ue=L.geometry.type,we=Math.pow($.tolerance/((1<<$.maxZoom)*$.extent),2),xe=[],de=L.id;if($.promoteId?de=L.properties[$.promoteId]:$.generateId&&(de=Y||0),ue==="Point")Ti(ie,xe);else if(ue==="MultiPoint")for(var Ee=0;Ee<ie.length;Ee++)Ti(ie[Ee],xe);else if(ue==="LineString")dr(ie,xe,we,!1);else if(ue==="MultiLineString"){if($.lineMetrics){for(Ee=0;Ee<ie.length;Ee++)dr(ie[Ee],xe=[],we,!1),Q.push(Nn(de,"LineString",xe,L.properties));return}Qr(ie,xe,we,!1)}else if(ue==="Polygon")Qr(ie,xe,we,!0);else{if(ue!=="MultiPolygon"){if(ue==="GeometryCollection"){for(Ee=0;Ee<L.geometry.geometries.length;Ee++)Nr(Q,{id:de,geometry:L.geometry.geometries[Ee],properties:L.properties},$,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ee=0;Ee<ie.length;Ee++){var Fe=[];Qr(ie[Ee],Fe,we,!0),xe.push(Fe)}}Q.push(Nn(de,ue,xe,L.properties))}}function Ti(Q,L){L.push(ji(Q[0])),L.push(pr(Q[1])),L.push(0)}function dr(Q,L,$,Y){for(var ie,ue,we=0,xe=0;xe<Q.length;xe++){var de=ji(Q[xe][0]),Ee=pr(Q[xe][1]);L.push(de),L.push(Ee),L.push(0),xe>0&&(we+=Y?(ie*Ee-de*ue)/2:Math.sqrt(Math.pow(de-ie,2)+Math.pow(Ee-ue,2))),ie=de,ue=Ee}var Fe=L.length-3;L[2]=1,cn(L,0,Fe,$),L[Fe+2]=1,L.size=Math.abs(we),L.start=0,L.end=L.size}function Qr(Q,L,$,Y){for(var ie=0;ie<Q.length;ie++){var ue=[];dr(Q[ie],ue,$,Y),L.push(ue)}}function ji(Q){return Q/360+.5}function pr(Q){var L=Math.sin(Q*Math.PI/180),$=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return $<0?0:$>1?1:$}function rr(Q,L,$,Y,ie,ue,we,xe){if(Y/=L,ue>=($/=L)&&we<Y)return Q;if(we<$||ue>=Y)return null;for(var de=[],Ee=0;Ee<Q.length;Ee++){var Fe=Q[Ee],Je=Fe.geometry,Ne=Fe.type,pt=ie===0?Fe.minX:Fe.minY,Xe=ie===0?Fe.maxX:Fe.maxY;if(pt>=$&&Xe<Y)de.push(Fe);else if(!(Xe<$||pt>=Y)){var _e=[];if(Ne==="Point"||Ne==="MultiPoint")ro(Je,_e,$,Y,ie);else if(Ne==="LineString")Si(Je,_e,$,Y,ie,!1,xe.lineMetrics);else if(Ne==="MultiLineString")ha(Je,_e,$,Y,ie,!1);else if(Ne==="Polygon")ha(Je,_e,$,Y,ie,!0);else if(Ne==="MultiPolygon")for(var Ae=0;Ae<Je.length;Ae++){var Bt=[];ha(Je[Ae],Bt,$,Y,ie,!0),Bt.length&&_e.push(Bt)}if(_e.length){if(xe.lineMetrics&&Ne==="LineString"){for(Ae=0;Ae<_e.length;Ae++)de.push(Nn(Fe.id,Ne,_e[Ae],Fe.tags));continue}Ne!=="LineString"&&Ne!=="MultiLineString"||(_e.length===1?(Ne="LineString",_e=_e[0]):Ne="MultiLineString"),Ne!=="Point"&&Ne!=="MultiPoint"||(Ne=_e.length===3?"Point":"MultiPoint"),de.push(Nn(Fe.id,Ne,_e,Fe.tags))}}}return de.length?de:null}function ro(Q,L,$,Y,ie){for(var ue=0;ue<Q.length;ue+=3){var we=Q[ue+ie];we>=$&&we<=Y&&(L.push(Q[ue]),L.push(Q[ue+1]),L.push(Q[ue+2]))}}function Si(Q,L,$,Y,ie,ue,we){for(var xe,de,Ee=zo(Q),Fe=ie===0?tu:cl,Je=Q.start,Ne=0;Ne<Q.length-3;Ne+=3){var pt=Q[Ne],Xe=Q[Ne+1],_e=Q[Ne+2],Ae=Q[Ne+3],Bt=Q[Ne+4],Jt=ie===0?pt:Xe,St=ie===0?Ae:Bt,jt=!1;we&&(xe=Math.sqrt(Math.pow(pt-Ae,2)+Math.pow(Xe-Bt,2))),Jt<$?St>$&&(de=Fe(Ee,pt,Xe,Ae,Bt,$),we&&(Ee.start=Je+xe*de)):Jt>Y?St<Y&&(de=Fe(Ee,pt,Xe,Ae,Bt,Y),we&&(Ee.start=Je+xe*de)):ds(Ee,pt,Xe,_e),St<$&&Jt>=$&&(de=Fe(Ee,pt,Xe,Ae,Bt,$),jt=!0),St>Y&&Jt<=Y&&(de=Fe(Ee,pt,Xe,Ae,Bt,Y),jt=!0),!ue&&jt&&(we&&(Ee.end=Je+xe*de),L.push(Ee),Ee=zo(Q)),we&&(Je+=xe)}var Wt=Q.length-3;pt=Q[Wt],Xe=Q[Wt+1],_e=Q[Wt+2],(Jt=ie===0?pt:Xe)>=$&&Jt<=Y&&ds(Ee,pt,Xe,_e),Wt=Ee.length-3,ue&&Wt>=3&&(Ee[Wt]!==Ee[0]||Ee[Wt+1]!==Ee[1])&&ds(Ee,Ee[0],Ee[1],Ee[2]),Ee.length&&L.push(Ee)}function zo(Q){var L=[];return L.size=Q.size,L.start=Q.start,L.end=Q.end,L}function ha(Q,L,$,Y,ie,ue){for(var we=0;we<Q.length;we++)Si(Q[we],L,$,Y,ie,ue,!1)}function ds(Q,L,$,Y){Q.push(L),Q.push($),Q.push(Y)}function tu(Q,L,$,Y,ie,ue){var we=(ue-L)/(Y-L);return Q.push(ue),Q.push($+(ie-$)*we),Q.push(1),we}function cl(Q,L,$,Y,ie,ue){var we=(ue-$)/(ie-$);return Q.push(L+(Y-L)*we),Q.push(ue),Q.push(1),we}function ul(Q,L){for(var $=[],Y=0;Y<Q.length;Y++){var ie,ue=Q[Y],we=ue.type;if(we==="Point"||we==="MultiPoint"||we==="LineString")ie=io(ue.geometry,L);else if(we==="MultiLineString"||we==="Polygon"){ie=[];for(var xe=0;xe<ue.geometry.length;xe++)ie.push(io(ue.geometry[xe],L))}else if(we==="MultiPolygon")for(ie=[],xe=0;xe<ue.geometry.length;xe++){for(var de=[],Ee=0;Ee<ue.geometry[xe].length;Ee++)de.push(io(ue.geometry[xe][Ee],L));ie.push(de)}$.push(Nn(ue.id,we,ie,ue.tags))}return $}function io(Q,L){var $=[];$.size=Q.size,Q.start!==void 0&&($.start=Q.start,$.end=Q.end);for(var Y=0;Y<Q.length;Y+=3)$.push(Q[Y]+L,Q[Y+1],Q[Y+2]);return $}function da(Q,L){if(Q.transformed)return Q;var $,Y,ie,ue=1<<Q.z,we=Q.x,xe=Q.y;for($=0;$<Q.features.length;$++){var de=Q.features[$],Ee=de.geometry,Fe=de.type;if(de.geometry=[],Fe===1)for(Y=0;Y<Ee.length;Y+=2)de.geometry.push(ei(Ee[Y],Ee[Y+1],L,ue,we,xe));else for(Y=0;Y<Ee.length;Y++){var Je=[];for(ie=0;ie<Ee[Y].length;ie+=2)Je.push(ei(Ee[Y][ie],Ee[Y][ie+1],L,ue,we,xe));de.geometry.push(Je)}}return Q.transformed=!0,Q}function ei(Q,L,$,Y,ie,ue){return[Math.round($*(Q*Y-ie)),Math.round($*(L*Y-ue))]}function Do(Q,L,$,Y,ie){for(var ue=L===ie.maxZoom?0:ie.tolerance/((1<<L)*ie.extent),we={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:$,y:Y,z:L,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},xe=0;xe<Q.length;xe++){we.numFeatures++,hl(we,Q[xe],ue,ie);var de=Q[xe].minX,Ee=Q[xe].minY,Fe=Q[xe].maxX,Je=Q[xe].maxY;de<we.minX&&(we.minX=de),Ee<we.minY&&(we.minY=Ee),Fe>we.maxX&&(we.maxX=Fe),Je>we.maxY&&(we.maxY=Je)}return we}function hl(Q,L,$,Y){var ie=L.geometry,ue=L.type,we=[];if(ue==="Point"||ue==="MultiPoint")for(var xe=0;xe<ie.length;xe+=3)we.push(ie[xe]),we.push(ie[xe+1]),Q.numPoints++,Q.numSimplified++;else if(ue==="LineString")Ro(we,ie,Q,$,!1,!1);else if(ue==="MultiLineString"||ue==="Polygon")for(xe=0;xe<ie.length;xe++)Ro(we,ie[xe],Q,$,ue==="Polygon",xe===0);else if(ue==="MultiPolygon")for(var de=0;de<ie.length;de++){var Ee=ie[de];for(xe=0;xe<Ee.length;xe++)Ro(we,Ee[xe],Q,$,!0,xe===0)}if(we.length){var Fe=L.tags||null;if(ue==="LineString"&&Y.lineMetrics){for(var Je in Fe={},L.tags)Fe[Je]=L.tags[Je];Fe.mapbox_clip_start=ie.start/ie.size,Fe.mapbox_clip_end=ie.end/ie.size}var Ne={geometry:we,type:ue==="Polygon"||ue==="MultiPolygon"?3:ue==="LineString"||ue==="MultiLineString"?2:1,tags:Fe};L.id!==null&&(Ne.id=L.id),Q.features.push(Ne)}}function Ro(Q,L,$,Y,ie,ue){var we=Y*Y;if(Y>0&&L.size<(ie?we:Y))$.numPoints+=L.length/3;else{for(var xe=[],de=0;de<L.length;de+=3)(Y===0||L[de+2]>we)&&($.numSimplified++,xe.push(L[de]),xe.push(L[de+1])),$.numPoints++;ie&&function(Ee,Fe){for(var Je=0,Ne=0,pt=Ee.length,Xe=pt-2;Ne<pt;Xe=Ne,Ne+=2)Je+=(Ee[Ne]-Ee[Xe])*(Ee[Ne+1]+Ee[Xe+1]);if(Je>0===Fe)for(Ne=0,pt=Ee.length;Ne<pt/2;Ne+=2){var _e=Ee[Ne],Ae=Ee[Ne+1];Ee[Ne]=Ee[pt-2-Ne],Ee[Ne+1]=Ee[pt-1-Ne],Ee[pt-2-Ne]=_e,Ee[pt-1-Ne]=Ae}}(xe,ue),Q.push(xe)}}function Vi(Q,L){var $=(L=this.options=function(ie,ue){for(var we in ue)ie[we]=ue[we];return ie}(Object.create(this.options),L)).debug;if($&&console.time("preprocess data"),L.maxZoom<0||L.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(L.promoteId&&L.generateId)throw new Error("promoteId and generateId cannot be used together.");var Y=function(ie,ue){var we=[];if(ie.type==="FeatureCollection")for(var xe=0;xe<ie.features.length;xe++)Nr(we,ie.features[xe],ue,xe);else Nr(we,ie.type==="Feature"?ie:{geometry:ie},ue);return we}(Q,L);this.tiles={},this.tileCoords=[],$&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",L.indexMaxZoom,L.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Y=function(ie,ue){var we=ue.buffer/ue.extent,xe=ie,de=rr(ie,1,-1-we,we,0,-1,2,ue),Ee=rr(ie,1,1-we,2+we,0,-1,2,ue);return(de||Ee)&&(xe=rr(ie,1,-we,1+we,0,-1,2,ue)||[],de&&(xe=ul(de,1).concat(xe)),Ee&&(xe=xe.concat(ul(Ee,-1)))),xe}(Y,L)).length&&this.splitTile(Y,0,0,0),$&&(Y.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ps(Q,L,$){return 32*((1<<Q)*$+L)+Q}function pa(Q,L){const $=Q.tileID.canonical;if(!this._geoJSONIndex)return L(null,null);const Y=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!Y)return L(null,null);const ie=new X(Y.features);let ue=Le(ie);ue.byteOffset===0&&ue.byteLength===ue.buffer.byteLength||(ue=new Uint8Array(ue)),L(null,{vectorTile:ie,rawData:ue.buffer})}Vi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Vi.prototype.splitTile=function(Q,L,$,Y,ie,ue,we){for(var xe=[Q,L,$,Y],de=this.options,Ee=de.debug;xe.length;){Y=xe.pop(),$=xe.pop(),L=xe.pop(),Q=xe.pop();var Fe=1<<L,Je=ps(L,$,Y),Ne=this.tiles[Je];if(!Ne&&(Ee>1&&console.time("creation"),Ne=this.tiles[Je]=Do(Q,L,$,Y,de),this.tileCoords.push({z:L,x:$,y:Y}),Ee)){Ee>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",L,$,Y,Ne.numFeatures,Ne.numPoints,Ne.numSimplified),console.timeEnd("creation"));var pt="z"+L;this.stats[pt]=(this.stats[pt]||0)+1,this.total++}if(Ne.source=Q,ie){if(L===de.maxZoom||L===ie)continue;var Xe=1<<ie-L;if($!==Math.floor(ue/Xe)||Y!==Math.floor(we/Xe))continue}else if(L===de.indexMaxZoom||Ne.numPoints<=de.indexMaxPoints)continue;if(Ne.source=null,Q.length!==0){Ee>1&&console.time("clipping");var _e,Ae,Bt,Jt,St,jt,Wt=.5*de.buffer/de.extent,Bo=.5-Wt,Ci=.5+Wt,Qe=1+Wt;_e=Ae=Bt=Jt=null,St=rr(Q,Fe,$-Wt,$+Ci,0,Ne.minX,Ne.maxX,de),jt=rr(Q,Fe,$+Bo,$+Qe,0,Ne.minX,Ne.maxX,de),Q=null,St&&(_e=rr(St,Fe,Y-Wt,Y+Ci,1,Ne.minY,Ne.maxY,de),Ae=rr(St,Fe,Y+Bo,Y+Qe,1,Ne.minY,Ne.maxY,de),St=null),jt&&(Bt=rr(jt,Fe,Y-Wt,Y+Ci,1,Ne.minY,Ne.maxY,de),Jt=rr(jt,Fe,Y+Bo,Y+Qe,1,Ne.minY,Ne.maxY,de),jt=null),Ee>1&&console.timeEnd("clipping"),xe.push(_e||[],L+1,2*$,2*Y),xe.push(Ae||[],L+1,2*$,2*Y+1),xe.push(Bt||[],L+1,2*$+1,2*Y),xe.push(Jt||[],L+1,2*$+1,2*Y+1)}}},Vi.prototype.getTile=function(Q,L,$){var Y=this.options,ie=Y.extent,ue=Y.debug;if(Q<0||Q>24)return null;var we=1<<Q,xe=ps(Q,L=(L%we+we)%we,$);if(this.tiles[xe])return da(this.tiles[xe],ie);ue>1&&console.log("drilling down to z%d-%d-%d",Q,L,$);for(var de,Ee=Q,Fe=L,Je=$;!de&&Ee>0;)Ee--,Fe=Math.floor(Fe/2),Je=Math.floor(Je/2),de=this.tiles[ps(Ee,Fe,Je)];return de&&de.source?(ue>1&&console.log("found parent tile z%d-%d-%d",Ee,Fe,Je),ue>1&&console.time("drilling down"),this.splitTile(de.source,Ee,Fe,Je,Q,L,$),ue>1&&console.timeEnd("drilling down"),this.tiles[xe]?da(this.tiles[xe],ie):null):null};class Lo extends a.VectorTileWorkerSource{constructor(L,$,Y,ie,ue){super(L,$,Y,ie,pa),ue&&(this.loadGeoJSON=ue)}loadData(L,$){const Y=L&&L.request,ie=Y&&Y.collectResourceTiming;this.loadGeoJSON(L,(ue,we)=>{if(ue||!we)return $(ue);if(typeof we!="object")return $(new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`));{ae(we,!0);try{if(L.filter){const de=a.createExpression(L.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(de.result==="error")throw new Error(de.value.map(Fe=>`${Fe.key}: ${Fe.message}`).join(", "));const Ee=we.features.filter(Fe=>de.value.evaluate({zoom:0},Fe));we={type:"FeatureCollection",features:Ee}}this._geoJSONIndex=L.cluster?new ur(function({superclusterOptions:de,clusterProperties:Ee}){if(!Ee||!de)return de;const Fe={},Je={},Ne={accumulated:null,zoom:0},pt={properties:null},Xe=Object.keys(Ee);for(const _e of Xe){const[Ae,Bt]=Ee[_e],Jt=a.createExpression(Bt),St=a.createExpression(typeof Ae=="string"?[Ae,["accumulated"],["get",_e]]:Ae);Fe[_e]=Jt.value,Je[_e]=St.value}return de.map=_e=>{pt.properties=_e;const Ae={};for(const Bt of Xe)Ae[Bt]=Fe[Bt].evaluate(Ne,pt);return Ae},de.reduce=(_e,Ae)=>{pt.properties=Ae;for(const Bt of Xe)Ne.accumulated=_e[Bt],_e[Bt]=Je[Bt].evaluate(Ne,pt)},de}(L)).load(we.features):function(de,Ee){return new Vi(de,Ee)}(we,L.geojsonVtOptions)}catch(de){return $(de)}this.loaded={};const xe={};if(ie){const de=a.getPerformanceMeasurement(Y);de&&(xe.resourceTiming={},xe.resourceTiming[L.source]=JSON.parse(JSON.stringify(de)))}$(null,xe)}})}reloadTile(L,$){const Y=this.loaded;return Y&&Y[L.uid]?super.reloadTile(L,$):this.loadTile(L,$)}loadGeoJSON(L,$){if(L.request)a.getJSON(L.request,$);else{if(typeof L.data!="string")return $(new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`));try{return $(null,JSON.parse(L.data))}catch{return $(new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(L,$){try{$(null,this._geoJSONIndex.getClusterExpansionZoom(L.clusterId))}catch(Y){$(Y)}}getClusterChildren(L,$){try{$(null,this._geoJSONIndex.getChildren(L.clusterId))}catch(Y){$(Y)}}getClusterLeaves(L,$){try{$(null,this._geoJSONIndex.getLeaves(L.clusterId,L.limit,L.offset))}catch(Y){$(Y)}}}class Oo{constructor(L){this.self=L,this.actor=new a.Actor(L,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:Lo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=($,Y)=>{if(this.workerSourceTypes[$])throw new Error(`Worker source with name "${$}" already registered.`);this.workerSourceTypes[$]=Y},this.self.registerRTLTextPlugin=$=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=$.applyArabicShaping,a.plugin.processBidirectionalText=$.processBidirectionalText,a.plugin.processStyledBidirectionalText=$.processStyledBidirectionalText}}clearCaches(L,$,Y){delete this.layerIndexes[L],delete this.availableImages[L],delete this.workerSources[L],delete this.demWorkerSources[L],Y()}checkIfReady(L,$,Y){Y()}setReferrer(L,$){this.referrer=$}spriteLoaded(L,$){this.isSpriteLoaded[L]=$;for(const Y in this.workerSources[L]){const ie=this.workerSources[L][Y];for(const ue in ie)ie[ue]instanceof a.VectorTileWorkerSource&&(ie[ue].isSpriteLoaded=$,ie[ue].fire(new a.Event("isSpriteLoaded")))}}setImages(L,$,Y){this.availableImages[L]=$;for(const ie in this.workerSources[L]){const ue=this.workerSources[L][ie];for(const we in ue)ue[we].availableImages=$}Y()}enableTerrain(L,$,Y){this.terrain=$,Y()}setProjection(L,$){this.projections[L]=a.getProjection($)}setLayers(L,$,Y){this.getLayerIndex(L).replace($),Y()}updateLayers(L,$,Y){this.getLayerIndex(L).update($.layers,$.removedIds),Y()}loadTile(L,$,Y){const ie=this.enableTerrain?a.extend({enableTerrain:this.terrain},$):$;ie.projection=this.projections[L]||this.defaultProjection,this.getWorkerSource(L,$.type,$.source).loadTile(ie,Y)}loadDEMTile(L,$,Y){const ie=this.enableTerrain?a.extend({buildQuadTree:this.terrain},$):$;this.getDEMWorkerSource(L,$.source).loadTile(ie,Y)}reloadTile(L,$,Y){const ie=this.enableTerrain?a.extend({enableTerrain:this.terrain},$):$;ie.projection=this.projections[L]||this.defaultProjection,this.getWorkerSource(L,$.type,$.source).reloadTile(ie,Y)}abortTile(L,$,Y){this.getWorkerSource(L,$.type,$.source).abortTile($,Y)}removeTile(L,$,Y){this.getWorkerSource(L,$.type,$.source).removeTile($,Y)}removeSource(L,$,Y){if(!this.workerSources[L]||!this.workerSources[L][$.type]||!this.workerSources[L][$.type][$.source])return;const ie=this.workerSources[L][$.type][$.source];delete this.workerSources[L][$.type][$.source],ie.removeSource!==void 0?ie.removeSource($,Y):Y()}loadWorkerSource(L,$,Y){try{this.self.importScripts($.url),Y()}catch(ie){Y(ie.toString())}}syncRTLPluginState(L,$,Y){try{a.plugin.setState($);const ie=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&ie!=null){this.self.importScripts(ie);const ue=a.plugin.isParsed();Y(ue?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ie}`),ue)}}catch(ie){Y(ie.toString())}}getAvailableImages(L){let $=this.availableImages[L];return $||($=[]),$}getLayerIndex(L){let $=this.layerIndexes[L];return $||($=this.layerIndexes[L]=new V),$}getWorkerSource(L,$,Y){return this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][$]||(this.workerSources[L][$]={}),this.workerSources[L][$][Y]||(this.workerSources[L][$][Y]=new this.workerSourceTypes[$]({send:(ie,ue,we,xe,de,Ee)=>{this.actor.send(ie,ue,we,L,de,Ee)},scheduler:this.actor.scheduler},this.getLayerIndex(L),this.getAvailableImages(L),this.isSpriteLoaded[L])),this.workerSources[L][$][Y]}getDEMWorkerSource(L,$){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][$]||(this.demWorkerSources[L][$]=new F),this.demWorkerSources[L][$]}enforceCacheSizeLimit(L,$){a.enforceCacheSizeLimit($)}getWorkerPerformanceMetrics(L,$,Y){Y(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Oo(self)),Oo}),x(["./shared"],function(a){var A=D;function D(d){return!function(r){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var f,_,y=new Blob([""],{type:"text/javascript"}),w=URL.createObjectURL(y);try{_=new Worker(w),f=!0}catch{f=!1}return _&&_.terminate(),URL.revokeObjectURL(w),f}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var f=document.createElement("canvas");f.width=f.height=1;var _=f.getContext("2d");if(!_)return!1;var y=_.getImageData(0,0,1,1);return y&&y.width===f.width}()?(V[c=r&&r.failIfMajorPerformanceCaveat]===void 0&&(V[c]=function(f){var _,y=function(w){var S=document.createElement("canvas"),I=Object.create(D.webGLContextAttributes);return I.failIfMajorPerformanceCaveat=w,S.getContext("webgl",I)||S.getContext("experimental-webgl",I)}(f);if(!y)return!1;try{_=y.createShader(y.VERTEX_SHADER)}catch{return!1}return!(!_||y.isContextLost())&&(y.shaderSource(_,"void main() {}"),y.compileShader(_),y.getShaderParameter(_,y.COMPILE_STATUS)===!0)}(c)),V[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(d)}var V={};function N(d,r){if(Array.isArray(d)){if(!Array.isArray(r)||d.length!==r.length)return!1;for(let c=0;c<d.length;c++)if(!N(d[c],r[c]))return!1;return!0}if(typeof d=="object"&&d!==null&&r!==null){if(typeof r!="object"||Object.keys(d).length!==Object.keys(r).length)return!1;for(const c in d)if(!N(d[c],r[c]))return!1;return!0}return d===r}D.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const F={create:function(d,r,c){const f=a.window.document.createElement(d);return r!==void 0&&(f.className=r),c&&c.appendChild(f),f},createNS:function(d,r){return a.window.document.createElementNS(d,r)}},ae=a.window.document&&a.window.document.documentElement.style,be=ae&&ae.userSelect!==void 0?"userSelect":"WebkitUserSelect";let fe;F.disableDrag=function(){ae&&be&&(fe=ae[be],ae[be]="none")},F.enableDrag=function(){ae&&be&&(ae[be]=fe)},F.setTransform=function(d,r){d.style.transform=r};let ee=!1;try{const d=Object.defineProperty({},"passive",{get(){ee=!0}});a.window.addEventListener("test",d,d),a.window.removeEventListener("test",d,d)}catch{ee=!1}F.addEventListener=function(d,r,c,f={}){d.addEventListener(r,c,"passive"in f&&ee?f:f.capture)},F.removeEventListener=function(d,r,c,f={}){d.removeEventListener(r,c,"passive"in f&&ee?f:f.capture)};const G=function(d){d.preventDefault(),d.stopPropagation(),a.window.removeEventListener("click",G,!0)};function X(d,r,c){const f=d.offsetWidth===r.width?1:d.offsetWidth/r.width;return new a.pointGeometry((c.clientX-r.left)*f,(c.clientY-r.top)*f)}function me(d,r){var c=r[0],f=r[1],_=r[2],y=r[3],w=c*y-_*f;return w?(d[0]=y*(w=1/w),d[1]=-f*w,d[2]=-_*w,d[3]=c*w,d):null}F.suppressClick=function(){a.window.addEventListener("click",G,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",G,!0)},0)},F.mousePos=function(d,r){const c=d.getBoundingClientRect();return X(d,c,r)},F.touchPos=function(d,r){const c=d.getBoundingClientRect(),f=[];for(let _=0;_<r.length;_++)f.push(X(d,c,r[_]));return f},F.mouseButton=function(d){return a.window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button},F.remove=function(d){d.parentNode&&d.parentNode.removeChild(d)};class Te{constructor(r,c){this.pos=r,this.dir=c}intersectsPlane(r,c,f){const _=a.dot(c,this.dir);if(Math.abs(_)<1e-6)return!1;const y=a.dot(a.sub(a.create(),r,this.pos),c)/_,w=a.scaleAndAdd(a.create(),this.pos,this.dir,y);return a.copy(f,w),!0}}class We{constructor(r,c){this.points=r,this.planes=c}static fromInvProjectionMatrix(r,c,f){const _=Math.pow(2,f),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const I=a.transformMat4([],S,r),P=1/I[3]/c*_;return a.mul(I,I,[P,P,1/I[3],P])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const I=a.sub([],y[S[0]],y[S[1]]),P=a.sub([],y[S[2]],y[S[1]]),z=a.normalize([],a.cross([],I,P)),R=-a.dot(z,y[S[1]]);return z.concat(R)});return new We(y,w)}}class Pe{constructor(r,c){this.min=r,this.max=c,this.center=a.scale([],a.add([],this.min,this.max),.5)}quadrant(r){const c=[r%2==0,r<2],f=a.clone(this.min),_=a.clone(this.max);for(let y=0;y<c.length;y++)f[y]=c[y]?this.min[y]:this.center[y],_[y]=c[y]?this.center[y]:this.max[y];return _[2]=this.max[2],new Pe(f,_)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}intersects(r){const c=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let f=!0;for(let _=0;_<r.planes.length;_++){const y=r.planes[_];let w=0;for(let S=0;S<c.length;S++)w+=a.dot$1(y,c[S])>=0;if(w===0)return 0;w!==c.length&&(f=!1)}if(f)return 2;for(let _=0;_<3;_++){let y=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let S=0;S<r.points.length;S++){const I=r.points[S][_]-this.min[_];y=Math.min(y,I),w=Math.max(w,I)}if(w<0||y>this.max[_]-this.min[_])return 0}return 1}}function Le(d){const{userImage:r}=d;return!!(r&&r.render&&r.render())&&(d.data.replace(new Uint8Array(r.data.buffer)),!0)}class Ke extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:c,callback:f}of this.requestors)this._notify(c,f);this.requestors=[]}}getImage(r){return this.images[r]}addImage(r,c){this._validate(r,c)&&(this.images[r]=c)}_validate(r,c){let f=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),f=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),f=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),f=!1),f}_validateStretch(r,c){if(!r)return!0;let f=0;for(const _ of r){if(_[0]<f||_[1]<_[0]||c<_[1])return!1;f=_[1]}return!0}_validateContent(r,c){return!(r&&(r.length!==4||r[0]<0||c.data.width<r[0]||r[1]<0||c.data.height<r[1]||r[2]<0||c.data.width<r[2]||r[3]<0||c.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,c){c.version=this.images[r].version+1,this.images[r]=c,this.updatedImages[r]=!0}removeImage(r){const c=this.images[r];delete this.images[r],delete this.patterns[r],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,c){let f=!0;if(!this.isLoaded())for(const _ of r)this.images[_]||(f=!1);this.isLoaded()||f?this._notify(r,c):this.requestors.push({ids:r,callback:c})}_notify(r,c){const f={};for(const _ of r){this.images[_]||this.fire(new a.Event("styleimagemissing",{id:_}));const y=this.images[_];y?f[_]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,hasRenderCallback:Boolean(y.userImage&&y.userImage.render)}:a.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,f)}getPixelSize(){const{width:r,height:c}=this.atlasImage;return{width:r,height:c}}getPattern(r){const c=this.patterns[r],f=this.getImage(r);if(!f)return null;if(c&&c.position.version===f.version)return c.position;if(c)c.position.version=f.version;else{const _={w:f.data.width+2,h:f.data.height+2,x:0,y:0},y=new a.ImagePosition(_,f);this.patterns[r]={bin:_,position:y}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const c=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(r,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const y in this.patterns)r.push(this.patterns[y].bin);const{w:c,h:f}=a.potpack(r),_=this.atlasImage;_.resize({width:c||1,height:f||1});for(const y in this.patterns){const{bin:w}=this.patterns[y],S=w.x+1,I=w.y+1,P=this.images[y].data,z=P.width,R=P.height;a.RGBAImage.copy(P,_,{x:0,y:0},{x:S,y:I},{width:z,height:R}),a.RGBAImage.copy(P,_,{x:0,y:R-1},{x:S,y:I-1},{width:z,height:1}),a.RGBAImage.copy(P,_,{x:0,y:0},{x:S,y:I+R},{width:z,height:1}),a.RGBAImage.copy(P,_,{x:z-1,y:0},{x:S-1,y:I},{width:1,height:R}),a.RGBAImage.copy(P,_,{x:0,y:0},{x:S+z,y:I},{width:1,height:R})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const c of r){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const f=this.images[c];Le(f)&&this.updateImage(c,f)}}}const Ye=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(d,r){return function([c,f,_]){const y=a.degToRad(f+90),w=a.degToRad(_);return{x:c*Math.cos(y)*Math.sin(w),y:c*Math.sin(y)*Math.sin(w),z:c*Math.cos(w),azimuthal:f,polar:_}}(d.expression.evaluate(r))}interpolate(d,r,c){return{x:a.number(d.x,r.x,c),y:a.number(d.y,r.y,c),z:a.number(d.z,r.z,c),azimuthal:a.number(d.azimuthal,r.azimuthal,c),polar:a.number(d.polar,r.polar,c)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),it="-transition";class st extends a.Evented{constructor(r){super(),this._transitionable=new a.Transitionable(Ye),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,c={}){if(!this._validate(a.validateLight,r,c))for(const f in r){const _=r[f];a.endsWith(f,it)?this._transitionable.setTransition(f.slice(0,-it.length),_):this._transitionable.setValue(f,_)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,f){return(!f||f.validate!==!1)&&a.emitValidationErrors(this,r.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const ut=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),ht="-transition";class kt extends a.Evented{constructor(r){super(),this._transitionable=new a.Transitionable(ut),this.set(r),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(r){for(const c in r){const f=r[c];a.endsWith(c,ht)?this._transitionable.setTransition(c.slice(0,-ht.length),f):this._transitionable.setValue(c,f)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}}function Tt(d,r,c,f){const _=a.smoothstep(45,65,c),[y,w]=Gt(d,f),S=a.length(r);let I=1-Math.min(1,Math.exp((S-y)/(w-y)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*_*d.alpha}function Gt(d,r){const c=.5/Math.tan(.5*r);return[d.range[0]+c,d.range[1]+c]}const nn=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"])}),an="-transition";class In extends a.Evented{constructor(r,c){super(),this._transitionable=new a.Transitionable(nn),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=c}isSoftDisabled(){return this._transform.projection.name!=="mercator"}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,c={}){if(!this._validate(a.validateFog,r,c))for(const f in r){const _=r[f];a.endsWith(f,an)?this._transitionable.setTransition(f.slice(0,-an.length),_):this._transitionable.setValue(f,_)}}getOpacity(r){if(this.isSoftDisabled())return 0;const c=this.properties&&this.properties.get("color")||1;return a.smoothstep(45,65,r)*c.a}getOpacityAtLatLng(r,c){return this.isSoftDisabled()?0:function(f,_,y){const w=a.MercatorCoordinate.fromLngLat(_),S=y.elevation?y.elevation.getAtPointOrZero(w):0,I=[w.x,w.y,S];return a.transformMat4$1(I,I,y.mercatorFogMatrix),Tt(f,I,y.pitch,y._fov)}(this.state,r,c)}getFovAdjustedRange(r){return this.isSoftDisabled()?[0,1]:Gt(this.state,r)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,f){return(!f||f.validate!==!1)&&a.emitValidationErrors(this,r.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class er{constructor(r,c){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const f=this.workerPool.acquire(this.id);for(let _=0;_<f.length;_++){const y=new er.Actor(f[_],c,this.id);y.name=`Worker ${_}`,this.actors.push(y)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,c,f){a.asyncAll(this.actors,(_,y)=>{_.send(r,c,y)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ze(d,r,c){return r*(a.EXTENT/(d.tileSize*Math.pow(2,c-d.tileID.overscaledZ)))}er.Actor=a.Actor;class _t{constructor(r,c,f,_){this.screenBounds=r,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=f,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(y=>_.pointCoordinate3D(y)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(r,c){let f,_;if(r instanceof a.pointGeometry||typeof r[0]=="number"){const y=a.pointGeometry.convert(r);f=[a.pointGeometry.convert(r)],_=c.isPointAboveHorizon(y)}else{const y=a.pointGeometry.convert(r[0]),w=a.pointGeometry.convert(r[1]);f=[y,w],_=a.polygonizeBounds(y,w).every(S=>c.isPointAboveHorizon(S))}return new _t(f,c.getCameraPoint(),_,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const c=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],_=a.polygonizeBounds(c,f,0,!1);return this.cameraPoint.y>f.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<f.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=f.x?_[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(_[3]=this.cameraPoint)),a.bufferConvexPolygon(_,r)}containsTile(r,c,f){const _=r.queryPadding+1,y=r.tileID.wrap,w=f?this._bufferedCameraMercator(_,c).map(K=>a.getTilePoint(r.tileTransform,K,y)):this._bufferedScreenMercator(_,c).map(K=>a.getTilePoint(r.tileTransform,K,y)),S=this.screenGeometryMercator.map(K=>a.getTileVec3(r.tileTransform,K,y)),I=S.map(K=>new a.pointGeometry(K[0],K[1])),P=c.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),z=a.getTileVec3(r.tileTransform,P,y),R=S.map(K=>{const Z=a.sub(K,K,z);return a.normalize(Z,Z),new Te(z,Z)}),U=Ze(r,1,c.zoom);if(a.polygonIntersectsBox(w,0,0,a.EXTENT,a.EXTENT))return{queryGeometry:this,tilespaceGeometry:I,tilespaceRays:R,bufferedTilespaceGeometry:w,bufferedTilespaceBounds:(W=a.getBounds(w),W.min.x=a.clamp(W.min.x,0,a.EXTENT),W.min.y=a.clamp(W.min.y,0,a.EXTENT),W.max.x=a.clamp(W.max.x,0,a.EXTENT),W.max.y=a.clamp(W.max.y,0,a.EXTENT),W),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:U};var W}_bufferedScreenMercator(r,c){const f=dt(r);if(this._screenRaycastCache[f])return this._screenRaycastCache[f];{const _=this.bufferedScreenGeometry(r).map(y=>c.pointCoordinate3D(y));return this._screenRaycastCache[f]=_,_}}_bufferedCameraMercator(r,c){const f=dt(r);if(this._cameraRaycastCache[f])return this._cameraRaycastCache[f];{const _=this.bufferedCameraGeometry(r).map(y=>c.pointCoordinate3D(y));return this._cameraRaycastCache[f]=_,_}}}function dt(d){return 100*d|0}function Ut(d,r,c){const f=function(_,y){if(_)return c(_);if(y){const w=a.pick(a.extend(y,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);y.vector_layers&&(w.vectorLayers=y.vector_layers,w.vectorLayerIds=w.vectorLayers.map(S=>S.id)),w.tiles=r.canonicalizeTileset(w,d.url),c(null,w)}};return d.url?a.getJSON(r.transformRequest(r.normalizeSourceURL(d.url),a.ResourceType.Source),f):a.exported.frame(()=>f(null,d))}class vn{constructor(r,c,f){this.bounds=a.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=c||0,this.maxzoom=f||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const c=Math.pow(2,r.z),f=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*c),_=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*c),y=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*c),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*c);return r.x>=f&&r.x<y&&r.y>=_&&r.y<w}}class wn{constructor(r,c,f){this.context=r;const _=r.gl;this.buffer=_.createBuffer(),this.dynamicDraw=Boolean(f),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const An={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ur{constructor(r,c,f,_){this.length=c.length,this.attributes=f,this.itemSize=c.bytesPerElement,this.dynamicDraw=_,this.context=r;const y=r.gl;this.buffer=y.createBuffer(),r.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,c){for(let f=0;f<this.attributes.length;f++){const _=c.attributes[this.attributes[f].name];_!==void 0&&r.enableVertexAttribArray(_)}}setVertexAttribPointers(r,c,f){for(let _=0;_<this.attributes.length;_++){const y=this.attributes[_],w=c.attributes[y.name];w!==void 0&&r.vertexAttribPointer(w,y.components,r[An[y.type]],!1,this.itemSize,y.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class It{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class di extends It{getDefault(){return a.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class no extends It{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Po extends It{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Ni extends It{getDefault(){return[!0,!0,!0,!0]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class hr extends It{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Ui extends It{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Ot extends It{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const c=this.current;(r.func!==c.func||r.ref!==c.ref||r.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class ct extends It{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class $t extends It{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=r,this.dirty=!1}}class cn extends It{getDefault(){return[0,1]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class tr extends It{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=r,this.dirty=!1}}class Nn extends It{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Jr extends It{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.BLEND):c.disable(c.BLEND),this.current=r,this.dirty=!1}}class Nr extends It{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Ti extends It{getDefault(){return a.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class dr extends It{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Qr extends It{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=r,this.dirty=!1}}class ji extends It{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class pr extends It{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class rr extends It{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class ro extends It{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Si extends It{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class zo extends It{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class ha extends It{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ds extends It{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class tu extends It{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class cl extends It{getDefault(){return null}set(r){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class ul extends It{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class io extends It{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class da extends It{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class ei extends It{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Do extends It{constructor(r,c){super(r),this.context=r,this.parent=c}getDefault(){return null}}class hl extends Do{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Ro extends Do{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Vi extends Ro{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ps{constructor(r,c,f,_){this.context=r,this.width=c,this.height=f;const y=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new hl(r,y),_&&(this.depthAttachment=new Ro(r,y))}destroy(){const r=this.context.gl,c=this.colorAttachment.get();if(c&&r.deleteTexture(c),this.depthAttachment){const f=this.depthAttachment.get();f&&r.deleteRenderbuffer(f)}r.deleteFramebuffer(this.framebuffer)}}class pa{constructor(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new di(this),this.clearDepth=new no(this),this.clearStencil=new Po(this),this.colorMask=new Ni(this),this.depthMask=new hr(this),this.stencilMask=new Ui(this),this.stencilFunc=new Ot(this),this.stencilOp=new ct(this),this.stencilTest=new $t(this),this.depthRange=new cn(this),this.depthTest=new tr(this),this.depthFunc=new Nn(this),this.blend=new Jr(this),this.blendFunc=new Nr(this),this.blendColor=new Ti(this),this.blendEquation=new dr(this),this.cullFace=new Qr(this),this.cullFaceSide=new ji(this),this.frontFace=new pr(this),this.program=new rr(this),this.activeTexture=new ro(this),this.viewport=new Si(this),this.bindFramebuffer=new zo(this),this.bindRenderbuffer=new ha(this),this.bindTexture=new ds(this),this.bindVertexBuffer=new tu(this),this.bindElementBuffer=new cl(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ul(this),this.pixelStoreUnpack=new io(this),this.pixelStoreUnpackPremultiplyAlpha=new da(this),this.pixelStoreUnpackFlipY=new ei(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,c){return new wn(this,r,c)}createVertexBuffer(r,c,f){return new ur(this,r,c,f)}createRenderbuffer(r,c,f){const _=this.gl,y=_.createRenderbuffer();return this.bindRenderbuffer.set(y),_.renderbufferStorage(_.RENDERBUFFER,r,c,f),this.bindRenderbuffer.set(null),y}createFramebuffer(r,c,f){return new ps(this,r,c,f)}clear({color:r,depth:c,stencil:f}){const _=this.gl;let y=0;r&&(y|=_.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(y|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),f!==void 0&&(y|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),_.clear(y)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){N(r.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Lo extends a.Evented{constructor(r,c,f,_){super(),this.id=r,this.dispatcher=f,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ut(this._options,this.map._requestManager,(r,c)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new a.ErrorEvent(r)):c&&(a.extend(this,c),c.bounds&&(this.tileBounds=new vn(c.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(c.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,c){const f=a.exported.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),f,this.tileSize);r.request=a.getImage(this.map._requestManager.transformRequest(_,a.ResourceType.Tile),(y,w,S,I)=>{if(delete r.request,r.aborted)r.state="unloaded",c(null);else if(y)r.state="errored",c(y);else if(w){this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:S,expires:I});const P=this.map.painter.context,z=P.gl;r.texture=this.map.painter.getTileTexture(w.width),r.texture?r.texture.update(w,{useMipmap:!0}):(r.texture=new a.Texture(P,w,z.RGBA,{useMipmap:!0}),r.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE),P.extTextureFilterAnisotropic&&z.texParameterf(z.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),r.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),c(null)}})}abortTile(r,c){r.request&&(r.request.cancel(),delete r.request),c()}unloadTile(r,c){r.texture&&this.map.painter.saveTileTexture(r.texture),c()}hasTransition(){return!1}}let Oo;class Q extends a.Evented{constructor(r,c,f,_){super(),this.id=r,this.dispatcher=f,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=c}load(r,c){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(f,_)=>{this._loaded=!0,f?this.fire(new a.ErrorEvent(f)):_&&(this.image=a.exported.getImageData(_),r&&(this.coordinates=r),c&&c(),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this.options.url=r.url,this.load(r.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}setCoordinates(r){this.coordinates=r,delete this._boundsArray;const c=r.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(f){let _=1/0,y=1/0,w=-1/0,S=-1/0;for(const R of f)_=Math.min(_,R.x),y=Math.min(y,R.y),w=Math.max(w,R.x),S=Math.max(S,R.y);const I=Math.max(w-_,S-y),P=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),z=Math.pow(2,P);return new a.CanonicalTileID(P,Math.floor((_+w)/2*z),Math.floor((y+S)/2*z))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){delete this._boundsArray}_makeBoundsArray(){const r=a.tileTransform(this.tileID,this.map.transform.projection),c=this.coordinates.map(f=>{const _=r.projection.project(f[0],f[1]);return a.getTilePoint(r,_)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(c[2].x,c[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,c=r.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(r,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}loadTile(r,c){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},c(null)):(r.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const L={vector:class extends a.Evented{constructor(d,r,c,f){if(super(),this.id=d,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(r,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ut(this._options,this.map._requestManager,(d,r)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new a.ErrorEvent(d)):r&&(a.extend(this,r),r.bounds&&(this.tileBounds=new vn(r.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(r.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}setSourceProperty(d){this._tileJSONRequest&&this._tileJSONRequest.cancel(),d();const r=this.map.style._getSourceCaches(this.id);for(const c of r)c.clearTiles();this.load()}setTiles(d){return this.setSourceProperty(()=>{this._options.tiles=d}),this}setUrl(d){return this.setSourceProperty(()=>{this.url=d,this._options.url=d}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(d,r){const c=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),f={request:this.map._requestManager.transformRequest(c,a.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(f.request.collectResourceTiming=this._collectResourceTiming,d.actor&&d.state!=="expired")d.state==="loading"?d.reloadCallback=r:d.request=d.actor.send("reloadTile",f,_.bind(this));else if(d.actor=this._tileWorkers[c]=this._tileWorkers[c]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",f,_.bind(this),void 0,!0);else{const y=a.loadVectorTile.call({deduped:this._deduped},f,(w,S)=>{w||!S?_.call(this,w):(f.data={cacheControl:S.cacheControl,expires:S.expires,rawData:S.rawData.slice(0)},d.actor&&d.actor.send("loadTile",f,_.bind(this),void 0,!0))},!0);d.request={cancel:y}}function _(y,w){return delete d.request,d.aborted?r(null):y&&y.status!==404?r(y):(w&&w.resourceTiming&&(d.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&d.setExpiryData(w),d.loadVectorData(w,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Lo,"raster-dem":class extends Lo{constructor(d,r,c,f){super(d,r,c,f),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(d,r){const c=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function f(_,y){_&&(d.state="errored",r(_)),y&&(d.dem=y,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",r(null))}d.request=a.getImage(this.map._requestManager.transformRequest(c,a.ResourceType.Tile),function(_,y,w,S){if(delete d.request,d.aborted)d.state="unloaded",r(null);else if(_)d.state="errored",r(_);else if(y){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:w,expires:S});const I=a.window.ImageBitmap&&y instanceof a.window.ImageBitmap&&(Oo==null&&(Oo=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),Oo),P=1-(y.width-a.prevPowerOfTwo(y.width))/2;P<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const z=I?y:a.exported.getImageData(y,P),R={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:z,encoding:this.encoding,padding:P};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",R,f.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(d){const r=d.canonical,c=Math.pow(2,r.z),f=(r.x-1+c)%c,_=r.x===0?d.wrap-1:d.wrap,y=(r.x+1+c)%c,w=r.x+1===c?d.wrap+1:d.wrap,S={};return S[new a.OverscaledTileID(d.overscaledZ,_,r.z,f,r.y).key]={backfilled:!1},S[new a.OverscaledTileID(d.overscaledZ,w,r.z,y,r.y).key]={backfilled:!1},r.y>0&&(S[new a.OverscaledTileID(d.overscaledZ,_,r.z,f,r.y-1).key]={backfilled:!1},S[new a.OverscaledTileID(d.overscaledZ,d.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},S[new a.OverscaledTileID(d.overscaledZ,w,r.z,y,r.y-1).key]={backfilled:!1}),r.y+1<c&&(S[new a.OverscaledTileID(d.overscaledZ,_,r.z,f,r.y+1).key]={backfilled:!1},S[new a.OverscaledTileID(d.overscaledZ,d.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},S[new a.OverscaledTileID(d.overscaledZ,w,r.z,y,r.y+1).key]={backfilled:!1}),S}unloadTile(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded"}},geojson:class extends a.Evented{constructor(d,r,c,f){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(f),this._data=r.data,this._options=a.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const _=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*_,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*_,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:a.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*_,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}getClusterExpansionZoom(d,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},r),this}getClusterChildren(d,r){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},r),this}getClusterLeaves(d,r,c,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:r,offset:c},f),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const d=a.extend({},this.workerOptions),r=this._data;typeof r=="string"?(d.request=this.map._requestManager.transformRequest(a.exported.resolveURL(r),a.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,d,(c,f)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new a.ErrorEvent(c));else{const _={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&f&&f.resourceTiming&&f.resourceTiming[this.id]&&(_.resourceTiming=f.resourceTiming[this.id]),this.fire(new a.Event("data",_)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,r){const c=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(c,{type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(f,_)=>(delete d.request,d.unloadVectorData(),d.aborted?r(null):f?r(f):(d.loadVectorData(_,this.map.painter,c==="reloadTile"),r(null))),void 0,c==="loadTile")}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Q{constructor(d,r,c,f){super(d,r,c,f),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const r of d.urls)this.urls.push(this.map._requestManager.transformRequest(r,a.ResourceType.Source).url);a.getVideo(this.urls,(r,c)=>{this._loaded=!0,r?this.fire(new a.ErrorEvent(r)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const r=this.video.seekable;d<r.start(0)||d>r.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const d=this.map.painter.context,r=d.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(d,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));for(const c in this.tiles){const f=this.tiles[c];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Q,canvas:class extends Q{constructor(d,r,c,f){super(d,r,c,f),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(y=>typeof y!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,c=r.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(r,this.canvas,c.RGBA,{premultiply:!0});for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}}},$=function(d,r,c,f){const _=new L[r.type](d,r,c,f);if(_.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${_.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],_),_};function Y(d,r){const c=a.identity([]);return a.scale$1(c,c,[.5*d.width,.5*-d.height,1]),a.translate(c,c,[1,-1,0]),a.multiply(c,c,d.calculateProjMatrix(r.toUnwrapped()))}function ie(d,r,c,f,_,y,w,S=!1){const I=d.tilesIn(f,w,S);I.sort(we);const P=[];for(const R of I)P.push({wrappedTileID:R.tile.tileID.wrapped().key,queryResults:R.tile.queryRenderedFeatures(r,c,d._state,R,_,y,Y(d.transform,R.tile.tileID),S)});const z=function(R){const U={},W={};for(const K of R){const Z=K.queryResults,ne=K.wrappedTileID,q=W[ne]=W[ne]||{};for(const re in Z){const se=Z[re],H=q[re]=q[re]||{},le=U[re]=U[re]||[];for(const he of se)H[he.featureIndex]||(H[he.featureIndex]=!0,le.push(he))}}return U}(P);for(const R in z)z[R].forEach(U=>{const W=U.feature,K=d.getFeatureState(W.layer["source-layer"],W.id);W.source=W.layer.source,W.layer["source-layer"]&&(W.sourceLayer=W.layer["source-layer"]),W.state=K});return z}function ue(d,r){const c=d.getRenderableIds().map(y=>d.getTileByID(y)),f=[],_={};for(let y=0;y<c.length;y++){const w=c[y],S=w.tileID.canonical.key;_[S]||(_[S]=!0,w.querySourceFeatures(f,r))}return f}function we(d,r){const c=d.tileID,f=r.tileID;return c.overscaledZ-f.overscaledZ||c.canonical.y-f.canonical.y||c.wrap-f.wrap||c.canonical.x-f.canonical.x}function xe(){return Ms.workerClass!=null?new Ms.workerClass:new a.window.Worker(Ms.workerUrl)}const de="mapboxgl_preloaded_worker_pool";class Ee{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Ee.workerCount;)this.workers.push(new xe);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[de]}numActive(){return Object.keys(this.active).length}}let Fe;function Je(){return Fe||(Fe=new Ee),Fe}function Ne(d,r){const c={};for(const f in d)f!=="ref"&&(c[f]=d[f]);return a.refProperties.forEach(f=>{f in r&&(c[f]=r[f])}),c}function pt(d){d=d.slice();const r=Object.create(null);for(let c=0;c<d.length;c++)r[d[c].id]=d[c];for(let c=0;c<d.length;c++)"ref"in d[c]&&(d[c]=Ne(d[c],r[d[c].ref]));return d}Ee.workerCount=2;const Xe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function _e(d,r,c){c.push({command:Xe.addSource,args:[d,r[d]]})}function Ae(d,r,c){r.push({command:Xe.removeSource,args:[d]}),c[d]=!0}function Bt(d,r,c,f){Ae(d,c,f),_e(d,r,c)}function Jt(d,r,c){let f;for(f in d[c])if(d[c].hasOwnProperty(f)&&f!=="data"&&!N(d[c][f],r[c][f]))return!1;for(f in r[c])if(r[c].hasOwnProperty(f)&&f!=="data"&&!N(d[c][f],r[c][f]))return!1;return!0}function St(d,r,c,f,_,y){let w;for(w in r=r||{},d=d||{})d.hasOwnProperty(w)&&(N(d[w],r[w])||c.push({command:y,args:[f,w,r[w],_]}));for(w in r)r.hasOwnProperty(w)&&!d.hasOwnProperty(w)&&(N(d[w],r[w])||c.push({command:y,args:[f,w,r[w],_]}))}function jt(d){return d.id}function Wt(d,r){return d[r.id]=r,d}class Bo{constructor(r,c){this.reset(r,c)}reset(r,c){this.points=r||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=a.clamp(r,0,1);let c=1,f=this._distances[c];const _=r*this.paddedLength+this.padding;for(;f<_&&c<this._distances.length;)f=this._distances[++c];const y=c-1,w=this._distances[y],S=f-w,I=S>0?(_-w)/S:0;return this.points[y].mult(1-I).add(this.points[c].mult(I))}}class Ci{constructor(r,c,f){const _=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(r/f),this.yCellCount=Math.ceil(c/f);for(let w=0;w<this.xCellCount*this.yCellCount;w++)_.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=c,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,c,f,_,y){this._forEachCell(c,f,_,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(y)}insertCircle(r,c,f,_){this._forEachCell(c-_,f-_,c+_,f+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(c),this.circles.push(f),this.circles.push(_)}_insertBoxCell(r,c,f,_,y,w){this.boxCells[y].push(w)}_insertCircleCell(r,c,f,_,y,w){this.circleCells[y].push(w)}_query(r,c,f,_,y,w){if(f<0||r>this.width||_<0||c>this.height)return!y&&[];const S=[];if(r<=0&&c<=0&&this.width<=f&&this.height<=_){if(y)return!0;for(let I=0;I<this.boxKeys.length;I++)S.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const P=this.circles[3*I],z=this.circles[3*I+1],R=this.circles[3*I+2];S.push({key:this.circleKeys[I],x1:P-R,y1:z-R,x2:P+R,y2:z+R})}return w?S.filter(w):S}return this._forEachCell(r,c,f,_,this._queryCell,S,{hitTest:y,seenUids:{box:{},circle:{}}},w),y?S.length>0:S}_queryCircle(r,c,f,_,y){const w=r-f,S=r+f,I=c-f,P=c+f;if(S<0||w>this.width||P<0||I>this.height)return!_&&[];const z=[];return this._forEachCell(w,I,S,P,this._queryCellCircle,z,{hitTest:_,circle:{x:r,y:c,radius:f},seenUids:{box:{},circle:{}}},y),_?z.length>0:z}query(r,c,f,_,y){return this._query(r,c,f,_,!1,y)}hitTest(r,c,f,_,y){return this._query(r,c,f,_,!0,y)}hitTestCircle(r,c,f,_){return this._queryCircle(r,c,f,!0,_)}_queryCell(r,c,f,_,y,w,S,I){const P=S.seenUids,z=this.boxCells[y];if(z!==null){const U=this.bboxes;for(const W of z)if(!P.box[W]){P.box[W]=!0;const K=4*W;if(r<=U[K+2]&&c<=U[K+3]&&f>=U[K+0]&&_>=U[K+1]&&(!I||I(this.boxKeys[W]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[W],x1:U[K],y1:U[K+1],x2:U[K+2],y2:U[K+3]})}}}const R=this.circleCells[y];if(R!==null){const U=this.circles;for(const W of R)if(!P.circle[W]){P.circle[W]=!0;const K=3*W;if(this._circleAndRectCollide(U[K],U[K+1],U[K+2],r,c,f,_)&&(!I||I(this.circleKeys[W]))){if(S.hitTest)return w.push(!0),!0;{const Z=U[K],ne=U[K+1],q=U[K+2];w.push({key:this.circleKeys[W],x1:Z-q,y1:ne-q,x2:Z+q,y2:ne+q})}}}}}_queryCellCircle(r,c,f,_,y,w,S,I){const P=S.circle,z=S.seenUids,R=this.boxCells[y];if(R!==null){const W=this.bboxes;for(const K of R)if(!z.box[K]){z.box[K]=!0;const Z=4*K;if(this._circleAndRectCollide(P.x,P.y,P.radius,W[Z+0],W[Z+1],W[Z+2],W[Z+3])&&(!I||I(this.boxKeys[K])))return w.push(!0),!0}}const U=this.circleCells[y];if(U!==null){const W=this.circles;for(const K of U)if(!z.circle[K]){z.circle[K]=!0;const Z=3*K;if(this._circlesCollide(W[Z],W[Z+1],W[Z+2],P.x,P.y,P.radius)&&(!I||I(this.circleKeys[K])))return w.push(!0),!0}}}_forEachCell(r,c,f,_,y,w,S,I){const P=this._convertToXCellCoord(r),z=this._convertToYCellCoord(c),R=this._convertToXCellCoord(f),U=this._convertToYCellCoord(_);for(let W=P;W<=R;W++)for(let K=z;K<=U;K++)if(y.call(this,r,c,f,_,this.xCellCount*K+W,w,S,I))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,c,f,_,y,w){const S=_-r,I=y-c,P=f+w;return P*P>S*S+I*I}_circleAndRectCollide(r,c,f,_,y,w,S){const I=(w-_)/2,P=Math.abs(r-(_+I));if(P>I+f)return!1;const z=(S-y)/2,R=Math.abs(c-(y+z));if(R>z+f)return!1;if(P<=I||R<=z)return!0;const U=P-I,W=R-z;return U*U+W*W<=f*f}}const Qe=Math.tan(85*Math.PI/180);function Lt(d,r,c,f,_){const y=a.create$1();if(r){const w=me([],_);y[0]=w[0],y[1]=w[1],y[4]=w[2],y[5]=w[3],c||a.rotateZ(y,y,f.angle)}else a.multiply(y,f.labelPlaneMatrix,d);return y}function Dt(d,r,c,f,_){if(r){const y=a.clone$1(d),w=a.identity([]);return w[0]=_[0],w[1]=_[1],w[4]=_[2],w[5]=_[3],a.multiply(y,y,w),c||a.rotateZ(y,y,-f.angle),y}return f.glCoordMatrix}function Rn(d,r,c=0){const f=[d.x,d.y,c,1];c?a.transformMat4(f,f,r):pl(f,f,r);const _=f[3];return{point:new a.pointGeometry(f[0]/_,f[1]/_),signedDistanceFromCamera:_}}function Fo(d,r){return Math.min(.5+d/r*.5,1.5)}function Rt(d,r){const c=d[0]/d[3],f=d[1]/d[3];return c>=-r[0]&&c<=r[0]&&f>=-r[1]&&f<=r[1]}function dl(d,r,c,f,_,y,w,S,I){const P=f?d.textSizeData:d.iconSizeData,z=a.evaluateSizeForZoom(P,c.transform.zoom),R=[256/c.width*2+1,256/c.height*2+1],U=f?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;U.clear();const W=d.lineVertexArray,K=f?d.text.placedSymbolArray:d.icon.placedSymbolArray,Z=c.transform.width/c.transform.height;let ne=!1;for(let q=0;q<K.length;q++){const re=K.get(q);if(re.writingMode!==a.WritingMode.vertical||ne||q!==0&&K.get(q-1).writingMode===a.WritingMode.horizontal||(ne=!0),re.hidden||re.writingMode===a.WritingMode.vertical&&!ne){pi(re.numGlyphs,U);continue}ne=!1;const se=new a.pointGeometry(re.tileAnchorX,re.tileAnchorY),H=I?I(se):0,le=[se.x,se.y,H],he=[...le,1];if(a.transformMat4(he,he,r),!Rt(he,R)){pi(re.numGlyphs,U);continue}const ke=Fo(c.transform.cameraToCenterDistance,he[3]),Ce=a.evaluateSizeForFeature(P,z,re),ze=w?Ce/ke:Ce*ke,De=Rn(new a.pointGeometry(le[0],le[1]),_,le[2]);if(De.signedDistanceFromCamera<=0){pi(re.numGlyphs,U);continue}let Ge={};const Me=w?null:I,qe=Ur(re,ze,!1,S,r,_,y,d.glyphOffsetArray,W,U,De.point,se,Ge,Z,Me);ne=qe.useVertical,Me&&qe.needsFlipping&&(Ge={}),(qe.notEnoughRoom||ne||qe.needsFlipping&&Ur(re,ze,!0,S,r,_,y,d.glyphOffsetArray,W,U,De.point,se,Ge,Z,Me).notEnoughRoom)&&pi(re.numGlyphs,U)}f?d.text.dynamicLayoutVertexBuffer.updateData(U):d.icon.dynamicLayoutVertexBuffer.updateData(U)}function fs(d,r,c,f,_,y,w,S,I,P,z,R,U){const W=S.glyphStartIndex+S.numGlyphs,K=S.lineStartIndex,Z=S.lineStartIndex+S.lineLength,ne=r.getoffsetX(S.glyphStartIndex),q=r.getoffsetX(W-1),re=oo(d*ne,c,f,_,y,w,S.segment,K,Z,I,P,z,R,U,!0);if(!re)return null;const se=oo(d*q,c,f,_,y,w,S.segment,K,Z,I,P,z,R,U,!0);return se?{first:re,last:se}:null}function ms(d,r,c,f){return d.writingMode===a.WritingMode.horizontal&&Math.abs(c.y-r.y)>Math.abs(c.x-r.x)*f?{useVertical:!0}:d.writingMode===a.WritingMode.vertical?r.y<c.y?{needsFlipping:!0}:null:d.flipState!==0&&function(_,y,w){const S=(y.x-_.x)*w;return S===0||Math.abs((y.y-_.y)/S)>Qe}(r,c,f)?d.flipState===1?{needsFlipping:!0}:null:r.x>c.x?{needsFlipping:!0}:null}function Ur(d,r,c,f,_,y,w,S,I,P,z,R,U,W,K){const Z=r/24,ne=d.lineOffsetX*Z,q=d.lineOffsetY*Z;let re;if(d.numGlyphs>1){const se=d.glyphStartIndex+d.numGlyphs,H=d.lineStartIndex,le=d.lineStartIndex+d.lineLength,he=fs(Z,S,ne,q,c,z,R,d,I,y,U,K,!1);if(!he)return{notEnoughRoom:!0};const ke=Rn(he.first.point,w).point,Ce=Rn(he.last.point,w).point;if(f&&!c){const ze=ms(d,ke,Ce,W);if(d.flipState=ze&&ze.needsFlipping?1:2,ze)return ze}re=[he.first];for(let ze=d.glyphStartIndex+1;ze<se-1;ze++)re.push(oo(Z*S.getoffsetX(ze),ne,q,c,z,R,d.segment,H,le,I,y,U,K,!1,!1));re.push(he.last)}else{if(f&&!c){const H=Rn(R,_).point,le=d.lineStartIndex+d.segment+1,he=new a.pointGeometry(I.getx(le),I.gety(le)),ke=Rn(he,_),Ce=ms(d,H,ke.signedDistanceFromCamera>0?ke.point:fd(R,he,H,1,_,void 0),W);if(d.flipState=Ce&&Ce.needsFlipping?1:2,Ce)return Ce}const se=oo(Z*S.getoffsetX(d.glyphStartIndex),ne,q,c,z,R,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,I,y,U,K,!1,!1);if(!se)return{notEnoughRoom:!0};re=[se]}for(const se of re)a.addDynamicAttributes(P,se.point,se.angle);return{}}function xn(d,r,c){const f={x:d.x,y:d.y,z:0};if(!c)return Rn(f,r,f.z);const _=c(d);return Rn(new a.pointGeometry(f.x,f.y),r,f.z+_)}function fd(d,r,c,f,_,y){const w=xn(d.add(d.sub(r)._unit()),_,y).point,S=c.sub(w);return c.add(S._mult(f/S.mag()))}function oo(d,r,c,f,_,y,w,S,I,P,z,R,U,W,K){const Z=f?d-r:d+r;let ne=Z>0?1:-1,q=0;f&&(ne*=-1,q=Math.PI),ne<0&&(q+=Math.PI);let re=ne>0?S+w:S+w+1,se=_,H=_,le=0,he=0;const ke=Math.abs(Z),Ce=[],ze=[];let De=y;const Ge=()=>{const yt=re-ne;return le===0?y:new a.pointGeometry(P.getx(yt),P.gety(yt))},Me=()=>fd(Ge(),De,H,ke-le+1,z,U);for(;le+he<=ke;){if(re+=ne,re<S||re>=I)return null;if(H=se,Ce.push(se),W&&ze.push(De||Ge()),se=R[re],se===void 0){De=new a.pointGeometry(P.getx(re),P.gety(re));const yt=xn(De,z,U);se=yt.signedDistanceFromCamera>0?R[re]=yt.point:Me()}else De=null;le+=he,he=H.dist(se)}K&&U&&(De=De||new a.pointGeometry(P.getx(re),P.gety(re)),R[re]=se=R[re]===void 0?se:Me(),he=H.dist(se));const qe=(ke-le)/he,Se=se.sub(H),He=Se.mult(qe)._add(H);c&&He._add(Se._unit()._perp()._mult(c*ne));const lt=q+Math.atan2(se.y-H.y,se.x-H.x);return Ce.push(He),W&&(De=De||new a.pointGeometry(P.getx(re),P.gety(re)),ze.push(function(yt,vt,wt){const Et=1-wt;return new a.pointGeometry(yt.x*Et+vt.x*wt,yt.y*Et+vt.y*wt)}(ze.length>0?ze[ze.length-1]:De,De,qe))),{point:He,angle:lt,path:Ce,tilePath:ze}}const nu=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function pi(d,r){for(let c=0;c<d;c++){const f=r.length;r.resize(f+4),r.float32.set(nu,3*f)}}function pl(d,r,c){const f=r[0],_=r[1];return d[0]=c[0]*f+c[4]*_+c[12],d[1]=c[1]*f+c[5]*_+c[13],d[3]=c[3]*f+c[7]*_+c[15],d}const fi=100;class Ht{constructor(r,c,f=new Ci(r.width+200,r.height+200,25),_=new Ci(r.width+200,r.height+200,25)){this.transform=r,this.grid=f,this.ignoredGrid=_,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+fi,this.screenBottomBoundary=r.height+fi,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=c}placeCollisionBox(r,c,f,_,y,w,S){let I=c.projectedAnchorZ;c.elevation&&(I+=c.elevation);const P=this.projectAndGetPerspectiveRatio(w,c.projectedAnchorX,c.projectedAnchorY,I,c.tileID),z=y*P.perspectiveRatio,R=(c.x1*r+f.x-c.padding)*z+P.point.x,U=(c.y1*r+f.y-c.padding)*z+P.point.y,W=(c.x2*r+f.x+c.padding)*z+P.point.x,K=(c.y2*r+f.y+c.padding)*z+P.point.y,Z=P.perspectiveRatio<=.55||P.aboveHorizon;return!this.isInsideGrid(R,U,W,K)||!_&&this.grid.hitTest(R,U,W,K,S)||Z?{box:[],offscreen:!1}:{box:[R,U,W,K],offscreen:this.isOffscreen(R,U,W,K)}}placeCollisionCircles(r,c,f,_,y,w,S,I,P,z,R,U,W,K){const Z=[],ne=this.transform.elevation,q=ne?Me=>ne.getAtTileOffset(K,Me.x,Me.y):Me=>0,re=new a.pointGeometry(c.tileAnchorX,c.tileAnchorY),se=q(re),H=this.projectAndGetPerspectiveRatio(w,re.x,re.y,se,K),{perspectiveRatio:le}=H,he=(z?y/le:y*le)/a.ONE_EM,ke=Rn(re,S,se).point,Ce=H.signedDistanceFromCamera>0?fs(he,_,c.lineOffsetX*he,c.lineOffsetY*he,!1,ke,re,c,f,S,{},ne&&!z?q:null,z&&!!ne):null;let ze=!1,De=!1,Ge=!0;if(Ce&&!H.aboveHorizon){const Me=.5*U*le+W,qe=new a.pointGeometry(-100,-100),Se=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),He=new Bo,lt=Ce.first,yt=Ce.last;let vt=[];for(let gt=lt.path.length-1;gt>=1;gt--)vt.push(lt.path[gt]);for(let gt=1;gt<yt.path.length;gt++)vt.push(yt.path[gt]);const wt=2.5*Me;if(I){const gt=vt.map(ne?(At,Qt)=>{const jn=q(Qt<lt.path.length-1?lt.tilePath[lt.path.length-1-Qt]:yt.tilePath[Qt-lt.path.length+2]);return Rn(At,I,jn)}:At=>Rn(At,I));vt=gt.some(At=>At.signedDistanceFromCamera<=0)?[]:gt.map(At=>At.point)}let Et=[];if(vt.length>0){const gt=vt[0].clone(),At=vt[0].clone();for(let Qt=1;Qt<vt.length;Qt++)gt.x=Math.min(gt.x,vt[Qt].x),gt.y=Math.min(gt.y,vt[Qt].y),At.x=Math.max(At.x,vt[Qt].x),At.y=Math.max(At.y,vt[Qt].y);Et=gt.x>=qe.x&&At.x<=Se.x&&gt.y>=qe.y&&At.y<=Se.y?[vt]:At.x<qe.x||gt.x>Se.x||At.y<qe.y||gt.y>Se.y?[]:a.clipLine([vt],qe.x,qe.y,Se.x,Se.y)}for(const gt of Et){He.reset(gt,.25*Me);let At=0;At=He.length<=.5*Me?1:Math.ceil(He.paddedLength/wt)+1;for(let Qt=0;Qt<At;Qt++){const jn=Qt/Math.max(At-1,1),ir=He.lerp(jn),_r=ir.x+fi,Tr=ir.y+fi;Z.push(_r,Tr,Me,0);const Vn=_r-Me,Zi=Tr-Me,Ii=_r+Me,fn=Tr+Me;if(Ge=Ge&&this.isOffscreen(Vn,Zi,Ii,fn),De=De||this.isInsideGrid(Vn,Zi,Ii,fn),!r&&this.grid.hitTestCircle(_r,Tr,Me,R)&&(ze=!0,!P))return{circles:[],offscreen:!1,collisionDetected:ze}}}}return{circles:!P&&ze||!De?[]:Z,offscreen:Ge,collisionDetected:ze}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let f=1/0,_=1/0,y=-1/0,w=-1/0;for(const z of r){const R=new a.pointGeometry(z.x+fi,z.y+fi);f=Math.min(f,R.x),_=Math.min(_,R.y),y=Math.max(y,R.x),w=Math.max(w,R.y),c.push(R)}const S=this.grid.query(f,_,y,w).concat(this.ignoredGrid.query(f,_,y,w)),I={},P={};for(const z of S){const R=z.key;if(I[R.bucketInstanceId]===void 0&&(I[R.bucketInstanceId]={}),I[R.bucketInstanceId][R.featureIndex])continue;const U=[new a.pointGeometry(z.x1,z.y1),new a.pointGeometry(z.x2,z.y1),new a.pointGeometry(z.x2,z.y2),new a.pointGeometry(z.x1,z.y2)];a.polygonIntersectsPolygon(c,U)&&(I[R.bucketInstanceId][R.featureIndex]=!0,P[R.bucketInstanceId]===void 0&&(P[R.bucketInstanceId]=[]),P[R.bucketInstanceId].push(R.featureIndex))}return P}insertCollisionBox(r,c,f,_,y){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:y},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,c,f,_,y){const w=c?this.ignoredGrid:this.grid,S={bucketInstanceId:f,featureIndex:_,collisionGroupID:y};for(let I=0;I<r.length;I+=4)w.insertCircle(S,r[I],r[I+1],r[I+2])}projectAndGetPerspectiveRatio(r,c,f,_,y){const w=[c,f,_||0,1];let S=!1;if(_||this.transform.pitch>0){a.transformMat4(w,w,r);let I=!1;this.fogState&&y&&(I=function(P,z,R,U,W,K){const Z=K.calculateFogTileMatrix(W),ne=[z,R,U];return a.transformMat4$1(ne,ne,Z),Tt(P,ne,K.pitch,K._fov)}(this.fogState,c,f,_||0,y.toUnwrapped(),this.transform)>.9),S=w[2]>w[3]||I}else pl(w,w,r);return{point:new a.pointGeometry((w[0]/w[3]+1)/2*this.transform.width+fi,(-w[1]/w[3]+1)/2*this.transform.height+fi),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/w[3]*.5,1.5),signedDistanceFromCamera:w[3],aboveHorizon:S}}isOffscreen(r,c,f,_){return f<fi||r>=this.screenRightBoundary||_<fi||c>this.screenBottomBoundary}isInsideGrid(r,c,f,_){return f>=0&&r<this.gridRightBoundary&&_>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const r=a.identity([]);return a.translate(r,r,[-100,-100,0]),r}}class fl{constructor(r,c,f,_){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?c:-c))):_&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class $o{constructor(r,c,f,_,y,w=!1){this.text=new fl(r?r.text:null,c,f,y),this.icon=new fl(r?r.icon:null,c,_,y),this.clipped=w}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class fr{constructor(r,c,f,_=!1){this.text=r,this.icon=c,this.skipFade=f,this.clipped=_}}class ti{constructor(){this.invProjMatrix=a.create$1(),this.viewportMatrix=a.create$1(),this.circles=[]}}class md{constructor(r,c,f,_,y){this.bucketInstanceId=r,this.featureIndex=c,this.sourceLayerIndex=f,this.bucketIndex=_,this.tileID=y}}class ml{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const c=++this.maxGroupID;this.collisionGroups[r]={ID:c,predicate:f=>f.collisionGroupID===c}}return this.collisionGroups[r]}}function Ln(d,r,c,f,_){const{horizontalAlign:y,verticalAlign:w}=a.getAnchorAlignment(d),S=-(y-.5)*r,I=-(w-.5)*c,P=a.evaluateVariableOffset(d,f);return new a.pointGeometry(S+P[0]*_,I+P[1]*_)}function No(d,r,c,f,_){const y=new a.pointGeometry(d,r);return c&&y._rotate(f?_:-_),y}class Uo{constructor(r,c,f,_,y){this.transform=r.clone(),this.collisionIndex=new Ht(this.transform,y),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new ml(f),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,c,f,_){const y=f.getBucket(c),w=f.latestFeatureIndex;if(!y||!w||c.id!==y.layerIds[0])return;const S=y.layers[0].layout,I=f.collisionBoxArray,P=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),z=f.tileSize/a.EXTENT,R=f.tileID.toUnwrapped(),U=this.transform.calculateProjMatrix(R),W=S.get("text-pitch-alignment")==="map",K=S.get("text-rotation-alignment")==="map";c.compileFilter();const Z=c.dynamicFilter(),ne=c.dynamicFilterNeedsFeature(),q=this.transform.calculatePixelsToTileUnitsMatrix(f),re=Lt(U,W,K,this.transform,q);let se=null;if(W){const he=Dt(U,W,K,this.transform,q);se=a.multiply([],this.transform.labelPlaneMatrix,he)}let H=null;Z&&f.latestFeatureIndex&&(H={unwrappedTileID:R,dynamicFilter:Z,dynamicFilterNeedsFeature:ne,featureIndex:f.latestFeatureIndex}),this.retainedQueryData[y.bucketInstanceId]=new md(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,f.tileID);const le={bucket:y,layout:S,posMatrix:U,textLabelPlaneMatrix:re,labelToScreenMatrix:se,clippingData:H,scale:P,textPixelRatio:z,holdingForFade:f.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(y.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(y.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(_)for(const he of y.sortKeyRanges){const{sortKey:ke,symbolInstanceStart:Ce,symbolInstanceEnd:ze}=he;r.push({sortKey:ke,symbolInstanceStart:Ce,symbolInstanceEnd:ze,parameters:le})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:le})}attemptAnchorPlacement(r,c,f,_,y,w,S,I,P,z,R,U,W,K,Z,ne,q,re){const se=[U.textOffset0,U.textOffset1],H=Ln(r,f,_,se,y),le=this.collisionIndex.placeCollisionBox(y,c,No(H.x,H.y,w,S,this.transform.angle),R,I,P,z.predicate);if((!ne||this.collisionIndex.placeCollisionBox(K.getSymbolInstanceIconSize(re,this.transform.zoom,W),ne,No(H.x,H.y,w,S,this.transform.angle),R,I,P,z.predicate).box.length!==0)&&le.box.length>0){let he;return this.prevPlacement&&this.prevPlacement.variableOffsets[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID].text&&(he=this.prevPlacement.variableOffsets[U.crossTileID].anchor),this.variableOffsets[U.crossTileID]={textOffset:se,width:f,height:_,anchor:r,textScale:y,prevAnchor:he},this.markUsedJustification(K,r,U,Z),K.allowVerticalPlacement&&(this.markUsedOrientation(K,Z,U),this.placedOrientations[U.crossTileID]=Z),{shift:H,placedGlyphBoxes:le}}}placeLayerBucketPart(r,c,f,_){const{bucket:y,layout:w,posMatrix:S,textLabelPlaneMatrix:I,labelToScreenMatrix:P,clippingData:z,textPixelRatio:R,holdingForFade:U,collisionBoxArray:W,partiallyEvaluatedTextSize:K,partiallyEvaluatedIconSize:Z,collisionGroup:ne}=r.parameters,q=w.get("text-optional"),re=w.get("icon-optional"),se=w.get("text-allow-overlap"),H=w.get("icon-allow-overlap"),le=w.get("text-rotation-alignment")==="map",he=w.get("text-pitch-alignment")==="map",ke=w.get("icon-text-fit")!=="none",Ce=w.get("symbol-z-order")==="viewport-y",ze=se&&(H||!y.hasIconData()||re),De=H&&(se||!y.hasTextData()||q);!y.collisionArrays&&W&&y.deserializeCollisionBoxes(W),f&&_&&y.updateCollisionDebugBuffers(this.transform.zoom,W);const Ge=(Me,qe,Se)=>{if(z){const fn={zoom:this.transform.zoom,pitch:this.transform.pitch};let Mn=null;if(z.dynamicFilterNeedsFeature){const Zt=this.retainedQueryData[y.bucketInstanceId];Mn=z.featureIndex.loadFeature({featureIndex:Me.featureIndex,bucketIndex:Zt.bucketIndex,sourceLayerIndex:Zt.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,z.dynamicFilter)(fn,Mn,this.retainedQueryData[y.bucketInstanceId].tileID.canonical,new a.pointGeometry(Me.tileAnchorX,Me.tileAnchorY),this.transform.calculateDistanceTileData(z.unwrappedTileID)))return this.placements[Me.crossTileID]=new fr(!1,!1,!1,!0),void(c[Me.crossTileID]=!0)}if(c[Me.crossTileID])return;if(U)return void(this.placements[Me.crossTileID]=new fr(!1,!1,!1));let He=!1,lt=!1,yt=!0,vt=null,wt={box:null,offscreen:null},Et={box:null,offscreen:null},gt=null,At=null,Qt=null,jn=0,ir=0,_r=0;Se.textFeatureIndex?jn=Se.textFeatureIndex:Me.useRuntimeCollisionCircles&&(jn=Me.featureIndex),Se.verticalTextFeatureIndex&&(ir=Se.verticalTextFeatureIndex);const Tr=fn=>{fn.tileID=this.retainedQueryData[y.bucketInstanceId].tileID,(this.transform.elevation||fn.elevation)&&(fn.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[y.bucketInstanceId].tileID,fn.tileAnchorX,fn.tileAnchorY):0)},Vn=Se.textBox;if(Vn){Tr(Vn);const fn=Zt=>{let gn=a.WritingMode.horizontal;if(y.allowVerticalPlacement&&!Zt&&this.prevPlacement){const or=this.prevPlacement.placedOrientations[Me.crossTileID];or&&(this.placedOrientations[Me.crossTileID]=or,gn=or,this.markUsedOrientation(y,gn,Me))}return gn},Mn=(Zt,gn)=>{if(y.allowVerticalPlacement&&Me.numVerticalGlyphVertices>0&&Se.verticalTextBox){for(const or of y.writingModes)if(or===a.WritingMode.vertical?(wt=gn(),Et=wt):wt=Zt(),wt&&wt.box&&wt.box.length)break}else wt=Zt()};if(w.get("text-variable-anchor")){let Zt=w.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Me.crossTileID]){const mn=this.prevPlacement.variableOffsets[Me.crossTileID];Zt.indexOf(mn.anchor)>0&&(Zt=Zt.filter(Vr=>Vr!==mn.anchor),Zt.unshift(mn.anchor))}const gn=(mn,Vr,Ra)=>{const zr=y.getSymbolInstanceTextSize(K,Me,this.transform.zoom,qe),_o=(mn.x2-mn.x1)*zr+2*mn.padding,ip=(mn.y2-mn.y1)*zr+2*mn.padding,Kl=ke&&!H?Vr:null;Kl&&Tr(Kl);let Ps={box:[],offscreen:!1};const op=se?2*Zt.length:Zt.length;for(let La=0;La<op;++La){const Yl=this.attemptAnchorPlacement(Zt[La%Zt.length],mn,_o,ip,zr,le,he,R,S,ne,La>=Zt.length,Me,qe,y,Ra,Kl,K,Z);if(Yl&&(Ps=Yl.placedGlyphBoxes,Ps&&Ps.box&&Ps.box.length)){He=!0,vt=Yl.shift;break}}return Ps};Mn(()=>gn(Vn,Se.iconBox,a.WritingMode.horizontal),()=>{const mn=Se.verticalTextBox;return mn&&Tr(mn),y.allowVerticalPlacement&&!(wt&&wt.box&&wt.box.length)&&Me.numVerticalGlyphVertices>0&&mn?gn(mn,Se.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),wt&&(He=wt.box,yt=wt.offscreen);const or=fn(wt&&wt.box);if(!He&&this.prevPlacement){const mn=this.prevPlacement.variableOffsets[Me.crossTileID];mn&&(this.variableOffsets[Me.crossTileID]=mn,this.markUsedJustification(y,mn.anchor,Me,or))}}else{const Zt=(gn,or)=>{const mn=y.getSymbolInstanceTextSize(K,Me,this.transform.zoom,qe),Vr=this.collisionIndex.placeCollisionBox(mn,gn,new a.pointGeometry(0,0),se,R,S,ne.predicate);return Vr&&Vr.box&&Vr.box.length&&(this.markUsedOrientation(y,or,Me),this.placedOrientations[Me.crossTileID]=or),Vr};Mn(()=>Zt(Vn,a.WritingMode.horizontal),()=>{const gn=Se.verticalTextBox;return y.allowVerticalPlacement&&Me.numVerticalGlyphVertices>0&&gn?(Tr(gn),Zt(gn,a.WritingMode.vertical)):{box:null,offscreen:null}}),fn(wt&&wt.box&&wt.box.length)}}if(gt=wt,He=gt&&gt.box&&gt.box.length>0,yt=gt&&gt.offscreen,Me.useRuntimeCollisionCircles){const fn=y.text.placedSymbolArray.get(Me.centerJustifiedTextSymbolIndex>=0?Me.centerJustifiedTextSymbolIndex:Me.verticalPlacedTextSymbolIndex),Mn=a.evaluateSizeForFeature(y.textSizeData,K,fn),Zt=w.get("text-padding");At=this.collisionIndex.placeCollisionCircles(se,fn,y.lineVertexArray,y.glyphOffsetArray,Mn,S,I,P,f,he,ne.predicate,Me.collisionCircleDiameter*Mn/a.ONE_EM,Zt,this.retainedQueryData[y.bucketInstanceId].tileID),He=se||At.circles.length>0&&!At.collisionDetected,yt=yt&&At.offscreen}if(Se.iconFeatureIndex&&(_r=Se.iconFeatureIndex),Se.iconBox){const fn=Mn=>{Tr(Mn);const Zt=ke&&vt?No(vt.x,vt.y,le,he,this.transform.angle):new a.pointGeometry(0,0),gn=y.getSymbolInstanceIconSize(Z,this.transform.zoom,qe);return this.collisionIndex.placeCollisionBox(gn,Mn,Zt,H,R,S,ne.predicate)};Et&&Et.box&&Et.box.length&&Se.verticalIconBox?(Qt=fn(Se.verticalIconBox),lt=Qt.box.length>0):(Qt=fn(Se.iconBox),lt=Qt.box.length>0),yt=yt&&Qt.offscreen}const Zi=q||Me.numHorizontalGlyphVertices===0&&Me.numVerticalGlyphVertices===0,Ii=re||Me.numIconVertices===0;if(Zi||Ii?Ii?Zi||(lt=lt&&He):He=lt&&He:lt=He=lt&&He,He&&gt&&gt.box&&this.collisionIndex.insertCollisionBox(gt.box,w.get("text-ignore-placement"),y.bucketInstanceId,Et&&Et.box&&ir?ir:jn,ne.ID),lt&&Qt&&this.collisionIndex.insertCollisionBox(Qt.box,w.get("icon-ignore-placement"),y.bucketInstanceId,_r,ne.ID),At&&(He&&this.collisionIndex.insertCollisionCircles(At.circles,w.get("text-ignore-placement"),y.bucketInstanceId,jn,ne.ID),f)){const fn=y.bucketInstanceId;let Mn=this.collisionCircleArrays[fn];Mn===void 0&&(Mn=this.collisionCircleArrays[fn]=new ti);for(let Zt=0;Zt<At.circles.length;Zt+=4)Mn.circles.push(At.circles[Zt+0]),Mn.circles.push(At.circles[Zt+1]),Mn.circles.push(At.circles[Zt+2]),Mn.circles.push(At.collisionDetected?1:0)}this.placements[Me.crossTileID]=new fr(He||ze,lt||De,yt||y.justReloaded),c[Me.crossTileID]=!0};if(Ce){const Me=y.getSortedSymbolIndexes(this.transform.angle);for(let qe=Me.length-1;qe>=0;--qe){const Se=Me[qe];Ge(y.symbolInstances.get(Se),Se,y.collisionArrays[Se])}}else for(let Me=r.symbolInstanceStart;Me<r.symbolInstanceEnd;Me++)Ge(y.symbolInstances.get(Me),Me,y.collisionArrays[Me]);if(f&&y.bucketInstanceId in this.collisionCircleArrays){const Me=this.collisionCircleArrays[y.bucketInstanceId];a.invert(Me.invProjMatrix,S),Me.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1}markUsedJustification(r,c,f,_){let y;y=_===a.WritingMode.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(c)];const w=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const S of w)S>=0&&(r.text.placedSymbolArray.get(S).crossTileID=y>=0&&S!==y?0:f.crossTileID)}markUsedOrientation(r,c,f){const _=c===a.WritingMode.horizontal||c===a.WritingMode.horizontalOnly?c:0,y=c===a.WritingMode.vertical?c:0,w=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const S of w)r.text.placedSymbolArray.get(S).placedOrientation=_;f.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let f=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const _=c?c.symbolFadeChange(r):1,y=c?c.opacities:{},w=c?c.variableOffsets:{},S=c?c.placedOrientations:{};for(const I in this.placements){const P=this.placements[I],z=y[I];z?(this.opacities[I]=new $o(z,_,P.text,P.icon,null,P.clipped),f=f||P.text!==z.text.placed||P.icon!==z.icon.placed):(this.opacities[I]=new $o(null,_,P.text,P.icon,P.skipFade,P.clipped),f=f||P.text||P.icon)}for(const I in y){const P=y[I];if(!this.opacities[I]){const z=new $o(P,_,!1,!1);z.isHidden()||(this.opacities[I]=z,f=f||P.text.placed||P.icon.placed)}}for(const I in w)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=w[I]);for(const I in S)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=S[I]);f?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:r)}updateLayerOpacities(r,c){const f={};for(const _ of c){const y=_.getBucket(r);y&&_.latestFeatureIndex&&r.id===y.layerIds[0]&&this.updateBucketOpacities(y,f,_.collisionBoxArray)}}updateBucketOpacities(r,c,f){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const _=r.layers[0].layout,y=!!r.layers[0].dynamicFilter(),w=new $o(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),I=_.get("icon-allow-overlap"),P=_.get("text-variable-anchor"),z=_.get("text-rotation-alignment")==="map",R=_.get("text-pitch-alignment")==="map",U=_.get("icon-text-fit")!=="none",W=new $o(null,0,S&&(I||!r.hasIconData()||_.get("icon-optional")),I&&(S||!r.hasTextData()||_.get("text-optional")),!0);!r.collisionArrays&&f&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(f);const K=(Z,ne,q)=>{for(let re=0;re<ne/4;re++)Z.opacityVertexArray.emplaceBack(q)};for(let Z=0;Z<r.symbolInstances.length;Z++){const ne=r.symbolInstances.get(Z),{numHorizontalGlyphVertices:q,numVerticalGlyphVertices:re,crossTileID:se}=ne;let H=this.opacities[se];c[se]?H=w:H||(H=W,this.opacities[se]=H),c[se]=!0;const le=ne.numIconVertices>0,he=this.placedOrientations[ne.crossTileID],ke=he===a.WritingMode.vertical,Ce=he===a.WritingMode.horizontal||he===a.WritingMode.horizontalOnly;if(q>0||re>0){const ze=iu(H.text);K(r.text,q,ke?mr:ze),K(r.text,re,Ce?mr:ze);const De=H.text.isHidden();[ne.rightJustifiedTextSymbolIndex,ne.centerJustifiedTextSymbolIndex,ne.leftJustifiedTextSymbolIndex].forEach(qe=>{qe>=0&&(r.text.placedSymbolArray.get(qe).hidden=De||ke?1:0)}),ne.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(ne.verticalPlacedTextSymbolIndex).hidden=De||Ce?1:0);const Ge=this.variableOffsets[ne.crossTileID];Ge&&this.markUsedJustification(r,Ge.anchor,ne,he);const Me=this.placedOrientations[ne.crossTileID];Me&&(this.markUsedJustification(r,"left",ne,Me),this.markUsedOrientation(r,Me,ne))}if(le){const ze=iu(H.icon);ne.placedIconSymbolIndex>=0&&(K(r.icon,ne.numIconVertices,ke?mr:ze),r.icon.placedSymbolArray.get(ne.placedIconSymbolIndex).hidden=H.icon.isHidden()),ne.verticalPlacedIconSymbolIndex>=0&&(K(r.icon,ne.numVerticalIconVertices,Ce?mr:ze),r.icon.placedSymbolArray.get(ne.verticalPlacedIconSymbolIndex).hidden=H.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const ze=r.collisionArrays[Z];if(ze){let De=new a.pointGeometry(0,0),Ge=!0;if(ze.textBox||ze.verticalTextBox){if(P){const qe=this.variableOffsets[se];qe?(De=Ln(qe.anchor,qe.width,qe.height,qe.textOffset,qe.textScale),z&&De._rotate(R?this.transform.angle:-this.transform.angle)):Ge=!1}y&&(Ge=!H.clipped),ze.textBox&&Un(r.textCollisionBox.collisionVertexArray,H.text.placed,!Ge||ke,De.x,De.y),ze.verticalTextBox&&Un(r.textCollisionBox.collisionVertexArray,H.text.placed,!Ge||Ce,De.x,De.y)}const Me=Ge&&Boolean(!Ce&&ze.verticalIconBox);ze.iconBox&&Un(r.iconCollisionBox.collisionVertexArray,H.icon.placed,Me,U?De.x:0,U?De.y:0),ze.verticalIconBox&&Un(r.iconCollisionBox.collisionVertexArray,H.icon.placed,!Me,U?De.x:0,U?De.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const Z=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=Z.invProjMatrix,r.placementViewportMatrix=Z.viewportMatrix,r.collisionCircleArray=Z.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,c){const f=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*f>r}setStale(){this.stale=!0}}function Un(d,r,c,f,_){d.emplaceBack(r?1:0,c?1:0,f||0,_||0),d.emplaceBack(r?1:0,c?1:0,f||0,_||0),d.emplaceBack(r?1:0,c?1:0,f||0,_||0),d.emplaceBack(r?1:0,c?1:0,f||0,_||0)}const ru=Math.pow(2,25),mi=Math.pow(2,24),fa=Math.pow(2,17),gl=Math.pow(2,16),ym=Math.pow(2,9),so=Math.pow(2,8),vm=Math.pow(2,1);function iu(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const r=d.placed?1:0,c=Math.floor(127*d.opacity);return c*ru+r*mi+c*fa+r*gl+c*ym+r*so+c*vm+r}const mr=0;class _l{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,c,f,_,y){const w=this._bucketParts;for(;this._currentTileIndex<r.length;)if(c.getBucketParts(w,_,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((S,I)=>S.sortKey-I.sortKey));this._currentPartIndex<w.length;){const S=w[this._currentPartIndex];if(c.placeLayerBucketPart(S,this._seenCrossTileIDs,f,S.symbolInstanceStart===0),this._currentPartIndex++,y())return!0}return!1}}class ao{constructor(r,c,f,_,y,w,S,I){this.placement=new Uo(r,y,w,S,I),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(r,c,f){const _=a.exported.now(),y=()=>{const w=a.exported.now()-_;return!this._forceFullPlacement&&w>2};for(;this._currentPlacementIndex>=0;){const w=c[r[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=S)&&(!w.maxzoom||w.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new _l(w)),this._inProgressLayer.continuePlacement(f[w.source],this.placement,this._showCollisionBoxes,w,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const ou=512/a.EXTENT/2;class yl{constructor(r,c,f){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=f;for(let _=0;_<c.length;_++){const y=c.get(_),w=y.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:y.crossTileID,coord:this.getScaledCoordinates(y,r)})}}getScaledCoordinates(r,c){const f=ou/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*a.EXTENT+r.tileAnchorX)*f),y:Math.floor((c.canonical.y*a.EXTENT+r.tileAnchorY)*f)}}findMatches(r,c,f){const _=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let y=0;y<r.length;y++){const w=r.get(y);if(w.crossTileID)continue;const S=this.indexedSymbolInstances[w.key];if(!S)continue;const I=this.getScaledCoordinates(w,c);for(const P of S)if(Math.abs(P.coord.x-I.x)<=_&&Math.abs(P.coord.y-I.y)<=_&&!f[P.crossTileID]){f[P.crossTileID]=!0,w.crossTileID=P.crossTileID;break}}}}class xm{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class bm{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const c=Math.round((r-this.lng)/360);if(c!==0)for(const f in this.indexes){const _=this.indexes[f],y={};for(const w in _){const S=_[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+c),y[S.tileID.key]=S}this.indexes[f]=y}this.lng=r}addBucket(r,c,f){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let y=0;y<c.symbolInstances.length;y++)c.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const _=this.usedCrossTileIDs[r.overscaledZ];for(const y in this.indexes){const w=this.indexes[y];if(Number(y)>r.overscaledZ)for(const S in w){const I=w[S];I.tileID.isChildOf(r)&&I.findMatches(c.symbolInstances,r,_)}else{const S=w[r.scaledTo(Number(y)).key];S&&S.findMatches(c.symbolInstances,r,_)}}for(let y=0;y<c.symbolInstances.length;y++){const w=c.symbolInstances.get(y);w.crossTileID||(w.crossTileID=f.generate(),_[w.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new yl(r,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(r,c){for(const f in c.indexedSymbolInstances)for(const _ of c.indexedSymbolInstances[f])delete this.usedCrossTileIDs[r][_.crossTileID]}removeStaleBuckets(r){let c=!1;for(const f in this.indexes){const _=this.indexes[f];for(const y in _)r[_[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,_[y]),delete _[y],c=!0)}return c}}class vl{constructor(){this.layerIndexes={},this.crossTileIDs=new xm,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,c,f){let _=this.layerIndexes[r.id];_===void 0&&(_=this.layerIndexes[r.id]=new bm);let y=!1;const w={};_.handleWrapJump(f);for(const S of c){const I=S.getBucket(r);I&&r.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(S.tileID,I,this.crossTileIDs)&&(y=!0),w[I.bucketInstanceId]=!0)}return _.removeStaleBuckets(w)&&(y=!0),y}pruneUnusedLayers(r){const c={};r.forEach(f=>{c[f]=!0});for(const f in this.layerIndexes)c[f]||delete this.layerIndexes[f]}}const xl=(d,r)=>a.emitValidationErrors(d,r&&r.filter(c=>c.identifier!=="source.canvas")),gd=a.pick(Xe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),wm=a.pick(Xe,["setCenter","setZoom","setBearing","setPitch"]),_d=function(){const d={},r=a.spec.$version;for(const c in a.spec.$root){const f=a.spec.$root[c];if(f.required){let _=null;_=c==="version"?r:f.type==="array"?[]:{},_!=null&&(d[c]=_)}}return d}(),Em={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ni extends a.Evented{constructor(r,c={}){super(),this.map=r,this.dispatcher=new er(Je(),this),this.imageManager=new Ke,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(r._requestManager,c.localFontFamily?a.LocalGlyphMode.all:c.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.lineAtlas=new a.LineAtlas(256,512),this.crossTileSymbolIndex=new vl,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const f=this;this._rtlTextPluginCallback=ni.registerForPluginStateChange(_=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(y,w)=>{if(a.triggerPluginCompletionEvent(y),w&&w.every(S=>S))for(const S in f._sourceCaches){const I=f._sourceCaches[S],P=I.getSource().type;P!=="vector"&&P!=="geojson"||I.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const y=this.getSource(_.sourceId);if(y&&y.vectorLayerIds)for(const w in this._layers){const S=this._layers[w];S.source===y.id&&this._validateLayer(S)}})}loadURL(r,c={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const f=typeof c.validate=="boolean"?c.validate:!a.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,c.accessToken);const _=this.map._requestManager.transformRequest(r,a.ResourceType.Style);this._request=a.getJSON(_,(y,w)=>{this._request=null,y?this.fire(new a.ErrorEvent(y)):w&&this._load(w,f)})}loadJSON(r,c={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(r,c.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(_d,!1)}_updateLayerCount(r,c){const f=c?1:-1;r.is3D()&&(this._num3DLayers+=f),r.type==="circle"&&(this._numCircleLayers+=f),r.type==="symbol"&&(this._numSymbolLayers+=f)}_load(r,c){if(c&&xl(this,a.validateStyle(r)))return;this._loaded=!0,this.stylesheet=r,this.updateProjection();for(const _ in r.sources)this.addSource(_,r.sources[_],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const f=pt(this.stylesheet.layers);this._order=f.map(_=>_.id),this._layers={},this._serializedLayers={};for(let _ of f)_=a.createStyleLayer(_),_.setEventedParent(this,{layer:{id:_.id}}),this._layers[_.id]=_,this._serializedLayers[_.id]=_.serialize(),this._updateLayerCount(_,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new st(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.updateProjection()}updateProjection(){const r=this.map.transform.setProjection(this.map._runtimeProjection||(this.stylesheet?this.stylesheet.projection:void 0));if(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),r){this.map.painter.clearBackgroundTiles();for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles();this.map._update(!0)}}_loadSprite(r){this._spriteRequest=function(c,f,_){let y,w,S;const I=a.exported.devicePixelRatio>1?"@2x":"";let P=a.getJSON(f.transformRequest(f.normalizeSpriteURL(c,I,".json"),a.ResourceType.SpriteJSON),(U,W)=>{P=null,S||(S=U,y=W,R())}),z=a.getImage(f.transformRequest(f.normalizeSpriteURL(c,I,".png"),a.ResourceType.SpriteImage),(U,W)=>{z=null,S||(S=U,w=W,R())});function R(){if(S)_(S);else if(y&&w){const U=a.exported.getImageData(w),W={};for(const K in y){const{width:Z,height:ne,x:q,y:re,sdf:se,pixelRatio:H,stretchX:le,stretchY:he,content:ke}=y[K],Ce=new a.RGBAImage({width:Z,height:ne});a.RGBAImage.copy(U,Ce,{x:q,y:re},{x:0,y:0},{width:Z,height:ne}),W[K]={data:Ce,pixelRatio:H,sdf:se,stretchX:le,stretchY:he,content:ke}}_(null,W)}}return{cancel(){P&&(P.cancel(),P=null),z&&(z.cancel(),z=null)}}}(r,this.map._requestManager,(c,f)=>{if(this._spriteRequest=null,c)this.fire(new a.ErrorEvent(c));else if(f)for(const _ in f)this.imageManager.addImage(_,f[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(r){const c=this.getSource(r.source);if(!c)return;const f=r.sourceLayer;f&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(f)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${f}" does not exist on source "${c.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const c=[];for(const f of r){const _=this._layers[f];_.type!=="custom"&&c.push(_.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&Em[r.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const c=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(_.length||y.length)&&this._updateWorkerLayers(_,y);for(const w in this._updatedSources){const S=this._updatedSources[w];S==="reload"?this._reloadSource(w):S==="clear"&&this._clearSource(w)}this._updateTilesForChangedImages();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const f={};for(const _ in this._sourceCaches){const y=this._sourceCaches[_];f[_]=y.used,y.used=!1}for(const _ of this._order){const y=this._layers[_];if(y.recalculate(r,this._availableImages),!y.isHidden(r.zoom)){const S=this._getLayerSourceCache(y);S&&(S.used=!0)}const w=this.map.painter;if(w){const S=y.getProgramIds();if(!S)continue;const I=y.getProgramConfiguration(r.zoom);for(const P of S)w.useProgram(P,I)}}for(const _ in f){const y=this._sourceCaches[_];f[_]!==y.used&&y.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:y.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),xl(this,a.validateStyle(r)))return!1;(r=a.clone$2(r)).layers=pt(r.layers);const c=function(_,y){if(!_)return[{command:Xe.setStyle,args:[y]}];let w=[];try{if(!N(_.version,y.version))return[{command:Xe.setStyle,args:[y]}];N(_.center,y.center)||w.push({command:Xe.setCenter,args:[y.center]}),N(_.zoom,y.zoom)||w.push({command:Xe.setZoom,args:[y.zoom]}),N(_.bearing,y.bearing)||w.push({command:Xe.setBearing,args:[y.bearing]}),N(_.pitch,y.pitch)||w.push({command:Xe.setPitch,args:[y.pitch]}),N(_.sprite,y.sprite)||w.push({command:Xe.setSprite,args:[y.sprite]}),N(_.glyphs,y.glyphs)||w.push({command:Xe.setGlyphs,args:[y.glyphs]}),N(_.transition,y.transition)||w.push({command:Xe.setTransition,args:[y.transition]}),N(_.light,y.light)||w.push({command:Xe.setLight,args:[y.light]}),N(_.fog,y.fog)||w.push({command:Xe.setFog,args:[y.fog]}),N(_.projection,y.projection)||w.push({command:Xe.setProjection,args:[y.projection]});const S={},I=[];(function(R,U,W,K){let Z;for(Z in U=U||{},R=R||{})R.hasOwnProperty(Z)&&(U.hasOwnProperty(Z)||Ae(Z,W,K));for(Z in U)U.hasOwnProperty(Z)&&(R.hasOwnProperty(Z)?N(R[Z],U[Z])||(R[Z].type==="geojson"&&U[Z].type==="geojson"&&Jt(R,U,Z)?W.push({command:Xe.setGeoJSONSourceData,args:[Z,U[Z].data]}):Bt(Z,U,W,K)):_e(Z,U,W))})(_.sources,y.sources,I,S);const P=[];_.layers&&_.layers.forEach(R=>{S[R.source]?w.push({command:Xe.removeLayer,args:[R.id]}):P.push(R)});let z=_.terrain;z&&S[z.source]&&(w.push({command:Xe.setTerrain,args:[void 0]}),z=void 0),w=w.concat(I),N(z,y.terrain)||w.push({command:Xe.setTerrain,args:[y.terrain]}),function(R,U,W){U=U||[];const K=(R=R||[]).map(jt),Z=U.map(jt),ne=R.reduce(Wt,{}),q=U.reduce(Wt,{}),re=K.slice(),se=Object.create(null);let H,le,he,ke,Ce,ze,De;for(H=0,le=0;H<K.length;H++)he=K[H],q.hasOwnProperty(he)?le++:(W.push({command:Xe.removeLayer,args:[he]}),re.splice(re.indexOf(he,le),1));for(H=0,le=0;H<Z.length;H++)he=Z[Z.length-1-H],re[re.length-1-H]!==he&&(ne.hasOwnProperty(he)?(W.push({command:Xe.removeLayer,args:[he]}),re.splice(re.lastIndexOf(he,re.length-le),1)):le++,ze=re[re.length-H],W.push({command:Xe.addLayer,args:[q[he],ze]}),re.splice(re.length-H,0,he),se[he]=!0);for(H=0;H<Z.length;H++)if(he=Z[H],ke=ne[he],Ce=q[he],!se[he]&&!N(ke,Ce))if(N(ke.source,Ce.source)&&N(ke["source-layer"],Ce["source-layer"])&&N(ke.type,Ce.type)){for(De in St(ke.layout,Ce.layout,W,he,null,Xe.setLayoutProperty),St(ke.paint,Ce.paint,W,he,null,Xe.setPaintProperty),N(ke.filter,Ce.filter)||W.push({command:Xe.setFilter,args:[he,Ce.filter]}),N(ke.minzoom,Ce.minzoom)&&N(ke.maxzoom,Ce.maxzoom)||W.push({command:Xe.setLayerZoomRange,args:[he,Ce.minzoom,Ce.maxzoom]}),ke)ke.hasOwnProperty(De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?St(ke[De],Ce[De],W,he,De.slice(6),Xe.setPaintProperty):N(ke[De],Ce[De])||W.push({command:Xe.setLayerProperty,args:[he,De,Ce[De]]}));for(De in Ce)Ce.hasOwnProperty(De)&&!ke.hasOwnProperty(De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?St(ke[De],Ce[De],W,he,De.slice(6),Xe.setPaintProperty):N(ke[De],Ce[De])||W.push({command:Xe.setLayerProperty,args:[he,De,Ce[De]]}))}else W.push({command:Xe.removeLayer,args:[he]}),ze=re[re.lastIndexOf(he)+1],W.push({command:Xe.addLayer,args:[Ce,ze]})}(P,y.layers,w)}catch(S){console.warn("Unable to compute style diff:",S),w=[{command:Xe.setStyle,args:[y]}]}return w}(this.serialize(),r).filter(_=>!(_.command in wm));if(c.length===0)return!1;const f=c.filter(_=>!(_.command in gd));if(f.length>0)throw new Error(`Unimplemented: ${f.map(_=>_.command).join(", ")}.`);return c.forEach(_=>{_.command!=="setTransition"&&this[_.command].apply(this,_.args)}),this.stylesheet=r,!0}addImage(r,c){if(this.getImage(r))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(r,c),this._afterImageUpdated(r)}updateImage(r,c){this.imageManager.updateImage(r,c)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,c,f={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateStyle.source,`sources.${r}`,c,null,f))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const _=$(r,c,this.dispatcher,this);_.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:_.serialize(),sourceId:r}));const y=w=>{const S=(w?"symbol:":"other:")+r,I=this._sourceCaches[S]=new a.SourceCache(S,_,w);(w?this._symbolSourceCaches:this._otherSourceCaches)[r]=I,I.style=this,I.onAdd(this.map)};y(!1),c.type!=="vector"&&c.type!=="geojson"||y(!0),_.onAdd&&_.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const c=this.getSource(r);if(c===void 0)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===r)return this.fire(new a.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new a.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const f=this._getSourceCaches(r);for(const _ of f)delete this._sourceCaches[_.id],delete this._updatedSources[_.id],_.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles();delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,c){this._checkLoaded(),this.getSource(r).setData(c),this._changed=!0}getSource(r){const c=this._getSourceCache(r);return c&&c.getSource()}addLayer(r,c,f={}){this._checkLoaded();const _=r.id;if(this.getLayer(_))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${_}" already exists on this map`)));let y;if(r.type==="custom"){if(xl(this,a.validateCustomStyleLayer(r)))return;y=a.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(_,r.source),r=a.clone$2(r),r=a.extend(r,{source:_})),this._validate(a.validateStyle.layer,`layers.${_}`,r,{arrayIndex:-1},f))return;y=a.createStyleLayer(r),this._validateLayer(y),y.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[y.id]=y.serialize(),this._updateLayerCount(y,!0)}const w=c?this._order.indexOf(c):this._order.length;if(c&&w===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(w,0,_),this._layerOrderChanged=!0,this._layers[_]=y;const S=this._getLayerSourceCache(y);if(this._removedLayers[_]&&y.source&&S&&y.type!=="custom"){const I=this._removedLayers[_];delete this._removedLayers[_],I.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",S.pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,c){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===c)return;const f=this._order.indexOf(r);this._order.splice(f,1);const _=c?this._order.indexOf(c):this._order.length;c&&_===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(_,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const c=this._layers[r];if(!c)return void this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const f=this._order.indexOf(r);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=c,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const c in this._layers)if(this._layers[c].type===r)return!0;return!1}setLayerZoomRange(r,c,f){this._checkLoaded();const _=this.getLayer(r);_?_.minzoom===c&&_.maxzoom===f||(c!=null&&(_.minzoom=c),f!=null&&(_.maxzoom=f),this._updateLayer(_)):this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,c,f={}){this._checkLoaded();const _=this.getLayer(r);if(_){if(!N(_.filter,c))return c==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(a.validateStyle.filter,`layers.${_.id}.filter`,c,{layerType:_.type},f)||(_.filter=a.clone$2(c),this._updateLayer(_)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){return a.clone$2(this.getLayer(r).filter)}setLayoutProperty(r,c,f,_={}){this._checkLoaded();const y=this.getLayer(r);y?N(y.getLayoutProperty(c),f)||(y.setLayoutProperty(c,f,_),this._updateLayer(y)):this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,c){const f=this.getLayer(r);if(f)return f.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,c,f,_={}){this._checkLoaded();const y=this.getLayer(r);y?N(y.getPaintProperty(c),f)||(y.setPaintProperty(c,f,_)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,c){return this.getLayer(r).getPaintProperty(c)}setFeatureState(r,c){this._checkLoaded();const f=r.source,_=r.sourceLayer,y=this.getSource(f);if(y===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const w=y.type;if(w==="geojson"&&_)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(w==="vector"&&!_)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const S=this._getSourceCaches(f);for(const I of S)I.setFeatureState(_,r.id,c)}removeFeatureState(r,c){this._checkLoaded();const f=r.source,_=this.getSource(f);if(_===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const y=_.type,w=y==="vector"?r.sourceLayer:void 0;if(y==="vector"&&!w)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const S=this._getSourceCaches(f);for(const I of S)I.removeFeatureState(w,r.id,c)}getFeatureState(r){this._checkLoaded();const c=r.source,f=r.sourceLayer,_=this.getSource(c);if(_!==void 0){if(_.type!=="vector"||f)return r.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(f,r.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const c in this._sourceCaches){const f=this._sourceCaches[c].getSource();r[f.id]||(r[f.id]=f.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const c=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&c&&c.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",c.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const c=w=>this._layers[w].type==="fill-extrusion",f={},_=[];for(let w=this._order.length-1;w>=0;w--){const S=this._order[w];if(c(S)){f[S]=w;for(const I of r){const P=I[S];if(P)for(const z of P)_.push(z)}}}_.sort((w,S)=>S.intersectionZ-w.intersectionZ);const y=[];for(let w=this._order.length-1;w>=0;w--){const S=this._order[w];if(c(S))for(let I=_.length-1;I>=0;I--){const P=_[I].feature;if(f[P.layer.id]<w)break;y.push(P),_.pop()}else for(const I of r){const P=I[S];if(P)for(const z of P)y.push(z.feature)}}return y}queryRenderedFeatures(r,c,f){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);const _={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const I of c.layers){const P=this._layers[I];if(!P)return this.fire(new a.ErrorEvent(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];_[P.source]=!0}}const y=[];c.availableImages=this._availableImages;const w=c&&c.layers?c.layers.some(I=>{const P=this.getLayer(I);return P&&P.is3D()}):this.has3DLayers(),S=_t.createFromScreenPoints(r,f);for(const I in this._sourceCaches){const P=this._sourceCaches[I].getSource().id;c.layers&&!_[P]||y.push(ie(this._sourceCaches[I],this._layers,this._serializedLayers,S,c,f,w,!!this.map._showQueryGeometry))}return this.placement&&y.push(function(I,P,z,R,U,W,K){const Z={},ne=W.queryRenderedSymbols(R),q=[];for(const re of Object.keys(ne).map(Number))q.push(K[re]);q.sort(we);for(const re of q){const se=re.featureIndex.lookupSymbolFeatures(ne[re.bucketInstanceId],P,re.bucketIndex,re.sourceLayerIndex,U.filter,U.layers,U.availableImages,I);for(const H in se){const le=Z[H]=Z[H]||[],he=se[H];he.sort((ke,Ce)=>{const ze=re.featureSortOrder;if(ze){const De=ze.indexOf(ke.featureIndex);return ze.indexOf(Ce.featureIndex)-De}return Ce.featureIndex-ke.featureIndex});for(const ke of he)le.push(ke)}}for(const re in Z)Z[re].forEach(se=>{const H=se.feature,le=z(I[re]).getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=le});return Z}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),S.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(r,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);const f=this._getSourceCaches(r);let _=[];for(const y of f)_=_.concat(ue(y,c));return _}addSourceType(r,c,f){return ni.getSourceType(r)?f(new Error(`A source type called "${r}" already exists.`)):(ni.setSourceType(r,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:c.workerSourceURL},f):f(null,null))}getLight(){return this.light.getLight()}setLight(r,c={}){this._checkLoaded();const f=this.light.getLight();let _=!1;for(const w in r)if(!N(r[w],f[w])){_=!0;break}if(!_)return;const y={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,c),this.light.updateTransitions(y)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(r){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(typeof r.source=="object"){const c="terrain-dem-src";this.addSource(c,r.source),r=a.clone$2(r),r=a.extend(r,{source:c})}if(!this._validate(a.validateStyle.terrain,"terrain",r)){if(this.terrain){const c=this.terrain,f=c.get();for(const _ in r)if(!N(r[_],f[_])){c.set(r),this.stylesheet.terrain=r;const y={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};c.updateTransitions(y);break}}else this._createTerrain(r);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(r){const c=this.fog=new In(r,this.map.transform);this.stylesheet.fog=r;const f={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};c.updateTransitions(f)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,f=c.get();for(const _ in r)if(!N(r[_],f[_])){c.set(r),this.stylesheet.fog=r;const y={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};c.updateTransitions(y);break}}else this._createFog(r);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(f=>this.isLayerDraped(this._layers[f])),c=this._order.filter(f=>!this.isLayerDraped(this._layers[f]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...c)}_createTerrain(r){const c=this.terrain=new kt(r);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const f={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};c.updateTransitions(f)}_force3DLayerUpdate(){for(const r in this._layers){const c=this._layers[r];c.type==="fill-extrusion"&&this._updateLayer(c)}}_validate(r,c,f,_,y={}){return(!y||y.validate!==!1)&&xl(this,r.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:f,styleSpec:a.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const c=this._getSourceCaches(r);for(const f of c)f.clearTiles()}_reloadSource(r){const c=this._getSourceCaches(r);for(const f of c)f.resume(),f.reload()}_updateSources(r){for(const c in this._sourceCaches)this._sourceCaches[c].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const c=this._sourceCaches[r];c.resume(),c.reload()}}_updatePlacement(r,c,f,_,y=!1){let w=!1,S=!1;const I={};for(const P of this._order){const z=this._layers[P];if(z.type!=="symbol")continue;if(!I[z.source]){const U=this._getLayerSourceCache(z);if(!U)continue;I[z.source]=U.getRenderableIds(!0).map(W=>U.getTileByID(W)).sort((W,K)=>K.tileID.overscaledZ-W.tileID.overscaledZ||(W.tileID.isLessThan(K.tileID)?-1:1))}const R=this.crossTileSymbolIndex.addLayer(z,I[z.source],r.center.lng);w=w||R}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),y=y||this._layerOrderChanged||f===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(y||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),r.zoom))&&(this.pauseablePlacement=new ao(r,this._order,y,c,f,_,this.placement,this.fog&&!this.fog.isSoftDisabled()?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),S=!0),w&&this.pauseablePlacement.placement.setStale()),S||w)for(const P of this._order){const z=this._layers[P];z.type==="symbol"&&this.placement.updateLayerOpacities(z,I[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,c,f){this.imageManager.getImages(c.icons,f),this._updateTilesForChangedImages();const _=y=>{y&&y.setDependencies(c.tileID.key,c.type,c.icons)};_(this._otherSourceCaches[c.source]),_(this._symbolSourceCaches[c.source])}getGlyphs(r,c,f){this.glyphManager.getGlyphs(c.stacks,f)}getResource(r,c,f){return a.makeRequest(c,f)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const c=[];return this._otherSourceCaches[r]&&c.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&c.push(this._symbolSourceCaches[r]),c}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}}ni.getSourceType=function(d){return L[d]},ni.setSourceType=function(d,r){L[d]=r},ni.registerForPluginStateChange=a.registerForPluginStateChange;var su=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,au="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let ma={},gs={};ma=Vt("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else 
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),gs=Vt(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const lo=Vt(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {
#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)
return mix(globe,mercator,t);
#else
return globe;
#endif
}vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),_s=su;var bl={background:Vt(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Vt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Vt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Vt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Vt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
extrude*=a_scale;vec3 normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));vec3 globePos=a_pos_3+xAxis*extrude.x+yAxis*extrude.y+elevationVector(tilePos)*elevation(tilePos);vec3 mercPos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+xAxis*extrude.x+yAxis*extrude.y;vec3 pos=mix_globe_mercator(globePos,mercPos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Vt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Vt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Vt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Vt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:Vt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Vt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Vt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Vt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Vt(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Vt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Vt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Vt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Vt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Vt(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Vt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Vt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Vt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Vt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Vt(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:Vt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Vt(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,au),skyboxGradient:Vt(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,au),skyboxCapture:Vt(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Vt(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {vec4 color=texture2D(u_image0,v_pos0);gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat4 u_up_vector_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying vec2 v_pos0;void main() {v_pos0=a_uv;vec2 uv=a_uv*EXTENT;vec4 up_vector=u_up_vector_matrix*vec4(elevationVector(uv),1.0);float height=elevation(uv);vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}"),globeAtmosphere:Vt(`uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {highp vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)
discard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}"),globeDepth:Vt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat4 u_up_vector_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying float v_depth;void main() {vec2 uv=a_uv*EXTENT;vec4 up_vector=u_up_vector_matrix*vec4(elevationVector(uv),1.0);float height=elevation(uv);vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);v_depth=gl_Position.z/gl_Position.w;}")};function Vt(d,r,c){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,y=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w=d.match(_),S=r.match(_),I=su.match(_);let P=S?S.concat(w):w;c||(ma.staticUniforms&&(P=ma.staticUniforms.concat(P)),gs.staticUniforms&&(P=gs.staticUniforms.concat(P))),P&&(P=P.concat(I));const z={};return{fragmentSource:d=d.replace(f,(R,U,W,K,Z)=>(z[Z]=!0,U==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
varying ${W} ${K} ${Z};
#else
uniform ${W} ${K} u_${Z};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Z}
    ${W} ${K} ${Z} = u_${Z};
#endif
`)),vertexSource:r=r.replace(f,(R,U,W,K,Z)=>{const ne=K==="float"?"vec2":"vec4",q=Z.match(/color/)?"color":ne;return z[Z]?U==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
attribute ${W} ${ne} a_${Z};
varying ${W} ${K} ${Z};
#else
uniform ${W} ${K} u_${Z};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = a_${Z};
#else
    ${W} ${K} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = unpack_mix_${q}(a_${Z}, u_${Z}_t);
#else
    ${W} ${K} ${Z} = u_${Z};
#endif
`:U==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
attribute ${W} ${ne} a_${Z};
#else
uniform ${W} ${K} u_${Z};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${W} ${K} ${Z} = a_${Z};
#else
    ${W} ${K} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${W} ${K} ${Z} = unpack_mix_${q}(a_${Z}, u_${Z}_t);
#else
    ${W} ${K} ${Z} = u_${Z};
#endif
`}),staticAttributes:y,staticUniforms:P}}class wl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,c,f,_,y,w,S,I){this.context=r;let P=this.boundPaintVertexBuffers.length!==_.length;for(let z=0;!P&&z<_.length;z++)this.boundPaintVertexBuffers[z]!==_[z]&&(P=!0);r.extVertexArrayObject&&this.vao&&this.boundProgram===c&&this.boundLayoutVertexBuffer===f&&!P&&this.boundIndexBuffer===y&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===I?(r.bindVertexArrayOES.set(this.vao),S&&S.bind(),y&&y.dynamicDraw&&y.bind(),I&&I.bind()):this.freshBind(c,f,_,y,w,S,I)}freshBind(r,c,f,_,y,w,S){let I;const P=r.numAttributes,z=this.context,R=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=r,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=_,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{I=z.currentNumAttributes||0;for(let U=P;U<I;U++)R.disableVertexAttribArray(U)}c.enableAttributes(R,r);for(const U of f)U.enableAttributes(R,r);w&&w.enableAttributes(R,r),S&&S.enableAttributes(R,r),c.bind(),c.setVertexAttribPointers(R,r,y);for(const U of f)U.bind(),U.setVertexAttribPointers(R,r,y);w&&(w.bind(),w.setVertexAttribPointers(R,r,y)),_&&_.bind(),S&&(S.bind(),S.setVertexAttribPointers(R,r,y)),z.currentNumAttributes=P}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function El(d,r){const c=Math.pow(2,r.canonical.z),f=r.canonical.y;return[new a.MercatorCoordinate(0,f/c).toLngLat().lat,new a.MercatorCoordinate(0,(f+1)/c).toLngLat().lat]}function lu(d,r,c,f,_,y,w){const S=d.context,I=S.gl,P=c.fbo;if(!P)return;d.prepareDrawTile(r);const z=d.useProgram("hillshade");S.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,P.colorAttachment.get());const R=((Z,ne,q,re)=>{const se=q.paint.get("hillshade-shadow-color"),H=q.paint.get("hillshade-highlight-color"),le=q.paint.get("hillshade-accent-color");let he=q.paint.get("hillshade-illumination-direction")*(Math.PI/180);q.paint.get("hillshade-illumination-anchor")==="viewport"&&(he-=Z.transform.angle);const ke=!Z.options.moving;return{u_matrix:re||Z.transform.calculateProjMatrix(ne.tileID.toUnwrapped(),ke),u_image:0,u_latrange:El(0,ne.tileID),u_light:[q.paint.get("hillshade-exaggeration"),he],u_shadow:se,u_highlight:H,u_accent:le}})(d,c,f,d.terrain?r.projMatrix:null);d.prepareDrawProgram(S,z,r.toUnwrapped());const{tileBoundsBuffer:U,tileBoundsIndexBuffer:W,tileBoundsSegments:K}=d.getTileBoundsBuffers(c);z.draw(S,I.TRIANGLES,_,y,w,a.CullFaceMode.disabled,R,f.id,U,W,K)}function ga(d,r,c){if(!r.needsDEMTextureUpload)return;const f=d.context,_=f.gl;f.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||d.getTileTexture(c.stride);const y=c.getPixels();r.demTexture?r.demTexture.update(y,{premultiply:!1}):r.demTexture=new a.Texture(f,y,_.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function _a(d,r,c,f,_,y){const w=d.context,S=w.gl;if(!r.dem)return;const I=r.dem;if(w.activeTexture.set(S.TEXTURE1),ga(d,r,I),!r.demTexture)return;r.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const P=I.dim;w.activeTexture.set(S.TEXTURE0);let z=r.fbo;if(!z){const K=new a.Texture(w,{width:P,height:P,data:null},S.RGBA);K.bind(S.LINEAR,S.CLAMP_TO_EDGE),z=r.fbo=w.createFramebuffer(P,P,!0),z.colorAttachment.set(K.texture)}w.bindFramebuffer.set(z.framebuffer),w.viewport.set([0,0,P,P]);const{tileBoundsBuffer:R,tileBoundsIndexBuffer:U,tileBoundsSegments:W}=d.getMercatorTileBoundsBuffers();d.useProgram("hillshadePrepare").draw(w,S.TRIANGLES,f,_,y,a.CullFaceMode.disabled,((K,Z)=>{const ne=Z.stride,q=a.create$1();return a.ortho(q,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(q,q,[0,-a.EXTENT,0]),{u_matrix:q,u_image:1,u_dimension:[ne,ne],u_zoom:K.overscaledZ,u_unpack:Z.unpackVector}})(r.tileID,I),c.id,R,U,W),r.needsHillshadePrepare=!1}const Xt=(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_image0:new a.Uniform1i(d,r.u_image0),u_skirt_height:new a.Uniform1f(d,r.u_skirt_height)}),ya=(d,r)=>({u_matrix:d,u_image0:0,u_skirt_height:r}),Tl=new class{constructor(){this.operations={}}newMorphing(d,r,c,f,_){if(d in this.operations){const y=this.operations[d];y.to.tileID.key!==c.tileID.key&&(y.queued=c)}else this.operations[d]={startTime:f,phase:0,duration:_,from:r,to:c,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const r=this.operations[d];return{from:r.from,to:r.to,phase:r.phase}}update(d){for(const r in this.operations){const c=this.operations[r];for(c.phase=(d-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,d)){delete this.operations[r];break}}}_nextOp(d,r){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=r,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},cu={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function yd(d,r){const c=1<<d.z;return!r&&(d.x===0||d.x===c-1)||d.y===0||d.y===c-1}const va=d=>({u_matrix:d});function uu(d,r,c,f,_){if(_>0){const y=a.exported.now(),w=(y-d.timeAdded)/_,S=r?(y-r.timeAdded)/_:-1,I=c.getSource(),P=f.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),z=!r||Math.abs(r.tileID.overscaledZ-P)>Math.abs(d.tileID.overscaledZ-P),R=z&&d.refreshedUponExpiration?1:a.clamp(z?w:1-S,0,1);return d.refreshedUponExpiration&&w>=1&&(d.refreshedUponExpiration=!1),r?{opacity:1,mix:1-R}:{opacity:R,mix:0}}return{opacity:1,mix:0}}class Tm extends a.SourceCache{constructor(r){const c=$("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new er(Je(),null),r.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,c,f){if(r.freezeTileCoverage)return;this.transform=r;const _=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((y,w)=>{if(y[w.key]="",!this._tiles[w.key]){const S=new a.Tile(w,this._source.tileSize*w.overscaleFactor(),r.tileZoom);S.state="loaded",this._tiles[w.key]=S}return y},{});for(const y in this._tiles)y in _||(this.freeFBO(y),this._tiles[y].unloadVectorData(),delete this._tiles[y])}freeFBO(r){const c=this.proxyCachedFBO[r];if(c!==void 0){const f=Object.values(c);this.renderCachePool.push(...f),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class vd extends a.OverscaledTileID{constructor(r,c,f){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=c,this.projMatrix=f}}class hu extends a.Elevation{constructor(r,c){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[f,_,y]=function(I){const P=new a.StructArrayLayout4i8,z=new a.StructArrayLayout3ui6,R=131;P.reserve(17161),z.reserve(33800);const U=a.EXTENT/128,W=a.EXTENT+U/2,K=W+U;for(let ne=-U;ne<K;ne+=U)for(let q=-U;q<K;q+=U){const re=q<0||q>W||ne<0||ne>W?24575:0,se=a.clamp(Math.round(q),0,a.EXTENT),H=a.clamp(Math.round(ne),0,a.EXTENT);P.emplaceBack(se+re,H,se,H)}const Z=(ne,q)=>{const re=q*R+ne;z.emplaceBack(re+1,re,re+R),z.emplaceBack(re+R,re+R+1,re+1)};for(let ne=1;ne<129;ne++)for(let q=1;q<129;q++)Z(q,ne);return[0,129].forEach(ne=>{for(let q=0;q<130;q++)Z(q,ne),Z(ne,q)}),[P,z,32768]}(),w=r.context;this.gridBuffer=w.createVertexBuffer(f,a.boundsAttributes.members),this.gridIndexBuffer=w.createIndexBuffer(_),this.gridSegments=a.SegmentVector.simpleSegment(0,0,f.length,_.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,f.length,y),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Tm(c.map),this.orthoMatrix=a.create$1(),a.ortho(this.orthoMatrix,0,a.EXTENT,0,a.EXTENT,0,1);const S=w.gl;this._overlapStencilMode=new a.StencilMode({func:S.GEQUAL,mask:255},0,255,S.KEEP,S.KEEP,S.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency()}update(r,c,f){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const _=r.terrain.properties;this.sourceCache=r._getSourceCache(_.get("source")),this._exaggeration=_.get("exaggeration");const y=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const w=this.sourceCache.getSource().tileSize/128,S=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(c,w*S,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,y(),this._initializing=!0),y(),c.updateElevation(!f),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,f=this.painter.transform;this._initializing&&(this._initializing=f._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(f.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=c.getIds().map(I=>{const P=c.getTileByID(I).tileID;return P.projMatrix=f.calculateProjMatrix(P.toUnwrapped()),P});(function(I,P){const z=P.transform.pointCoordinate(P.transform.getCameraPoint()),R=new a.pointGeometry(z.x,z.y);I.sort((U,W)=>{if(W.overscaledZ-U.overscaledZ)return W.overscaledZ-U.overscaledZ;const K=new a.pointGeometry(U.canonical.x+(1<<U.canonical.z)*U.wrap,U.canonical.y),Z=new a.pointGeometry(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),ne=R.mult(1<<U.canonical.z);return ne.x-=.5,ne.y-=.5,ne.distSqr(K)-ne.distSqr(Z)})})(_,this.painter),this._previousZoom=f.zoom;const y=this.proxyToSource||{};this.proxyToSource={},_.forEach(I=>{this.proxyToSource[I.key]={}}),this.terrainTileForTile={};const w=this._style._sourceCaches;for(const I in w){const P=w[I];if(!P.used||(P!==this.sourceCache&&(this._findCoveringTileCache[P.id]={}),this._setupProxiedCoordsForOrtho(P,r[I],y),P.usedForTerrain))continue;const z=r[I];P.getSource().reparseOverscaled&&this._assignTerrainTiles(z)}this.proxiedCoords[c.id]=_.map(I=>new vd(I,I.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(y),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const S={};this._visibleDemTiles=[];for(const I of this.proxyCoords){const P=this.terrainTileForTile[I.key];if(!P)continue;const z=P.tileID.key;z in S||(this._visibleDemTiles.push(P),S[z]=z)}}_assignTerrainTiles(r){this._initializing||r.forEach(c=>{if(this.terrainTileForTile[c.key])return;const f=this._findTileCoveringTileID(c,this.sourceCache);f&&(this.terrainTileForTile[c.key]=f)})}_prepareDEMTextures(){const r=this.painter.context,c=r.gl;for(const f in this.terrainTileForTile){const _=this.terrainTileForTile[f],y=_.dem;!y||_.demTexture&&!_.needsDEMTextureUpload||(r.activeTexture.set(c.TEXTURE1),ga(this.painter,_,y))}}_prepareDemTileUniforms(r,c,f,_){if(!c||c.demTexture==null)return!1;const y=r.tileID.canonical,w=Math.pow(2,c.tileID.canonical.z-y.z),S=_||"";return f[`u_dem_tl${S}`]=[y.x*w%1,y.y*w%1],f[`u_dem_scale${S}`]=w,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let r=0;const c=this._visibleDemTiles.reduce((f,_)=>{if(!_.dem)return f;const y=_.dem.tree.minimums[0];return y>0&&r++,f+y},0);return r?c/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,c=r.gl;r.activeTexture.set(c.TEXTURE2);const f=this._getLoadedAreaMinimum(),_={width:1,height:1,data:new Uint8Array(a.DEMData.pack(f,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let y=this._emptyDEMTexture;return y?y.update(_,{premultiply:!1}):y=this._emptyDEMTexture=new a.Texture(r,_,c.RGBA,{premultiply:!1}),y}setupElevationDraw(r,c,f){const _=this.painter.context,y=_.gl,w=(S=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(S),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var S;w.u_dem_size=this.sourceCache.getSource().tileSize,w.u_exaggeration=this.exaggeration();let I=null,P=null,z=1;if(f&&f.morphing&&this._useVertexMorphing){const R=f.morphing.srcDemTile,U=f.morphing.dstDemTile;z=f.morphing.phase,R&&U&&(this._prepareDemTileUniforms(r,R,w,"_prev")&&(P=R),this._prepareDemTileUniforms(r,U,w)&&(I=U))}if(P&&I?(_.activeTexture.set(y.TEXTURE2),I.demTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE,y.NEAREST),_.activeTexture.set(y.TEXTURE4),P.demTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE,y.NEAREST),w.u_dem_lerp=z):(I=this.terrainTileForTile[r.tileID.key],_.activeTexture.set(y.TEXTURE2),(this._prepareDemTileUniforms(r,I,w)?I.demTexture:this.emptyDEMTexture).bind(y.NEAREST,y.CLAMP_TO_EDGE)),f&&f.useDepthForOcclusion&&(_.activeTexture.set(y.TEXTURE3),this._depthTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE),w.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),f&&f.useMeterToDem&&I){const R=(1<<I.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;w.u_meter_to_dem=R}f&&f.labelPlaneMatrixInv&&(w.u_label_plane_matrix_inv=f.labelPlaneMatrixInv),c.setTerrainUniformValues(_,w)}renderToBackBuffer(r){const c=this.painter,f=this.painter.context;r.length!==0&&(f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),this.renderingToTexture=!1,function(_,y,w,S,I){const P=_.context,z=P.gl;let R,U;const W=_.options.showTerrainWireframe?2:0,K=(se,H)=>{if(U===se)return;const le=[cu[se]];H&&le.push(cu[W]),R=_.useProgram("terrainRaster",null,le),U=se},Z=_.colorModeForRenderPass(),ne=new a.DepthMode(z.LEQUAL,a.DepthMode.ReadWrite,_.depthRangeFor3D);Tl.update(I);const q=_.transform,re=6*Math.pow(1.5,22-q.zoom)*y.exaggeration();(W?[!1,!0]:[!1]).forEach(se=>{U=-1;const H=se?z.LINES:z.TRIANGLES,[le,he]=se?y.getWirefameBuffer():[y.gridIndexBuffer,y.gridSegments];for(const ze of S){const De=w.getTile(ze),Ge=a.StencilMode.disabled,Me=y.prevTerrainTileForTile[ze.key],qe=y.terrainTileForTile[ze.key];Ce=qe,(ke=Me)!=null&&Ce!=null&&ke.hasData()&&Ce.hasData()&&ke.demTexture!=null&&Ce.demTexture!=null&&ke.tileID.key!==Ce.tileID.key&&Tl.newMorphing(ze.key,Me,qe,I,250),P.activeTexture.set(z.TEXTURE0),De.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE);const Se=Tl.getMorphValuesForProxy(ze.key),He=Se?1:0;let lt;Se&&(lt={morphing:{srcDemTile:Se.from,dstDemTile:Se.to,phase:a.easeCubicInOut(Se.phase)}});const yt=ya(ze.projMatrix,yd(ze.canonical,q.renderWorldCopies)?re/10:re);K(He,se),y.setupElevationDraw(De,R,lt),_.prepareDrawProgram(P,R,ze.toUnwrapped()),R.draw(P,H,ne,Ge,Z,a.CullFaceMode.backCCW,yt,"terrain_raster",y.gridBuffer,le,he)}var ke,Ce})}(c,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const c=this.painter,f=this.painter.context,_=this.proxySourceCache,y=this.proxiedCoords[_.id],w=this._drapedRenderBatches.shift(),S=[],I=c.style.order;let P=0;for(const z of y){const R=_.getTileByID(z.proxyTileKey),U=_.proxyCachedFBO[z.key]?_.proxyCachedFBO[z.key][r]:void 0,W=U!==void 0?_.renderCache[U]:this.pool[P++],K=U!==void 0;if(R.texture=W.tex,K&&!W.dirty){S.push(R.tileID);continue}let Z;f.bindFramebuffer.set(W.fb.framebuffer),this.renderedToTile=!1,W.dirty&&(f.clear({color:a.Color.transparent}),W.dirty=!1);for(let ne=w.start;ne<=w.end;++ne){const q=c.style._layers[I[ne]];if(q.isHidden(c.transform.zoom))continue;const re=c.style._getLayerSourceCache(q),se=re?this.proxyToSource[z.key][re.id]:[z];if(!se)continue;const H=se;f.viewport.set([0,0,W.fb.width,W.fb.height]),Z!==(re?re.id:null)&&(this._setupStencil(W,se,q,re),Z=re?re.id:null),c.renderLayer(c,re,q,H)}this.renderedToTile?(W.dirty=!0,S.push(R.tileID)):K||--P,P===5&&(P=0,this.renderToBackBuffer(S))}return this.renderToBackBuffer(S),this.renderingToTexture=!1,f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),w.end+1}postRender(){}renderCacheEfficiency(r){const c=r.order.length;if(c===0)return{efficiency:100};let f,_=0,y=0,w=!1;for(let S=0;S<c;++S){const I=r._layers[r.order[S]];this._style.isLayerDraped(I)?(w&&++_,++y):w||(w=!0,f=I.id)}return y===0?{efficiency:100}:{efficiency:100*(1-_/y),firstUndrapedLayer:f}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{r=Math.min(r,c.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,c,f){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(y=>y.dem).map(y=>{const w=y.tileID,S=Math.pow(2,w.overscaledZ),{x:I,y:P}=w.canonical,z=I/S,R=(I+1)/S,U=P/S,W=(P+1)/S;return{minx:z,miny:U,maxx:R,maxy:W,t:y.dem.tree.raycastRoot(z,U,R,W,r,c,f),tile:y}});_.sort((y,w)=>(y.t!==null?y.t:Number.MAX_VALUE)-(w.t!==null?w.t:Number.MAX_VALUE));for(const y of _){if(y.t==null)return null;const w=y.tile.dem.tree.raycast(y.minx,y.miny,y.maxx,y.maxy,r,c,f);if(w!=null)return w}return null}_createFBO(){const r=this.painter.context,c=r.gl,f=this.drapeBufferSize;r.activeTexture.set(c.TEXTURE0);const _=new a.Texture(r,{width:f[0],height:f[1],data:null},c.RGBA);_.bind(c.LINEAR,c.CLAMP_TO_EDGE);const y=r.createFramebuffer(f[0],f[1],!1);return y.colorAttachment.set(_.texture),y.depthAttachment=new Vi(r,y.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,f[0],f[1]),this._stencilRef=0,y.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):y.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:y,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const c=this._style._layers[r],f=c.isHidden(this.painter.transform.zoom),_=c.getCrossfadeParameters(),y=!!_&&_.t!==1,w=c.hasTransition();return c.type!=="custom"&&!f&&(y||w)})}_clearRasterFadeFromRenderCache(){let r=!1;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c]._source instanceof Lo){r=!0;break}if(r)for(let c=0;c<this._style.order.length;++c){const f=this._style._layers[this._style.order[c]],_=f.isHidden(this.painter.transform.zoom),y=this._style._getLayerSourceCache(f);if(f.type!=="raster"||_||!y)continue;const w=f.paint.get("raster-fade-duration");for(const S of this.proxyCoords){const I=this.proxyToSource[S.key][y.id];if(I)for(const P of I){const z=uu(y.getTile(P),y.findLoadedParent(P,0),y,this.painter.transform,w);(z.opacity!==1||z.mix!==0)&&this._clearRenderCacheForTile(y.id,P)}}}}_setupDrapedRenderBatches(){const r=this._style.order,c=r.length;if(c===0)return;const f=[];let _,y=0,w=this._style._layers[r[y]];for(;!this._style.isLayerDraped(w)&&w.isHidden(this.painter.transform.zoom)&&++y<c;)w=this._style._layers[r[y]];for(;y<c;++y){const S=this._style._layers[r[y]];S.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(S)?_===void 0&&(_=y):_!==void 0&&(f.push({start:_,end:y-1}),_=void 0))}_!==void 0&&f.push({start:_,end:y-1}),this._drapedRenderBatches=f}_setupRenderCache(r){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const w=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let S=0;S<w.length;++S){const I=Object.values(w[S]);c.renderCachePool.push(...I)}}return}this._clearRasterFadeFromRenderCache();const f=this.proxyCoords,_=this._tilesDirty;for(let w=f.length-1;w>=0;w--){const S=f[w];if(c.getTileByID(S.key),c.proxyCachedFBO[S.key]!==void 0){const I=r[S.key],P=this.proxyToSource[S.key];let z=0;for(const R in P){const U=P[R],W=I[R];if(!W||W.length!==U.length||U.some((K,Z)=>K!==W[Z]||_[R]&&_[R].hasOwnProperty(K.key))){z=-1;break}++z}for(const R in c.proxyCachedFBO[S.key])c.renderCache[c.proxyCachedFBO[S.key][R]].dirty=z<0||z!==Object.values(I).length}}const y=[...this._drapedRenderBatches];y.sort((w,S)=>S.end-S.start-(w.end-w.start));for(const w of y)for(const S of f){if(c.proxyCachedFBO[S.key])continue;let I=c.renderCachePool.pop();I===void 0&&c.renderCache.length<50&&(I=c.renderCache.length,c.renderCache.push(this._createFBO())),I!==void 0&&(c.proxyCachedFBO[S.key]={},c.proxyCachedFBO[S.key][w.start]=I,c.renderCache[I].dirty=!0)}this._tilesDirty={}}_setupStencil(r,c,f,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const y=this.painter.context,w=y.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let S;if(f.isTileClipped())S=c.length,this._overlapStencilMode.test={func:w.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);S=1,this._overlapStencilMode.test={func:w.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+S>255&&(y.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=S,this._overlapStencilMode.ref=this._stencilRef,f.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(r,c){const f=this.painter,_=this.painter.context,y=_.gl;f._tileClippingMaskIDs={},_.setColorMode(a.ColorMode.disabled),_.setDepthMode(a.DepthMode.disabled);const w=f.useProgram("clippingMask");for(const S of r){const I=f._tileClippingMaskIDs[S.key]=--c;w.draw(_,y.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:y.ALWAYS,mask:0},I,255,y.KEEP,y.KEEP,y.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,va(S.projMatrix),"$clipping",f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}pointCoordinate(r){const c=this.painter.transform;if(r.x<0||r.x>c.width||r.y<0||r.y>c.height)return null;const f=[r.x,r.y,1,1];a.transformMat4(f,f,c.pixelMatrixInverse),a.scale$2(f,f,1/f[3]),f[0]/=c.worldSize,f[1]/=c.worldSize;const _=c._camera.position,y=a.mercatorZfromAltitude(1,c.center.lat),w=[_[0],_[1],_[2]/y,0],S=a.subtract([],f.slice(0,3),w);a.normalize(S,S);const I=this.raycast(w,S,this._exaggeration);return I!==null&&I?(a.scaleAndAdd(w,w,S,I),w[3]=w[2],w[2]*=y,w):null}drawDepth(){const r=this.painter,c=r.context,f=this.proxySourceCache,_=Math.ceil(r.width),y=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===_&&this._depthFBO.height===y||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const w=c.gl,S=c.createFramebuffer(_,y,!0);c.activeTexture.set(w.TEXTURE0);const I=new a.Texture(c,{width:_,height:y,data:null},w.RGBA);I.bind(w.NEAREST,w.CLAMP_TO_EDGE),S.colorAttachment.set(I.texture);const P=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,_,y);S.depthAttachment.set(P),this._depthFBO=S,this._depthTexture=I}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,_,y]),function(w,S,I,P){const z=w.context,R=z.gl;z.clear({depth:1});const U=w.useProgram("terrainDepth"),W=new a.DepthMode(R.LESS,a.DepthMode.ReadWrite,w.depthRangeFor3D);for(const K of P){const Z=I.getTile(K),ne=ya(K.projMatrix,0);S.setupElevationDraw(Z,U),U.draw(z,R.TRIANGLES,W,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,ne,"terrain_depth",S.gridBuffer,S.gridIndexBuffer,S.gridNoSkirtSegments)}}(r,this,f,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,c,f){if(r.getSource()instanceof Q)return this._setupProxiedCoordsForImageSource(r,c,f);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const _=this.proxiedCoords[r.id]=[],y=this.proxyCoords;for(let S=0;S<y.length;S++){const I=y[S],P=this._findTileCoveringTileID(I,r);if(P){const z=this._createProxiedId(I,P,f[I.key]&&f[I.key][r.id]);_.push(z),this.proxyToSource[I.key][r.id]=[z]}}let w=!1;for(let S=0;S<c.length;S++){const I=r.getTile(c[S]);if(!I||!I.hasData())continue;const P=this._findTileCoveringTileID(I.tileID,this.proxySourceCache);if(P&&P.tileID.canonical.z!==I.tileID.canonical.z){const z=this.proxyToSource[P.tileID.key][r.id],R=this._createProxiedId(P.tileID,I,f[P.tileID.key]&&f[P.tileID.key][r.id]);z?z.splice(z.length-1,0,R):this.proxyToSource[P.tileID.key][r.id]=[R],_.push(R),w=!0}}this._sourceTilesOverlap[r.id]=w}_setupProxiedCoordsForImageSource(r,c,f){if(!r.getSource().loaded())return;const _=this.proxiedCoords[r.id]=[],y=this.proxyCoords,w=r.getSource(),S=new a.pointGeometry(w.tileID.x,w.tileID.y)._div(1<<w.tileID.z),I=w.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((z,R)=>(z.min.x=Math.min(z.min.x,R.x-S.x),z.min.y=Math.min(z.min.y,R.y-S.y),z.max.x=Math.max(z.max.x,R.x-S.x),z.max.y=Math.max(z.max.y,R.y-S.y),z),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),P=(z,R)=>{const U=z.wrap+z.canonical.x/(1<<z.canonical.z),W=z.canonical.y/(1<<z.canonical.z),K=a.EXTENT/(1<<z.canonical.z),Z=R.wrap+R.canonical.x/(1<<R.canonical.z),ne=R.canonical.y/(1<<R.canonical.z);return U+K<Z+I.min.x||U>Z+I.max.x||W+K<ne+I.min.y||W>ne+I.max.y};for(let z=0;z<y.length;z++){const R=y[z];for(let U=0;U<c.length;U++){const W=r.getTile(c[U]);if(!W||!W.hasData()||P(R,W.tileID))continue;const K=this._createProxiedId(R,W,f[R.key]&&f[R.key][r.id]),Z=this.proxyToSource[R.key][r.id];Z?Z.push(K):this.proxyToSource[R.key][r.id]=[K],_.push(K)}}}_createProxiedId(r,c,f){let _=this.orthoMatrix;if(f){const y=f.find(w=>w.key===c.tileID.key);if(y)return y}if(c.tileID.key!==r.key){const y=r.canonical.z-c.tileID.canonical.z;let w,S,I;_=a.create$1();const P=c.tileID.wrap-r.wrap<<r.overscaledZ;y>0?(w=a.EXTENT>>y,S=w*((c.tileID.canonical.x<<y)-r.canonical.x+P),I=w*((c.tileID.canonical.y<<y)-r.canonical.y)):(w=a.EXTENT<<-y,S=a.EXTENT*(c.tileID.canonical.x-(r.canonical.x+P<<-y)),I=a.EXTENT*(c.tileID.canonical.y-(r.canonical.y<<-y))),a.ortho(_,0,w,0,w,0,1),a.translate(_,_,[S,I,0])}return new vd(c.tileID,r.key,_)}_findTileCoveringTileID(r,c){let f=c.getTile(r);if(f&&f.hasData())return f;const _=this._findCoveringTileCache[c.id],y=_[r.key];if(f=y?c.getTileByID(y):null,f&&f.hasData()||y===null)return f;let w=f?f.tileID:r,S=w.overscaledZ;const I=c.getSource().minzoom,P=[];if(!y){const R=c.getSource().maxzoom;if(r.canonical.z>=R){const U=r.canonical.z-R;c.getSource().reparseOverscaled?(S=Math.max(r.canonical.z+2,c.transform.tileZoom),w=new a.OverscaledTileID(S,r.wrap,R,r.canonical.x>>U,r.canonical.y>>U)):U!==0&&(S=R,w=new a.OverscaledTileID(S,r.wrap,R,r.canonical.x>>U,r.canonical.y>>U))}w.key!==r.key&&(P.push(w.key),f=c.getTile(w))}const z=R=>{P.forEach(U=>{_[U]=R}),P.length=0};for(S-=1;S>=I&&(!f||!f.hasData());S--){f&&z(f.tileID.key);const R=w.calculateScaledKey(S);if(f=c.getTileByID(R),f&&f.hasData())break;const U=_[R];if(U===null)break;U===void 0?P.push(R):f=c.getTileByID(U)}return z(f?f.tileID.key:null),f&&f.hasData()?f:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(r){this.renderedToTile=!0}_clearRenderCacheForTile(r,c){let f=this._tilesDirty[r];f||(f=this._tilesDirty[r]={}),f[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(c){let f,_,y;const w=new a.StructArrayLayout2ui4,S=131;for(_=1;_<129;_++){for(f=1;f<129;f++)y=_*S+f,w.emplaceBack(y,y+1),w.emplaceBack(y,y+S),w.emplaceBack(y+1,y+S),_===128&&w.emplaceBack(y+S,y+S+1);w.emplaceBack(y+1,y+1+S)}return w}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function Sl(d){const r=[];for(let c=0;c<d.length;c++){if(d[c]===null)continue;const f=d[c].split(" ");r.push(f.pop())}return r}class Cl{static cacheKey(r,c,f){let _=`${r}${f?f.cacheKey:""}`;for(const y of c)_+=`/${y}`;return _}constructor(r,c,f,_,y,w){const S=r.gl;this.program=S.createProgram();const I=Sl(f.staticAttributes),P=_?_.getBinderAttributes():[],z=I.concat(P),R=f.staticUniforms?Sl(f.staticUniforms):[],U=_?_.getBinderUniforms():[],W=R.concat(U),K=[];for(const le of W)K.indexOf(le)<0&&K.push(le);let Z=_?_.defines():[];Z=Z.concat(w.map(le=>`#define ${le}`));const ne=Z.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,_s,lo.fragmentSource,gs.fragmentSource,f.fragmentSource).join(`
`),q=Z.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,_s,lo.vertexSource,gs.vertexSource,ma.vertexSource,f.vertexSource).join(`
`),re=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(re,ne),S.compileShader(re),S.attachShader(this.program,re);const se=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(se,q),S.compileShader(se),S.attachShader(this.program,se),this.attributes={};const H={};this.numAttributes=z.length;for(let le=0;le<this.numAttributes;le++)z[le]&&(S.bindAttribLocation(this.program,le,z[le]),this.attributes[z[le]]=le);S.linkProgram(this.program),S.deleteShader(se),S.deleteShader(re);for(let le=0;le<K.length;le++){const he=K[le];if(he&&!H[he]){const ke=S.getUniformLocation(this.program,he);ke&&(H[he]=ke)}}this.fixedUniforms=y(r,H),this.binderUniforms=_?_.getUniforms(r,H):[],w.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((le,he)=>({u_dem:new a.Uniform1i(le,he.u_dem),u_dem_prev:new a.Uniform1i(le,he.u_dem_prev),u_dem_unpack:new a.Uniform4f(le,he.u_dem_unpack),u_dem_tl:new a.Uniform2f(le,he.u_dem_tl),u_dem_scale:new a.Uniform1f(le,he.u_dem_scale),u_dem_tl_prev:new a.Uniform2f(le,he.u_dem_tl_prev),u_dem_scale_prev:new a.Uniform1f(le,he.u_dem_scale_prev),u_dem_size:new a.Uniform1f(le,he.u_dem_size),u_dem_lerp:new a.Uniform1f(le,he.u_dem_lerp),u_exaggeration:new a.Uniform1f(le,he.u_exaggeration),u_depth:new a.Uniform1i(le,he.u_depth),u_depth_size_inv:new a.Uniform2f(le,he.u_depth_size_inv),u_meter_to_dem:new a.Uniform1f(le,he.u_meter_to_dem),u_label_plane_matrix_inv:new a.UniformMatrix4f(le,he.u_label_plane_matrix_inv),u_tile_tl_up:new a.Uniform3f(le,he.u_tile_tl_up),u_tile_tr_up:new a.Uniform3f(le,he.u_tile_tr_up),u_tile_br_up:new a.Uniform3f(le,he.u_tile_br_up),u_tile_bl_up:new a.Uniform3f(le,he.u_tile_bl_up),u_tile_up_scale:new a.Uniform1f(le,he.u_tile_up_scale)}))(r,H)),w.indexOf("FOG")!==-1&&(this.fogUniforms=((le,he)=>({u_fog_matrix:new a.UniformMatrix4f(le,he.u_fog_matrix),u_fog_range:new a.Uniform2f(le,he.u_fog_range),u_fog_color:new a.Uniform4f(le,he.u_fog_color),u_fog_horizon_blend:new a.Uniform1f(le,he.u_fog_horizon_blend),u_fog_temporal_offset:new a.Uniform1f(le,he.u_fog_temporal_offset)}))(r,H))}setTerrainUniformValues(r,c){if(!this.terrainUniforms)return;const f=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in c)f[_].set(c[_])}}setFogUniformValues(r,c){if(!this.fogUniforms)return;const f=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in c)f[_].location&&f[_].set(c[_])}}draw(r,c,f,_,y,w,S,I,P,z,R,U,W,K,Z,ne){const q=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(f),r.setStencilMode(_),r.setColorMode(y),r.setCullFace(w);for(const se in this.fixedUniforms)this.fixedUniforms[se].set(S[se]);K&&K.setUniforms(r,this.binderUniforms,U,{zoom:W});const re={[q.LINES]:2,[q.TRIANGLES]:3,[q.LINE_STRIP]:1}[c];for(const se of R.get()){const H=se.vaos||(se.vaos={});(H[I]||(H[I]=new wl)).bind(r,this,P,K?K.getPaintVertexBuffers():[],z,se.vertexOffset,Z,ne),q.drawElements(c,se.primitiveLength*re,q.UNSIGNED_SHORT,se.primitiveOffset*re*2)}}}function kl(d,r,c){const f=1/Ze(c,1,r.transform.tileZoom),_=Math.pow(2,c.tileID.overscaledZ),y=c.tileSize*Math.pow(2,r.transform.tileZoom)/_,w=y*(c.tileID.canonical.x+c.tileID.wrap*_),S=y*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[f,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[w>>16,S>>16],u_pixel_coord_lower:[65535&w,65535&S]}}const du=(d,r,c,f)=>{const _=r.style.light,y=_.properties.get("position"),w=[y.x,y.y,y.z],S=a.create$2();_.properties.get("anchor")==="viewport"&&(a.fromRotation(S,-r.transform.angle),a.transformMat3(w,w,S));const I=_.properties.get("color");return{u_matrix:d,u_lightpos:w,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+c,u_opacity:f}},xd=(d,r,c,f,_,y,w)=>a.extend(du(d,r,c,f),kl(y,r,w),{u_height_factor:-Math.pow(2,_.overscaledZ)/w.tileSize/8}),bd=d=>({u_matrix:d}),ys=(d,r,c,f)=>a.extend(bd(d),kl(c,r,f)),xa=(d,r)=>({u_matrix:d,u_world:r}),wd=(d,r,c,f,_)=>a.extend(ys(d,r,c,f),{u_world:_}),jr=(d,r,c,f)=>{const _=d.transform;let y;return y=f.paint.get("circle-pitch-alignment")==="map"?_.calculatePixelsToTileUnitsMatrix(c):new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]),{u_camera_to_center_distance:_.cameraToCenterDistance,u_matrix:d.translatePosMatrix(r.projMatrix,c,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:y}},pu=d=>{const r=[];return d.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},Il=(d,r,c)=>{const f=a.EXTENT/c.tileSize;return{u_matrix:d,u_camera_to_center_distance:r.cameraToCenterDistance,u_extrude_scale:[r.pixelsToGLUnits[0]/f,r.pixelsToGLUnits[1]/f]}},ba=(d,r,c=1)=>({u_matrix:d,u_color:r,u_overlay:0,u_overlay_scale:c}),fu=(d,r,c,f)=>({u_matrix:d,u_extrude_scale:Ze(r,1,c),u_intensity:f}),mu=(d,r,c,f,_,y)=>{const w=d.transform,S=w.calculatePixelsToTileUnitsMatrix(r),I={u_matrix:Pl(d,r,c,_),u_pixels_to_tile_units:S,u_device_pixel_ratio:a.exported.devicePixelRatio,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:y,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0};if(gu(c)){const P=Ml(r,d.transform);I.u_texsize=r.lineAtlasTexture.size,I.u_scale=[P,f.fromScale,f.toScale],I.u_mix=f.t}return I},Al=(d,r,c,f,_)=>{const y=d.transform,w=Ml(r,y);return{u_matrix:Pl(d,r,c,_),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:y.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:a.exported.devicePixelRatio,u_image:0,u_scale:[w,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}};function Ml(d,r){return 1/Ze(d,1,r.tileZoom)}function Pl(d,r,c,f){return d.translatePosMatrix(f||r.tileID.projMatrix,r,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const zl=d=>{const r=[];return gu(d)&&r.push("RENDER_LINE_DASH"),d.paint.get("line-gradient")&&r.push("RENDER_LINE_GRADIENT"),r};function gu(d){const r=d.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const Ed=(d,r,c,f,_)=>{return{u_matrix:d,u_tl_parent:r,u_scale_parent:c,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(w=_.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(y=_.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:vs(_.paint.get("raster-hue-rotate"))};var y,w};function vs(d){d*=Math.PI/180;const r=Math.sin(d),c=Math.cos(d);return[(2*c+1)/3,(-Math.sqrt(3)*r-c+1)/3,(Math.sqrt(3)*r-c+1)/3]}const Td=(d,r,c,f,_,y,w,S,I,P,z,R,U,W)=>{const K=_.transform;return{u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:K.cameraToCenterDistance,u_pitch:K.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:K.width/K.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:w,u_coord_matrix:S,u_is_text:+I,u_pitch_with_map:+f,u_texsize:P,u_tile_id:z,u_zoom_transition:R,u_inv_rot_matrix:U,u_merc_center:W,u_texture:0}},Sd=(d,r,c,f,_,y,w,S,I,P,z,R,U,W,K)=>{const{cameraToCenterDistance:Z,_pitch:ne}=_.transform;return a.extend(Td(d,r,c,f,_,y,w,S,I,P,R,U,W,K),{u_gamma_scale:f?Z*Math.cos(_.terrain?0:ne):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+z})},Sm=(d,r,c,f,_,y,w,S,I,P,z,R,U,W)=>a.extend(Sd(d,r,c,f,_,y,w,S,!0,I,!0,z,R,U,W),{u_texsize_icon:P,u_texture_icon:1}),Cm=(d,r,c)=>({u_matrix:d,u_opacity:r,u_color:c}),km=(d,r,c,f,_,y)=>a.extend(function(w,S,I,P){const z=I.imageManager.getPattern(w.from.toString()),R=I.imageManager.getPattern(w.to.toString()),{width:U,height:W}=I.imageManager.getPixelSize(),K=Math.pow(2,P.tileID.overscaledZ),Z=P.tileSize*Math.pow(2,I.transform.tileZoom)/K,ne=Z*(P.tileID.canonical.x+P.tileID.wrap*K),q=Z*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:R.tl,u_pattern_br_b:R.br,u_texsize:[U,W],u_mix:S.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:R.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/Ze(P,1,I.transform.tileZoom),u_pixel_coord_upper:[ne>>16,q>>16],u_pixel_coord_lower:[65535&ne,65535&q]}}(f,y,c,_),{u_matrix:d,u_opacity:r}),Im={fillExtrusion:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_lightpos:new a.Uniform3f(d,r.u_lightpos),u_lightintensity:new a.Uniform1f(d,r.u_lightintensity),u_lightcolor:new a.Uniform3f(d,r.u_lightcolor),u_vertical_gradient:new a.Uniform1f(d,r.u_vertical_gradient),u_opacity:new a.Uniform1f(d,r.u_opacity)}),fillExtrusionPattern:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_lightpos:new a.Uniform3f(d,r.u_lightpos),u_lightintensity:new a.Uniform1f(d,r.u_lightintensity),u_lightcolor:new a.Uniform3f(d,r.u_lightcolor),u_vertical_gradient:new a.Uniform1f(d,r.u_vertical_gradient),u_height_factor:new a.Uniform1f(d,r.u_height_factor),u_image:new a.Uniform1i(d,r.u_image),u_texsize:new a.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,r.u_scale),u_fade:new a.Uniform1f(d,r.u_fade),u_opacity:new a.Uniform1f(d,r.u_opacity)}),fill:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix)}),fillPattern:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_image:new a.Uniform1i(d,r.u_image),u_texsize:new a.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,r.u_scale),u_fade:new a.Uniform1f(d,r.u_fade)}),fillOutline:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_world:new a.Uniform2f(d,r.u_world)}),fillOutlinePattern:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_world:new a.Uniform2f(d,r.u_world),u_image:new a.Uniform1i(d,r.u_image),u_texsize:new a.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,r.u_scale),u_fade:new a.Uniform1f(d,r.u_fade)}),circle:(d,r)=>({u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_extrude_scale:new a.UniformMatrix2f(d,r.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(d,r.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(d,r.u_matrix)}),collisionBox:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_extrude_scale:new a.Uniform2f(d,r.u_extrude_scale)}),collisionCircle:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_inv_matrix:new a.UniformMatrix4f(d,r.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(d,r.u_viewport_size)}),debug:(d,r)=>({u_color:new a.UniformColor(d,r.u_color),u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_overlay:new a.Uniform1i(d,r.u_overlay),u_overlay_scale:new a.Uniform1f(d,r.u_overlay_scale)}),clippingMask:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix)}),heatmap:(d,r)=>({u_extrude_scale:new a.Uniform1f(d,r.u_extrude_scale),u_intensity:new a.Uniform1f(d,r.u_intensity),u_matrix:new a.UniformMatrix4f(d,r.u_matrix)}),heatmapTexture:(d,r)=>({u_image:new a.Uniform1i(d,r.u_image),u_color_ramp:new a.Uniform1i(d,r.u_color_ramp),u_opacity:new a.Uniform1f(d,r.u_opacity)}),hillshade:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_image:new a.Uniform1i(d,r.u_image),u_latrange:new a.Uniform2f(d,r.u_latrange),u_light:new a.Uniform2f(d,r.u_light),u_shadow:new a.UniformColor(d,r.u_shadow),u_highlight:new a.UniformColor(d,r.u_highlight),u_accent:new a.UniformColor(d,r.u_accent)}),hillshadePrepare:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_image:new a.Uniform1i(d,r.u_image),u_dimension:new a.Uniform2f(d,r.u_dimension),u_zoom:new a.Uniform1f(d,r.u_zoom),u_unpack:new a.Uniform4f(d,r.u_unpack)}),line:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_pixels_to_tile_units:new a.UniformMatrix2f(d,r.u_pixels_to_tile_units),u_device_pixel_ratio:new a.Uniform1f(d,r.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(d,r.u_units_to_pixels),u_dash_image:new a.Uniform1i(d,r.u_dash_image),u_gradient_image:new a.Uniform1i(d,r.u_gradient_image),u_image_height:new a.Uniform1f(d,r.u_image_height),u_texsize:new a.Uniform2f(d,r.u_texsize),u_scale:new a.Uniform3f(d,r.u_scale),u_mix:new a.Uniform1f(d,r.u_mix)}),linePattern:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_texsize:new a.Uniform2f(d,r.u_texsize),u_pixels_to_tile_units:new a.UniformMatrix2f(d,r.u_pixels_to_tile_units),u_device_pixel_ratio:new a.Uniform1f(d,r.u_device_pixel_ratio),u_image:new a.Uniform1i(d,r.u_image),u_units_to_pixels:new a.Uniform2f(d,r.u_units_to_pixels),u_scale:new a.Uniform3f(d,r.u_scale),u_fade:new a.Uniform1f(d,r.u_fade)}),raster:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_tl_parent:new a.Uniform2f(d,r.u_tl_parent),u_scale_parent:new a.Uniform1f(d,r.u_scale_parent),u_buffer_scale:new a.Uniform1f(d,r.u_buffer_scale),u_fade_t:new a.Uniform1f(d,r.u_fade_t),u_opacity:new a.Uniform1f(d,r.u_opacity),u_image0:new a.Uniform1i(d,r.u_image0),u_image1:new a.Uniform1i(d,r.u_image1),u_brightness_low:new a.Uniform1f(d,r.u_brightness_low),u_brightness_high:new a.Uniform1f(d,r.u_brightness_high),u_saturation_factor:new a.Uniform1f(d,r.u_saturation_factor),u_contrast_factor:new a.Uniform1f(d,r.u_contrast_factor),u_spin_weights:new a.Uniform3f(d,r.u_spin_weights)}),symbolIcon:(d,r)=>({u_is_size_zoom_constant:new a.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,r.u_size_t),u_size:new a.Uniform1f(d,r.u_size),u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new a.Uniform1f(d,r.u_pitch),u_rotate_symbol:new a.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,r.u_fade_change),u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new a.Uniform1i(d,r.u_is_text),u_pitch_with_map:new a.Uniform1i(d,r.u_pitch_with_map),u_texsize:new a.Uniform2f(d,r.u_texsize),u_tile_id:new a.Uniform3f(d,r.u_tile_id),u_zoom_transition:new a.Uniform1f(d,r.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(d,r.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(d,r.u_merc_center),u_texture:new a.Uniform1i(d,r.u_texture)}),symbolSDF:(d,r)=>({u_is_size_zoom_constant:new a.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,r.u_size_t),u_size:new a.Uniform1f(d,r.u_size),u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new a.Uniform1f(d,r.u_pitch),u_rotate_symbol:new a.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,r.u_fade_change),u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new a.Uniform1i(d,r.u_is_text),u_pitch_with_map:new a.Uniform1i(d,r.u_pitch_with_map),u_texsize:new a.Uniform2f(d,r.u_texsize),u_texture:new a.Uniform1i(d,r.u_texture),u_gamma_scale:new a.Uniform1f(d,r.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(d,r.u_device_pixel_ratio),u_tile_id:new a.Uniform3f(d,r.u_tile_id),u_zoom_transition:new a.Uniform1f(d,r.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(d,r.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(d,r.u_merc_center),u_is_halo:new a.Uniform1i(d,r.u_is_halo)}),symbolTextAndIcon:(d,r)=>({u_is_size_zoom_constant:new a.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,r.u_size_t),u_size:new a.Uniform1f(d,r.u_size),u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new a.Uniform1f(d,r.u_pitch),u_rotate_symbol:new a.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,r.u_fade_change),u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new a.Uniform1i(d,r.u_is_text),u_pitch_with_map:new a.Uniform1i(d,r.u_pitch_with_map),u_texsize:new a.Uniform2f(d,r.u_texsize),u_texsize_icon:new a.Uniform2f(d,r.u_texsize_icon),u_texture:new a.Uniform1i(d,r.u_texture),u_texture_icon:new a.Uniform1i(d,r.u_texture_icon),u_gamma_scale:new a.Uniform1f(d,r.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(d,r.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(d,r.u_is_halo)}),background:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_opacity:new a.Uniform1f(d,r.u_opacity),u_color:new a.UniformColor(d,r.u_color)}),backgroundPattern:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_opacity:new a.Uniform1f(d,r.u_opacity),u_image:new a.Uniform1i(d,r.u_image),u_pattern_tl_a:new a.Uniform2f(d,r.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(d,r.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(d,r.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(d,r.u_pattern_br_b),u_texsize:new a.Uniform2f(d,r.u_texsize),u_mix:new a.Uniform1f(d,r.u_mix),u_pattern_size_a:new a.Uniform2f(d,r.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(d,r.u_pattern_size_b),u_scale_a:new a.Uniform1f(d,r.u_scale_a),u_scale_b:new a.Uniform1f(d,r.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,r.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(d,r.u_tile_units_to_pixels)}),terrainRaster:Xt,terrainDepth:Xt,skybox:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_sun_direction:new a.Uniform3f(d,r.u_sun_direction),u_cubemap:new a.Uniform1i(d,r.u_cubemap),u_opacity:new a.Uniform1f(d,r.u_opacity),u_temporal_offset:new a.Uniform1f(d,r.u_temporal_offset)}),skyboxGradient:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_color_ramp:new a.Uniform1i(d,r.u_color_ramp),u_center_direction:new a.Uniform3f(d,r.u_center_direction),u_radius:new a.Uniform1f(d,r.u_radius),u_opacity:new a.Uniform1f(d,r.u_opacity),u_temporal_offset:new a.Uniform1f(d,r.u_temporal_offset)}),skyboxCapture:(d,r)=>({u_matrix_3f:new a.UniformMatrix3f(d,r.u_matrix_3f),u_sun_direction:new a.Uniform3f(d,r.u_sun_direction),u_sun_intensity:new a.Uniform1f(d,r.u_sun_intensity),u_color_tint_r:new a.Uniform4f(d,r.u_color_tint_r),u_color_tint_m:new a.Uniform4f(d,r.u_color_tint_m),u_luminance:new a.Uniform1f(d,r.u_luminance)})};let xs;function Dl(d,r,c,f,_,y,w){const S=d.context,I=S.gl,P=d.useProgram("collisionBox"),z=[];let R=0,U=0;for(let se=0;se<f.length;se++){const H=f[se],le=r.getTile(H),he=le.getBucket(c);if(!he)continue;let ke=H.projMatrix;_[0]===0&&_[1]===0||(ke=d.translatePosMatrix(H.projMatrix,le,_,y));const Ce=w?he.textCollisionBox:he.iconCollisionBox,ze=he.collisionCircleArray;if(ze.length>0){const De=a.create$1(),Ge=ke;a.mul$1(De,he.placementInvProjMatrix,d.transform.glCoordMatrix),a.mul$1(De,De,he.placementViewportMatrix),z.push({circleArray:ze,circleOffset:U,transform:Ge,invTransform:De}),R+=ze.length/4,U=R}Ce&&(d.terrain&&d.terrain.setupElevationDraw(le,P),P.draw(S,I.LINES,a.DepthMode.disabled,a.StencilMode.disabled,d.colorModeForRenderPass(),a.CullFaceMode.disabled,Il(ke,d.transform,le),c.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,null,d.transform.zoom,null,Ce.collisionVertexBuffer,Ce.collisionVertexBufferExt))}if(!w||!z.length)return;const W=d.useProgram("collisionCircle"),K=new a.StructArrayLayout2f1f2i16;K.resize(4*R),K._trim();let Z=0;for(const se of z)for(let H=0;H<se.circleArray.length/4;H++){const le=4*H,he=se.circleArray[le+0],ke=se.circleArray[le+1],Ce=se.circleArray[le+2],ze=se.circleArray[le+3];K.emplace(Z++,he,ke,Ce,ze,0),K.emplace(Z++,he,ke,Ce,ze,1),K.emplace(Z++,he,ke,Ce,ze,2),K.emplace(Z++,he,ke,Ce,ze,3)}(!xs||xs.length<2*R)&&(xs=function(se){const H=2*se,le=new a.StructArrayLayout3ui6;le.resize(H),le._trim();for(let he=0;he<H;he++){const ke=6*he;le.uint16[ke+0]=4*he+0,le.uint16[ke+1]=4*he+1,le.uint16[ke+2]=4*he+2,le.uint16[ke+3]=4*he+2,le.uint16[ke+4]=4*he+3,le.uint16[ke+5]=4*he+0}return le}(R));const ne=S.createIndexBuffer(xs,!0),q=S.createVertexBuffer(K,a.collisionCircleLayout.members,!0);for(const se of z){const H={u_matrix:se.transform,u_inv_matrix:se.invTransform,u_camera_to_center_distance:(re=d.transform).cameraToCenterDistance,u_viewport_size:[re.width,re.height]};W.draw(S,I.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,d.colorModeForRenderPass(),a.CullFaceMode.disabled,H,c.id,q,ne,a.SegmentVector.simpleSegment(0,2*se.circleOffset,se.circleArray.length,se.circleArray.length/2),null,d.transform.zoom,null,null,null)}var re;q.destroy(),ne.destroy()}const jo=a.identity(new Float32Array(16));function Cd(d,r,c,f,_,y){const{horizontalAlign:w,verticalAlign:S}=a.getAnchorAlignment(d),I=-(w-.5)*r,P=-(S-.5)*c,z=a.evaluateVariableOffset(d,f);return new a.pointGeometry((I/_+z[0])*y,(P/_+z[1])*y)}function kd(d,r,c,f,_,y,w,S,I,P,z,R){const U=d.text.placedSymbolArray,W=d.text.dynamicLayoutVertexArray,K=d.icon.dynamicLayoutVertexArray,Z={};W.clear();for(let ne=0;ne<U.length;ne++){const q=U.get(ne),re=d.allowVerticalPlacement&&!q.placedOrientation,se=q.hidden||!q.crossTileID||re?null:f[q.crossTileID];if(se){const H=new a.pointGeometry(q.tileAnchorX,q.tileAnchorY),le=R(H),he=Rn(H,c?S:w,le),ke=Fo(y.cameraToCenterDistance,he.signedDistanceFromCamera);let Ce=_.evaluateSizeForFeature(d.textSizeData,P,q)*ke/a.ONE_EM;c&&(Ce*=d.tilePixelRatio/I);const{width:ze,height:De,anchor:Ge,textOffset:Me,textScale:qe}=se,Se=Cd(Ge,ze,De,Me,qe,Ce),He=c?Rn(H.add(Se),w,le).point:he.point.add(r?Se.rotate(-y.angle):Se),lt=d.allowVerticalPlacement&&q.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let yt=0;yt<q.numGlyphs;yt++)a.addDynamicAttributes(W,He,lt);z&&q.associatedIconIndex>=0&&(Z[q.associatedIconIndex]={shiftedAnchor:He,angle:lt})}else pi(q.numGlyphs,W)}if(z){K.clear();const ne=d.icon.placedSymbolArray;for(let q=0;q<ne.length;q++){const re=ne.get(q);if(re.hidden)pi(re.numGlyphs,K);else{const se=Z[q];if(se)for(let H=0;H<re.numGlyphs;H++)a.addDynamicAttributes(K,se.shiftedAnchor,se.angle);else pi(re.numGlyphs,K)}}d.icon.dynamicLayoutVertexBuffer.updateData(K)}d.text.dynamicLayoutVertexBuffer.updateData(W)}function _u(d,r,c){return c.iconsInText&&r?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function co(d,r,c,f,_,y,w,S,I,P,z,R){const U=d.context,W=U.gl,K=d.transform,Z=S==="map",ne=I==="map",q=Z&&c.layout.get("symbol-placement")!=="point",re=Z&&!ne&&!q,se=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let H=!1;const le=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),he=[0,0],ke=c.layout.get("text-variable-anchor"),Ce=[],ze=[];d.terrain&&ne&&ze.push("PITCH_WITH_MAP_TERRAIN"),q&&ze.push("PROJECTED_POS_ON_VIEWPORT");for(const De of f){const Ge=r.getTile(De),Me=Ge.getBucket(c);if(!Me)continue;const qe=_?Me.text:Me.icon;if(!qe||!qe.segments.get().length)continue;const Se=qe.programConfigurations.get(c.id),He=_||Me.sdfIcons,lt=_?Me.textSizeData:Me.iconSizeData,yt=ne||K.pitch!==0,vt=d.useProgram(_u(He,_,Me),Se,ze),wt=a.evaluateSizeForZoom(lt,K.zoom),Et=[De.canonical.x,De.canonical.y,1<<De.canonical.z];let gt,At,Qt,jn,ir=[0,0],_r=null;if(_){if(At=Ge.glyphAtlasTexture,Qt=W.LINEAR,gt=Ge.glyphAtlasTexture.size,Me.iconsInText){ir=Ge.imageAtlasTexture.size,_r=Ge.imageAtlasTexture;const zr=lt.kind==="composite"||lt.kind==="camera";jn=yt||d.options.rotating||d.options.zooming||zr?W.LINEAR:W.NEAREST}}else{const zr=c.layout.get("icon-size").constantOr(0)!==1||Me.iconsNeedLinear;At=Ge.imageAtlasTexture,Qt=He||d.options.rotating||d.options.zooming||zr||yt?W.LINEAR:W.NEAREST,gt=Ge.imageAtlasTexture.size}const Tr=d.transform.calculatePixelsToTileUnitsMatrix(Ge),Vn=Lt(De.projMatrix,ne,Z,d.transform,Tr),Zi=d.terrain&&ne&&q?a.invert(new Float32Array(16),Vn):jo,Ii=Dt(De.projMatrix,ne,Z,d.transform,Tr),fn=ke&&Me.hasTextData(),Mn=c.layout.get("icon-text-fit")!=="none"&&fn&&Me.hasIconData();if(q){const zr=K.elevation;dl(Me,De.projMatrix,d,_,Vn,Ii,ne,P,zr?_o=>zr.getAtTileOffset(De,_o.x,_o.y):null)}const Zt=d.translatePosMatrix(De.projMatrix,Ge,y,w),gn=q||_&&ke||Mn?jo:Vn,or=d.translatePosMatrix(Ii,Ge,y,w,!0),mn=He&&c.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Vr;Vr=He?Me.iconsInText?Sm(lt.kind,wt,re,ne,d,Zt,gn,or,gt,ir,Et,0,d.identityMat,he):Sd(lt.kind,wt,re,ne,d,Zt,gn,or,_,gt,!0,Et,0,d.identityMat,he):Td(lt.kind,wt,re,ne,d,Zt,gn,or,_,gt,Et,0,d.identityMat,he);const Ra={program:vt,buffers:qe,uniformValues:Vr,atlasTexture:At,atlasTextureIcon:_r,atlasInterpolation:Qt,atlasInterpolationIcon:jn,isSDF:He,hasHalo:mn,tile:Ge,labelPlaneMatrixInv:Zi};if(se&&Me.canOverlap){H=!0;const zr=qe.segments.get();for(const _o of zr)Ce.push({segments:new a.SegmentVector([_o]),sortKey:_o.sortKey,state:Ra})}else Ce.push({segments:qe.segments,sortKey:0,state:Ra})}H&&Ce.sort((De,Ge)=>De.sortKey-Ge.sortKey);for(const De of Ce){const Ge=De.state;if(d.terrain&&d.terrain.setupElevationDraw(Ge.tile,Ge.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:Ge.labelPlaneMatrixInv}),U.activeTexture.set(W.TEXTURE0),Ge.atlasTexture.bind(Ge.atlasInterpolation,W.CLAMP_TO_EDGE),Ge.atlasTextureIcon&&(U.activeTexture.set(W.TEXTURE1),Ge.atlasTextureIcon&&Ge.atlasTextureIcon.bind(Ge.atlasInterpolationIcon,W.CLAMP_TO_EDGE)),Ge.isSDF){const Me=Ge.uniformValues;Ge.hasHalo&&(Me.u_is_halo=1,yu(Ge.buffers,De.segments,c,d,Ge.program,le,z,R,Me)),Me.u_is_halo=0}yu(Ge.buffers,De.segments,c,d,Ge.program,le,z,R,Ge.uniformValues)}}function yu(d,r,c,f,_,y,w,S,I){const P=f.context;_.draw(P,P.gl.TRIANGLES,y,w,S,a.CullFaceMode.disabled,I,c.id,d.layoutVertexBuffer,d.indexBuffer,r,c.paint,f.transform.zoom,d.programConfigurations.get(c.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function Vo(d,r,c,f,_,y,w){const S=d.context.gl,I=c.paint.get("fill-pattern"),P=I&&I.constantOr(1),z=c.getCrossfadeParameters();let R,U,W,K,Z;w?(U=P&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",R=S.LINES):(U=P?"fillPattern":"fill",R=S.TRIANGLES);for(const ne of f){const q=r.getTile(ne);if(P&&!q.patternsLoaded())continue;const re=q.getBucket(c);if(!re)continue;d.prepareDrawTile(ne);const se=re.programConfigurations.get(c.id),H=d.useProgram(U,se);P&&(d.context.activeTexture.set(S.TEXTURE0),q.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),se.updatePaintBuffers(z));const le=I.constantOr(null);if(le&&q.imageAtlas){const ke=q.imageAtlas,Ce=ke.patternPositions[le.to.toString()],ze=ke.patternPositions[le.from.toString()];Ce&&ze&&se.setConstantPatternPositions(Ce,ze)}const he=d.translatePosMatrix(ne.projMatrix,q,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(w){K=re.indexBuffer2,Z=re.segments2;const ke=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[S.drawingBufferWidth,S.drawingBufferHeight];W=U==="fillOutlinePattern"&&P?wd(he,d,z,q,ke):xa(he,ke)}else K=re.indexBuffer,Z=re.segments,W=P?ys(he,d,z,q):bd(he);d.prepareDrawProgram(d.context,H,ne.toUnwrapped()),H.draw(d.context,R,_,d.stencilModeForClipping(ne),y,a.CullFaceMode.disabled,W,c.id,re.layoutVertexBuffer,K,Z,c.paint,d.transform.zoom,se)}}function uo(d,r,c,f,_,y,w){const S=d.context,I=S.gl,P=c.paint.get("fill-extrusion-pattern"),z=P.constantOr(1),R=c.getCrossfadeParameters(),U=c.paint.get("fill-extrusion-opacity");for(const W of f){const K=r.getTile(W),Z=K.getBucket(c);if(!Z)continue;const ne=Z.programConfigurations.get(c.id),q=d.useProgram(z?"fillExtrusionPattern":"fillExtrusion",ne);if(d.terrain){const he=d.terrain;if(!Z.enableTerrain)continue;if(he.setupElevationDraw(K,q,{useMeterToDem:!0}),Id(S,r,W,Z,c,he),!Z.centroidVertexBuffer){const ke=q.attributes.a_centroid_pos;ke!==void 0&&I.vertexAttrib2f(ke,0,0)}}z&&(d.context.activeTexture.set(I.TEXTURE0),K.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ne.updatePaintBuffers(R));const re=P.constantOr(null);if(re&&K.imageAtlas){const he=K.imageAtlas,ke=he.patternPositions[re.to.toString()],Ce=he.patternPositions[re.from.toString()];ke&&Ce&&ne.setConstantPatternPositions(ke,Ce)}const se=d.translatePosMatrix(W.projMatrix,K,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),H=c.paint.get("fill-extrusion-vertical-gradient"),le=z?xd(se,d,H,U,W,R,K):du(se,d,H,U);d.prepareDrawProgram(S,q,W.toUnwrapped()),q.draw(S,S.gl.TRIANGLES,_,y,w,a.CullFaceMode.backCCW,le,c.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,c.paint,d.transform.zoom,ne,d.terrain?Z.centroidVertexBuffer:null)}}function Id(d,r,c,f,_,y){const w=[q=>{let re=q.canonical.x-1,se=q.wrap;return re<0&&(re=(1<<q.canonical.z)-1,se--),new a.OverscaledTileID(q.overscaledZ,se,q.canonical.z,re,q.canonical.y)},q=>{let re=q.canonical.x+1,se=q.wrap;return re===1<<q.canonical.z&&(re=0,se++),new a.OverscaledTileID(q.overscaledZ,se,q.canonical.z,re,q.canonical.y)},q=>new a.OverscaledTileID(q.overscaledZ,q.wrap,q.canonical.z,q.canonical.x,(q.canonical.y===0?1<<q.canonical.z:q.canonical.y)-1),q=>new a.OverscaledTileID(q.overscaledZ,q.wrap,q.canonical.z,q.canonical.x,q.canonical.y===(1<<q.canonical.z)-1?0:q.canonical.y+1)],S=q=>{const re=r.getSource().maxzoom,se=ke=>{const Ce=r.getTileByID(ke);if(Ce&&Ce.hasData())return Ce.getBucket(_)};let H,le,he;return(q.overscaledZ===q.canonical.z||q.overscaledZ>=re)&&(H=se(q.key)),q.overscaledZ>=re&&(le=se(q.calculateScaledKey(q.overscaledZ+1))),q.overscaledZ>re&&(he=se(q.calculateScaledKey(q.overscaledZ-1))),H||le||he},I=[0,0,0],P=(q,re)=>(I[0]=Math.min(q.min.y,re.min.y),I[1]=Math.max(q.max.y,re.max.y),I[2]=a.EXTENT-re.min.x>q.max.x?re.min.x-a.EXTENT:q.max.x,I),z=(q,re)=>(I[0]=Math.min(q.min.x,re.min.x),I[1]=Math.max(q.max.x,re.max.x),I[2]=a.EXTENT-re.min.y>q.max.y?re.min.y-a.EXTENT:q.max.y,I),R=[(q,re)=>P(q,re),(q,re)=>P(re,q),(q,re)=>z(q,re),(q,re)=>z(re,q)],U=new a.pointGeometry(0,0);let W,K,Z;const ne=(q,re,se,H,le)=>{const he=[[H?se:q,H?q:se,0],[H?se:re,H?re:se,0]],ke=le<0?a.EXTENT+le:le,Ce=[H?ke:(q+re)/2,H?(q+re)/2:ke,0];return se===0&&le<0||se!==0&&le>0?y.getForTilePoints(Z,[Ce],!0,K):he.push(Ce),y.getForTilePoints(c,he,!0,W),Math.max(he[0][2],he[1][2],Ce[2])/y.exaggeration()};for(let q=0;q<4;q++){const re=f.borders[q];if(re.length===0&&(f.borderDone[q]=!0),f.borderDone[q])continue;const se=Z=w[q](c),H=S(se);if(!H||!H.enableTerrain||(K=y.findDEMTileFor(se),!K||!K.dem))continue;if(!W){const Ce=y.findDEMTileFor(c);if(!Ce||!Ce.dem)return;W=Ce}const le=(q<2?1:5)-q,he=H.borders[le];let ke=0;for(let Ce=0;Ce<re.length;Ce++){const ze=f.featuresOnBorder[re[Ce]],De=ze.borders[q];let Ge;for(;ke<he.length&&(Ge=H.featuresOnBorder[he[ke]],!(Ge.borders[le][1]>De[0]+3));)H.borderDone[le]||H.encodeCentroid(void 0,Ge,!1),ke++;if(Ge&&ke<he.length){const Me=ke;let qe=0;for(;!(Ge.borders[le][0]>De[1]-3)&&(qe++,++ke!==he.length);)Ge=H.featuresOnBorder[he[ke]];if(Ge=H.featuresOnBorder[he[Me]],ze.intersectsCount()>1||Ge.intersectsCount()>1||qe!==1){qe!==1&&(ke=Me),f.encodeCentroid(void 0,ze,!1),H.borderDone[le]||H.encodeCentroid(void 0,Ge,!1);continue}const Se=R[q](ze,Ge),He=q%2?a.EXTENT-1:0;U.x=ne(Se[0],Math.min(a.EXTENT-1,Se[1]),He,q<2,Se[2]),U.y=0,f.encodeCentroid(U,ze,!1),H.borderDone[le]||H.encodeCentroid(U,Ge,!1)}else f.encodeCentroid(void 0,ze,!1)}f.borderDone[q]=f.needsCentroidUpdate=!0,H.borderDone[le]||(H.borderDone[le]=H.needsCentroidUpdate=!0)}(f.needsCentroidUpdate||!f.centroidVertexBuffer&&f.centroidVertexArray.length!==0)&&f.uploadCentroid(d)}const vu=new a.Color(1,0,0,1),Kt=new a.Color(0,1,0,1),Rl=new a.Color(0,0,1,1),Am=new a.Color(1,0,1,1),Ad=new a.Color(0,1,1,1);function bs(d,r,c,f){Ll(d,0,r+c/2,d.transform.width,c,f)}function Md(d,r,c,f){Ll(d,r-c/2,0,c,d.transform.height,f)}function Ll(d,r,c,f,_,y){const w=d.context,S=w.gl;S.enable(S.SCISSOR_TEST),S.scissor(r*a.exported.devicePixelRatio,c*a.exported.devicePixelRatio,f*a.exported.devicePixelRatio,_*a.exported.devicePixelRatio),w.clear({color:y}),S.disable(S.SCISSOR_TEST)}function Pd(d,r,c){const f=d.context,_=f.gl,y=c.projMatrix,w=d.useProgram("debug"),S=r.getTileByID(c.key);d.terrain&&d.terrain.setupElevationDraw(S,w);const I=a.DepthMode.disabled,P=a.StencilMode.disabled,z=d.colorModeForRenderPass(),R="$debug";f.activeTexture.set(_.TEXTURE0),d.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),S._makeDebugTileBoundsBuffers(d.context,d.transform.projection);const U=S._tileDebugBuffer||d.debugBuffer,W=S._tileDebugIndexBuffer||d.debugIndexBuffer,K=S._tileDebugSegments||d.debugSegments;w.draw(f,_.LINE_STRIP,I,P,z,a.CullFaceMode.disabled,ba(y,a.Color.red),R,U,W,K);const Z=S.latestRawTileData,ne=Math.floor((Z&&Z.byteLength||0)/1024),q=r.getTile(c).tileSize,re=512/Math.min(q,512)*(c.overscaledZ/d.transform.zoom)*.5;let se=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(se+=` => ${c.overscaledZ}`),function(H,le){H.initDebugOverlayCanvas();const he=H.debugOverlayCanvas,ke=H.context.gl,Ce=H.debugOverlayCanvas.getContext("2d");Ce.clearRect(0,0,he.width,he.height),Ce.shadowColor="white",Ce.shadowBlur=2,Ce.lineWidth=1.5,Ce.strokeStyle="white",Ce.textBaseline="top",Ce.font="bold 36px Open Sans, sans-serif",Ce.fillText(le,5,5),Ce.strokeText(le,5,5),H.debugOverlayTexture.update(he),H.debugOverlayTexture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE)}(d,`${se} ${ne}kb`),w.draw(f,_.TRIANGLES,I,P,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,ba(y,a.Color.transparent,re),R,d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments)}const Mm=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:xu}=Mm;function gi(d,r,c,f){d.emplaceBack(r,c,f)}class ws{constructor(r){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,gi(this.vertexArray,-1,-1,1),gi(this.vertexArray,1,-1,1),gi(this.vertexArray,-1,1,1),gi(this.vertexArray,1,1,1),gi(this.vertexArray,-1,-1,-1),gi(this.vertexArray,1,-1,-1),gi(this.vertexArray,-1,1,-1),gi(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,xu),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function ho(d,r,c,f,_,y){const w=d.gl,S=r.paint.get("sky-atmosphere-color"),I=r.paint.get("sky-atmosphere-halo-color"),P=r.paint.get("sky-atmosphere-sun-intensity"),z=((R,U,W,K,Z)=>({u_matrix_3f:R,u_sun_direction:U,u_sun_intensity:W,u_color_tint_r:[K.r,K.g,K.b,K.a],u_color_tint_m:[Z.r,Z.g,Z.b,Z.a],u_luminance:5e-5}))(a.fromMat4([],f),_,P,S,I);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+y,r.skyboxTexture,0),c.draw(d,w.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,z,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Ol={symbol:function(d,r,c,f,_){if(d.renderPass!=="translucent")return;const y=a.StencilMode.disabled,w=d.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(S,I,P,z,R,U,W){const K=I.transform,Z=R==="map",ne=U==="map";for(const q of S){const re=z.getTile(q),se=re.getBucket(P);if(!se||!se.text||!se.text.segments.get().length)continue;const H=a.evaluateSizeForZoom(se.textSizeData,K.zoom),le=I.transform.calculatePixelsToTileUnitsMatrix(re),he=Lt(q.projMatrix,ne,Z,I.transform,le),ke=P.layout.get("icon-text-fit")!=="none"&&se.hasIconData();if(H){const Ce=Math.pow(2,K.zoom-re.tileID.overscaledZ),ze=K.elevation;kd(se,Z,ne,W,a.symbolSize,K,he,q.projMatrix,Ce,H,ke,ze?De=>ze.getAtTileOffset(q,De.x,De.y):De=>0)}}}(f,d,c,r,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),_),c.paint.get("icon-opacity").constantOr(1)!==0&&co(d,r,c,f,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),y,w),c.paint.get("text-opacity").constantOr(1)!==0&&co(d,r,c,f,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),y,w),r.map.showCollisionBoxes&&(Dl(d,r,c,f,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Dl(d,r,c,f,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(d,r,c,f){if(d.renderPass!=="translucent")return;const _=c.paint.get("circle-opacity"),y=c.paint.get("circle-stroke-width"),w=c.paint.get("circle-stroke-opacity"),S=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)===0&&(y.constantOr(1)===0||w.constantOr(1)===0))return;const I=d.context,P=I.gl,z=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),R=a.StencilMode.disabled,U=d.colorModeForRenderPass(),W=[];for(let K=0;K<f.length;K++){const Z=f[K],ne=r.getTile(Z),q=ne.getBucket(c);if(!q)continue;const re=q.programConfigurations.get(c.id),se=pu(c),H={programConfiguration:re,program:d.useProgram("circle",re,se),layoutVertexBuffer:q.layoutVertexBuffer,indexBuffer:q.indexBuffer,uniformValues:jr(d,Z,ne,c),tile:ne};if(S){const le=q.segments.get();for(const he of le)W.push({segments:new a.SegmentVector([he]),sortKey:he.sortKey,state:H})}else W.push({segments:q.segments,sortKey:0,state:H})}S&&W.sort((K,Z)=>K.sortKey-Z.sortKey);for(const K of W){const{programConfiguration:Z,program:ne,layoutVertexBuffer:q,indexBuffer:re,uniformValues:se,tile:H}=K.state,le=K.segments;d.terrain&&d.terrain.setupElevationDraw(H,ne,{useDepthForOcclusion:!0}),d.prepareDrawProgram(I,ne,H.tileID.toUnwrapped()),ne.draw(I,P.TRIANGLES,z,R,U,a.CullFaceMode.disabled,se,c.id,q,re,le,c.paint,d.transform.zoom,Z)}},heatmap:function(d,r,c,f){if(c.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const _=d.context,y=_.gl,w=a.StencilMode.disabled,S=new a.ColorMode([y.ONE,y.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(I,P,z){const R=I.gl;I.activeTexture.set(R.TEXTURE1),I.viewport.set([0,0,P.width/4,P.height/4]);let U=z.heatmapFbo;if(U)R.bindTexture(R.TEXTURE_2D,U.colorAttachment.get()),I.bindFramebuffer.set(U.framebuffer);else{const W=R.createTexture();R.bindTexture(R.TEXTURE_2D,W),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_S,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_T,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MAG_FILTER,R.LINEAR),U=z.heatmapFbo=I.createFramebuffer(P.width/4,P.height/4,!1),function(K,Z,ne,q){const re=K.gl;re.texImage2D(re.TEXTURE_2D,0,re.RGBA,Z.width/4,Z.height/4,0,re.RGBA,K.extRenderToTextureHalfFloat?K.extTextureHalfFloat.HALF_FLOAT_OES:re.UNSIGNED_BYTE,null),q.colorAttachment.set(ne)}(I,P,W,U)}})(_,d,c),_.clear({color:a.Color.transparent});for(let I=0;I<f.length;I++){const P=f[I];if(r.hasRenderableParent(P))continue;const z=r.getTile(P),R=z.getBucket(c);if(!R)continue;const U=R.programConfigurations.get(c.id),W=d.useProgram("heatmap",U),{zoom:K}=d.transform;d.terrain&&d.terrain.setupElevationDraw(z,W),d.prepareDrawProgram(_,W,P.toUnwrapped()),W.draw(_,y.TRIANGLES,a.DepthMode.disabled,w,S,a.CullFaceMode.disabled,fu(P.projMatrix,z,K,c.paint.get("heatmap-intensity")),c.id,R.layoutVertexBuffer,R.indexBuffer,R.segments,c.paint,d.transform.zoom,U)}_.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(_,y){const w=_.context,S=w.gl,I=y.heatmapFbo;if(!I)return;w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,I.colorAttachment.get()),w.activeTexture.set(S.TEXTURE1);let P=y.colorRampTexture;P||(P=y.colorRampTexture=new a.Texture(w,y.colorRamp,S.RGBA)),P.bind(S.LINEAR,S.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(w,S.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,_.colorModeForRenderPass(),a.CullFaceMode.disabled,((z,R,U,W)=>({u_image:0,u_color_ramp:1,u_opacity:R.paint.get("heatmap-opacity")}))(0,y),y.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,y.paint,_.transform.zoom)}(d,c))},line:function(d,r,c,f){if(d.renderPass!=="translucent")return;const _=c.paint.get("line-opacity"),y=c.paint.get("line-width");if(_.constantOr(1)===0||y.constantOr(1)===0)return;const w=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),S=d.colorModeForRenderPass(),I=c.paint.get("line-dasharray"),P=I.constantOr(1),z=c.layout.get("line-cap"),R=c.paint.get("line-pattern"),U=R.constantOr(1),W=c.paint.get("line-gradient"),K=c.getCrossfadeParameters(),Z=U?"linePattern":"line",ne=d.context,q=ne.gl;for(const re of f){const se=r.getTile(re);if(U&&!se.patternsLoaded())continue;const H=se.getBucket(c);if(!H)continue;d.prepareDrawTile(re);const le=H.programConfigurations.get(c.id),he=zl(c),ke=d.useProgram(Z,le,he),Ce=R.constantOr(null);if(Ce&&se.imageAtlas){const qe=se.imageAtlas,Se=qe.patternPositions[Ce.to.toString()],He=qe.patternPositions[Ce.from.toString()];Se&&He&&le.setConstantPatternPositions(Se,He)}const ze=I.constantOr(null),De=z.constantOr(null);if(!U&&ze&&De&&se.lineAtlas){const qe=se.lineAtlas,Se=qe.getDash(ze.to,De),He=qe.getDash(ze.from,De);Se&&He&&le.setConstantPatternPositions(Se,He)}const Ge=d.terrain?re.projMatrix:null,Me=U?Al(d,se,c,K,Ge):mu(d,se,c,K,Ge,H.lineClipsArray.length);if(W){const qe=H.gradients[c.id];let Se=qe.texture;if(c.gradientVersion!==qe.version){let He=256;if(c.stepInterpolant){const lt=r.getSource().maxzoom,yt=re.canonical.z===lt?Math.ceil(1<<d.transform.maxZoom-re.canonical.z):1;He=a.clamp(a.nextPowerOfTwo(H.maxLineLength/a.EXTENT*1024*yt),256,ne.maxTextureSize)}qe.gradient=a.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:He,image:qe.gradient||void 0,clips:H.lineClipsArray}),qe.texture?qe.texture.update(qe.gradient):qe.texture=new a.Texture(ne,qe.gradient,q.RGBA),qe.version=c.gradientVersion,Se=qe.texture}ne.activeTexture.set(q.TEXTURE1),Se.bind(c.stepInterpolant?q.NEAREST:q.LINEAR,q.CLAMP_TO_EDGE)}P&&(ne.activeTexture.set(q.TEXTURE0),se.lineAtlasTexture.bind(q.LINEAR,q.REPEAT),le.updatePaintBuffers(K)),U&&(ne.activeTexture.set(q.TEXTURE0),se.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),le.updatePaintBuffers(K)),d.prepareDrawProgram(ne,ke,re.toUnwrapped()),ke.draw(ne,q.TRIANGLES,w,d.stencilModeForClipping(re),S,a.CullFaceMode.disabled,Me,c.id,H.layoutVertexBuffer,H.indexBuffer,H.segments,c.paint,d.transform.zoom,le,H.layoutVertexBuffer2)}},fill:function(d,r,c,f){const _=c.paint.get("fill-color"),y=c.paint.get("fill-opacity");if(y.constantOr(1)===0)return;const w=d.colorModeForRenderPass(),S=c.paint.get("fill-pattern"),I=d.opaquePassEnabledForLayer()&&!S.constantOr(1)&&_.constantOr(a.Color.transparent).a===1&&y.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===I){const P=d.depthModeForSublayer(1,d.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);Vo(d,r,c,f,P,w,!1)}if(d.renderPass==="translucent"&&c.paint.get("fill-antialias")){const P=d.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);Vo(d,r,c,f,P,w,!0)}},"fill-extrusion":function(d,r,c,f){const _=c.paint.get("fill-extrusion-opacity");if(_!==0&&d.renderPass==="translucent"){const y=new a.DepthMode(d.context.gl.LEQUAL,a.DepthMode.ReadWrite,d.depthRangeFor3D);if(_!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))uo(d,r,c,f,y,a.StencilMode.disabled,a.ColorMode.disabled),uo(d,r,c,f,y,d.stencilModeFor3D(),d.colorModeForRenderPass());else{const w=d.colorModeForRenderPass();uo(d,r,c,f,y,a.StencilMode.disabled,w)}}},hillshade:function(d,r,c,f){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const _=d.context,y=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),w=d.colorModeForRenderPass(),S=d.terrain&&d.terrain.renderingToTexture,[I,P]=d.renderPass!=="translucent"||S?[{},f]:d.stencilConfigForOverlap(f);for(const z of P){const R=r.getTile(z);if(R.needsHillshadePrepare&&d.renderPass==="offscreen")_a(d,R,c,y,a.StencilMode.disabled,w);else if(d.renderPass==="translucent"){const U=S&&d.terrain?d.terrain.stencilModeForRTTOverlap(z):I[z.overscaledZ];lu(d,z,R,c,y,U,w)}}_.viewport.set([0,0,d.width,d.height])},raster:function(d,r,c,f,_,y){if(d.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!f.length)return;const w=d.context,S=w.gl,I=r.getSource(),P=d.useProgram("raster"),z=d.colorModeForRenderPass(),R=d.terrain&&d.terrain.renderingToTexture,[U,W]=I instanceof Q||R?[{},f]:d.stencilConfigForOverlap(f),K=W[W.length-1].overscaledZ,Z=!d.options.moving;for(const ne of W){const q=R?a.DepthMode.disabled:d.depthModeForSublayer(ne.overscaledZ-K,c.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,S.LESS),re=ne.toUnwrapped(),se=r.getTile(ne);if(R&&(!se||!se.hasData()))continue;const H=R?ne.projMatrix:d.transform.calculateProjMatrix(re,Z),le=d.terrain&&R?d.terrain.stencilModeForRTTOverlap(ne):U[ne.overscaledZ],he=y?0:c.paint.get("raster-fade-duration");se.registerFadeDuration(he);const ke=r.findLoadedParent(ne,0),Ce=uu(se,ke,r,d.transform,he);let ze,De;d.terrain&&d.terrain.prepareDrawTile(ne);const Ge=c.paint.get("raster-resampling")==="nearest"?S.NEAREST:S.LINEAR;w.activeTexture.set(S.TEXTURE0),se.texture.bind(Ge,S.CLAMP_TO_EDGE),w.activeTexture.set(S.TEXTURE1),ke?(ke.texture.bind(Ge,S.CLAMP_TO_EDGE),ze=Math.pow(2,ke.tileID.overscaledZ-se.tileID.overscaledZ),De=[se.tileID.canonical.x*ze%1,se.tileID.canonical.y*ze%1]):se.texture.bind(Ge,S.CLAMP_TO_EDGE);const Me=Ed(H,De||[0,0],ze||1,Ce,c);if(d.prepareDrawProgram(w,P,re),I instanceof Q)P.draw(w,S.TRIANGLES,q,a.StencilMode.disabled,z,a.CullFaceMode.disabled,Me,c.id,I.boundsBuffer,d.quadTriangleIndexBuffer,I.boundsSegments);else{const{tileBoundsBuffer:qe,tileBoundsIndexBuffer:Se,tileBoundsSegments:He}=d.getTileBoundsBuffers(se);P.draw(w,S.TRIANGLES,q,le,z,a.CullFaceMode.disabled,Me,c.id,qe,Se,He)}}},background:function(d,r,c,f){const _=c.paint.get("background-color"),y=c.paint.get("background-opacity");if(y===0)return;const w=d.context,S=w.gl,I=d.transform,P=I.tileSize,z=c.paint.get("background-pattern");if(d.isPatternMissing(z))return;const R=!z&&_.a===1&&y===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==R)return;const U=a.StencilMode.disabled,W=d.depthModeForSublayer(0,R==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),K=d.colorModeForRenderPass(),Z=d.useProgram(z?"backgroundPattern":"background");let ne,q=f;q||(ne=d.getBackgroundTiles(),q=Object.values(ne).map(se=>se.tileID)),z&&(w.activeTexture.set(S.TEXTURE0),d.imageManager.bind(d.context));const re=c.getCrossfadeParameters();for(const se of q){const H=se.toUnwrapped(),le=f?se.projMatrix:d.transform.calculateProjMatrix(H);d.prepareDrawTile(se);const he=r?r.getTile(se):ne?ne[se.key]:new a.Tile(se,P,I.zoom,d),ke=z?km(le,y,d,z,{tileID:se,tileSize:P},re):Cm(le,y,_);d.prepareDrawProgram(w,Z,H);const{tileBoundsBuffer:Ce,tileBoundsIndexBuffer:ze,tileBoundsSegments:De}=d.getTileBoundsBuffers(he);Z.draw(w,S.TRIANGLES,W,U,K,a.CullFaceMode.disabled,ke,c.id,Ce,ze,De)}},sky:function(d,r,c){const f=d.transform,_=f.projection.name==="mercator"?1:a.smoothstep(7,8,f.zoom),y=c.paint.get("sky-opacity")*_;if(y===0)return;const w=d.context,S=c.paint.get("sky-type"),I=new a.DepthMode(w.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),P=d.frameCounter/1e3%1;S==="atmosphere"?d.renderPass==="offscreen"?c.needsSkyboxCapture(d)&&(function(z,R,U,W){const K=z.context,Z=K.gl;let ne=R.skyboxFbo;if(!ne){ne=R.skyboxFbo=K.createFramebuffer(32,32,!1),R.skyboxGeometry=new ws(K),R.skyboxTexture=K.gl.createTexture(),Z.bindTexture(Z.TEXTURE_CUBE_MAP,R.skyboxTexture),Z.texParameteri(Z.TEXTURE_CUBE_MAP,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_CUBE_MAP,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_CUBE_MAP,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_CUBE_MAP,Z.TEXTURE_MAG_FILTER,Z.LINEAR);for(let H=0;H<6;++H)Z.texImage2D(Z.TEXTURE_CUBE_MAP_POSITIVE_X+H,0,Z.RGBA,32,32,0,Z.RGBA,Z.UNSIGNED_BYTE,null)}K.bindFramebuffer.set(ne.framebuffer),K.viewport.set([0,0,32,32]);const q=R.getCenter(z,!0),re=z.useProgram("skyboxCapture"),se=new Float64Array(16);a.identity(se),a.rotateY(se,se,.5*-Math.PI),ho(K,R,re,se,q,0),a.identity(se),a.rotateY(se,se,.5*Math.PI),ho(K,R,re,se,q,1),a.identity(se),a.rotateX(se,se,.5*-Math.PI),ho(K,R,re,se,q,2),a.identity(se),a.rotateX(se,se,.5*Math.PI),ho(K,R,re,se,q,3),a.identity(se),ho(K,R,re,se,q,4),a.identity(se),a.rotateY(se,se,Math.PI),ho(K,R,re,se,q,5),K.viewport.set([0,0,z.width,z.height])}(d,c),c.markSkyboxValid(d)):d.renderPass==="sky"&&function(z,R,U,W,K){const Z=z.context,ne=Z.gl,q=z.transform,re=z.useProgram("skybox");Z.activeTexture.set(ne.TEXTURE0),ne.bindTexture(ne.TEXTURE_CUBE_MAP,R.skyboxTexture);const se=((H,le,he,ke,Ce)=>({u_matrix:H,u_sun_direction:le,u_cubemap:0,u_opacity:ke,u_temporal_offset:Ce}))(q.skyboxMatrix,R.getCenter(z,!1),0,W,K);z.prepareDrawProgram(Z,re),re.draw(Z,ne.TRIANGLES,U,a.StencilMode.disabled,z.colorModeForRenderPass(),a.CullFaceMode.backCW,se,"skybox",R.skyboxGeometry.vertexBuffer,R.skyboxGeometry.indexBuffer,R.skyboxGeometry.segment)}(d,c,I,y,P):S==="gradient"&&d.renderPass==="sky"&&function(z,R,U,W,K){const Z=z.context,ne=Z.gl,q=z.transform,re=z.useProgram("skyboxGradient");R.skyboxGeometry||(R.skyboxGeometry=new ws(Z)),Z.activeTexture.set(ne.TEXTURE0);let se=R.colorRampTexture;se||(se=R.colorRampTexture=new a.Texture(Z,R.colorRamp,ne.RGBA)),se.bind(ne.LINEAR,ne.CLAMP_TO_EDGE);const H=((le,he,ke,Ce,ze)=>({u_matrix:le,u_color_ramp:0,u_center_direction:he,u_radius:a.degToRad(ke),u_opacity:Ce,u_temporal_offset:ze}))(q.skyboxMatrix,R.getCenter(z,!1),R.paint.get("sky-gradient-radius"),W,K);z.prepareDrawProgram(Z,re),re.draw(Z,ne.TRIANGLES,U,a.StencilMode.disabled,z.colorModeForRenderPass(),a.CullFaceMode.backCW,H,"skyboxGradient",R.skyboxGeometry.vertexBuffer,R.skyboxGeometry.indexBuffer,R.skyboxGeometry.segment)}(d,c,I,y,P)},debug:function(d,r,c){for(let f=0;f<c.length;f++)Pd(d,r,c[f])},custom:function(d,r,c){const f=d.context,_=c.implementation;if(d.transform.projection.name==="mercator"){if(d.renderPass==="offscreen"){const y=_.prerender;y&&(d.setCustomLayerDefaults(),f.setColorMode(d.colorModeForRenderPass()),y.call(_,f.gl,d.transform.customLayerMatrix()),f.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),f.setColorMode(d.colorModeForRenderPass()),f.setStencilMode(a.StencilMode.disabled);const y=_.renderingMode==="3d"?new a.DepthMode(d.context.gl.LEQUAL,a.DepthMode.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,a.DepthMode.ReadOnly);f.setDepthMode(y),_.render(f.gl,d.transform.customLayerMatrix()),f.setDirty(),d.setBaseState(),f.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.")}};class zd{constructor(r,c){this.context=new pa(r),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new vl,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,c){const f=!!r&&!!r.terrain&&this.transform.projection.name==="mercator";if(!(f||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new hu(this,r));const _=this._terrain;this.transform.elevation=f?_:null,_.update(r,this.transform,c)}_updateFog(r){const c=r.fog;if(!c||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[f,_]=c.getFovAdjustedRange(this.transform._fov);if(f>_)return void(this.transform.fogCullDistSq=null);const y=f+.78*(_-f);this.transform.fogCullDistSq=y*y}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,c){if(this.width=r*a.exported.devicePixelRatio,this.height=c*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style.order)this.style._layers[f].resize()}setup(){const r=this.context,c=new a.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(a.EXTENT,0),c.emplaceBack(0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(c,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const f=new a.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(a.EXTENT,0),f.emplaceBack(0,a.EXTENT),f.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=r.createVertexBuffer(f,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const _=new a.StructArrayLayout2i4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(_,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const y=new a.StructArrayLayout4i8;y.emplaceBack(0,0,0,0),y.emplaceBack(a.EXTENT,0,a.EXTENT,0),y.emplaceBack(0,a.EXTENT,0,a.EXTENT),y.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(y,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const w=new a.StructArrayLayout3ui6;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(w);const S=new a.StructArrayLayout1ui2;for(const P of[0,1,3,2,0])S.emplaceBack(P);this.debugIndexBuffer=r.createIndexBuffer(S),this.emptyTexture=new a.Texture(r,{width:1,height:1,data:new Uint8Array([0,0,0,0])},r.gl.RGBA),this.identityMat=a.create$1();const I=this.context.gl;this.stencilClearMode=new a.StencilMode({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.loadTimeStamps.push(a.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,c=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(r,c.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,va(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,c,f){if(!(c&&this.currentStencilSource!==c.id&&r.isTileClipped()&&f&&f.length))return;this.currentStencilSource=c.id;const _=this.context,y=_.gl;this.nextStencilID+f.length>256&&this.clearStencil(),_.setColorMode(a.ColorMode.disabled),_.setDepthMode(a.DepthMode.disabled);const w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of f){const I=c.getTile(S),P=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,{tileBoundsBuffer:z,tileBoundsIndexBuffer:R,tileBoundsSegments:U}=this.getTileBoundsBuffers(I);w.draw(_,y.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:y.ALWAYS,mask:0},P,255,y.KEEP,y.KEEP,y.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,va(S.projMatrix),"$clipping",z,R,U)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,c=this.context.gl;return new a.StencilMode({func:c.NOTEQUAL,mask:255},r,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const c=this.context.gl;return new a.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(r){const c=this.context.gl,f=r.sort((w,S)=>S.overscaledZ-w.overscaledZ),_=f[f.length-1].overscaledZ,y=f[0].overscaledZ-_+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const w={};for(let S=0;S<y;S++)w[S+_]=new a.StencilMode({func:c.GEQUAL,mask:255},S+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=y,[w,f]}return[{[_]:a.StencilMode.disabled},f]}colorModeForRenderPass(){const r=this.context.gl;if(this._showOverdrawInspector){const c=1/8;return new a.ColorMode([r.CONSTANT_COLOR,r.ONE],new a.Color(c,c,c,0),[!0,!0,!0,!0])}return this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(r,c,f){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new a.DepthMode(f||this.context.gl.LEQUAL,c,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,c){this.style=r,this.options=c,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const f=this.style.order,_=this.style._sourceCaches;for(const P in _){const z=_[P];z.used&&z.prepare(this.context)}const y={},w={},S={};for(const P in _){const z=_[P];y[P]=z.getVisibleCoordinates(),w[P]=y[P].slice().reverse(),S[P]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let P=0;P<f.length;P++)if(this.style._layers[f[P]].is3D()){this.opaquePassCutoff=P;break}if(this.terrain&&(this.terrain.updateTileBinding(S),this.opaquePassCutoff=0),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const P of f){const z=this.style._layers[P],R=r._getLayerSourceCache(z);if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const U=R?w[R.id]:void 0;(z.type==="custom"||z.isSky()||U&&U.length)&&this.renderLayer(this,R,z,U)}this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let I=a.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(I=this.style.fog.properties.get("color")),this.context.clear({color:c.showOverdrawInspector?a.Color.black:I,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const P=this.style._layers[f[this.currentLayer]],z=r._getLayerSourceCache(P);if(P.isSky())continue;const R=z?w[z.id]:void 0;this._renderTileClippingMasks(P,z,R),this.renderLayer(this,z,P,R)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const P=this.style._layers[f[this.currentLayer]],z=r._getLayerSourceCache(P);P.isSky()&&this.renderLayer(this,z,P,z?w[z.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;){const P=this.style._layers[f[this.currentLayer]],z=r._getLayerSourceCache(P);if(P.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(P)){if(P.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const R=z?(P.type==="symbol"?S:w)[z.id]:void 0;this._renderTileClippingMasks(P,z,z?y[z.id]:void 0),this.renderLayer(this,z,P,R),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let P=null;a.values(this.style._layers).forEach(z=>{const R=r._getLayerSourceCache(z);R&&!z.isHidden(this.transform.zoom)&&(!P||P.getSource().maxzoom<R.getSource().maxzoom)&&(P=R)}),P&&this.options.showTileBoundaries&&Ol.debug(this,P,P.getVisibleCoordinates())}this.options.showPadding&&function(P){const z=P.transform.padding;bs(P,P.transform.height-(z.top||0),3,vu),bs(P,z.bottom||0,3,Kt),Md(P,z.left||0,3,Rl),Md(P,P.transform.width-(z.right||0),3,Am);const R=P.transform.centerPoint;(function(U,W,K,Z){Ll(U,W-1,K-10,2,20,Z),Ll(U,W-10,K-1,20,2,Z)})(P,R.x,P.transform.height-R.y,Ad)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%a.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(r,c,f,_){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="sky"||f.type==="custom"||_&&_.length)&&(this.id=f.id,this.gpuTimingStart(f),Ol[f.type](r,c,f,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let f=this.gpuTimers[r.id];f||(f=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),f.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,f.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}queryGpuTimers(r){const c={};for(const f in r){const _=r[f],y=this.context.extTimerQuery,w=y.getQueryObjectEXT(_.query,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(_.query),c[f]=w}return c}translatePosMatrix(r,c,f,_,y){if(!f[0]&&!f[1])return r;const w=y?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(w){const P=Math.sin(w),z=Math.cos(w);f=[f[0]*z-f[1]*P,f[0]*P+f[1]*z]}const S=[y?f[0]:Ze(c,f[0],this.transform.zoom),y?f[1]:Ze(c,f[1],this.transform.zoom),0],I=new Float32Array(16);return a.translate(I,r,S),I}saveTileTexture(r){const c=this._tileTextures[r.size[0]];c?c.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const c=this._tileTextures[r];return c&&c.length>0?c.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const c=this.imageManager.getPattern(r.from.toString()),f=this.imageManager.getPattern(r.to.toString());return!c||!f}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,c=this.style&&this.style.fog,f=[];return this.terrain&&!this.terrain.renderingToTexture&&f.push("TERRAIN"),c&&!r&&c.getOpacity(this.transform.pitch)!==0&&f.push("FOG"),r&&f.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&f.push("OVERDRAW_INSPECTOR"),f}useProgram(r,c,f){this.cache=this.cache||{};const _=f||[],y=this.currentGlobalDefines().concat(_),w=Cl.cacheKey(r,y,c);return this.cache[w]||(this.cache[w]=new Cl(this.context,r,bl[r],c,Im[r],y)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(r){this.terrain&&this.terrain.prepareDrawTile(r)}prepareDrawProgram(r,c,f){if(this.terrain&&this.terrain.renderingToTexture)return;const _=this.style.fog;if(_){const y=_.getOpacity(this.transform.pitch);y!==0&&c.setFogUniformValues(r,((w,S,I,P)=>{const z=S.properties.get("color"),R=w.frameCounter/1e3%1,U=[z.r/z.a,z.g/z.a,z.b/z.a,P];return{u_fog_matrix:I?w.transform.calculateFogTileMatrix(I):w.identityMat,u_fog_range:S.getFovAdjustedRange(w.transform._fov),u_fog_color:U,u_fog_horizon_blend:S.properties.get("horizon-blend"),u_fog_temporal_offset:R}})(this,_,f,y))}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const r=this.context.gl,c=r.createTexture();return r.bindTexture(r.TEXTURE_2D,c),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,c=this._backgroundTiles={},f=this.transform.coveringTiles({tileSize:512});for(const _ of f)c[_.key]=r[_.key]||new a.Tile(_,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class Es{constructor(r=0,c=0,f=0,_=0){if(isNaN(r)||r<0||isNaN(c)||c<0||isNaN(f)||f<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=c,this.left=f,this.right=_}interpolate(r,c,f){return c.top!=null&&r.top!=null&&(this.top=a.number(r.top,c.top,f)),c.bottom!=null&&r.bottom!=null&&(this.bottom=a.number(r.bottom,c.bottom,f)),c.left!=null&&r.left!=null&&(this.left=a.number(r.left,c.left,f)),c.right!=null&&r.right!=null&&(this.right=a.number(r.right,c.right,f)),this}getCenter(r,c){const f=a.clamp((this.left+r-this.right)/2,0,r),_=a.clamp((this.top+c-this.bottom)/2,0,c);return new a.pointGeometry(f,_)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Es(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function po(d,r){return[d[4*r],d[4*r+1],d[4*r+2],d[4*r+3]]}function ri(d,r,c){d[4*r+0]=c[0],d[4*r+1]=c[1],d[4*r+2]=c[2],d[4*r+3]=c[3]}function Bl(d,r){const c=po(d,3);a.fromQuat(d,r),ri(d,3,c)}function bu(d,r){ri(d,3,[r[0],r[1],r[2],1])}function Fl(d,r){const c=a.identity$1([]);return a.rotateZ$1(c,c,-r),a.rotateX$1(c,c,-d),c}function fo(d,r){const c=[d[0],d[1],0],f=[r[0],r[1],0];if(a.length(c)>=1e-15){const w=a.normalize([],c);a.scale(f,w,a.dot(f,w)),r[0]=f[0],r[1]=f[1]}const _=a.cross([],r,d);if(a.len(_)<1e-15)return null;const y=Math.atan2(-_[1],_[0]);return Fl(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),y)}class wu{constructor(r,c){this.position=r,this.orientation=c}get position(){return this._position}set position(r){this._position=this._renderWorldCopies?function(c){if(!c)return;const f=Array.isArray(c)?new a.MercatorCoordinate(c[0],c[1],c[2]):c;return f.x=a.wrap(f.x,0,1),f}(r):r}lookAtPoint(r,c){if(this.orientation=null,!this.position)return;const f=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(r)):0,_=this.position,y=a.MercatorCoordinate.fromLngLat(r,f),w=[y.x-_.x,y.y-_.y,y.z-_.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=fo(w,c)}setPitchBearing(r,c){this.orientation=Fl(a.degToRad(r),a.degToRad(-c))}}class Ts{constructor(r,c){this._transform=a.identity([]),this._orientation=a.identity$1([]),c&&(this._orientation=c,Bl(this._transform,this._orientation)),r&&bu(this._transform,r)}get mercatorPosition(){const r=this.position;return new a.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=po(this._transform,3);return[r[0],r[1],r[2]]}set position(r){bu(this._transform,r)}get orientation(){return this._orientation}set orientation(r){this._orientation=r,Bl(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,c){this._orientation=Fl(r,c),Bl(this._transform,this._orientation)}forward(){const r=po(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=po(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=po(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,c){const f=new Float64Array(16);return a.invert(f,this.getWorldToCamera(r,c)),f}getWorldToCameraPosition(r,c,f){const _=this.position;a.scale(_,_,-r);const y=new Float64Array(16);return a.fromScaling(y,[f,f,f]),a.translate(y,y,_),y[10]*=c,y}getWorldToCamera(r,c){const f=new Float64Array(16),_=new Float64Array(4),y=this.position;return a.conjugate(_,this._orientation),a.scale(y,y,-r),a.fromQuat(f,_),a.translate(f,f,y),f[1]*=-1,f[5]*=-1,f[9]*=-1,f[13]*=-1,f[8]*=c,f[9]*=c,f[10]*=c,f[11]*=c,f}getCameraToClipPerspective(r,c,f,_){const y=new Float64Array(16);return a.perspective(y,r,c,f,_),y}getDistanceToElevation(r){const c=r===0?0:a.mercatorZfromAltitude(r,this.position[1]),f=this.forward();return(c-this.position[2])/f[2]}clone(){return new Ts([...this.position],[...this.orientation])}}function $l(d,r){const c=Eu(d),f=function(y,w,S,I,P){const z=new a.LngLat(S.lng-180*Go,S.lat),R=new a.LngLat(S.lng+180*Go,S.lat),U=y.project(z.lng,z.lat),W=y.project(R.lng,R.lat),K=-Math.atan2(W.y-U.y,W.x-U.x),Z=a.MercatorCoordinate.fromLngLat(S);Z.y=a.clamp(Z.y,-.999975,.999975);const ne=Z.toLngLat(),q=y.project(ne.lng,ne.lat),re=a.MercatorCoordinate.fromLngLat(ne);re.x+=Go;const se=re.toLngLat(),H=y.project(se.lng,se.lat),le=Dd(H.x-q.x,H.y-q.y,K),he=a.MercatorCoordinate.fromLngLat(ne);he.y+=Go;const ke=he.toLngLat(),Ce=y.project(ke.lng,ke.lat),ze=Dd(Ce.x-q.x,Ce.y-q.y,K),De=Math.abs(le.x)/Math.abs(ze.y),Ge=a.identity([]);a.rotateZ(Ge,Ge,-K*(1-(P?0:I)));const Me=a.identity([]);return a.scale$1(Me,Me,[1,1-(1-De)*I,1]),Me[4]=-ze.x/ze.y*I,a.rotateZ(Me,Me,K),a.multiply(Me,Ge,Me),Me}(d.projection,0,d.center,c,r),_=wa(d);return a.scale$1(f,f,[_,_,1]),f}function wa(d){const r=d.projection,c=Eu(d),f=Zo(r,d.center),_=Zo(r,a.LngLat.convert(r.center));return Math.pow(2,f*c+(1-c)*_)}function Eu(d){const r=d.projection.range;if(!r)return 0;const c=Math.max(d.width,d.height),f=Math.log(c/1024)/Math.LN2;return a.smoothstep(r[0]+f,r[1]+f,d.zoom)}const Go=1/4e4;function Zo(d,r){const c=a.clamp(r.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),f=new a.LngLat(r.lng-180*Go,c),_=new a.LngLat(r.lng+180*Go,c),y=d.project(f.lng,c),w=d.project(_.lng,c),S=a.MercatorCoordinate.fromLngLat(f),I=a.MercatorCoordinate.fromLngLat(_),P=w.x-y.x,z=w.y-y.y,R=I.x-S.x,U=I.y-S.y,W=Math.sqrt((R*R+U*U)/(P*P+z*z));return Math.log(W)/Math.LN2}function Dd(d,r,c){const f=Math.cos(c),_=Math.sin(c);return{x:d*f-r*_,y:d*_+r*f}}class Tu{constructor(r,c,f,_,y){this.tileSize=512,this._renderWorldCopies=y===void 0||y,this._minZoom=r||0,this._maxZoom=c||22,this._minPitch=f==null?0:f,this._maxPitch=_==null?60:_,this.setProjection(),this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Es,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Ts,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const r=new Tu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r.tileSize=this.tileSize,r.setMaxBounds(this.getMaxBounds()),r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._cameraZoom=this._cameraZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.setProjection(this.getProjection()),r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,r?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(r){this._terrainEnabled()&&this._cameraZoom==null&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),r&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(r){r==null&&(r={name:"mercator"}),this.projectionOptions=r;const c=this.projection?this.getProjection():void 0;return this.projection=a.getProjection(r),!N(c,this.getProjection())&&(this._calcMatrices(),!0)}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.wrap===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const c=-r*Math.PI/180;var f;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(f=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f),function(_,y,w){var S=y[0],I=y[1],P=y[2],z=y[3],R=Math.sin(w),U=Math.cos(w);_[0]=S*U+P*R,_[1]=I*U+z*R,_[2]=S*-R+P*U,_[3]=I*-R+z*U}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const c=a.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(r){const c=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const r=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center),-1);return r===-1?(this._cameraZoom=null,!1):(this._centerAltitude=r,!0)}_updateCameraOnTerrain(){const r=this.cameraToCenterDistance/this.worldSize,c=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(c+r)}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],f=this.horizonLineFromTop();let _=0,y=0;for(let w=0;w<c.length;w++){const S=new a.pointGeometry(c[w][0]*this.width,f+c[w][1]*(this.height-f)),I=r.pointCoordinate(S);if(!I)continue;const P=1/Math.hypot(I[0]-this._camera.position[0],I[1]-this._camera.position[1]);_+=I[3]*P,y+=P}return y===0?NaN:_/y}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._cameraZoom==null||!this._elevation)return;const r=this._cameraZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),f=a.mercatorZfromAltitude(c,this.center.lat),_=this._mercatorZfromZoom(r),y=this._mercatorZfromZoom(this._maxZoom),w=Math.max(_-f,y);this._setZoom(this._zoomFromMercatorZ(w))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let f;f=r.z<this._camera.position[2]?[c.x,c.y,c.z]:[r.x,r.y,r.z];const _=a.length(a.sub([],this._camera.position,f));return a.clamp(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let c=!1;if(r.orientation&&!a.exactEquals(r.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(r.orientation)),r.position){const f=[r.position.x,r.position.y,r.position.z];a.exactEquals$1(f,this._camera.position)||(this._setCameraPosition(f),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,c=new wu;return c.position=new a.MercatorCoordinate(r[0],r[1],r[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(r){if(!a.length$1(r))return!1;a.normalize$1(r,r);const c=a.transformQuat([],[0,0,-1],r),f=a.transformQuat([],[0,-1,0],r);if(f[2]<0)return!1;const _=fo(c,f);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(r){const c=this.zoomScale(this.minZoom)*this.tileSize,f=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;r[2]=a.clamp(r[2],_/f,_/c),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,c,f){this._unmodified=!1,this._edgeInsets.interpolate(r,c,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const c=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(r){const c=[new a.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const f=this.pointCoordinate(new a.pointGeometry(0,0)),_=this.pointCoordinate(new a.pointGeometry(this.width,0)),y=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),w=this.pointCoordinate(new a.pointGeometry(0,this.height)),S=Math.floor(Math.min(f.x,_.x,y.x,w.x)),I=Math.floor(Math.max(f.x,_.x,y.x,w.x)),P=1;for(let z=S-P;z<=I+P;z++)z!==0&&c.push(new a.UnwrappedTileID(z,r))}return c}coveringTiles(r){let c=this.coveringZoomLevel(r);const f=c,_=this.elevation&&!r.isTerrainDEM,y=this.projection.name==="mercator";if(r.minzoom!==void 0&&c<r.minzoom)return[];r.maxzoom!==void 0&&c>r.maxzoom&&(c=r.maxzoom);const w=this.locationCoordinate(this.center),S=1<<c,I=[S*w.x,S*w.y,0],P=We.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c),z=this.pointCoordinate(this.getCameraPoint()),R=S*a.mercatorZfromAltitude(1,this.center.lat),U=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),W=[S*z.x,S*z.y,U],K=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),Z=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&y?c:0,ne=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,q=r.isTerrainDEM?-ne:this._elevation?this._elevation.getMinElevationBelowMSL():0,re=wa(this),se=Se=>{const He=1/4e4,lt=new a.MercatorCoordinate(Se.x+He,Se.y,Se.z),yt=new a.MercatorCoordinate(Se.x,Se.y+He,Se.z),vt=Se.toLngLat(),wt=lt.toLngLat(),Et=yt.toLngLat(),gt=this.locationCoordinate(vt),At=this.locationCoordinate(wt),Qt=this.locationCoordinate(Et),jn=Math.hypot(At.x-gt.x,At.y-gt.y),ir=Math.hypot(Qt.x-gt.x,Qt.y-gt.y);return Math.sqrt(jn*ir)*re/He},H=(Se,He,lt,yt,vt,wt)=>{const Et=a.tileTransform({z:Se,x:He,y:lt},this.projection);return new Pe([(yt+Et.x/Et.scale)*S,S*(Et.y/Et.scale),vt],[(yt+Et.x2/Et.scale)*S,S*(Et.y2/Et.scale),wt])},le=Se=>({aabb:H(0,0,0,Se,q,ne),zoom:0,x:0,y:0,wrap:Se,fullyVisible:!1}),he=[];let ke=[];const Ce=c,ze=r.reparseOverscaled?f:c,De=Se=>{if(!this._elevation||!Se.tileID)return;const He=this._elevation.getMinMaxForTile(Se.tileID),lt=Se.aabb;He?(lt.min[2]=He.min,lt.max[2]=He.max,lt.center[2]=(lt.min[2]+lt.max[2])/2):(Se.shouldSplit=qe(Se),Se.shouldSplit||(lt.min[2]=lt.max[2]=lt.center[2]=this._centerAltitude))},Ge=Se=>Se*Se,Me=Ge((U-this._centerAltitude)*R),qe=Se=>{if(Se.zoom<Z)return!0;if(Se.zoom===Ce)return!1;if(Se.shouldSplit!=null)return Se.shouldSplit;const He=Se.aabb.distanceX(W),lt=Se.aabb.distanceY(W);let yt=Me;_&&(yt=Ge(Se.aabb.distanceZ(W)*R));let vt=1;if(!y&&f<=5){const Et=Math.pow(2,Se.zoom),gt=se(new a.MercatorCoordinate((Se.x+.5)/Et,(Se.y+.5)/Et));vt=gt>.85?1:gt}const wt=He*He+lt*lt+yt;return wt<Ge((1<<Ce-Se.zoom)*K*vt*((Et,gt)=>{if(gt*Ge(.707)<Et)return 1;const At=Math.sqrt(gt/Et);return At/(1.4144271570014144+(Math.pow(1.1,At-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(yt,Me),wt))};if(this.renderWorldCopies)for(let Se=1;Se<=3;Se++)he.push(le(-Se)),he.push(le(Se));for(he.push(le(0));he.length>0;){const Se=he.pop(),He=Se.x,lt=Se.y;let yt=Se.fullyVisible;if(!yt){const vt=Se.aabb.intersects(P);if(vt===0)continue;yt=vt===2}if(Se.zoom!==Ce&&qe(Se))for(let vt=0;vt<4;vt++){const wt=(He<<1)+vt%2,Et=(lt<<1)+(vt>>1),gt={aabb:this.projection.name==="mercator"?Se.aabb.quadrant(vt):H(Se.zoom+1,wt,Et,Se.wrap,0,0),zoom:Se.zoom+1,x:wt,y:Et,wrap:Se.wrap,fullyVisible:yt,tileID:void 0,shouldSplit:void 0};_&&(gt.tileID=new a.OverscaledTileID(Se.zoom+1===Ce?ze:Se.zoom+1,Se.wrap,Se.zoom+1,wt,Et),De(gt)),he.push(gt)}else{const vt=Se.zoom===Ce?ze:Se.zoom;if(r.minzoom&&r.minzoom>vt)continue;const wt=I[0]-(.5+He+(Se.wrap<<Se.zoom))*(1<<c-Se.zoom),Et=I[1]-.5-lt,gt=Se.tileID?Se.tileID:new a.OverscaledTileID(vt,Se.wrap,Se.zoom,He,lt);ke.push({tileID:gt,distanceSq:wt*wt+Et*Et})}}if(this.fogCullDistSq){const Se=this.fogCullDistSq,He=this.horizonLineFromTop();ke=ke.filter(lt=>{const yt=[0,0,0,1],vt=[a.EXTENT,a.EXTENT,0,1],wt=this.calculateFogTileMatrix(lt.tileID.toUnwrapped());a.transformMat4(yt,yt,wt),a.transformMat4(vt,vt,wt);const Et=a.getAABBPointSquareDist(yt,vt);if(Et===0)return!0;let gt=!1;const At=this._elevation;if(At&&Et>Se&&He!==0){const Qt=this.calculateProjMatrix(lt.tileID.toUnwrapped());let jn;r.isTerrainDEM||(jn=At.getMinMaxForTile(lt.tileID)),jn||(jn={min:q,max:ne});const ir=a.furthestTileCorner(this.rotation),_r=[ir[0]*a.EXTENT,ir[1]*a.EXTENT,jn.max];a.transformMat4$1(_r,_r,Qt),gt=(1-_r[1])*this.height*.5<He}return Et<Se||gt})}return ke.sort((Se,He)=>Se.distanceSq-He.distanceSq).map(Se=>Se.tileID)}resize(r,c){this.width=r,this.height=c,this.pixelsToGLUnits=[2/r,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const c=a.clamp(r.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),f=this.projection.project(r.lng,c);return new a.pointGeometry(f.x*this.worldSize,f.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(r,c){const f=this.pointCoordinate(c),_=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(r);this.setLocation(new a.MercatorCoordinate(y.x-(f.x-_.x),y.y-(f.y-_.y)))}setLocation(r){this.center=this.coordinateLocation(r),this.renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r){return this._coordinatePoint(this.locationCoordinate(r),!1)}locationPoint3D(r){return this._coordinatePoint(this.locationCoordinate(r),!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,c){const f=c?a.mercatorZfromAltitude(c,r.lat):void 0,_=this.projection.project(r.lng,r.lat);return new a.MercatorCoordinate(_.x,_.y,f)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,c){const f=c!=null?c:this._centerAltitude,_=[r.x,r.y,0,1],y=[r.x,r.y,1,1];a.transformMat4(_,_,this.pixelMatrixInverse),a.transformMat4(y,y,this.pixelMatrixInverse);const w=y[3];a.scale$2(_,_,1/_[3]),a.scale$2(y,y,1/w);const S=_[2],I=y[2];return{p0:_,p1:y,t:S===I?0:(f-S)/(I-S)}}screenPointToMercatorRay(r){const c=[r.x,r.y,0,1],f=[r.x,r.y,1,1];return a.transformMat4(c,c,this.pixelMatrixInverse),a.transformMat4(f,f,this.pixelMatrixInverse),a.scale$2(c,c,1/c[3]),a.scale$2(f,f,1/f[3]),c[2]=a.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,f[2]=a.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,a.scale$2(c,c,1/this.worldSize),a.scale$2(f,f,1/this.worldSize),new Te([c[0],c[1],c[2]],a.normalize([],a.sub([],f,c)))}rayIntersectionCoordinate(r){const{p0:c,p1:f,t:_}=r,y=a.mercatorZfromAltitude(c[2],this._center.lat),w=a.mercatorZfromAltitude(f[2],this._center.lat);return new a.MercatorCoordinate(a.number(c[0],f[0],_)/this.worldSize,a.number(c[1],f[1],_)/this.worldSize,a.number(y,w,_))}pointCoordinate(r,c=this._centerAltitude){const f=this.horizonLineFromTop(!1),_=new a.pointGeometry(r.x,Math.max(f,r.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(_,c))}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);const c=this.elevation;let f=this.elevation.pointCoordinate(r);if(f)return new a.MercatorCoordinate(f[0],f[1],f[2]);let _=0,y=this.horizonLineFromTop();if(r.y>y)return this.pointCoordinate(r);const w=.02*y,S=r.clone();for(let I=0;I<10&&y-_>w;I++){S.y=a.number(_,y,.66);const P=c.pointCoordinate(S);P?(y=S.y,f=P):_=S.y}return f?new a.MercatorCoordinate(f[0],f[1],f[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){if(this.elevation)return!this.elevation.pointCoordinate(r);{const c=this.horizonLineFromTop();return r.y<c}}_coordinatePoint(r,c){const f=c&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,_=[r.x*this.worldSize,r.y*this.worldSize,f+r.toAltitude(),1];return a.transformMat4(_,_,this.pixelMatrix),_[3]>0?new a.pointGeometry(_[0]/_[3],_[1]/_[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(r,c){const f=new a.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),_=new a.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),y=new a.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),w=new a.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let S=this.pointCoordinate(f,r),I=this.pointCoordinate(_,r);const P=this.pointCoordinate(y,c),z=this.pointCoordinate(w,c),R=(U,W)=>(W.y-U.y)/(W.x-U.x);return S.y>1&&I.y>=0?S=new a.MercatorCoordinate((1-z.y)/R(z,S)+z.x,1):S.y<0&&I.y<=1&&(S=new a.MercatorCoordinate(-z.y/R(z,S)+z.x,0)),I.y>1&&S.y>=0?I=new a.MercatorCoordinate((1-P.y)/R(P,I)+P.x,1):I.y<0&&S.y<=1&&(I=new a.MercatorCoordinate(-P.y/R(P,I)+P.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(S)).extend(this.coordinateLocation(I)).extend(this.coordinateLocation(z)).extend(this.coordinateLocation(P))}_getBounds3D(){const r=this.elevation,c=r.visibleDemTiles.reduce((f,_)=>{if(_.dem){const y=_.dem.tree;f.min=Math.min(f.min,y.minimums[0]),f.max=Math.max(f.max,y.maximums[0])}return f},{min:Number.MAX_VALUE,max:0});return this._getBounds(c.min*r.exaggeration(),c.max*r.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(r=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,f=this.height/2-c*(1-this._horizonShift);return r?Math.max(0,f):f}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,c){let f,_,y;const w=r.canonical,S=a.identity(new Float64Array(16));if(this.projection.name==="mercator")f=c/this.zoomScale(w.z),_=(w.x+Math.pow(2,w.z)*r.wrap)*f,y=w.y*f;else{const I=a.tileTransform(w,this.projection);f=1,_=I.x+r.wrap*I.scale,y=I.y,a.scale$1(S,S,[f/I.scale,f/I.scale,this.pixelsPerMeter/this.worldSize])}return a.translate(S,S,[_,y,0]),a.scale$1(S,S,[f/a.EXTENT,f/a.EXTENT,1]),S}calculateDistanceTileData(r){const c=r.key,f=this._distanceTileDataCache;if(f[c])return f[c];const _=r.canonical,y=1/this.height,w=this.cameraWorldSize/this.zoomScale(_.z),S=(_.x+Math.pow(2,_.z)*r.wrap)*w,I=_.y*w,P=this.point,z=this.angle,R=Math.sin(-z),U=-Math.cos(-z);return f[c]={bearing:[R,U],center:[(P.x-S)*y,(P.y-I)*y],scale:w/a.EXTENT*y},f[c]}calculateFogTileMatrix(r){const c=r.key,f=this._fogTileMatrixCache;if(f[c])return f[c];const _=this.calculatePosMatrix(r,this.cameraWorldSize);return a.multiply(_,this.worldToFogMatrix,_),f[c]=new Float32Array(_),f[c]}calculateProjMatrix(r,c=!1){const f=r.key,_=c?this._alignedProjMatrixCache:this._projMatrixCache;if(_[f])return _[f];const y=this.calculatePosMatrix(r,this.worldSize);return a.multiply(y,this.projection.name==="mercator"?c?this.alignedProjMatrix:this.projMatrix:this.mercatorMatrix,y),_[f]=new Float32Array(y),_[f]}calculatePixelsToTileUnitsMatrix(r){const c=r.tileID.key,f=this._pixelsToTileUnitsCache;if(f[c])return f[c];const _=function(y,w){const{scale:S}=y.tileTransform,I=S*a.EXTENT/(y.tileSize*Math.pow(2,w.zoom-y.tileID.overscaledZ+y.tileID.canonical.z));return P=new Float32Array(4),U=(z=w.inverseAdjustmentMatrix)[1],W=z[2],K=z[3],ne=(R=[I,I])[1],P[0]=z[0]*(Z=R[0]),P[1]=U*Z,P[2]=W*ne,P[3]=K*ne,P;var P,z,R,U,W,K,Z,ne}(r,this);return f[c]=_,f[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const r=this._elevation;this._updateCameraState();const c=this._camera.position,f=this._camera.forward();if(c[2]<=0||f[2]>=0)return;const _=a.mercatorZfromAltitude(1,this._center.lat);c[2]/=_,f[2]/=_,a.normalize(f,f);const y=r.raycast(c,f,r.exaggeration());if(y){const w=a.scaleAndAdd([],c,f,y),S=new a.MercatorCoordinate(w[0],w[1],a.mercatorZfromAltitude(w[2],a.latFromMercatorY(w[1]))),I=this._camera.position,P=S.z+a.length([S.x-I[0],S.y-I[1],S.z-I[2]]);this._cameraZoom=this._zoomFromMercatorZ(P),this._centerAltitude=S.toAltitude(),this._center=this.coordinateLocation(S),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const r=this._elevation;this._updateCameraState();const c=r.getAtPointOrZero(this._camera.mercatorPosition),f=this._minimumHeightOverTerrain()*Math.cos(a.degToRad(this._maxPitch)),_=a.mercatorZfromAltitude(c,this._center.lat),y=this._camera.position[2]-_;if(y<f){const w=this.locationCoordinate(this._center,this._centerAltitude),S=this._camera.mercatorPosition,I=[w.x-S.x,w.y-S.y,w.z-S.z],P=a.length(I);I[2]-=f-y;const z=a.length(I);if(z===0)return;a.scale(I,I,P/z),this._camera.position=[w.x-I[0],w.y-I[1],w.z-I[2]],this._camera.orientation=fo(I,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.name!=="mercator"){const R=this.center;return R.lat=a.clamp(R.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(R.lng=a.clamp(R.lng,this.minLng,this.maxLng)),this.center=R,void(this._constraining=!1)}const r=this._unmodified,{x:c,y:f}=this.point;let _=0,y=c,w=f;const S=this.width/2,I=this.height/2,P=this.worldMinY*this.scale,z=this.worldMaxY*this.scale;if(f-I<P&&(w=P+I),f+I>z&&(w=z-I),z-P<this.height&&(_=Math.max(_,this.height/(z-P)),w=(z+P)/2),this.maxBounds||!this.renderWorldCopies){const R=this.worldMinX*this.scale,U=this.worldMaxX*this.scale,W=this.worldSize/2-(R+U)/2;y=(c+W+this.worldSize)%this.worldSize-W,y-S<R&&(y=R+S),y+S>U&&(y=U-S),U-R<this.width&&(_=Math.max(_,this.width/(U-R)),y=(U+R)/2)}y===c&&w===f||(this.center=this.unproject(new a.pointGeometry(y,w))),_&&(this.zoom+=this.scaleZoom(_)),this._constrainCameraAltitude(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const c=this.pixelsPerMeter;this._updateCameraState();const f=Math.PI/2+this._pitch,_=this.fovAboveCenter,y=this.elevation?this.elevation.getMinElevationBelowMSL()*c:0,w=(this._camera.position[2]*this.worldSize-y)/Math.cos(this._pitch),S=Math.sin(_)*w/Math.sin(a.clamp(Math.PI-f-_,.01,Math.PI-.01)),I=this.point,P=I.x,z=I.y,R=Math.cos(Math.PI/2-this._pitch)*S+w,U=Math.min(1.01*R,w*(1/this._horizonShift)),W=this.height/50,K=this._camera.getWorldToCamera(this.worldSize,c),Z=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,W,U);Z[8]=2*-r.x/this.width,Z[9]=2*r.y/this.height;let ne=a.mul$1([],Z,K);if(this.projection.name!=="mercator"){const Ge=this.locationCoordinate(this.center),Me=a.identity([]);a.translate(Me,Me,[Ge.x*this.worldSize,Ge.y*this.worldSize,0]),a.multiply(Me,Me,$l(this)),a.translate(Me,Me,[-Ge.x*this.worldSize,-Ge.y*this.worldSize,0]),a.multiply(ne,ne,Me),this.inverseAdjustmentMatrix=function(qe){const Se=$l(qe,!0);return me([],[Se[0],Se[1],Se[4],Se[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale$1([],ne,[this.worldSize,this.worldSize,this.worldSize/c]),this.projMatrix=ne,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const q=new Float32Array(16);a.identity(q),a.scale$1(q,q,[1,-1,1]),a.rotateX(q,q,this._pitch),a.rotateZ(q,q,this.angle);const re=a.perspective(new Float32Array(16),this._fov,this.width/this.height,W,U),se=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;re[8]=2*-r.x/this.width,re[9]=2*(r.y+se)/this.height,this.skyboxMatrix=a.multiply(q,re,q);const H=this.width%2/2,le=this.height%2/2,he=Math.cos(this.angle),ke=Math.sin(this.angle),Ce=P-Math.round(P)+he*H+ke*le,ze=z-Math.round(z)+he*le+ke*H,De=new Float64Array(ne);if(a.translate(De,De,[Ce>.5?Ce-1:Ce,ze>.5?ze-1:ze,0]),this.alignedProjMatrix=De,ne=a.create$1(),a.scale$1(ne,ne,[this.width/2,-this.height/2,1]),a.translate(ne,ne,[1,-1,0]),this.labelPlaneMatrix=ne,ne=a.create$1(),a.scale$1(ne,ne,[1,-1,1]),a.translate(ne,ne,[-1,-1,0]),a.scale$1(ne,ne,[2/this.width,2/this.height,1]),this.glCoordMatrix=ne,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},ne=a.invert(new Float64Array(16),this.pixelMatrix),!ne)throw new Error("failed to invert matrix");this.pixelMatrixInverse=ne,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSize,c=this.cameraPixelsPerMeter,f=this._camera.position,_=1/this.height,y=[r,r,c];a.scale(y,y,_),a.scale(f,f,-1),a.multiply$1(f,f,y);const w=a.create$1();a.translate(w,w,f),a.scale$1(w,w,y),this.mercatorFogMatrix=w,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,c,_)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const r=this._camera.forward(),c=this.cameraToCenterDistance,f=this.point,_=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-a.mercatorZfromAltitude(this._centerAltitude,this.center.lat),y=this.cameraToCenterDistance/_;this._camera.position=[f.x/this.worldSize-r[0]*c/y,f.y/this.worldSize-r[1]*c/y,a.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-r[2]*c/y]}_translateCameraConstrained(r){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),f=r[2];let _=1;f>0&&(_=Math.min((c-this._camera.position[2])/f,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,r,_),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,c=this._camera.forward(),{pitch:f,bearing:_}=this._camera.getPitchBearing(),y=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat),w=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),S=Math.max((r[2]-y)/Math.cos(f),w),I=this._zoomFromMercatorZ(S);a.scaleAndAdd(r,r,c,S),this._pitch=a.clamp(f,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(_,-Math.PI,Math.PI),this._setZoom(a.clamp(I,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=this.coordinateLocation(new a.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._cameraZoom!=null?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}_terrainEnabled(){return!(!this._elevation||this.projection.name!=="mercator"&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(r,c){const f=Math.min(r.x,c.x),_=Math.max(r.x,c.x),y=Math.min(r.y,c.y),w=Math.max(r.y,c.y);if(y<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const S=[new a.pointGeometry(f,y),new a.pointGeometry(_,w),new a.pointGeometry(f,w),new a.pointGeometry(_,y)],I=this.renderWorldCopies?-3:0,P=this.renderWorldCopies?4:1;for(const z of S){const R=this.pointRayIntersection(z);if(R.t<0)return!0;const U=this.rayIntersectionCoordinate(R);if(U.x<I||U.y<0||U.x>P||U.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(r,c){const f=a.length(a.sub([],this._camera.position,r)),_=this._zoomFromMercatorZ(f)+c;return f-this._mercatorZfromZoom(_)}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,r))}}function Su(d,r){let c=!1,f=null;const _=()=>{f=null,c&&(d(),f=setTimeout(_,r),c=!1)};return()=>(c=!0,f||_(),f)}class Nl{constructor(r){this._hashName=r&&encodeURIComponent(r),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Su(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const c=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,_=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,_),w=Math.round(c.lng*y)/y,S=Math.round(c.lat*y)/y,I=this._map.getBearing(),P=this._map.getPitch();let z="";if(z+=r?`/${w}/${S}/${f}`:`${f}/${S}/${w}`,(I||P)&&(z+="/"+Math.round(10*I)/10),P&&(z+=`/${Math.round(P)}`),this._hashName){const R=this._hashName;let U=!1;const W=a.window.location.hash.slice(1).split("&").map(K=>{const Z=K.split("=")[0];return Z===R?(U=!0,`${Z}=${z}`):K}).filter(K=>K);return U||W.push(`${R}=${z}`),`#${W.join("&")}`}return`#${z}`}_getCurrentHash(){const r=a.window.location.hash.replace("#","");if(this._hashName){let c;return r.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._getCurrentHash();if(r.length>=3&&!r.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:c,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,r)}}const Ss={linearity:.3,easing:a.bezier(0,0,.3,1)},Rd=a.extend({deceleration:2500,maxSpeed:1400},Ss),Ld=a.extend({deceleration:20,maxSpeed:1400},Ss),Ul=a.extend({deceleration:1e3,maxSpeed:360},Ss),Cu=a.extend({deceleration:1e3,maxSpeed:90},Ss);class Od{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,c=a.exported.now();for(;r.length>0&&c-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)c.zoom+=y.zoomDelta||0,c.bearing+=y.bearingDelta||0,c.pitch+=y.pitchDelta||0,y.panDelta&&c.pan._add(y.panDelta),y.around&&(c.around=y.around),y.pinchAround&&(c.pinchAround=y.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(c.pan.mag()){const y=Ta(c.pan.mag(),f,a.extend({},Rd,r||{}));_.offset=c.pan.mult(y.amount/c.pan.mag()),_.center=this._map.transform.center,Ea(_,y)}if(c.zoom){const y=Ta(c.zoom,f,Ld);_.zoom=this._map.transform.zoom+y.amount,Ea(_,y)}if(c.bearing){const y=Ta(c.bearing,f,Ul);_.bearing=this._map.transform.bearing+a.clamp(y.amount,-179,179),Ea(_,y)}if(c.pitch){const y=Ta(c.pitch,f,Cu);_.pitch=this._map.transform.pitch+y.amount,Ea(_,y)}if(_.zoom||_.bearing){const y=c.pinchAround===void 0?c.around:c.pinchAround;_.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),a.extend(_,{noMoveStart:!0})}}function Ea(d,r){(!d.duration||d.duration<r.duration)&&(d.duration=r.duration,d.easing=r.easing)}function Ta(d,r,c){const{maxSpeed:f,linearity:_,deceleration:y}=c,w=a.clamp(d*_/(r/1e3),-f,f),S=Math.abs(w)/(y*_);return{easing:c.easing,duration:1e3*S,amount:w*(S/2)}}class Pr extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,f,_={}){const y=F.mousePos(c.getCanvasContainer(),f),w=c.unproject(y);super(r,a.extend({point:y,lngLat:w,originalEvent:f},_)),this._defaultPrevented=!1,this.target=c}}class Sa extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,f){const _=r==="touchend"?f.changedTouches:f.touches,y=F.touchPos(c.getCanvasContainer(),_),w=y.map(I=>c.unproject(I)),S=y.reduce((I,P,z,R)=>I.add(P.div(R.length)),new a.pointGeometry(0,0));super(r,{points:y,point:S,lngLats:w,lngLat:c.unproject(S),originalEvent:f}),this._defaultPrevented=!1}}class Cs extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,f){super(r,{originalEvent:f}),this._defaultPrevented=!1}}class Bd{constructor(r,c){this._map=r,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Cs(r.type,this._map,r))}mousedown(r,c){return this._mousedownPos=c,this._firePreventable(new Pr(r.type,this._map,r))}mouseup(r){this._map.fire(new Pr(r.type,this._map,r))}preclick(r){const c=a.extend({},r);c.type="preclick",this._map.fire(new Pr(c.type,this._map,c))}click(r,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(r),this._map.fire(new Pr(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new Pr(r.type,this._map,r))}mouseover(r){this._map.fire(new Pr(r.type,this._map,r))}mouseout(r){this._map.fire(new Pr(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Sa(r.type,this._map,r))}touchmove(r){this._map.fire(new Sa(r.type,this._map,r))}touchend(r){this._map.fire(new Sa(r.type,this._map,r))}touchcancel(r){this._map.fire(new Sa(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fd{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(r){this._map.fire(new Pr(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new Pr(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class $d{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,c){this.isEnabled()&&r.shiftKey&&r.button===0&&(F.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(r,c){if(!this._active)return;const f=c;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=f,this._box||(this._box=F.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const y=Math.min(_.x,f.x),w=Math.max(_.x,f.x),S=Math.min(_.y,f.y),I=Math.max(_.y,f.y);this._map._requestDomTask(()=>{this._box&&(F.setTransform(this._box,`translate(${y}px,${S}px)`),this._box.style.width=w-y+"px",this._box.style.height=I-S+"px")})}mouseupWindow(r,c){if(!this._active||r.button!==0)return;const f=this._startPos,_=c;if(this.reset(),F.suppressClick(),f.x!==_.x||f.y!==_.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:y=>y.fitScreenCoordinates(f,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(F.remove(this._box),this._box=null),F.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,c){return this._map.fire(new a.Event(r,{originalEvent:c}))}}function jl(d,r){const c={};for(let f=0;f<d.length;f++)c[d[f].identifier]=r[f];return c}class Nd{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,c,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),f.length===this.numTouches&&(this.centroid=function(_){const y=new a.pointGeometry(0,0);for(const w of _)y._add(w);return y.div(_.length)}(c),this.touches=jl(f,c)))}touchmove(r,c,f){if(this.aborted||!this.centroid)return;const _=jl(f,c);for(const y in this.touches){const w=this.touches[y],S=_[y];(!S||S.dist(w)>30)&&(this.aborted=!0)}}touchend(r,c,f){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Vl{constructor(r){this.singleTap=new Nd(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,c,f){this.singleTap.touchstart(r,c,f)}touchmove(r,c,f){this.singleTap.touchmove(r,c,f)}touchend(r,c,f){const _=this.singleTap.touchend(r,c,f);if(_){const y=r.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(_)<30;if(y&&w||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class gr{constructor(){this._zoomIn=new Vl({numTouches:1,numTaps:2}),this._zoomOut=new Vl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,c,f){this._zoomIn.touchstart(r,c,f),this._zoomOut.touchstart(r,c,f)}touchmove(r,c,f){this._zoomIn.touchmove(r,c,f),this._zoomOut.touchmove(r,c,f)}touchend(r,c,f){const _=this._zoomIn.touchend(r,c,f),y=this._zoomOut.touchend(r,c,f);return _?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(_)},{originalEvent:r})}):y?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(y)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Pm={0:1,2:2};class _i{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(r,c){return!1}_move(r,c){return{}}mousedown(r,c){if(this._lastPoint)return;const f=F.mouseButton(r);this._correctButton(r,f)&&(this._lastPoint=c,this._eventButton=f)}mousemoveWindow(r,c){const f=this._lastPoint;if(f){if(r.preventDefault(),function(_,y){const w=Pm[y];return _.buttons===void 0||(_.buttons&w)!==w}(r,this._eventButton))this.reset();else if(this._moved||!(c.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(f,c)}}mouseupWindow(r){this._lastPoint&&F.mouseButton(r)===this._eventButton&&(this._moved&&F.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ud extends _i{mousedown(r,c){super.mousedown(r,c),this._lastPoint&&(this._active=!0)}_correctButton(r,c){return c===0&&!r.ctrlKey}_move(r,c){return{around:c,panDelta:c.sub(r)}}}class Gi extends _i{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const f=.8*(c.x-r.x);if(f)return this._active=!0,{bearingDelta:f}}contextmenu(r){r.preventDefault()}}class qo extends _i{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const f=-.5*(c.y-r.y);if(f)return this._active=!0,{pitchDelta:f}}contextmenu(r){r.preventDefault()}}class zm{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(r,c,f){return this._calculateTransform(r,c,f)}touchmove(r,c,f){if(this._active&&!(f.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(f.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.preventDefault(),this._calculateTransform(r,c,f)}}touchend(r,c,f){this._calculateTransform(r,c,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,c,f){f.length>0&&(this._active=!0);const _=jl(f,c),y=new a.pointGeometry(0,0),w=new a.pointGeometry(0,0);let S=0;for(const P in _){const z=_[P],R=this._touches[P];R&&(y._add(z),w._add(z.sub(R)),S++,_[P]=z)}if(this._touches=_,S<this._minTouches||!w.mag())return;const I=w.div(S);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(S),panDelta:I}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F.create("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class ku{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(r){}_move(r,c,f){return{}}touchstart(r,c,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([c[0],c[1]]))}touchmove(r,c,f){if(!this._firstTwoTouches)return;r.preventDefault();const[_,y]=this._firstTwoTouches,w=Gl(f,c,_),S=Gl(f,c,y);if(!w||!S)return;const I=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],I,r)}touchend(r,c,f){if(!this._firstTwoTouches)return;const[_,y]=this._firstTwoTouches,w=Gl(f,c,_),S=Gl(f,c,y);w&&S||(this._active&&F.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Gl(d,r,c){for(let f=0;f<d.length;f++)if(d[f].identifier===c)return r[f]}function jd(d,r){return Math.log(d/r)/Math.LN2}class Vd extends ku{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,c){const f=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(jd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:jd(this._distance,f),pinchAround:c}}}function ks(d,r){return 180*d.angleWith(r)/Math.PI}class ki extends ku{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,c){const f=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ks(this._vector,f),pinchAround:c}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const c=25/(Math.PI*this._minDiameter)*360,f=ks(r,this._startVector);return Math.abs(f)<c}}function Zl(d){return Math.abs(d.y)>Math.abs(d.x)}class Gd extends ku{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(r){this._lastPoints=r,Zl(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,c,f){const _=r[0].sub(this._lastPoints[0]),y=r[1].sub(this._lastPoints[1]);if(!(this._map._cooperativeGestures&&f.touches.length<3)&&(this._valid=this.gestureBeginsVertically(_,y,f.timeStamp),this._valid))return this._lastPoints=r,this._active=!0,{pitchDelta:(_.y+y.y)/2*-.5}}gestureBeginsVertically(r,c,f){if(this._valid!==void 0)return this._valid;const _=r.mag()>=2,y=c.mag()>=2;if(!_&&!y)return;if(!_||!y)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const w=r.y>0==c.y>0;return Zl(r)&&Zl(c)&&w}}const Ca={panStep:100,bearingStep:15,pitchStep:10};class at{constructor(){const r=Ca;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let c=0,f=0,_=0,y=0,w=0;switch(r.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:r.shiftKey?f=-1:(r.preventDefault(),y=-1);break;case 39:r.shiftKey?f=1:(r.preventDefault(),y=1);break;case 38:r.shiftKey?_=1:(r.preventDefault(),w=-1);break;case 40:r.shiftKey?_=-1:(r.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(f=0,_=0),{cameraAnimation:S=>{const I=S.getZoom();S.easeTo({duration:300,easeId:"keyboardHandler",easing:Zd,zoom:c?Math.round(I)+c*(r.shiftKey?2:1):I,bearing:S.getBearing()+f*this._bearingStep,pitch:S.getPitch()+_*this._pitchStep,offset:[-y*this._panStep,-w*this._panStep],center:S.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Zd(d){return d*(2-d)}const Iu=4.000244140625;class ka{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=r.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const f=a.exported.now(),_=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,c!==0&&c%Iu==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(_*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),r.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=r,this._delta-=c,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=F.mousePos(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform,c=()=>r._terrainEnabled()?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const I=this._type==="wheel"&&Math.abs(this._delta)>Iu?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&P!==0&&(P=1/P);const z=c(),R=Math.pow(2,z),U=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):R;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(U*P))),this._type==="wheel"&&(this._startZoom=c(),this._easing=this._smoothOutEasing(200)),this._delta=0}const f=typeof this._targetZoom=="number"?this._targetZoom:c(),_=this._startZoom,y=this._easing;let w,S=!1;if(this._type==="wheel"&&_&&y){const I=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),P=y(I);w=a.number(_,f,P),I<1?this._frameId||(this._frameId=!0):S=!0}else w=f,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:w-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let c=a.ease;if(this._prevEase){const f=this._prevEase,_=(a.exported.now()-f.start)/f.duration,y=f.easing(_+.01)-f.easing(_),w=.27/Math.sqrt(y*y+1e-4)*.01,S=Math.sqrt(.0729-w*w);c=a.bezier(w,S,.25,1)}return this._prevEase={start:a.exported.now(),duration:r,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F.create("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!a.window.document.fullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class Ia{constructor(r,c){this._clickZoom=r,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class qd{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,c){return r.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:f.getZoom()+(r.shiftKey?-1:1),around:f.unproject(c)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wd{constructor(){this._tap=new Vl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(r,c,f){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=c[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(r,c,f))}touchmove(r,c,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const _=c[0],y=_.y-this._swipePoint.y;return this._swipePoint=_,r.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(r,c,f)}touchend(r,c,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(r,c,f)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hd{constructor(r,c,f){this._el=r,this._mousePan=c,this._touchPan=f}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Xd{constructor(r,c,f){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=c,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Kd{constructor(r,c,f,_){this._el=r,this._touchZoom=c,this._touchRotate=f,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Aa=d=>d.zoom||d.drag||d.pitch||d.rotate;class Yd extends a.Event{}class ql{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,c){const f=a.sub([],c,r);this.radius=a.length(f[2]<0?a.div([],f,this.constants):[f[0],f[1],0])}projectRay(r){a.div(r,r,this.constants),a.normalize(r,r),a.mul$2(r,r,this.constants);const c=a.scale([],r,this.radius);if(c[2]>0){const f=a.scale([],[0,0,1],a.dot(c,[0,0,1])),_=a.scale([],a.normalize([],[c[0],c[1],0]),this.radius),y=a.add([],c,a.scale([],a.sub([],a.add([],_,f),c),2));c[0]=y[0],c[1]=y[1]}return c}}function Is(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class Wl{constructor(r,c){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Od(r),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new ql,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),a.bindAll(["handleEvent","handleWindowEvent"],this);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[_,y,w]of this._listeners)F.addEventListener(_,y,_===a.window.document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[r,c,f]of this._listeners)F.removeEventListener(r,c,r===a.window.document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(r){const c=this._map,f=c.getCanvasContainer();this._add("mapEvent",new Bd(c,r));const _=c.boxZoom=new $d(c,r);this._add("boxZoom",_);const y=new gr,w=new qd;c.doubleClickZoom=new Ia(w,y),this._add("tapZoom",y),this._add("clickZoom",w);const S=new Wd;this._add("tapDragZoom",S);const I=c.touchPitch=new Gd(c);this._add("touchPitch",I);const P=new Gi(r),z=new qo(r);c.dragRotate=new Xd(r,P,z),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const R=new Ud(r),U=new zm(c,r);c.dragPan=new Hd(f,R,U),this._add("mousePan",R),this._add("touchPan",U,["touchZoom","touchRotate"]);const W=new ki,K=new Vd;c.touchZoomRotate=new Kd(f,K,W,S),this._add("touchRotate",W,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Fd(c));const Z=c.scrollZoom=new ka(c,this);this._add("scrollZoom",Z,["mousePan"]);const ne=c.keyboard=new at;this._add("keyboard",ne);for(const q of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[q]&&c[q].enable(r[q])}_add(r,c,f){this._handlers.push({handlerName:r,handler:c,allowed:f}),this._handlersById[r]=c}stop(r){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Aa(this._eventsInProgress))||this.isZooming()}_blockedByActive(r,c,f){for(const _ in r)if(_!==f&&(!c||c.indexOf(_)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const c=[];for(const f of r)this._el.contains(f.target)&&c.push(f);return c}handleEvent(r,c){this._updatingCamera=!0;const f=r.type==="renderFrame",_=f?void 0:r,y={needsRenderFrame:!1},w={},S={},I=r.touches?this._getMapTouches(r.touches):void 0,P=I?F.touchPos(this._el,I):f?void 0:F.mousePos(this._el,r);for(const{handlerName:U,handler:W,allowed:K}of this._handlers){if(!W.isEnabled())continue;let Z;this._blockedByActive(S,K,U)?W.reset():W[c||r.type]&&(Z=W[c||r.type](r,P,I),this.mergeHandlerResult(y,w,Z,U,_),Z&&Z.needsRenderFrame&&this._triggerRenderFrame()),(Z||W.isActive())&&(S[U]=W)}const z={};for(const U in this._previousActiveHandlers)S[U]||(z[U]=_);this._previousActiveHandlers=S,(Object.keys(z).length||Is(y))&&(this._changes.push([y,w,z]),this._triggerRenderFrame()),(Object.keys(S).length||Is(y))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:R}=y;R&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],R(this._map))}mergeHandlerResult(r,c,f,_,y){if(!f)return;a.extend(r,f);const w={handlerName:_,originalEvent:f.originalEvent||y};f.zoomDelta!==void 0&&(c.zoom=w),f.panDelta!==void 0&&(c.drag=w),f.pitchDelta!==void 0&&(c.pitch=w),f.bearingDelta!==void 0&&(c.rotate=w)}_applyChanges(){const r={},c={},f={};for(const[_,y,w]of this._changes)_.panDelta&&(r.panDelta=(r.panDelta||new a.pointGeometry(0,0))._add(_.panDelta)),_.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(r.around=_.around),_.aroundCoord!==void 0&&(r.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(r.pinchAround=_.pinchAround),_.noInertia&&(r.noInertia=_.noInertia),a.extend(c,y),a.extend(f,w);this._updateMapTransform(r,c,f),this._changes=[]}_updateMapTransform(r,c,f){const _=this._map,y=_.transform,w=re=>[re.x,re.y,re.z];if((re=>{const se=this._eventsInProgress.drag;return se&&!this._handlersById[se.handlerName].isActive()})()&&!Is(r)){const re=y.zoom;y.cameraElevationReference="sea",y.recenterOnTerrain(),y.cameraElevationReference="ground",re!==y.zoom&&this._map._update(!0)}if(!Is(r))return this._fireEvents(c,f,!0);let{panDelta:S,zoomDelta:I,bearingDelta:P,pitchDelta:z,around:R,aroundCoord:U,pinchAround:W}=r;W!==void 0&&(R=W),(re=>c.drag&&!this._eventsInProgress.drag)()&&R&&(this._dragOrigin=w(y.pointCoordinate3D(R)),this._trackingEllipsoid.setup(y._camera.position,this._dragOrigin)),y.cameraElevationReference="sea",_._stop(!0),R=R||_.transform.centerPoint,P&&(y.bearing+=P),z&&(y.pitch+=z),y._updateCameraState();const K=[0,0,0];if(S){const re=y.screenPointToMercatorRay(R),se=y.screenPointToMercatorRay(R.sub(S)),H=this._trackingEllipsoid.projectRay(re.dir),le=this._trackingEllipsoid.projectRay(se.dir);K[0]=le[0]-H[0],K[1]=le[1]-H[1]}const Z=y.zoom,ne=[0,0,0];if(I){const re=w(U||y.pointCoordinate3D(R)),se={dir:a.normalize([],a.sub([],re,y._camera.position))},H=y.screenPointToMercatorRay(y.centerPoint);if(se.dir[2]<0){const le=a.altitudeFromMercatorZ(re[2],re[1]),he=y.rayIntersectionCoordinate(y.pointRayIntersection(y.centerPoint,le)),ke=y.zoomDeltaToMovement(w(he),I)*(H.dir[2]/se.dir[2]);a.scale(ne,se.dir,ke)}else if(y._terrainEnabled()){const le=y.zoomDeltaToMovement(re,I);a.scale(ne,se.dir,le)}}const q=a.add(K,K,ne);y._translateCameraConstrained(q),I&&Math.abs(y.zoom-Z)>1e-4&&y.recenterOnTerrain(),y.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(c,f,!0)}_fireEvents(r,c,f){const _=Aa(this._eventsInProgress),y=Aa(r),w={};for(const z in r){const{originalEvent:R}=r[z];this._eventsInProgress[z]||(w[`${z}start`]=R),this._eventsInProgress[z]=r[z]}!_&&y&&this._fireEvent("movestart",y.originalEvent);for(const z in w)this._fireEvent(z,w[z]);y&&this._fireEvent("move",y.originalEvent);for(const z in r){const{originalEvent:R}=r[z];this._fireEvent(z,R)}const S={};let I;for(const z in this._eventsInProgress){const{handlerName:R,originalEvent:U}=this._eventsInProgress[z];this._handlersById[R].isActive()||(delete this._eventsInProgress[z],I=c[R]||U,S[`${z}end`]=I)}for(const z in S)this._fireEvent(z,S[z]);const P=Aa(this._eventsInProgress);if(f&&(_||y)&&!P){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),R=U=>U!==0&&-this._bearingSnap<U&&U<this._bearingSnap;z?(R(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:I})):(this._map.fire(new a.Event("moveend",{originalEvent:I})),R(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,c){this._map.fire(new a.Event(r,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new Yd("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Au="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Jd extends a.Evented{constructor(r,c){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,c){return this.jumpTo({center:r},c)}panBy(r,c,f){return r=a.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,a.extend({offset:r},c),f)}panTo(r,c,f){return this.easeTo(a.extend({center:r},c),f)}getZoom(){return this.transform.zoom}setZoom(r,c){return this.jumpTo({zoom:r},c),this}zoomTo(r,c,f){return this.easeTo(a.extend({zoom:r},c),f)}zoomIn(r,c){return this.zoomTo(this.getZoom()+1,r,c),this}zoomOut(r,c){return this.zoomTo(this.getZoom()-1,r,c),this}getBearing(){return this.transform.bearing}setBearing(r,c){return this.jumpTo({bearing:r},c),this}getPadding(){return this.transform.padding}setPadding(r,c){return this.jumpTo({padding:r},c),this}rotateTo(r,c,f){return this.easeTo(a.extend({bearing:r},c),f)}resetNorth(r,c){return this.rotateTo(0,a.extend({duration:1e3},r),c),this}resetNorthPitch(r,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},r),c),this}snapToNorth(r,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,c):this}getPitch(){return this.transform.pitch}setPitch(r,c){return this.jumpTo({pitch:r},c),this}cameraForBounds(r,c){r=a.LngLatBounds.convert(r);const f=c&&c.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),f,c)}_extendCameraOptions(r){const c={top:0,bottom:0,right:0,left:0};if(typeof(r=a.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const f=r.padding;r.padding={top:f,bottom:f,right:f,left:f}}return r.padding=a.extend(c,r.padding),r}_cameraForBoxAndBearing(r,c,f,_){const y=this._extendCameraOptions(_),w=this.transform,S=w.padding,I=w.project(a.LngLat.convert(r)),P=w.project(a.LngLat.convert(c)),z=I.rotate(-a.degToRad(f)),R=P.rotate(-a.degToRad(f)),U=new a.pointGeometry(Math.max(z.x,R.x),Math.max(z.y,R.y)),W=new a.pointGeometry(Math.min(z.x,R.x),Math.min(z.y,R.y)),K=U.sub(W),Z=(w.width-(S.left+S.right+y.padding.left+y.padding.right))/K.x,ne=(w.height-(S.top+S.bottom+y.padding.top+y.padding.bottom))/K.y;if(ne<0||Z<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const q=Math.min(w.scaleZoom(w.scale*Math.min(Z,ne)),y.maxZoom),re=typeof y.offset.x=="number"?new a.pointGeometry(y.offset.x,y.offset.y):a.pointGeometry.convert(y.offset),se=new a.pointGeometry((y.padding.left-y.padding.right)/2,(y.padding.top-y.padding.bottom)/2).rotate(f*Math.PI/180),H=re.add(se).mult(w.scale/w.zoomScale(q));return{center:w.unproject(I.add(P).div(2).sub(H)),zoom:q,bearing:f}}_cameraForBox(r,c,f,_,y){const w=this._extendCameraOptions(y);f=f||0,_=_||0,r=a.LngLat.convert(r),c=a.LngLat.convert(c);const S=this.transform.clone();S.padding=w.padding;const I=this.getFreeCameraOptions(),P=new a.LngLat(.5*(r.lng+c.lng),.5*(r.lat+c.lat)),z=.5*(f+_);if(S._camera.position[2]<a.mercatorZfromAltitude(z,P.lat))return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");I.lookAtPoint(P),S.setFreeCameraOptions(I);const R=a.MercatorCoordinate.fromLngLat(r),U=a.MercatorCoordinate.fromLngLat(c),W=S.pointRayIntersection(S.centerPoint,z),K=[(Z=S.rayIntersectionCoordinate(W)).x,Z.y,Z.z];var Z;const ne=S.screenPointToMercatorRay(S.centerPoint);let q,re=0;do{const se=Math.floor(S.zoom),H=1<<se,le=Math.min(H*R.x,H*U.x),he=Math.min(H*R.y,H*U.y),ke=Math.max(H*R.x,H*U.x),Ce=Math.max(H*R.y,H*U.y),ze=new Pe([le,he,f],[ke,Ce,_]),De=We.fromInvProjectionMatrix(S.invProjMatrix,S.worldSize,se);if(ze.intersects(De)!==2){q&&(S._camera.position=a.scaleAndAdd([],S._camera.position,ne.dir,-q),S._updateStateFromCamera());break}const Ge=a.sub([],S._camera.position,K);q=.5*a.length(Ge),S._camera.position=a.scaleAndAdd([],S._camera.position,ne.dir,q);try{S._updateStateFromCamera()}catch{return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++re<10);return{center:S.center,zoom:S.zoom,bearing:S.bearing,pitch:S.pitch}}fitBounds(r,c,f){return this._fitInternal(this.cameraForBounds(r,c),c,f)}_raycastElevationBox(r,c){const f=this.transform.elevation;if(!f)return;const _=new a.pointGeometry(r.x,c.y),y=new a.pointGeometry(c.x,r.y),w=f.pointCoordinate(r);if(!w)return;const S=f.pointCoordinate(c);if(!S)return;const I=f.pointCoordinate(_);if(!I)return;const P=f.pointCoordinate(y);if(!P)return;const z=new a.MercatorCoordinate(w[0],w[1]).toLngLat(),R=new a.MercatorCoordinate(S[0],S[1]).toLngLat(),U=new a.MercatorCoordinate(I[0],I[1]).toLngLat(),W=new a.MercatorCoordinate(P[0],P[1]).toLngLat(),K=Math.min(z.lng,Math.min(R.lng,Math.min(U.lng,W.lng))),Z=Math.min(z.lat,Math.min(R.lat,Math.min(U.lat,W.lat))),ne=Math.max(z.lng,Math.max(R.lng,Math.max(U.lng,W.lng))),q=Math.max(z.lat,Math.max(R.lat,Math.max(U.lat,W.lat))),re=Math.min(w[3],Math.min(S[3],Math.min(I[3],P[3]))),se=Math.max(w[3],Math.max(S[3],Math.max(I[3],P[3])));return{minLngLat:new a.LngLat(K,Z),maxLngLat:new a.LngLat(ne,q),minAltitude:re,maxAltitude:se}}fitScreenCoordinates(r,c,f,_,y){let w,S,I,P;const z=a.pointGeometry.convert(r),R=a.pointGeometry.convert(c),U=this._raycastElevationBox(z,R);if(U)w=U.minLngLat,S=U.maxLngLat,I=U.minAltitude,P=U.maxAltitude;else{if(this.transform.anyCornerOffEdge(z,R))return this;w=this.transform.pointLocation(z),S=this.transform.pointLocation(R)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(r)),this.transform.pointLocation(a.pointGeometry.convert(c)),f,_):this._cameraForBox(w,S,I,P,_),_,y)}_fitInternal(r,c,f){return r?(delete(c=a.extend(r,c)).padding,c.linear?this.easeTo(c,f):this.flyTo(c,f)):this}jumpTo(r,c){this.stop();const f=this.transform;let _=!1,y=!1,w=!1;return"zoom"in r&&f.zoom!==+r.zoom&&(_=!0,f.zoom=+r.zoom),r.center!==void 0&&(f.center=a.LngLat.convert(r.center)),"bearing"in r&&f.bearing!==+r.bearing&&(y=!0,f.bearing=+r.bearing),"pitch"in r&&f.pitch!==+r.pitch&&(w=!0,f.pitch=+r.pitch),r.padding==null||f.isPaddingEqual(r.padding)||(f.padding=r.padding),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),_&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),y&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),w&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))}getFreeCameraOptions(){return this.transform.projection.name!=="mercator"&&a.warnOnce(Au),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,c){const f=this.transform;if(f.projection.name!=="mercator")return void a.warnOnce(Au);this.stop();const _=f.zoom,y=f.pitch,w=f.bearing;f.setFreeCameraOptions(r);const S=_!==f.zoom,I=y!==f.pitch,P=w!==f.bearing;return this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),S&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),P&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),I&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c)),this}easeTo(r,c){this._stop(!1,r.easeId),((r=a.extend({offset:[0,0],duration:500,easing:a.ease},r)).animate===!1||!r.essential&&a.exported.prefersReducedMotion)&&(r.duration=0);const f=this.transform,_=this.getZoom(),y=this.getBearing(),w=this.getPitch(),S=this.getPadding(),I="zoom"in r?+r.zoom:_,P="bearing"in r?this._normalizeBearing(r.bearing,y):y,z="pitch"in r?+r.pitch:w,R="padding"in r?r.padding:f.padding,U=a.pointGeometry.convert(r.offset);let W=f.centerPoint.add(U);const K=f.pointLocation(W),Z=a.LngLat.convert(r.center||K);this._normalizeCenter(Z);const ne=f.project(K),q=f.project(Z).sub(ne),re=f.zoomScale(I-_);let se,H;r.around&&(se=a.LngLat.convert(r.around),H=f.locationPoint(se));const le={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||I!==_,this._rotating=this._rotating||y!==P,this._pitching=this._pitching||z!==w,this._padding=!f.isPaddingEqual(R),this._easeId=r.easeId,this._prepareEase(c,r.noMoveStart,le),this._ease(he=>{if(this._zooming&&(f.zoom=a.number(_,I,he)),this._rotating&&(f.bearing=a.number(y,P,he)),this._pitching&&(f.pitch=a.number(w,z,he)),this._padding&&(f.interpolatePadding(S,R,he),W=f.centerPoint.add(U)),se)f.setLocationAtPoint(se,H);else{const ke=f.zoomScale(f.zoom-_),Ce=I>_?Math.min(2,re):Math.max(.5,re),ze=Math.pow(Ce,1-he),De=f.unproject(ne.add(q.mult(he*ze)).mult(ke));f.setLocationAtPoint(f.renderWorldCopies?De.wrap():De,W)}this._fireMoveEvents(c)},he=>{f.recenterOnTerrain(),this._afterEase(c,he)},r),this}_prepareEase(r,c,f={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||f.moving||this.fire(new a.Event("movestart",r)),this._zooming&&!f.zooming&&this.fire(new a.Event("zoomstart",r)),this._rotating&&!f.rotating&&this.fire(new a.Event("rotatestart",r)),this._pitching&&!f.pitching&&this.fire(new a.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new a.Event("move",r)),this._zooming&&this.fire(new a.Event("zoom",r)),this._rotating&&this.fire(new a.Event("rotate",r)),this._pitching&&this.fire(new a.Event("pitch",r))}_afterEase(r,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId,this.transform.cameraElevationReference="ground";const f=this._zooming,_=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new a.Event("zoomend",r)),_&&this.fire(new a.Event("rotateend",r)),y&&this.fire(new a.Event("pitchend",r)),this.fire(new a.Event("moveend",r))}flyTo(r,c){if(!r.essential&&a.exported.prefersReducedMotion){const He=a.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(He,c)}this.stop(),r=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},r);const f=this.transform,_=this.getZoom(),y=this.getBearing(),w=this.getPitch(),S=this.getPadding(),I="zoom"in r?a.clamp(+r.zoom,f.minZoom,f.maxZoom):_,P="bearing"in r?this._normalizeBearing(r.bearing,y):y,z="pitch"in r?+r.pitch:w,R="padding"in r?r.padding:f.padding,U=f.zoomScale(I-_),W=a.pointGeometry.convert(r.offset);let K=f.centerPoint.add(W);const Z=f.pointLocation(K),ne=a.LngLat.convert(r.center||Z);this._normalizeCenter(ne);const q=f.project(Z),re=f.project(ne).sub(q);let se=r.curve;const H=Math.max(f.width,f.height),le=H/U,he=re.mag();if("minZoom"in r){const He=a.clamp(Math.min(r.minZoom,_,I),f.minZoom,f.maxZoom),lt=H/f.zoomScale(He-_);se=Math.sqrt(lt/he*2)}const ke=se*se;function Ce(He){const lt=(le*le-H*H+(He?-1:1)*ke*ke*he*he)/(2*(He?le:H)*ke*he);return Math.log(Math.sqrt(lt*lt+1)-lt)}function ze(He){return(Math.exp(He)-Math.exp(-He))/2}function De(He){return(Math.exp(He)+Math.exp(-He))/2}const Ge=Ce(0);let Me=function(He){return De(Ge)/De(Ge+se*He)},qe=function(He){return H*((De(Ge)*(ze(lt=Ge+se*He)/De(lt))-ze(Ge))/ke)/he;var lt},Se=(Ce(1)-Ge)/se;if(Math.abs(he)<1e-6||!isFinite(Se)){if(Math.abs(H-le)<1e-6)return this.easeTo(r,c);const He=le<H?-1:1;Se=Math.abs(Math.log(le/H))/se,qe=function(){return 0},Me=function(lt){return Math.exp(He*se*lt)}}return r.duration="duration"in r?+r.duration:1e3*Se/("screenSpeed"in r?+r.screenSpeed/se:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=y!==P,this._pitching=z!==w,this._padding=!f.isPaddingEqual(R),this._prepareEase(c,!1),this._ease(He=>{const lt=He*Se,yt=1/Me(lt);f.zoom=He===1?I:_+f.scaleZoom(yt),this._rotating&&(f.bearing=a.number(y,P,He)),this._pitching&&(f.pitch=a.number(w,z,He)),this._padding&&(f.interpolatePadding(S,R,He),K=f.centerPoint.add(W));const vt=He===1?ne:f.unproject(q.add(re.mult(qe(lt))).mult(yt));f.setLocationAtPoint(f.renderWorldCopies?vt.wrap():vt,K),f._updateCenterElevation(),this._fireMoveEvents(c)},()=>this._afterEase(c),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,c)}if(!r){const f=this.handlers;f&&f.stop(!1)}return this}_ease(r,c,f){f.animate===!1||f.duration===0?(r(1),c()):(this._easeStart=a.exported.now(),this._easeOptions=f,this._onEaseFrame=r,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,c){r=a.wrap(r,-180,180);const f=Math.abs(r-c);return Math.abs(r-360-c)<f&&(r-=360),Math.abs(r+360-c)<f&&(r+=360),r}_normalizeCenter(r){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const f=r.lng-c.center.lng;r.lng+=f>180?-360:f<-180?360:0}}class Mu{constructor(r={}){this.options=r,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const c=this.options&&this.options.compact;return this._map=r,this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=F.create("button","mapboxgl-ctrl-attrib-button",this._container),F.create("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden",!0),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=F.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){F.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,c){const f=this._map._getUIString(`AttributionControl.${c}`);r.setAttribute("aria-label",f),r.firstElementChild&&r.firstElementChild.setAttribute("title",f)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(r){const f=c.reduce((_,y,w)=>(y.value&&(_+=`${y.key}=${y.value}${w<c.length-1?"&":""}`),_),"?");r.href=`${a.config.FEEDBACK_URL}/${f}${this._map._hash?this._map._hash.getHashString(!0):""}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const c=this._map.style._sourceCaches;for(const _ in c){const y=c[_];if(y.used){const w=y.getSource();w.attribution&&r.indexOf(w.attribution)<0&&r.push(w.attribution)}}r.sort((_,y)=>_.length-y.length),r=r.filter((_,y)=>{for(let w=y+1;w<r.length;w++)if(r[w].indexOf(_)>=0)return!1;return!0});const f=r.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,r.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Pu{constructor(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)}onAdd(r){this._map=r,this._container=F.create("div","mapboxgl-ctrl");const c=F.create("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){F.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const c in r){const f=r[c].getSource();if(f.hasOwnProperty("mapbox_logo")&&!f.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const c=r[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class zu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const c=++this._id;return this._queue.push({callback:r,id:c,cancelled:!1}),c}remove(r){const c=this._currentlyRunning,f=c?this._queue.concat(c):this._queue;for(const _ of f)if(_.id===r)return void(_.cancelled=!0)}run(r=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const f of c)if(!f.cancelled&&(f.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Du(d,r,c){if(d=new a.LngLat(d.lng,d.lat),r){const f=new a.LngLat(d.lng-360,d.lat),_=new a.LngLat(d.lng+360,d.lat),y=360*Math.ceil(Math.abs(d.lng-c.center.lng)/360),w=c.locationPoint(d).distSqr(r),S=r.x<0||r.y<0||r.x>c.width||r.y>c.height;c.locationPoint(f).distSqr(r)<w&&(S||Math.abs(f.lng-c.center.lng)<y)?d=f:c.locationPoint(_).distSqr(r)<w&&(S||Math.abs(_.lng-c.center.lng)<y)&&(d=_)}for(;Math.abs(d.lng-c.center.lng)>180;){const f=c.locationPoint(d);if(f.x>=0&&f.y>=0&&f.x<=c.width&&f.y<=c.height)break;d.lng>c.center.lng?d.lng-=360:d.lng+=360}return d}const Hl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ma extends a.Evented{constructor(r,c){if(super(),(r instanceof a.window.HTMLElement||c)&&(r=a.extend({element:r},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=a.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=F.create("div"),this._element.setAttribute("aria-label","Map marker");const _=F.createNS("http://www.w3.org/2000/svg","svg"),y=41,w=27;_.setAttributeNS(null,"display","block"),_.setAttributeNS(null,"height",`${y}px`),_.setAttributeNS(null,"width",`${w}px`),_.setAttributeNS(null,"viewBox",`0 0 ${w} ${y}`);const S=F.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");const I=F.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill-rule","nonzero");const P=F.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"transform","translate(3.0, 29.0)"),P.setAttributeNS(null,"fill","#000000");const z=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const se of z){const H=F.createNS("http://www.w3.org/2000/svg","ellipse");H.setAttributeNS(null,"opacity","0.04"),H.setAttributeNS(null,"cx","10.5"),H.setAttributeNS(null,"cy","5.80029008"),H.setAttributeNS(null,"rx",se.rx),H.setAttributeNS(null,"ry",se.ry),P.appendChild(H)}const R=F.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill",this._color);const U=F.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),R.appendChild(U);const W=F.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"fill","#000000");const K=F.createNS("http://www.w3.org/2000/svg","path");K.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),W.appendChild(K);const Z=F.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Z.setAttributeNS(null,"fill","#FFFFFF");const ne=F.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");const q=F.createNS("http://www.w3.org/2000/svg","circle");q.setAttributeNS(null,"fill","#000000"),q.setAttributeNS(null,"opacity","0.25"),q.setAttributeNS(null,"cx","5.5"),q.setAttributeNS(null,"cy","5.5"),q.setAttributeNS(null,"r","5.4999962");const re=F.createNS("http://www.w3.org/2000/svg","circle");re.setAttributeNS(null,"fill","#FFFFFF"),re.setAttributeNS(null,"cx","5.5"),re.setAttributeNS(null,"cy","5.5"),re.setAttributeNS(null,"r","5.4999962"),ne.appendChild(q),ne.appendChild(re),I.appendChild(P),I.appendChild(R),I.appendChild(W),I.appendChild(Z),I.appendChild(ne),_.appendChild(I),_.setAttributeNS(null,"height",y*this._scale+"px"),_.setAttributeNS(null,"width",w*this._scale+"px"),this._element.appendChild(_),this._offset=a.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",_=>{_.preventDefault()}),this._element.addEventListener("mousedown",_=>{_.preventDefault()});const f=this._element.classList;for(const _ in Hl)f.remove(`mapboxgl-marker-anchor-${_}`);f.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),F.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=a.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const c=38.1,f=13.5,_=Math.sqrt(Math.pow(f,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-c],"bottom-left":[_,-1*(c-f+_)],"bottom-right":[-_,-1*(c-f+_)],left:[f,-1*(c-f)],right:[-f,-1*(c-f)]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const c=r.code,f=r.charCode||r.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()}_onMapClick(r){const c=r.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const r=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(r))return void this._clearFadeTimer();const c=this._map.unproject(r);let f=!1;if(this._map.transform._terrainEnabled()&&this._map.getTerrain()){const y=this._map.getFreeCameraOptions();if(y.position){const w=y.position.toLngLat();f=w.distanceTo(c)<.9*w.distanceTo(this._lngLat)}}const _=(1-this._map._queryFogOpacity(c))*(f?.2:1);this._element.style.opacity=`${_}`,this._popup&&this._popup._setOpacity(`${_}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(r){const c=this._map.transform;return!!r&&r.x>=0&&r.x<c.width&&r.y>=0&&r.y<c.height}_update(r){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Du(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(c=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let f="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?f="rotateX(0deg)":this._pitchAlignment==="map"&&(f=`rotateX(${this._map.getPitch()}deg)`),r&&r.type!=="moveend"||(this._pos=this._pos.round()),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&F.setTransform(this._element,`${Hl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${f} ${c}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})}_transformedOffset(){if(!this._defaultMarker)return this._offset;const r=this._map.transform,c=this._offset.mult(this._scale);return this._rotationAlignment==="map"&&c._rotate(r.angle),this._pitchAlignment==="map"&&(c.y*=Math.cos(r._pitch)),c}getOffset(){return this._offset}setOffset(r){return this._offset=a.pointGeometry.convert(r),this._update(),this}_onMove(r){if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(r){this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Qd{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const c=a.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,c,f){this._start=this.getValue(c),this._end=r,this._startTime=c,this._endTime=c+f}}const ep={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},{HTMLImageElement:Pa,HTMLElement:tp,ImageBitmap:mo}=a.window,np={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function za(d){d.parentNode&&d.parentNode.removeChild(d)}const rp={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ru{constructor(r,c,f=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Gi({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,f&&(this.mousePitch=new qo({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),F.addEventListener(c,"mousedown",this.mousedown),F.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),F.addEventListener(c,"touchmove",this.touchmove),F.addEventListener(c,"touchend",this.touchend),F.addEventListener(c,"touchcancel",this.reset)}down(r,c){this.mouseRotate.mousedown(r,c),this.mousePitch&&this.mousePitch.mousedown(r,c),F.disableDrag()}move(r,c){const f=this.map,_=this.mouseRotate.mousemoveWindow(r,c);if(_&&_.bearingDelta&&f.setBearing(f.getBearing()+_.bearingDelta),this.mousePitch){const y=this.mousePitch.mousemoveWindow(r,c);y&&y.pitchDelta&&f.setPitch(f.getPitch()+y.pitchDelta)}}off(){const r=this.element;F.removeEventListener(r,"mousedown",this.mousedown),F.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),F.removeEventListener(r,"touchmove",this.touchmove),F.removeEventListener(r,"touchend",this.touchend),F.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){F.enableDrag(),F.removeEventListener(a.window,"mousemove",this.mousemove),F.removeEventListener(a.window,"mouseup",this.mouseup)}mousedown(r){this.down(a.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),F.mousePos(this.element,r)),F.addEventListener(a.window,"mousemove",this.mousemove),F.addEventListener(a.window,"mouseup",this.mouseup)}mousemove(r){this.move(r,F.mousePos(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=F.touchPos(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=F.touchPos(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Lu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let go,Xl=0,Da=!1;const Ou={maxWidth:100,unit:"metric"};function Bu(d,r,c){const f=c&&c.maxWidth||100,_=d._container.getBoundingClientRect().height/2,y=d.unproject([0,_]),w=d.unproject([f,_]),S=y.distanceTo(w);if(c&&c.unit==="imperial"){const I=3.2808*S;I>5280?As(r,f,I/5280,d._getUIString("ScaleControl.Miles"),d):As(r,f,I,d._getUIString("ScaleControl.Feet"),d)}else c&&c.unit==="nautical"?As(r,f,S/1852,d._getUIString("ScaleControl.NauticalMiles"),d):S>=1e3?As(r,f,S/1e3,d._getUIString("ScaleControl.Kilometers"),d):As(r,f,S,d._getUIString("ScaleControl.Meters"),d)}function As(d,r,c,f,_){const y=function(S){const I=Math.pow(10,`${Math.floor(S)}`.length-1);let P=S/I;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(z){const R=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*R)/R}(P),I*P}(c),w=y/c;_._requestDomTask(()=>{d.style.width=r*w+"px",d.innerHTML=`${y}&nbsp;${f}`})}const Dm={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Rm=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Ms={version:a.version,supported:A,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Jd{constructor(d){if((d=a.extend({},np,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Tu(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._optimizeForTerrain=d.optimizeForTerrain,this._renderTaskQueue=new zu,this._domRenderTaskQueue=new zu,this._controls=[],this._markers=[],this._mapId=a.uniqueId(),this._locale=a.extend({},ep,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new Qd(0),this._requestManager=new a.RequestManager(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,typeof d.container=="string"){if(this._container=a.window.document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof tp))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Wl(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),this._hash=d.hash&&new Nl(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,a.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),d.attributionControl&&this.addControl(new Mu({customAttribution:d.customAttribution})),this._logoControl=new Pu,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new a.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new a.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(d,r){if(r===void 0&&(r=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=d.onAdd(this);this._controls.push(d);const f=this._controlPositions[r];return r.indexOf("bottom")!==-1?f.insertBefore(c,f.firstChild):f.appendChild(c),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(d);return r>-1&&this._controls.splice(r,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){const[r,c]=this._containerDimensions();if(r===this.transform.width&&c===this.transform.height)return this;this._resizeCanvas(r,c),this.transform.resize(r,c),this.painter.resize(Math.ceil(r),Math.ceil(c));const f=!this._moving;return f&&this.fire(new a.Event("movestart",d)).fire(new a.Event("move",d)),this.fire(new a.Event("resize",d)),f&&this.fire(new a.Event("moveend",d)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(a.LngLatBounds.convert(d)),this._update()}setMinZoom(d){if((d=d==null?-2:d)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d==null?22:d)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d==null?0:d)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d==null?85:d)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this._update()}getProjection(){return this.transform.getProjection()}setProjection(d){this._lazyInitEmptyStyle(),typeof d=="string"&&(d={name:d}),this._runtimeProjection=d,this.style.updateProjection()}project(d){return this.transform.locationPoint3D(a.LngLat.convert(d))}unproject(d){return this.transform.pointLocation3D(a.pointGeometry.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(d,r,c){if(d==="mouseenter"||d==="mouseover"){let f=!1;const _=w=>{const S=r.filter(P=>this.getLayer(P)),I=S.length?this.queryRenderedFeatures(w.point,{layers:S}):[];I.length?f||(f=!0,c.call(this,new Pr(d,this,w.originalEvent,{features:I}))):f=!1},y=()=>{f=!1};return{layers:new Set(r),listener:c,delegates:{mousemove:_,mouseout:y}}}if(d==="mouseleave"||d==="mouseout"){let f=!1;const _=w=>{const S=r.filter(I=>this.getLayer(I));(S.length?this.queryRenderedFeatures(w.point,{layers:S}):[]).length?f=!0:f&&(f=!1,c.call(this,new Pr(d,this,w.originalEvent)))},y=w=>{f&&(f=!1,c.call(this,new Pr(d,this,w.originalEvent)))};return{layers:new Set(r),listener:c,delegates:{mousemove:_,mouseout:y}}}{const f=_=>{const y=r.filter(S=>this.getLayer(S)),w=y.length?this.queryRenderedFeatures(_.point,{layers:y}):[];w.length&&(_.features=w,c.call(this,_),delete _.features)};return{layers:new Set(r),listener:c,delegates:{[d]:f}}}}on(d,r,c){if(c===void 0)return super.on(d,r);Array.isArray(r)||(r=[r]);const f=this._createDelegatedListener(d,r,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(f);for(const _ in f.delegates)this.on(_,f.delegates[_]);return this}once(d,r,c){if(c===void 0)return super.once(d,r);Array.isArray(r)||(r=[r]);const f=this._createDelegatedListener(d,r,c);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(d,r,c){if(c===void 0)return super.off(d,r);r=new Set(Array.isArray(r)?r:[r]);const f=(y,w)=>{if(y.size!==w.size)return!1;for(const S of y)if(!w.has(S))return!1;return!0},_=this._delegatedListeners?this._delegatedListeners[d]:void 0;return _&&(y=>{for(let w=0;w<y.length;w++){const S=y[w];if(S.listener===c&&f(S.layers,r)){for(const I in S.delegates)this.off(I,S.delegates[I]);return y.splice(w,1),this}}})(_),this}queryRenderedFeatures(d,r){return this.style?(r!==void 0||d===void 0||d instanceof a.pointGeometry||Array.isArray(d)||(r=d,d=void 0),this.style.queryRenderedFeatures(d=d||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(d,r){return this.style.querySourceFeatures(d,r)}queryTerrainElevation(d,r){const c=this.transform.elevation;return c?(r=a.extend({},{exaggerated:!0},r),c.getAtPoint(a.MercatorCoordinate.fromLngLat(d),null,r.exaggerated)):null}setStyle(d,r){return(r=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&d?(this._diffStyle(d,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(d,r))}_getUIString(d){const r=this._locale[d];if(r==null)throw new Error(`Missing UI string '${d}'`);return r}_updateStyle(d,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),d&&(this.style=new ni(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ni(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,r){if(typeof d=="string"){const c=this._requestManager.normalizeStyleURL(d),f=this._requestManager.transformRequest(c,a.ResourceType.Style);a.getJSON(f,(_,y)=>{_?this.fire(new a.ErrorEvent(_)):y&&this._updateDiff(y,r)})}else typeof d=="object"&&this._updateDiff(d,r)}_updateDiff(d,r){try{this.style.setState(d)&&this._update(!0)}catch(c){a.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(d,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(d,r){return this._lazyInitEmptyStyle(),this.style.addSource(d,r),this._update(!0)}isSourceLoaded(d){const r=this.style&&this.style._getSourceCaches(d);if(r.length!==0)return r.every(c=>c.loaded());this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${d}'`)))}areTilesLoaded(){const d=this.style&&this.style._sourceCaches;for(const r in d){const c=d[r]._tiles;for(const f in c){const _=c[f];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(d,r,c){return this._lazyInitEmptyStyle(),this.style.addSourceType(d,r,c)}removeSource(d){return this.style.removeSource(d),this._updateTerrain(),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,r,{pixelRatio:c=1,sdf:f=!1,stretchX:_,stretchY:y,content:w}={}){if(this._lazyInitEmptyStyle(),r instanceof Pa||mo&&r instanceof mo){const{width:S,height:I,data:P}=a.exported.getImageData(r);this.style.addImage(d,{data:new a.RGBAImage({width:S,height:I},P),pixelRatio:c,stretchX:_,stretchY:y,content:w,sdf:f,version:0})}else{if(r.width===void 0||r.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:S,height:I,data:P}=r,z=r;this.style.addImage(d,{data:new a.RGBAImage({width:S,height:I},new Uint8Array(P)),pixelRatio:c,stretchX:_,stretchY:y,content:w,sdf:f,version:0,userImage:z}),z.onAdd&&z.onAdd(this,d)}}}updateImage(d,r){const c=this.style.getImage(d);if(!c)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=r instanceof Pa||mo&&r instanceof mo?a.exported.getImageData(r):r,{width:_,height:y,data:w}=f;return _===void 0||y===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):_!==c.data.width||y!==c.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(c.data.replace(w,!(r instanceof Pa||mo&&r instanceof mo)),void this.style.updateImage(d,c))}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,r){a.getImage(this._requestManager.transformRequest(d,a.ResourceType.Image),(c,f)=>{r(c,f instanceof Pa?a.exported.getImageData(f):f)})}listImages(){return this.style.listImages()}addLayer(d,r){return this._lazyInitEmptyStyle(),this.style.addLayer(d,r),this._update(!0)}moveLayer(d,r){return this.style.moveLayer(d,r),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,r,c){return this.style.setLayerZoomRange(d,r,c),this._update(!0)}setFilter(d,r,c={}){return this.style.setFilter(d,r,c),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,r,c,f={}){return this.style.setPaintProperty(d,r,c,f),this._update(!0)}getPaintProperty(d,r){return this.style.getPaintProperty(d,r)}setLayoutProperty(d,r,c,f={}){return this.style.setLayoutProperty(d,r,c,f),this._update(!0)}getLayoutProperty(d,r){return this.style.getLayoutProperty(d,r)}setLight(d,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(d){return this._lazyInitEmptyStyle(),this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(d),this.transform):0}setFeatureState(d,r){return this.style.setFeatureState(d,r),this._update()}removeFeatureState(d,r){return this.style.removeFeatureState(d,r),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}_containerDimensions(){let d=0,r=0;return this._container&&(d=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300),[d,r]}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=F.create("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=F.create("div","mapboxgl-canvas-container",d);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=F.create("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const c=this._containerDimensions();this._resizeCanvas(c[0],c[1]);const f=this._controlContainer=F.create("div","mapboxgl-control-container",d),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{_[y]=F.create("div",`mapboxgl-ctrl-${y}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,r){const c=a.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(d),this._canvas.height=c*Math.ceil(r),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${r}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const r=this._markers.indexOf(d);r!==-1&&this._markers.splice(r,1)}_setupPainter(){const d=a.extend({},A.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);r?(a.storeAuthState(r,!0),this.painter=new zd(r,this.transform),this.on("data",c=>{c.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(r)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let r;const c=this.painter.context.extTimerQuery,f=a.exported.now();this.listens("gpu-timing-frame")&&(r=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,r));let _=this._updateAverageElevation(f);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;let y=!1;const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,P=this.transform.pitch,z=a.exported.now();this.style.zoomHistory.update(I,z);const R=new a.EvaluationParameters(I,{now:z,fadeDuration:w,pitch:P,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),U=R.crossFadingFactor();U===1&&U===this._crossFadingFactor||(y=!0,this._crossFadingFactor=U),this.style.update(R)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||y)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const I=a.exported.now()-f;c.endQueryEXT(c.TIME_ELAPSED_EXT,r),setTimeout(()=>{const P=c.getQueryObjectEXT(r,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(r),this.fire(new a.Event("gpu-timing-frame",{cpuTime:I,gpuTime:P}))},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const P=this.painter.queryGpuTimers(I);this.fire(new a.Event("gpu-timing-layer",{layerTimes:P}))},50)}const S=this._sourcesDirty||this._styleDirty||this._placementDirty||_;if(S||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(_=this._updateAverageElevation(f,!0)),_)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const P=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:P})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||S||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const d of this._markers)d._update()}_updateAverageElevation(d,r=!1){const c=f=>(this.transform.averageElevation=f,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);if((r||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const f=this.transform.averageElevation;let _=this.transform.sampleAverageElevation();isNaN(_)?_=0:this._averageElevationLastSampledAt=d;const y=Math.abs(f-_);if(y>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(_),c(_);this._averageElevation.easeTo(_,d,300)}else if(y>1e-4)return this._averageElevation.jumpTo(_),c(_)}return!!this._averageElevation.isEasing(d)&&c(this._averageElevation.getValue(d))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===a.AUTH_ERR_MSG||d.status===401)){const r=this.painter.context.gl;a.storeAuthState(r,!1),this._logoControl instanceof Pu&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const c=this.painter.context.gl,f=c.createFramebuffer();function _(y){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,y,0);const w=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,w),w}return c.bindFramebuffer(c.FRAMEBUFFER,f),this._canvasPixelComparison(_(d),r.canvasCopies.map(_),r.timeStamps)}_canvasPixelComparison(d,r,c){let f=c[1]-c[0];const _=d.length/4;for(let y=0;y<r.length;y++){const w=r[y];let S=0;for(let I=0;I<w.length;I+=4)w[I]===d[I]&&w[I+1]===d[I+1]&&w[I+2]===d[I+2]&&w[I+3]===d[I+3]&&(S+=1);f+=(c[y+2]-c[y+1])*(1-S/_)}return f}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.clearWorkerCaches(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),za(this._canvasContainer),za(this._controlContainer),za(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=a.exported.frame(r=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(r)}))}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}_setCacheLimits(d,r){a.setCacheLimits(d,r)}get version(){return a.version}},NavigationControl:class{constructor(d){this.options=a.extend({},rp,d),this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),F.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),F.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=F.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const d=this._map.getZoom(),r=d===this._map.getMaxZoom(),c=d===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())}_rotateCompassArrow(){const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=d)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ru(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){F.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(d,r){const c=F.create("button",d,this._container);return c.type="button",c.addEventListener("click",r),c}_setButtonTitle(d,r){const c=this._map._getUIString(`NavigationControl.${r}`);d.setAttribute("aria-label",c),d.firstElementChild&&d.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends a.Evented{constructor(d){super(),this.options=a.extend({},Lu,d),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=Su(this._updateMarkerRotation,20)}onAdd(d){var r;return this._map=d,this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,go!==void 0?r(go):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(c=>{go=c.state!=="denied",r(go)}):(go=!!a.window.navigator.geolocation,r(go)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),F.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Xl=0,Da=!1}_isOutOfMapMaxBounds(d){const r=this._map.getMaxBounds(),c=d.coords;return r&&(c.longitude<r.getWest()||c.longitude>r.getEast()||c.latitude<r.getSouth()||c.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",d)),this._finish()}}_updateCamera(d){const r=new a.LngLat(d.coords.longitude,d.coords.latitude),c=d.coords.accuracy,f=this._map.getBearing(),_=a.extend({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(c),_,{geolocateSource:!0})}_updateMarker(d){if(d){const r=new a.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map._container.getBoundingClientRect().height/2,r=this._map.unproject([0,d]),c=this._map.unproject([100,d]),f=r.distanceTo(c)/100,_=Math.ceil(2*this._accuracy/f);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&Da)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=F.create("button","mapboxgl-ctrl-geolocate",this._container),F.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",d===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F.create("div","mapboxgl-user-location"),this._dotElement.appendChild(F.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(F.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ma({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=F.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ma({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:d.absolute===!0&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Xl--,Da=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Xl++,Xl>1?(d={maximumAge:6e5,timeout:0},Da=!0):(d=this.options.positionOptions,Da=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&d()}).catch(console.error):d()}_clearWatch(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Mu,ScaleControl:class{constructor(d){this.options=a.extend({},Ou,d),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Bu(this._map,this._container,this.options)}onAdd(d){return this._map=d,this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){F.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(d){this.options.unit=d,Bu(this._map,this._container,this.options)}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof a.window.HTMLElement?this._container=d.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){F.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=F.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);F.create("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden",!0),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(d){super(),this.options=a.extend(Object.create(Dm),d),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&F.remove(this._content),this._container&&(F.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=a.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(a.window.document.createTextNode(d))}setHTML(d){const r=a.window.document.createDocumentFragment(),c=a.window.document.createElement("body");let f;for(c.innerHTML=d;f=c.firstChild,f;)r.appendChild(f);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=F.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._container&&this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._container&&this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let r;return this._classList.delete(d)?r=!1:(this._classList.add(d),r=!0),this._container&&this._updateClassList(),r}_createCloseButton(){this.options.closeButton&&(this._closeButton=F.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.setAttribute("aria-hidden","true"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(d){this._update(d.point)}_onMouseMove(d){this._update(d.point)}_onDrag(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const r=this._pos,c=this._container.offsetWidth,f=this._container.offsetHeight;let _;return _=r.y+d.bottom.y<f?["top"]:r.y>this._map.transform.height-f?["bottom"]:[],r.x<c/2?_.push("left"):r.x>this._map.transform.width-c/2&&_.push("right"),_.length===0?"bottom":_.join("-")}_updateClassList(){const d=[...this._classList];d.push("mapboxgl-popup"),this._anchor&&d.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&d.push("mapboxgl-popup-track-pointer"),this._container.className=d.join(" ")}_update(d){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=F.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=F.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Du(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||d){const r=this._pos=this._trackPointer&&d?d:this._map.project(this._lngLat),c=function(y){if(y||(y=new a.pointGeometry(0,0)),typeof y=="number"){const w=Math.round(Math.sqrt(.5*Math.pow(y,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,y),"top-left":new a.pointGeometry(w,w),"top-right":new a.pointGeometry(-w,w),bottom:new a.pointGeometry(0,-y),"bottom-left":new a.pointGeometry(w,-w),"bottom-right":new a.pointGeometry(-w,-w),left:new a.pointGeometry(y,0),right:new a.pointGeometry(-y,0)}}if(y instanceof a.pointGeometry||Array.isArray(y)){const w=a.pointGeometry.convert(y);return{center:w,top:w,"top-left":w,"top-right":w,bottom:w,"bottom-left":w,"bottom-right":w,left:w,right:w}}return{center:a.pointGeometry.convert(y.center||[0,0]),top:a.pointGeometry.convert(y.top||[0,0]),"top-left":a.pointGeometry.convert(y["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(y["top-right"]||[0,0]),bottom:a.pointGeometry.convert(y.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(y["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(y["bottom-right"]||[0,0]),left:a.pointGeometry.convert(y.left||[0,0]),right:a.pointGeometry.convert(y.right||[0,0])}}(this.options.offset),f=this._anchor=this._getAnchor(c),_=r.add(c[f]).round();this._map._requestDomTask(()=>{this._container&&f&&F.setTransform(this._container,`${Hl[f]} translate(${_.x}px,${_.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(Rm);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._content&&(this._content.style.opacity=d),this._tip&&(this._tip.style.opacity=d)}},Marker:Ma,Style:ni,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:wu,Evented:a.Evented,config:a.config,prewarm:function(){Je().acquire(de)},clearPrewarmedResources:function(){const d=Fe;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(de),Fe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(d){a.config.ACCESS_TOKEN=d},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(d){a.config.API_URL=d},get workerCount(){return Ee.workerCount},set workerCount(d){Ee.workerCount=d},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){a.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){a.clearTileCache(d)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return Ms});var E=g;return E})})(Nw);var GL=Nw.exports,qf={exports:{}},Qh={};/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gA=te.exports,jw=60103;Qh.Fragment=60107;if(typeof Symbol=="function"&&Symbol.for){var Vw=Symbol.for;jw=Vw("react.element"),Qh.Fragment=Vw("react.fragment")}var _A=gA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yA=Object.prototype.hasOwnProperty,vA={key:!0,ref:!0,__self:!0,__source:!0};function Gw(t,n,s){var h,g={},x=null,E=null;s!==void 0&&(x=""+s),n.key!==void 0&&(x=""+n.key),n.ref!==void 0&&(E=n.ref);for(h in n)yA.call(n,h)&&!vA.hasOwnProperty(h)&&(g[h]=n[h]);if(t&&t.defaultProps)for(h in n=t.defaultProps,n)g[h]===void 0&&(g[h]=n[h]);return{$$typeof:jw,type:t,key:x,ref:E,props:g,_owner:_A.current}}Qh.jsx=Gw;Qh.jsxs=Gw;qf.exports=Qh;const Be=qf.exports.jsx,Ft=qf.exports.jsxs,rl=qf.exports.Fragment;function xA(t,n,s){s===void 0&&(s={});var h={type:"Feature"};return(s.id===0||s.id)&&(h.id=s.id),s.bbox&&(h.bbox=s.bbox),h.properties=n||{},h.geometry=t,h}function bA(t,n,s){s===void 0&&(s={});for(var h=0,g=t;h<g.length;h++){var x=g[h];if(x.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var E=0;E<x[x.length-1].length;E++)if(x[x.length-1][E]!==x[0][E])throw new Error("First and last Position are not equivalent.")}var a={type:"Polygon",coordinates:t};return xA(a,n,s)}function wA(t,n){n===void 0&&(n={});var s={type:"FeatureCollection"};return n.id&&(s.id=n.id),n.bbox&&(s.bbox=n.bbox),s.features=t,s}function Zw(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}var EA=globalThis&&globalThis.__spreadArrays||function(){for(var t=0,n=0,s=arguments.length;n<s;n++)t+=arguments[n].length;for(var h=Array(t),g=0,n=0;n<s;n++)for(var x=arguments[n],E=0,a=x.length;E<a;E++,g++)h[g]=x[E];return h};function TA(t){return Array.isArray(t)?Ww(t):t&&t.bbox?Ww(t.bbox):[CA(),kA()]}function ZL(t,n){n===void 0&&(n={}),t==null&&(t=1),(!Zw(n.num_vertices)||n.num_vertices===void 0)&&(n.num_vertices=10),(!Zw(n.max_radial_length)||n.max_radial_length===void 0)&&(n.max_radial_length=10);for(var s=[],h=function(x){var E=[],a=EA(Array(n.num_vertices+1)).map(Math.random);a.forEach(function(A,D,V){V[D]=D>0?A+V[D-1]:A}),a.forEach(function(A){A=A*2*Math.PI/a[a.length-1];var D=Math.random();E.push([D*(n.max_radial_length||10)*Math.sin(A),D*(n.max_radial_length||10)*Math.cos(A)])}),E[E.length-1]=E[0],E=E.map(SA(TA(n.bbox))),s.push(bA([E]))},g=0;g<t;g++)h();return wA(s)}function SA(t){return function(n){return[n[0]+t[0],n[1]+t[1]]}}function qw(){return Math.random()-.5}function CA(){return qw()*360}function kA(){return qw()*180}function Ww(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}function Hw(...t){return n=>t.forEach(s=>function(h,g){typeof h=="function"?h(g):h!=null&&(h.current=g)}(s,n))}function Wf(...t){return te.exports.useCallback(Hw(...t),t)}function Fr(){return Fr=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(t[h]=s[h])}return t},Fr.apply(this,arguments)}const Xw=te.exports.forwardRef((t,n)=>{const g=t,{children:s}=g,h=kr(g,["children"]);return te.exports.Children.toArray(s).some(Yw)?te.exports.createElement(te.exports.Fragment,null,te.exports.Children.map(s,x=>Yw(x)?te.exports.createElement(Fy,Fr({},h,{ref:n}),x.props.children):x)):te.exports.createElement(Fy,Fr({},h,{ref:n}),s)});Xw.displayName="Slot";const Fy=te.exports.forwardRef((t,n)=>{const g=t,{children:s}=g,h=kr(g,["children"]);return te.exports.isValidElement(s)?te.exports.cloneElement(s,Sn(bt({},IA(h,s.props)),{ref:Hw(n,s.ref)})):te.exports.Children.count(s)>1?te.exports.Children.only(null):null});Fy.displayName="SlotClone";const Kw=({children:t})=>te.exports.createElement(te.exports.Fragment,null,t);function Yw(t){return te.exports.isValidElement(t)&&t.type===Kw}function IA(t,n){const s=bt({},n);for(const h in n){const g=t[h],x=n[h];/^on[A-Z]/.test(h)?s[h]=(...E)=>{x==null||x(...E),g==null||g(...E)}:h==="style"?s[h]=bt(bt({},g),x):h==="className"&&(s[h]=[g,x].filter(Boolean).join(" "))}return bt(bt({},t),s)}const Zc=["a","button","div","h2","h3","img","li","nav","p","span","svg","ul"].reduce((t,n)=>Sn(bt({},t),{[n]:te.exports.forwardRef((s,h)=>{const a=s,{asChild:g}=a,x=kr(a,["asChild"]),E=g?Xw:n;return te.exports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),s.as&&console.error(AA),te.exports.createElement(E,Fr({},x,{ref:h}))})}),{}),AA="Warning: The `as` prop has been removed in favour of `asChild`. For details, see https://radix-ui.com/docs/primitives/overview/styling#changing-the-rendered-element",Hf=Boolean(globalThis==null?void 0:globalThis.document)?te.exports.useLayoutEffect:()=>{},Jw=te.exports.forwardRef((t,n)=>{var s,h;const D=t,{containerRef:g,style:x}=D,E=kr(D,["containerRef","style"]),a=(s=g==null?void 0:g.current)!==null&&s!==void 0?s:globalThis==null||(h=globalThis.document)===null||h===void 0?void 0:h.body,[,A]=te.exports.useState({});return Hf(()=>{A({})},[]),a?$w.createPortal(te.exports.createElement(Zc.div,Fr({"data-radix-portal":""},E,{ref:n,style:a===document.body?bt({position:"absolute",top:0,left:0,zIndex:2147483647},x):void 0})),a):null}),MA=Jw;var Qw=Object.prototype.hasOwnProperty;function ed(t,n){var s,h;if(t===n)return!0;if(t&&n&&(s=t.constructor)===n.constructor){if(s===Date)return t.getTime()===n.getTime();if(s===RegExp)return t.toString()===n.toString();if(s===Array){if((h=t.length)===n.length)for(;h--&&ed(t[h],n[h]););return h===-1}if(!s||typeof t=="object"){h=0;for(s in t)if(Qw.call(t,s)&&++h&&!Qw.call(n,s)||!(s in n)||!ed(t[s],n[s]))return!1;return Object.keys(n).length===h}}return t!==t&&n!==n}function td(t,n){if(Object.is(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;const s=Object.keys(t);if(s.length!==Object.keys(n).length)return!1;for(let h=0;h<s.length;h++)if(!Object.prototype.hasOwnProperty.call(n,s[h])||!Object.is(t[s[h]],n[s[h]]))return!1;return!0}var Xf=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},e2=function(){function t(n,s){for(var h=0;h<s.length;h++){var g=s[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(n,g.key,g)}}return function(n,s,h){return s&&t(n.prototype,s),h&&t(n,h),n}}(),PA=function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)},zA=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:t},DA=function(){function t(n,s,h,g){Xf(this,t),this.name=n,this.fn=s,this.args=h,this.modifiers=g}return e2(t,[{key:"_test",value:function(s){var h=this.fn;try{qc(this.modifiers.slice(),h)(s)}catch{h=function(){return!1}}try{return qc(this.modifiers.slice(),h)(s)}catch{return!1}}},{key:"_check",value:function(s){try{qc(this.modifiers.slice(),this.fn)(s)}catch{if(qc(this.modifiers.slice(),function(g){return g})(!1))return}if(!qc(this.modifiers.slice(),this.fn)(s))throw null}},{key:"_testAsync",value:function(s){var h=this;return new Promise(function(g,x){n2(h.modifiers.slice(),h.fn)(s).then(function(E){E?g(s):x(null)}).catch(function(E){return x(E)})})}}]),t}();function t2(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"simple";return typeof t=="object"?t[n]:t}function qc(t,n){if(t.length){var s=t.shift(),h=qc(t,n);return s.perform(h)}else return t2(n)}function n2(t,n){if(t.length){var s=t.shift(),h=n2(t,n);return s.performAsync(h)}else return function(g){return Promise.resolve(t2(n,"async")(g))}}var RA=function t(n,s,h){Xf(this,t),this.name=n,this.perform=s,this.performAsync=h},$y=function(t){PA(n,t);function n(s,h,g,x){Xf(this,n);for(var E=arguments.length,a=Array(E>4?E-4:0),A=4;A<E;A++)a[A-4]=arguments[A];var D=zA(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,a));return Error.captureStackTrace&&Error.captureStackTrace(D,n),D.rule=s,D.value=h,D.cause=g,D.target=x,D}return n}(Error),LA=function(){function t(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Xf(this,t),this.chain=n,this.nextRuleModifiers=s}return e2(t,[{key:"_applyRule",value:function(s,h){var g=this;return function(){for(var x=arguments.length,E=Array(x),a=0;a<x;a++)E[a]=arguments[a];return g.chain.push(new DA(h,s.apply(g,E),E,g.nextRuleModifiers)),g.nextRuleModifiers=[],g}}},{key:"_applyModifier",value:function(s,h){return this.nextRuleModifiers.push(new RA(h,s.simple,s.async)),this}},{key:"_clone",value:function(){return new t(this.chain.slice(),this.nextRuleModifiers.slice())}},{key:"test",value:function(s){return this.chain.every(function(h){return h._test(s)})}},{key:"testAll",value:function(s){var h=[];return this.chain.forEach(function(g){try{g._check(s)}catch(x){h.push(new $y(g,s,x))}}),h}},{key:"check",value:function(s){this.chain.forEach(function(h){try{h._check(s)}catch(g){throw new $y(h,s,g)}})}},{key:"testAsync",value:function(s){var h=this;return new Promise(function(g,x){r2(s,h.chain.slice(),g,x)})}}]),t}();function r2(t,n,s,h){if(n.length){var g=n.shift();g._testAsync(t).then(function(){r2(t,n,s,h)},function(x){h(new $y(g,t,x))})}else s(t)}function ui(){return i2(new LA)}var Kf={};ui.extend=function(t){Object.assign(Kf,t)};ui.clearCustomRules=function(){Kf={}};function i2(t){return new Proxy(t,{get:function(s,h){if(h in s)return s[h];var g=i2(t._clone());if(h in o2)return g._applyModifier(o2[h],h);if(h in Kf)return g._applyRule(Kf[h],h);if(h in s2)return g._applyRule(s2[h],h)}})}var o2={not:{simple:function(n){return function(s){return!n(s)}},async:function(n){return function(s){return Promise.resolve(n(s)).then(function(h){return!h}).catch(function(h){return!0})}}},some:{simple:function(n){return function(s){return Yf(s).some(function(h){try{return n(h)}catch{return!1}})}},async:function(n){return function(s){return Promise.all(Yf(s).map(function(h){try{return n(h).catch(function(g){return!1})}catch{return!1}})).then(function(h){return h.some(Boolean)})}}},every:{simple:function(n){return function(s){return Yf(s).every(n)}},async:function(n){return function(s){return Promise.all(Yf(s).map(n)).then(function(h){return h.every(Boolean)})}}}};function Yf(t){return typeof t=="string"?t.split(""):t}var s2={equal:function(n){return function(s){return s==n}},exact:function(n){return function(s){return s===n}},number:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function(s){return typeof s=="number"&&(n||isFinite(s))}},integer:function(){return function(n){var s=Number.isInteger||OA;return s(n)}},numeric:function(){return function(n){return!isNaN(parseFloat(n))&&isFinite(n)}},string:function(){return Wc("string")},boolean:function(){return Wc("boolean")},undefined:function(){return Wc("undefined")},null:function(){return Wc("null")},array:function(){return Wc("array")},object:function(){return Wc("object")},instanceOf:function(n){return function(s){return s instanceof n}},pattern:function(n){return function(s){return n.test(s)}},lowercase:function(){return function(n){return/^([a-z]+\s*)+$/.test(n)}},uppercase:function(){return function(n){return/^([A-Z]+\s*)+$/.test(n)}},vowel:function(){return function(n){return/^[aeiou]+$/i.test(n)}},consonant:function(){return function(n){return/^(?=[^aeiou])([a-z]+)$/i.test(n)}},first:function(n){return function(s){return s[0]==n}},last:function(n){return function(s){return s[s.length-1]==n}},empty:function(){return function(n){return n.length===0}},length:function(n,s){return function(h){return h.length>=n&&h.length<=(s||n)}},minLength:function(n){return function(s){return s.length>=n}},maxLength:function(n){return function(s){return s.length<=n}},negative:function(){return function(n){return n<0}},positive:function(){return function(n){return n>=0}},between:function(n,s){return function(h){return h>=n&&h<=s}},range:function(n,s){return function(h){return h>=n&&h<=s}},lessThan:function(n){return function(s){return s<n}},lessThanOrEqual:function(n){return function(s){return s<=n}},greaterThan:function(n){return function(s){return s>n}},greaterThanOrEqual:function(n){return function(s){return s>=n}},even:function(){return function(n){return n%2==0}},odd:function(){return function(n){return n%2!=0}},includes:function(n){return function(s){return~s.indexOf(n)}},schema:function(n){return BA(n)},passesAnyOf:function(){for(var n=arguments.length,s=Array(n),h=0;h<n;h++)s[h]=arguments[h];return function(g){return s.some(function(x){return x.test(g)})}},optional:function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function(h){return s&&typeof h=="string"&&h.trim()===""||h!=null&&n.check(h),!0}}};function Wc(t){return function(n){return Array.isArray(n)&&t==="array"||n===null&&t==="null"||typeof n===t}}function OA(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function BA(t){return{simple:function(s){var h=[];if(Object.keys(t).forEach(function(g){var x=t[g];try{x.check((s||{})[g])}catch(E){E.target=g,h.push(E)}}),h.length>0)throw h;return!0},async:function(s){var h=[],g=Object.keys(t).map(function(x){var E=t[x];return E.testAsync((s||{})[x]).catch(function(a){a.target=x,h.push(a)})});return Promise.all(g).then(function(x){if(h.length>0)throw h;return!0})}}}var _n="colors",Hr="sizes",mt="space",FA={gap:mt,gridGap:mt,columnGap:mt,gridColumnGap:mt,rowGap:mt,gridRowGap:mt,inset:mt,insetBlock:mt,insetBlockEnd:mt,insetBlockStart:mt,insetInline:mt,insetInlineEnd:mt,insetInlineStart:mt,margin:mt,marginTop:mt,marginRight:mt,marginBottom:mt,marginLeft:mt,marginBlock:mt,marginBlockEnd:mt,marginBlockStart:mt,marginInline:mt,marginInlineEnd:mt,marginInlineStart:mt,padding:mt,paddingTop:mt,paddingRight:mt,paddingBottom:mt,paddingLeft:mt,paddingBlock:mt,paddingBlockEnd:mt,paddingBlockStart:mt,paddingInline:mt,paddingInlineEnd:mt,paddingInlineStart:mt,top:mt,right:mt,bottom:mt,left:mt,scrollMargin:mt,scrollMarginTop:mt,scrollMarginRight:mt,scrollMarginBottom:mt,scrollMarginLeft:mt,scrollMarginX:mt,scrollMarginY:mt,scrollMarginBlock:mt,scrollMarginBlockEnd:mt,scrollMarginBlockStart:mt,scrollMarginInline:mt,scrollMarginInlineEnd:mt,scrollMarginInlineStart:mt,scrollPadding:mt,scrollPaddingTop:mt,scrollPaddingRight:mt,scrollPaddingBottom:mt,scrollPaddingLeft:mt,scrollPaddingX:mt,scrollPaddingY:mt,scrollPaddingBlock:mt,scrollPaddingBlockEnd:mt,scrollPaddingBlockStart:mt,scrollPaddingInline:mt,scrollPaddingInlineEnd:mt,scrollPaddingInlineStart:mt,fontSize:"fontSizes",background:_n,backgroundColor:_n,backgroundImage:_n,borderImage:_n,border:_n,borderBlock:_n,borderBlockEnd:_n,borderBlockStart:_n,borderBottom:_n,borderBottomColor:_n,borderColor:_n,borderInline:_n,borderInlineEnd:_n,borderInlineStart:_n,borderLeft:_n,borderLeftColor:_n,borderRight:_n,borderRightColor:_n,borderTop:_n,borderTopColor:_n,caretColor:_n,color:_n,columnRuleColor:_n,fill:_n,outline:_n,outlineColor:_n,stroke:_n,textDecorationColor:_n,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Hr,minBlockSize:Hr,maxBlockSize:Hr,inlineSize:Hr,minInlineSize:Hr,maxInlineSize:Hr,width:Hr,minWidth:Hr,maxWidth:Hr,height:Hr,minHeight:Hr,maxHeight:Hr,flexBasis:Hr,gridTemplateColumns:Hr,gridTemplateRows:Hr,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},$A=(t,n)=>typeof n=="function"?{"()":Function.prototype.toString.call(n)}:n,Hc=()=>{const t=Object.create(null);return(n,s,...h)=>{const g=(x=>JSON.stringify(x,$A))(n);return g in t?t[g]:t[g]=s(n,...h)}},il=Symbol.for("sxs.internal"),Ny=(t,n)=>Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)),a2=t=>{for(const n in t)return!0;return!1},{hasOwnProperty:NA}=Object.prototype,Uy=t=>t.includes("-")?t:t.replace(/[A-Z]/g,n=>"-"+n.toLowerCase()),UA=/\s+(?![^()]*\))/,Xc=t=>n=>t(...typeof n=="string"?String(n).split(UA):[n]),l2={appearance:t=>({WebkitAppearance:t,appearance:t}),backfaceVisibility:t=>({WebkitBackfaceVisibility:t,backfaceVisibility:t}),backdropFilter:t=>({WebkitBackdropFilter:t,backdropFilter:t}),backgroundClip:t=>({WebkitBackgroundClip:t,backgroundClip:t}),boxDecorationBreak:t=>({WebkitBoxDecorationBreak:t,boxDecorationBreak:t}),clipPath:t=>({WebkitClipPath:t,clipPath:t}),content:t=>({content:t.includes('"')||t.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(t)?t:`"${t}"`}),hyphens:t=>({WebkitHyphens:t,hyphens:t}),maskImage:t=>({WebkitMaskImage:t,maskImage:t}),maskSize:t=>({WebkitMaskSize:t,maskSize:t}),tabSize:t=>({MozTabSize:t,tabSize:t}),textSizeAdjust:t=>({WebkitTextSizeAdjust:t,textSizeAdjust:t}),userSelect:t=>({WebkitUserSelect:t,userSelect:t}),marginBlock:Xc((t,n)=>({marginBlockStart:t,marginBlockEnd:n||t})),marginInline:Xc((t,n)=>({marginInlineStart:t,marginInlineEnd:n||t})),maxSize:Xc((t,n)=>({maxBlockSize:t,maxInlineSize:n||t})),minSize:Xc((t,n)=>({minBlockSize:t,minInlineSize:n||t})),paddingBlock:Xc((t,n)=>({paddingBlockStart:t,paddingBlockEnd:n||t})),paddingInline:Xc((t,n)=>({paddingInlineStart:t,paddingInlineEnd:n||t}))},jy=/([\d.]+)([^]*)/,jA=(t,n)=>t.length?t.reduce((s,h)=>(s.push(...n.map(g=>g.includes("&")?g.replace(/&/g,/[ +>|~]/.test(h)&&/&.*&/.test(g)?`:is(${h})`:h):h+" "+g)),s),[]):n,VA=(t,n)=>t in GA&&typeof n=="string"?n.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(s,h,g,x)=>h+(g==="stretch"?`-moz-available${x};${Uy(t)}:${h}-webkit-fill-available`:`-moz-fit-content${x};${Uy(t)}:${h}fit-content`)+x):String(n),GA={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},ss=t=>t?t+"-":"",c2=(t,n,s)=>t.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(h,g,x,E,a)=>E=="$"==!!x?h:(g||E=="--"?"calc(":"")+"var(--"+(E==="$"?ss(n)+(a.includes("$")?"":ss(s))+a.replace(/\$/g,"-"):a)+")"+(g||E=="--"?"*"+(g||"")+(x||"1")+")":"")),ZA=/\s*,\s*(?![^()]*\))/,qA=Object.prototype.toString,Kc=(t,n,s,h,g)=>{let x,E,a;const A=(D,V,N)=>{let F,ae;const be=fe=>{for(F in fe){const X=F.charCodeAt(0)===64,me=X&&Array.isArray(fe[F])?fe[F]:[fe[F]];for(ae of me){const Te=/[A-Z]/.test(G=F)?G:G.replace(/-[^]/g,Pe=>Pe[1].toUpperCase()),We=typeof ae=="object"&&ae&&ae.toString===qA&&(!h.utils[Te]||!V.length);if(Te in h.utils&&!We){const Pe=h.utils[Te];if(Pe!==E){E=Pe,be(Pe(ae)),E=null;continue}}else if(Te in l2){const Pe=l2[Te];if(Pe!==a){a=Pe,be(Pe(ae)),a=null;continue}}if(X&&(ee=F.slice(1)in h.media?"@media "+h.media[F.slice(1)]:F,F=ee.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(Pe,Le,Ke,Ye,it,st)=>{const ut=jy.test(Le),ht=.0625*(ut?-1:1),[kt,Tt]=ut?[Ye,Le]:[Le,Ye];return"("+(Ke[0]==="="?"":Ke[0]===">"===ut?"max-":"min-")+kt+":"+(Ke[0]!=="="&&Ke.length===1?Tt.replace(jy,(Gt,nn,an)=>Number(nn)+ht*(Ke===">"?1:-1)+an):Tt)+(it?") and ("+(it[0]===">"?"min-":"max-")+kt+":"+(it.length===1?st.replace(jy,(Gt,nn,an)=>Number(nn)+ht*(it===">"?-1:1)+an):st):"")+")"})),We){const Pe=X?N.concat(F):[...N],Le=X?[...V]:jA(V,F.split(ZA));x!==void 0&&g(u2(...x)),x=void 0,A(ae,Le,Pe)}else x===void 0&&(x=[[],V,N]),F=X||F.charCodeAt(0)!==36?F:`--${ss(h.prefix)}${F.slice(1).replace(/\$/g,"-")}`,ae=We?ae:typeof ae=="number"?ae&&Te in WA?String(ae)+"px":String(ae):c2(VA(Te,ae==null?"":ae),h.prefix,h.themeMap[Te]),x[0].push(`${X?`${F} `:`${Uy(F)}:`}${ae}`)}}var ee,G};be(D),x!==void 0&&g(u2(...x)),x=void 0};A(t,n,s)},u2=(t,n,s)=>`${s.map(h=>`${h}{`).join("")}${n.length?`${n.join(",")}{`:""}${t.join(";")}${n.length?"}":""}${Array(s.length?s.length+1:0).join("}")}`,WA={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},h2=t=>String.fromCharCode(t+(t>25?39:97)),ol=t=>(n=>{let s,h="";for(s=Math.abs(n);s>52;s=s/52|0)h=h2(s%52)+h;return h2(s%52)+h})(((n,s)=>{let h=s.length;for(;h;)n=33*n^s.charCodeAt(--h);return n})(5381,JSON.stringify(t))>>>0),nd=["themed","global","styled","onevar","resonevar","allvar","inline"],HA=t=>{if(t.href&&!t.href.startsWith(location.origin))return!1;try{return t.cssRules,!0}catch{return!1}},XA=t=>{let n;const s=()=>{if(n){const{rules:E,sheet:a}=n;if(!a.deleteRule){for(;Object(Object(a.cssRules)[0]).type===3;)a.cssRules.splice(0,1);a.cssRules=[]}for(const A in E)delete E[A]}const h=Object(t).styleSheets||[];for(const E of h)if(HA(E)){for(let a=0,A=E.cssRules;A[a];++a){const D=Object(A[a]);if(D.type!==1)continue;const V=Object(A[a+1]);if(V.type!==4)continue;++a;const{cssText:N}=D;if(!N.startsWith("--sxs"))continue;const F=N.slice(14,-3).trim().split(/\s+/),ae=nd[F[0]];ae&&(n||(n={sheet:E,reset:s,rules:{}}),n.rules[ae]={group:V,index:a,cache:new Set(F)})}if(n)break}if(!n){const E=(a,A)=>({type:A,cssRules:[],insertRule(D,V){this.cssRules.splice(V,0,E(D,{import:3,undefined:1}[(D.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return a==="@media{}"?`@media{${[].map.call(this.cssRules,D=>D.cssText).join("")}}`:a}});n={sheet:t?(t.head||t).appendChild(document.createElement("style")).sheet:E("","text/css"),rules:{},reset:s,toString(){const{cssRules:a}=n.sheet;return[].map.call(a,(A,D)=>{const{cssText:V}=A;let N="";if(V.startsWith("--sxs"))return"";if(a[D-1]&&(N=a[D-1].cssText).startsWith("--sxs")){if(!A.cssRules.length)return"";for(const F in n.rules)if(n.rules[F].group===A)return`--sxs{--sxs:${[...n.rules[F].cache].join(" ")}}${V}`;return A.cssRules.length?`${N}${V}`:""}return V}).join("")}}}const{sheet:g,rules:x}=n;for(let E=nd.length-1;E>=0;--E){const a=nd[E];if(!x[a]){const A=nd[E+1],D=x[A]?x[A].index:g.cssRules.length;g.insertRule("@media{}",D),g.insertRule(`--sxs{--sxs:${E}}`,D),x[a]={group:g.cssRules[D+1],index:D,cache:new Set([E])}}KA(x[a])}};return s(),n},KA=t=>{const n=t.group;let s=n.cssRules.length;t.apply=h=>{try{n.insertRule(h,s),++s}catch{}}},rd=Symbol(),YA=Hc(),d2=(t,n)=>YA(t,()=>(...s)=>{let h={type:null,composers:new Set};for(const g of s)if(g!=null)if(g[il]){h.type==null&&(h.type=g[il].type);for(const x of g[il].composers)h.composers.add(x)}else g.constructor!==Object||g.$$typeof?h.type==null&&(h.type=g):h.composers.add(JA(g,t));return h.type==null&&(h.type="span"),h.composers.size||h.composers.add(["PJLV",{},[],[],{},[]]),QA(t,h,n)}),JA=(x,g)=>{var E=x,{variants:t,compoundVariants:n,defaultVariants:s}=E,h=kr(E,["variants","compoundVariants","defaultVariants"]);const a=`${ss(g.prefix)}c-${ol(h)}`,A=[],D=[],V=Object.create(null),N=[];for(const fe in s)V[fe]=String(s[fe]);if(typeof t=="object"&&t)for(const fe in t){F=V,ae=fe,NA.call(F,ae)||(V[fe]="undefined");const ee=t[fe];for(const G in ee){const X={[fe]:String(G)};String(G)==="undefined"&&N.push(fe);const me=ee[G],Te=[X,me,!a2(me)];A.push(Te)}}var F,ae;if(typeof n=="object"&&n)for(const fe of n){let be=fe,{css:ee}=be,G=kr(be,["css"]);ee=typeof ee=="object"&&ee||{};for(const me in G)G[me]=String(G[me]);const X=[G,ee,!a2(ee)];D.push(X)}return[a,h,A,D,V,N]},QA=(t,n,s)=>{const[h,g,x,E]=eM(n.composers),a=typeof n.type=="function"||n.type.$$typeof?(N=>{function F(){for(let ae=0;ae<F[rd].length;ae++){const[be,fe]=F[rd][ae];N.rules[be].apply(fe)}return F[rd]=[],null}return F[rd]=[],F.rules={},nd.forEach(ae=>F.rules[ae]={apply:be=>F[rd].push([ae,be])}),F})(s):null,A=(a||s).rules,D=`.${h}${g.length>1?`:where(.${g.slice(1).join(".")})`:""}`,V=N=>{N=typeof N=="object"&&N||tM;const G=N,{css:F}=G,ae=kr(G,["css"]),be={};for(const X in x)if(delete ae[X],X in N){let me=N[X];typeof me=="object"&&me?be[X]=bt({"@initial":x[X]},me):(me=String(me),be[X]=me!=="undefined"||E.has(X)?me:x[X])}else be[X]=x[X];const fe=new Set([...g]);for(const[X,me,Te,We]of n.composers){s.rules.styled.cache.has(X)||(s.rules.styled.cache.add(X),Kc(me,[`.${X}`],[],t,Ke=>{A.styled.apply(Ke)}));const Pe=p2(Te,be,t.media),Le=p2(We,be,t.media,!0);for(const Ke of Pe)if(Ke!==void 0)for(const[Ye,it,st]of Ke){const ut=`${X}-${ol(it)}-${Ye}`;fe.add(ut);const ht=(st?s.rules.resonevar:s.rules.onevar).cache,kt=st?A.resonevar:A.onevar;ht.has(ut)||(ht.add(ut),Kc(it,[`.${ut}`],[],t,Tt=>{kt.apply(Tt)}))}for(const Ke of Le)if(Ke!==void 0)for(const[Ye,it]of Ke){const st=`${X}-${ol(it)}-${Ye}`;fe.add(st),s.rules.allvar.cache.has(st)||(s.rules.allvar.cache.add(st),Kc(it,[`.${st}`],[],t,ut=>{A.allvar.apply(ut)}))}}if(typeof F=="object"&&F){const X=`${h}-i${ol(F)}-css`;fe.add(X),s.rules.inline.cache.has(X)||(s.rules.inline.cache.add(X),Kc(F,[`.${X}`],[],t,me=>{A.inline.apply(me)}))}for(const X of String(N.className||"").trim().split(/\s+/))X&&fe.add(X);const ee=ae.className=[...fe].join(" ");return{type:n.type,className:ee,selector:D,props:ae,toString:()=>ee,deferredInjector:a}};return Ny(V,{className:h,selector:D,[il]:n,toString:()=>(s.rules.styled.cache.has(h)||V(),h)})},eM=t=>{let n="";const s=[],h={},g=[];for(const[x,,,,E,a]of t){n===""&&(n=x),s.push(x),g.push(...a);for(const A in E){const D=E[A];(h[A]===void 0||D!=="undefined"||a.includes(D))&&(h[A]=D)}}return[n,s,h,new Set(g)]},p2=(t,n,s,h)=>{const g=[];e:for(let[x,E,a]of t){if(a)continue;let A,D=0,V=!1;for(A in x){const N=x[A];let F=n[A];if(F!==N){if(typeof F!="object"||!F)continue e;{let ae,be,fe=0;for(const ee in F){if(N===String(F[ee])){if(ee!=="@initial"){const G=ee.slice(1);(be=be||[]).push(G in s?s[G]:ee.replace(/^@media ?/,"")),V=!0}D+=fe,ae=!0}++fe}if(be&&be.length&&(E={["@media "+be.join(", ")]:E}),!ae)continue e}}}(g[D]=g[D]||[]).push([h?"cv":`${A}-${x[A]}`,E,V])}return g},tM={},nM=Hc(),rM=(t,n)=>nM(t,()=>(...s)=>{const h=()=>{for(let g of s){g=typeof g=="object"&&g||{};let x=ol(g);if(!n.rules.global.cache.has(x)){if(n.rules.global.cache.add(x),"@import"in g){let E=[].indexOf.call(n.sheet.cssRules,n.rules.themed.group)-1;for(let a of[].concat(g["@import"]))a=a.includes('"')||a.includes("'")?a:`"${a}"`,n.sheet.insertRule(`@import ${a};`,E++);delete g["@import"]}Kc(g,[],[],t,E=>{n.rules.global.apply(E)})}}return""};return Ny(h,{toString:h})}),iM=Hc(),oM=(t,n)=>iM(t,()=>s=>{const h=`${ss(t.prefix)}k-${ol(s)}`,g=()=>{if(!n.rules.global.cache.has(h)){n.rules.global.cache.add(h);const x=[];Kc(s,[],[],t,a=>x.push(a));const E=`@keyframes ${h}{${x.join("")}}`;n.rules.global.apply(E)}return h};return Ny(g,{get name(){return g()},toString:g})}),sM=class{constructor(t,n,s,h){this.token=t==null?"":String(t),this.value=n==null?"":String(n),this.scale=s==null?"":String(s),this.prefix=h==null?"":String(h)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+ss(this.prefix)+ss(this.scale)+this.token}toString(){return this.computedValue}},aM=Hc(),lM=(t,n)=>aM(t,()=>(s,h)=>{h=typeof s=="object"&&s||Object(h);const g=`.${s=(s=typeof s=="string"?s:"")||`${ss(t.prefix)}t-${ol(h)}`}`,x={},E=[];for(const A in h){x[A]={};for(const D in h[A]){const V=`--${ss(t.prefix)}${A}-${D}`,N=c2(String(h[A][D]),t.prefix,A);x[A][D]=new sM(D,N,A,t.prefix),E.push(`${V}:${N}`)}}const a=()=>{if(E.length&&!n.rules.themed.cache.has(s)){n.rules.themed.cache.add(s);const A=`${h===t.theme?":root,":""}.${s}{${E.join(";")}}`;n.rules.themed.apply(A)}return s};return Sn(bt({},x),{get className(){return a()},selector:g,toString:a})}),cM=Hc(),uM=Hc(),hM=t=>{const n=(s=>{let h=!1;const g=cM(s,x=>{h=!0;const E="prefix"in(x=typeof x=="object"&&x||{})?String(x.prefix):"",a=typeof x.media=="object"&&x.media||{},A=typeof x.root=="object"?x.root||null:globalThis.document||null,D=typeof x.theme=="object"&&x.theme||{},V={prefix:E,media:a,theme:D,themeMap:typeof x.themeMap=="object"&&x.themeMap||bt({},FA),utils:typeof x.utils=="object"&&x.utils||{}},N=XA(A),F={css:d2(V,N),globalCss:rM(V,N),keyframes:oM(V,N),createTheme:lM(V,N),reset(){N.reset(),F.theme.toString()},theme:{},sheet:N,config:V,prefix:E,getCssText:N.toString,toString:N.toString};return String(F.theme=F.createTheme(D)),F});return h||g.reset(),g})(t);return n.styled=(({config:s,sheet:h})=>uM(s,()=>{const g=d2(s,h);return(...x)=>{const E=g(...x),a=E[il].type,A=Nt.forwardRef((D,V)=>{const N=D&&D.as||a,{props:F,deferredInjector:ae}=E(D);return delete F.as,F.ref=V,ae?Nt.createElement(Nt.Fragment,null,Nt.createElement(N,F),Nt.createElement(ae,null)):Nt.createElement(N,F)});return A.className=E.className,A.displayName=`Styled.${a.displayName||a.name||a}`,A.selector=E.selector,A.toString=()=>E.selector,A[il]=E[il],A}}))(n),n};function dM(t,n,s){return Math.max(n,Math.min(t,s))}const Xr={toVector(t,n){return t===void 0&&(t=n),Array.isArray(t)?t:[t,t]},add(t,n){return[t[0]+n[0],t[1]+n[1]]},sub(t,n){return[t[0]-n[0],t[1]-n[1]]},addTo(t,n){t[0]+=n[0],t[1]+=n[1]},subTo(t,n){t[0]-=n[0],t[1]-=n[1]}};function f2(t,n,s){return n===0||Math.abs(n)===1/0?Math.pow(t,s*5):t*n*s/(n+s*t)}function m2(t,n,s,h=.15){return h===0?dM(t,n,s):t<n?-f2(n-t,s-n,h)+n:t>s?+f2(t-s,s-n,h)+s:t}function pM(t,[n,s],[h,g]){const[[x,E],[a,A]]=t;return[m2(n,x,E,h),m2(s,a,A,g)]}function hi(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function g2(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);n&&(h=h.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),s.push.apply(s,h)}return s}function cr(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?g2(Object(s),!0).forEach(function(h){hi(t,h,s[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):g2(Object(s)).forEach(function(h){Object.defineProperty(t,h,Object.getOwnPropertyDescriptor(s,h))})}return t}const _2={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function y2(t){return t?t[0].toUpperCase()+t.slice(1):""}function fM(t,n="",s=!1){const h=_2[t],g=h&&h[n]||n;return"on"+y2(t)+y2(g)+(s?"Capture":"")}function mM(t,n=""){const s=_2[t],h=s&&s[n]||n;return t+h}function Vy(t){return"touches"in t}function gM(t){return Array.from(t.touches).filter(n=>{var s,h;return n.target===t.currentTarget||((s=t.currentTarget)===null||s===void 0||(h=s.contains)===null||h===void 0?void 0:h.call(s,n.target))})}function _M(t){return t.type==="touchend"?t.changedTouches:t.targetTouches}function v2(t){return Vy(t)?_M(t)[0]:t}function yM(t){return gM(t).map(n=>n.identifier)}function Gy(t){const n=v2(t);return Vy(t)?n.identifier:n.pointerId}function x2(t){const n=v2(t);return[n.clientX,n.clientY]}function vM(t){const n={};if("buttons"in t&&(n.buttons=t.buttons),"shiftKey"in t){const{shiftKey:s,altKey:h,metaKey:g,ctrlKey:x}=t;Object.assign(n,{shiftKey:s,altKey:h,metaKey:g,ctrlKey:x})}return n}function Jf(t,...n){return typeof t=="function"?t(...n):t}function xM(){}function bM(...t){return t.length===0?xM:t.length===1?t[0]:function(){let n;for(const s of t)n=s.apply(this,arguments)||n;return n}}function b2(t,n){return Object.assign({},n,t||{})}const wM=32;class EM{constructor(n,s,h){this.ctrl=n,this.args=s,this.key=h,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(n){this.ctrl.state[this.key]=n}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:n,shared:s,ingKey:h,args:g}=this;s[h]=n._active=n.active=n._blocked=n._force=!1,n._step=[!1,!1],n.intentional=!1,n._movement=[0,0],n._distance=[0,0],n._delta=[0,0],n._bounds=[[-1/0,1/0],[-1/0,1/0]],n.args=g,n.axis=void 0,n.memo=void 0,n.elapsedTime=0,n.direction=[0,0],n.distance=[0,0],n.velocity=[0,0],n.movement=[0,0],n.delta=[0,0],n.timeStamp=0}start(n){const s=this.state,h=this.config;s._active||(this.reset(),this.computeInitial(),s._active=!0,s.target=n.target,s.currentTarget=n.currentTarget,s.lastOffset=h.from?Jf(h.from,s):s.offset,s.offset=s.lastOffset),s.startTime=s.timeStamp=n.timeStamp}computeValues(n){const s=this.state;s._values=n,s.values=this.config.transform(n)}computeInitial(){const n=this.state;n._initial=n._values,n.initial=n.values}compute(n){const{state:s,config:h,shared:g}=this;s.args=this.args;let x=0;if(n&&(s.event=n,h.preventDefault&&n.cancelable&&s.event.preventDefault(),s.type=n.type,g.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,g.locked=!!document.pointerLockElement,Object.assign(g,vM(n)),g.down=g.pressed=g.buttons%2==1||g.touches>0,x=n.timeStamp-s.timeStamp,s.timeStamp=n.timeStamp,s.elapsedTime=s.timeStamp-s.startTime),s._active){const be=s._delta.map(Math.abs);Xr.addTo(s._distance,be)}const[E,a]=s._movement,[A,D]=h.threshold,{_step:V,values:N}=s;if(h.hasCustomTransform?(V[0]===!1&&(V[0]=Math.abs(E)>=A&&N[0]),V[1]===!1&&(V[1]=Math.abs(a)>=D&&N[1])):(V[0]===!1&&(V[0]=Math.abs(E)>=A&&Math.sign(E)*A),V[1]===!1&&(V[1]=Math.abs(a)>=D&&Math.sign(a)*D)),s.intentional=V[0]!==!1||V[1]!==!1,!s.intentional)return;const F=[0,0];if(h.hasCustomTransform){const[be,fe]=N;F[0]=V[0]!==!1?be-V[0]:0,F[1]=V[1]!==!1?fe-V[1]:0}else F[0]=V[0]!==!1?E-V[0]:0,F[1]=V[1]!==!1?a-V[1]:0;if(this.intent&&this.intent(F),(s._active&&!s._blocked||s.active)&&(s.first=s._active&&!s.active,s.last=!s._active&&s.active,s.active=g[this.ingKey]=s._active,n)){s.first&&("bounds"in h&&(s._bounds=Jf(h.bounds,s)),this.setup&&this.setup()),s.movement=F;const be=s.offset;if(this.computeOffset(),!s.last||x>wM){s.delta=Xr.sub(s.offset,be);const fe=s.delta.map(Math.abs);Xr.addTo(s.distance,fe),s.direction=s.delta.map(Math.sign),!s.first&&x>0&&(s.velocity=[fe[0]/x,fe[1]/x])}}const ae=s._active?h.rubberband||[0,0]:[0,0];s.offset=pM(s._bounds,s.offset,ae),this.computeMovement()}emit(){const n=this.state,s=this.shared,h=this.config;if(n._active||this.clean(),(n._blocked||!n.intentional)&&!n._force&&!h.triggerAllEvents)return;const g=this.handler(cr(cr(cr({},s),n),{},{[this.aliasKey]:n.values}));g!==void 0&&(n.memo=g)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function TM([t,n]){const s=Math.abs(t)-Math.abs(n);if(s>0)return"x";if(s<0)return"y"}function SM(t,n){switch(n){case"x":t[1]=0;break;case"y":t[0]=0;break}}class CM extends EM{constructor(...n){super(...n);hi(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Xr.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Xr.sub(this.state.offset,this.state.lastOffset)}intent(n){this.state.axis=this.state.axis||TM(n),this.state._blocked=(this.config.lockDirection||!!this.config.axis)&&!this.state.axis||!!this.config.axis&&this.config.axis!==this.state.axis,!this.state._blocked&&(this.config.axis||this.config.lockDirection)&&SM(n,this.state.axis)}}const kM=t=>t,w2=.15,E2={enabled(t=!0){return t},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[w2,w2];case!1:return[0,0];default:return Xr.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return Xr.toVector(t)},transform(t,n,s){const h=t||s.shared.transform;return this.hasCustomTransform=!!h,h||kM},threshold(t){return Xr.toVector(t,0)}},id=cr(cr({},E2),{},{axis(t,n,{axis:s}){if(this.lockDirection=s==="lock",!this.lockDirection)return s},bounds(t={}){if(typeof t=="function")return x=>id.bounds(t(x));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:n=-1/0,right:s=1/0,top:h=-1/0,bottom:g=1/0}=t;return[[n,s],[h,g]]}}),Qf=10,T2={ArrowRight:(t=1)=>[Qf*t,0],ArrowLeft:(t=1)=>[-Qf*t,0],ArrowUp:(t=1)=>[0,-Qf*t],ArrowDown:(t=1)=>[0,Qf*t]};class IM extends CM{constructor(...n){super(...n);hi(this,"ingKey","dragging")}reset(){super.reset();const n=this.state;n._pointerId=void 0,n._pointerActive=!1,n._keyboardActive=!1,n._preventScroll=!1,n._delayed=!1,n.swipe=[0,0],n.tap=!1,n.canceled=!1,n.cancel=this.cancel.bind(this)}setup(){const n=this.state;if(n._bounds instanceof HTMLElement){const s=n._bounds.getBoundingClientRect(),h=n.currentTarget.getBoundingClientRect(),g={left:s.left-h.left+n.offset[0],right:s.right-h.right+n.offset[0],top:s.top-h.top+n.offset[1],bottom:s.bottom-h.bottom+n.offset[1]};n._bounds=id.bounds(g)}}cancel(){const n=this.state;n.canceled||(n.canceled=!0,n._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(n){const s=this.config,h=this.state;n.buttons!=null&&(Array.isArray(s.pointerButtons)?!s.pointerButtons.includes(n.buttons):s.pointerButtons!==-1&&s.pointerButtons!==n.buttons)||(this.ctrl.setEventIds(n),s.pointerCapture&&n.target.setPointerCapture(n.pointerId),!h._pointerActive&&(this.start(n),this.setupPointer(n),h._pointerId=Gy(n),h._pointerActive=!0,this.computeValues(x2(n)),this.computeInitial(),s.preventScroll?this.setupScrollPrevention(n):s.delay>0?this.setupDelayTrigger(n):this.startPointerDrag(n)))}startPointerDrag(n){const s=this.state;s._active=!0,s._preventScroll=!0,s._delayed=!1,this.compute(n),this.emit()}pointerMove(n){const s=this.state,h=this.config;if(!s._pointerActive||s.type===n.type&&n.timeStamp===s.timeStamp)return;const g=Gy(n);if(s._pointerId&&g!==s._pointerId)return;const x=x2(n);if(document.pointerLockElement===n.target?s._delta=[n.movementX,n.movementY]:(s._delta=Xr.sub(x,s._values),this.computeValues(x)),Xr.addTo(s._movement,s._delta),this.compute(n),s._delayed){this.timeoutStore.remove("dragDelay"),s.active=!1,this.startPointerDrag(n);return}if(h.preventScroll&&!s._preventScroll)if(s.axis)if(s.axis===h.preventScrollAxis||h.preventScrollAxis==="xy"){s._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(n);return}else return;this.emit()}pointerUp(n){this.ctrl.setEventIds(n);try{this.config.pointerCapture&&n.target.hasPointerCapture(n.pointerId)&&n.target.releasePointerCapture(n.pointerId)}catch{}const s=this.state,h=this.config;if(!s._pointerActive)return;const g=Gy(n);if(s._pointerId&&g!==s._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(n);const[x,E]=s._distance;if(s.tap=x<=3&&E<=3,s.tap&&h.filterTaps)s._force=!0;else{const[a,A]=s.direction,[D,V]=s.velocity,[N,F]=s.movement,[ae,be]=h.swipe.velocity,[fe,ee]=h.swipe.distance,G=h.swipe.duration;s.elapsedTime<G&&(Math.abs(D)>ae&&Math.abs(N)>fe&&(s.swipe[0]=a),Math.abs(V)>be&&Math.abs(F)>ee&&(s.swipe[1]=A))}this.emit()}pointerClick(n){this.state.tap||(n.preventDefault(),n.stopPropagation())}setupPointer(n){const s=this.config;let h=s.device;s.pointerLock&&n.currentTarget.requestPointerLock(),s.pointerCapture||(this.eventStore.add(this.sharedConfig.window,h,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,h,"end",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(n){this.state._preventScroll&&n.cancelable&&n.preventDefault()}setupScrollPrevention(n){AM(n),this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1}),this.eventStore.add(this.sharedConfig.window,"touch","end",this.clean.bind(this),{passive:!1}),this.eventStore.add(this.sharedConfig.window,"touch","cancel",this.clean.bind(this),{passive:!1}),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScroll,n)}setupDelayTrigger(n){this.state._delayed=!0,this.timeoutStore.add("dragDelay",this.startPointerDrag.bind(this),this.config.delay,n)}keyDown(n){const s=T2[n.key];if(s){const h=this.state,g=n.shiftKey?10:n.altKey?.1:1;h._delta=s(g),this.start(n),h._keyboardActive=!0,Xr.addTo(h._movement,h._delta),this.compute(n),this.emit()}}keyUp(n){n.key in T2&&(this.state._keyboardActive=!1,this.setActive(),this.compute(n),this.emit())}bind(n){const s=this.config.device;n(s,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(n(s,"change",this.pointerMove.bind(this)),n(s,"end",this.pointerUp.bind(this)),n(s,"cancel",this.pointerUp.bind(this))),n("key","down",this.keyDown.bind(this)),n("key","up",this.keyUp.bind(this)),this.config.filterTaps&&n("click","",this.pointerClick.bind(this),{capture:!0})}}function AM(t){"persist"in t&&typeof t.persist=="function"&&t.persist()}const od=typeof window!="undefined"&&window.document&&window.document.createElement;function S2(){return od&&"ontouchstart"in window}function MM(){return S2()||od&&window.navigator.maxTouchPoints>1}function PM(){return od&&"onpointerdown"in window}function zM(){return od&&"exitPointerLock"in window.document}function DM(){try{return"constructor"in GestureEvent}catch{return!1}}const Bi={isBrowser:od,gesture:DM(),touch:S2(),touchscreen:MM(),pointer:PM(),pointerLock:zM()},RM=250,LM=180,OM=.5,BM=50,FM=250,$M=cr(cr({},id),{},{pointerLock(t,n,{pointer:{lock:s=!1,touch:h=!1}={}}){return this.useTouch=Bi.touch&&h,Bi.pointerLock&&s},device(t,n){return this.useTouch?"touch":this.pointerLock?"mouse":Bi.pointer?"pointer":Bi.touch?"touch":"mouse"},preventScroll(t=!1,n,{preventScrollAxis:s="y"}){return s&&(this.preventScrollAxis=s),Bi.touchscreen?typeof t=="number"?t:t?RM:!1:!1},pointerCapture(t,n,{pointer:{capture:s=!0,buttons:h=1}={}}){return this.pointerButtons=h,!this.pointerLock&&this.device==="pointer"&&s},threshold(t,n,{filterTaps:s=!1,axis:h=void 0}){const g=Xr.toVector(t,s?3:h?1:0);return this.filterTaps=s,g},swipe({velocity:t=OM,distance:n=BM,duration:s=FM}={}){return{velocity:this.transform(Xr.toVector(t)),distance:this.transform(Xr.toVector(n)),duration:s}},delay(t=0){switch(t){case!0:return LM;case!1:return 0;default:return t}}});cr(cr({},E2),{},{useTouch(t,n,{pointer:{touch:s=!1}={}}){return Bi.touch&&s},device(t,n,s){if(s.shared.target&&!Bi.touch&&Bi.gesture)return"gesture";if(this.useTouch)return"touch";if(Bi.touchscreen){if(Bi.pointer)return"pointer";if(Bi.touch)return"touch"}},bounds(t,n,{scaleBounds:s={},angleBounds:h={}}){const g=E=>{const a=b2(Jf(s,E),{min:-1/0,max:1/0});return[a.min,a.max]},x=E=>{const a=b2(Jf(h,E),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof s!="function"&&typeof h!="function"?[g(),x()]:E=>[g(E),x(E)]},threshold(t,n,s){return this.lockDirection=s.axis==="lock",Xr.toVector(t,this.lockDirection?[.1,3]:0)}});cr(cr({},id),{},{mouseOnly:(t=!0)=>t});cr(cr({},id),{},{mouseOnly:(t=!0)=>t});const C2=new Map,Zy=new Map;function NM(t){C2.set(t.key,t.engine),Zy.set(t.key,t.resolver)}const UM={key:"drag",engine:IM,resolver:$M};function jM(t,n){if(t==null)return{};var s={},h=Object.keys(t),g,x;for(x=0;x<h.length;x++)g=h[x],!(n.indexOf(g)>=0)&&(s[g]=t[g]);return s}function VM(t,n){if(t==null)return{};var s=jM(t,n),h,g;if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(t);for(g=0;g<x.length;g++)h=x[g],!(n.indexOf(h)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,h)||(s[h]=t[h]))}return s}const GM={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=Bi.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:n=!1}={}){return{passive:t,capture:n}},transform(t){return t}},ZM=["target","eventOptions","window","enabled","transform"];function em(t={},n){const s={};for(const[h,g]of Object.entries(n))switch(typeof g){case"function":s[h]=g.call(s,t[h],h,t);break;case"object":s[h]=em(t[h],g);break;case"boolean":g&&(s[h]=t[h]);break}return s}function qM(t,n){const s=t,{target:h,eventOptions:g,window:x,enabled:E,transform:a}=s,A=VM(s,ZM),D={shared:em({target:h,eventOptions:g,window:x,enabled:E,transform:a},GM)};if(n){const V=Zy.get(n);D[n]=em(cr({shared:D.shared},A),V)}else for(const V in A){const N=Zy.get(V);N&&(D[V]=em(cr({shared:D.shared},A[V]),N))}return D}class k2{constructor(n){hi(this,"_listeners",[]),this._ctrl=n}add(n,s,h,g,x){const E=mM(s,h),a=cr(cr({},this._ctrl.config.shared.eventOptions),x);n.addEventListener(E,g,a),this._listeners.push(()=>n.removeEventListener(E,g,a))}clean(){this._listeners.forEach(n=>n()),this._listeners=[]}}class WM{constructor(){hi(this,"_timeouts",new Map)}add(n,s,h=140,...g){this.remove(n),this._timeouts.set(n,window.setTimeout(s,h,...g))}remove(n){const s=this._timeouts.get(n);s&&window.clearTimeout(s)}clean(){this._timeouts.forEach(n=>void window.clearTimeout(n)),this._timeouts.clear()}}class HM{constructor(n){hi(this,"gestures",new Set),hi(this,"_targetEventStore",new k2(this)),hi(this,"gestureEventStores",{}),hi(this,"gestureTimeoutStores",{}),hi(this,"handlers",{}),hi(this,"config",{}),hi(this,"pointerIds",new Set),hi(this,"touchIds",new Set),hi(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),XM(this,n)}setEventIds(n){Vy(n)?this.touchIds=new Set(yM(n)):"pointerId"in n&&(n.type==="pointerup"||n.type==="pointercancel"?this.pointerIds.delete(n.pointerId):n.type==="pointerdown"&&this.pointerIds.add(n.pointerId))}applyHandlers(n,s){this.handlers=n,this.nativeHandlers=s}applyConfig(n,s){this.config=qM(n,s)}clean(){this._targetEventStore.clean();for(const n of this.gestures)this.gestureEventStores[n].clean(),this.gestureTimeoutStores[n].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...n){const s=this.config.shared,h=s.eventOptions,g={};let x;if(s.target&&(x=s.target(),!x))return;const E=KM(g,h,!!x);if(s.enabled){for(const a of this.gestures)if(this.config[a].enabled){const A=C2.get(a);new A(this,n,a).bind(E)}for(const a in this.nativeHandlers)E(a,"",A=>this.nativeHandlers[a](cr(cr({},this.state.shared),{},{event:A,args:n})),void 0,!0)}for(const a in g)g[a]=bM(...g[a]);if(!x)return g;for(const a in g){let A=a.substr(2).toLowerCase();const D=!!~A.indexOf("capture"),V=!!~A.indexOf("passive");(D||V)&&(A=A.replace(/capture|passive/g,"")),this._targetEventStore.add(x,A,"",g[a],{capture:D,passive:V})}}}function Yc(t,n){t.gestures.add(n),t.gestureEventStores[n]=new k2(t),t.gestureTimeoutStores[n]=new WM}function XM(t,n){n.drag&&Yc(t,"drag"),n.wheel&&Yc(t,"wheel"),n.scroll&&Yc(t,"scroll"),n.move&&Yc(t,"move"),n.pinch&&Yc(t,"pinch"),n.hover&&Yc(t,"hover")}const KM=(t,n,s)=>(h,g,x,E={},a=!1)=>{var A,D;const V=(A=E.capture)!==null&&A!==void 0?A:n.capture,N=(D=E.passive)!==null&&D!==void 0?D:n.passive;let F=a?h:fM(h,g,V);s&&N&&(F+="Passive"),t[F]=t[F]||[],t[F].push(x)};function YM(t,n={},s,h){const g=Nt.useMemo(()=>new HM(t),[]);if(g.applyHandlers(t,h),g.applyConfig(n,s),Nt.useEffect(g.effect.bind(g)),Nt.useEffect(()=>g.clean.bind(g),[]),n.target===void 0)return g.bind.bind(g)}function I2(t,n={}){return NM(UM),YM({drag:t},n,"drag")}const JM=bk["useId".toString()]||(()=>{});let QM=0;function eP(t){const[n,s]=te.exports.useState(JM());return Hf(()=>{t||s(h=>h!=null?h:String(QM++))},[t]),t||(n?`radix-${n}`:"")}const tP=te.exports.forwardRef((t,n)=>te.exports.createElement(Zc.span,Fr({},t,{ref:n,style:Sn(bt({},t.style),{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"})}))),nP=tP,rP=te.exports.forwardRef((t,n)=>{const E=t,{children:s,width:h=10,height:g=5}=E,x=kr(E,["children","width","height"]);return te.exports.createElement(Zc.svg,Fr({},x,{ref:n,width:h,height:g,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),t.asChild?s:te.exports.createElement("polygon",{points:"0,0 30,0 15,10"}))}),iP=rP;function A2(t){const[n,s]=te.exports.useState(void 0);return te.exports.useEffect(()=>{if(t){const h=new ResizeObserver(g=>{if(!Array.isArray(g)||!g.length)return;const x=g[0];let E,a;if("borderBoxSize"in x){const A=x.borderBoxSize,D=Array.isArray(A)?A[0]:A;E=D.inlineSize,a=D.blockSize}else{const A=t.getBoundingClientRect();E=A.width,a=A.height}s({width:E,height:a})});return h.observe(t,{box:"border-box"}),()=>{s(void 0),h.unobserve(t)}}},[t]),n}function oP(t,n){const s=sl.get(t);return s===void 0?(sl.set(t,{rect:{},callbacks:[n]}),sl.size===1&&(qy=requestAnimationFrame(M2))):(s.callbacks.push(n),n(t.getBoundingClientRect())),()=>{const h=sl.get(t);if(h===void 0)return;const g=h.callbacks.indexOf(n);g>-1&&h.callbacks.splice(g,1),h.callbacks.length===0&&(sl.delete(t),sl.size===0&&cancelAnimationFrame(qy))}}let qy;const sl=new Map;function M2(){const t=[];sl.forEach((n,s)=>{const h=s.getBoundingClientRect();var g,x;g=n.rect,x=h,(g.width!==x.width||g.height!==x.height||g.top!==x.top||g.right!==x.right||g.bottom!==x.bottom||g.left!==x.left)&&(n.rect=h,t.push(n))}),t.forEach(n=>{n.callbacks.forEach(s=>s(n.rect))}),qy=requestAnimationFrame(M2)}function P2(t){const[n,s]=te.exports.useState();return te.exports.useEffect(()=>{if(t){const h=oP(t,s);return()=>{s(void 0),h()}}},[t]),n}function z2(t,n=[]){let s=[];const h=()=>{const g=s.map(x=>te.exports.createContext(x));return function(x){const E=(x==null?void 0:x[t])||g;return te.exports.useMemo(()=>({[`__scope${t}`]:Sn(bt({},x),{[t]:E})}),[x,E])}};return h.scopeName=t,[function(g,x){const E=te.exports.createContext(x),a=s.length;function A(D){const fe=D,{scope:V,children:N}=fe,F=kr(fe,["scope","children"]),ae=(V==null?void 0:V[t][a])||E,be=te.exports.useMemo(()=>F,Object.values(F));return te.exports.createElement(ae.Provider,{value:be},N)}return s=[...s,x],A.displayName=g+"Provider",[A,function(D,V){const N=(V==null?void 0:V[t][a])||E,F=te.exports.useContext(N);if(F)return F;if(x!==void 0)return x;throw new Error(`\`${D}\` must be used within \`${g}\``)}]},sP(h,...n)]}function sP(...t){const n=t[0];if(t.length===1)return n;const s=()=>{const h=t.map(g=>({useScope:g(),scopeName:g.scopeName}));return function(g){const x=h.reduce((E,{useScope:a,scopeName:A})=>bt(bt({},E),a(g)[`__scope${A}`]),{});return te.exports.useMemo(()=>({[`__scope${n.scopeName}`]:x}),[x])}};return s.scopeName=n.scopeName,s}function aP({anchorRect:t,popperSize:n,arrowSize:s,arrowOffset:h=0,side:g,sideOffset:x=0,align:E,alignOffset:a=0,shouldAvoidCollisions:A=!0,collisionBoundariesRect:D,collisionTolerance:V=0}){if(!t||!n||!D)return{popperStyles:lP,arrowStyles:Wy};const N=function(Le,Ke,Ye=0,it=0,st){const ut=st?st.height:0,ht=D2(Ke,Le,"x"),kt=D2(Ke,Le,"y"),Tt=kt.before-Ye-ut,Gt=kt.after+Ye+ut,nn=ht.before-Ye-ut,an=ht.after+Ye+ut;return{top:{start:{x:ht.start+it,y:Tt},center:{x:ht.center,y:Tt},end:{x:ht.end-it,y:Tt}},right:{start:{x:an,y:kt.start+it},center:{x:an,y:kt.center},end:{x:an,y:kt.end-it}},bottom:{start:{x:ht.start+it,y:Gt},center:{x:ht.center,y:Gt},end:{x:ht.end-it,y:Gt}},left:{start:{x:nn,y:kt.start+it},center:{x:nn,y:kt.center},end:{x:nn,y:kt.end-it}}}}(n,t,x,a,s),F=N[g][E];if(A===!1){const Le=R2(F);let Ke=Wy;return s&&(Ke=O2({popperSize:n,arrowSize:s,arrowOffset:h,side:g,align:E})),{popperStyles:Sn(bt({},Le),{"--radix-popper-transform-origin":L2(n,g,E,h,s)}),arrowStyles:Ke,placedSide:g,placedAlign:E}}const ae=DOMRect.fromRect(bt(bt({},n),F)),be=(fe=D,ee=V,DOMRect.fromRect({width:fe.width-2*ee,height:fe.height-2*ee,x:fe.left+ee,y:fe.top+ee}));var fe,ee;const G=F2(ae,be),X=N[B2(g)][E],me=function(Le,Ke,Ye){const it=B2(Le);return Ke[Le]&&!Ye[it]?it:Le}(g,G,F2(DOMRect.fromRect(bt(bt({},n),X)),be)),Te=function(Le,Ke,Ye,it,st){const ut=Ye==="top"||Ye==="bottom",ht=ut?"left":"top",kt=ut?"right":"bottom",Tt=ut?"width":"height",Gt=Ke[Tt]>Le[Tt];return(it==="start"||it==="center")&&(st[ht]&&Gt||st[kt]&&!Gt)?"end":(it==="end"||it==="center")&&(st[kt]&&Gt||st[ht]&&!Gt)?"start":it}(n,t,g,E,G),We=R2(N[me][Te]);let Pe=Wy;return s&&(Pe=O2({popperSize:n,arrowSize:s,arrowOffset:h,side:me,align:Te})),{popperStyles:Sn(bt({},We),{"--radix-popper-transform-origin":L2(n,me,Te,h,s)}),arrowStyles:Pe,placedSide:me,placedAlign:Te}}function D2(t,n,s){const h=t[s==="x"?"left":"top"],g=s==="x"?"width":"height",x=t[g],E=n[g];return{before:h-E,start:h,center:h+(x-E)/2,end:h+x-E,after:h+x}}function R2(t){return{position:"absolute",top:0,left:0,minWidth:"max-content",willChange:"transform",transform:`translate3d(${Math.round(t.x+window.scrollX)}px, ${Math.round(t.y+window.scrollY)}px, 0)`}}function L2(t,n,s,h,g){const x=n==="top"||n==="bottom",E=g?g.width:0,a=g?g.height:0,A=E/2+h;let D="",V="";return x?(D={start:`${A}px`,center:"center",end:t.width-A+"px"}[s],V=n==="top"?`${t.height+a}px`:-a+"px"):(D=n==="left"?`${t.width+a}px`:-a+"px",V={start:`${A}px`,center:"center",end:t.height-A+"px"}[s]),`${D} ${V}`}const lP={position:"fixed",top:0,left:0,opacity:0,transform:"translate3d(0, -200%, 0)"},Wy={position:"absolute",opacity:0};function O2({popperSize:t,arrowSize:n,arrowOffset:s,side:h,align:g}){const x=(t.width-n.width)/2,E=(t.height-n.width)/2,a={top:0,right:90,bottom:180,left:-90}[h],A=Math.max(n.width,n.height),D={width:`${A}px`,height:`${A}px`,transform:`rotate(${a}deg)`,willChange:"transform",position:"absolute",[h]:"100%",direction:cP(h,g)};return h!=="top"&&h!=="bottom"||(g==="start"&&(D.left=`${s}px`),g==="center"&&(D.left=`${x}px`),g==="end"&&(D.right=`${s}px`)),h!=="left"&&h!=="right"||(g==="start"&&(D.top=`${s}px`),g==="center"&&(D.top=`${E}px`),g==="end"&&(D.bottom=`${s}px`)),D}function cP(t,n){return(t!=="top"&&t!=="right"||n!=="end")&&(t!=="bottom"&&t!=="left"||n==="end")?"ltr":"rtl"}function B2(t){return{top:"bottom",right:"left",bottom:"top",left:"right"}[t]}function F2(t,n){return{top:t.top<n.top,right:t.right>n.right,bottom:t.bottom>n.bottom,left:t.left<n.left}}const[$2,N2]=z2("Popper"),[uP,U2]=$2("Popper"),hP=t=>{const{__scopePopper:n,children:s}=t,[h,g]=te.exports.useState(null);return te.exports.createElement(uP,{scope:n,anchor:h,onAnchorChange:g},s)},dP=te.exports.forwardRef((t,n)=>{const A=t,{__scopePopper:s,virtualRef:h}=A,g=kr(A,["__scopePopper","virtualRef"]),x=U2("PopperAnchor",s),E=te.exports.useRef(null),a=Wf(n,E);return te.exports.useEffect(()=>{x.onAnchorChange((h==null?void 0:h.current)||E.current)}),h?null:te.exports.createElement(Zc.div,Fr({},g,{ref:a}))}),[pP,fP]=$2("PopperContent"),mP=te.exports.forwardRef((t,n)=>{const ut=t,{__scopePopper:s,side:h="bottom",sideOffset:g,align:x="center",alignOffset:E,collisionTolerance:a,avoidCollisions:A=!0}=ut,D=kr(ut,["__scopePopper","side","sideOffset","align","alignOffset","collisionTolerance","avoidCollisions"]),V=U2("PopperContent",s),[N,F]=te.exports.useState(),ae=P2(V.anchor),[be,fe]=te.exports.useState(null),ee=A2(be),[G,X]=te.exports.useState(null),me=A2(G),Te=Wf(n,ht=>fe(ht)),We=function(){const[ht,kt]=te.exports.useState(void 0);return te.exports.useEffect(()=>{let Tt;function Gt(){kt({width:window.innerWidth,height:window.innerHeight})}function nn(){window.clearTimeout(Tt),Tt=window.setTimeout(Gt,100)}return Gt(),window.addEventListener("resize",nn),()=>window.removeEventListener("resize",nn)},[]),ht}(),Pe=We?DOMRect.fromRect(Sn(bt({},We),{x:0,y:0})):void 0,{popperStyles:Le,arrowStyles:Ke,placedSide:Ye,placedAlign:it}=aP({anchorRect:ae,popperSize:ee,arrowSize:me,arrowOffset:N,side:h,sideOffset:g,align:x,alignOffset:E,shouldAvoidCollisions:A,collisionBoundariesRect:Pe,collisionTolerance:a}),st=Ye!==void 0;return te.exports.createElement("div",{style:Le,"data-radix-popper-content-wrapper":""},te.exports.createElement(pP,{scope:s,arrowStyles:Ke,onArrowChange:X,onArrowOffsetChange:F},te.exports.createElement(Zc.div,Fr({"data-side":Ye,"data-align":it},D,{style:Sn(bt({},D.style),{animation:st?void 0:"none"}),ref:Te}))))}),gP=te.exports.forwardRef(function(t,n){const a=t,{__scopePopper:s,offset:h}=a,g=kr(a,["__scopePopper","offset"]),x=fP("PopperArrow",s),{onArrowOffsetChange:E}=x;return te.exports.useEffect(()=>E(h),[E,h]),te.exports.createElement("span",{style:Sn(bt({},x.arrowStyles),{pointerEvents:"none"})},te.exports.createElement("span",{ref:x.onArrowChange,style:{display:"inline-block",verticalAlign:"top",pointerEvents:"auto"}},te.exports.createElement(iP,Fr({},g,{ref:n,style:Sn(bt({},g.style),{display:"block"})}))))}),_P=hP,yP=dP,vP=mP,xP=gP,j2=t=>{const{present:n,children:s}=t,h=function(E){const[a,A]=te.exports.useState(),D=te.exports.useRef({}),V=te.exports.useRef(E),N=te.exports.useRef("none"),F=E?"mounted":"unmounted",[ae,be]=function(fe,ee){return te.exports.useReducer((G,X)=>{const me=ee[G][X];return me!=null?me:G},fe)}(F,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return te.exports.useEffect(()=>{const fe=tm(D.current);N.current=ae==="mounted"?fe:"none"},[ae]),Hf(()=>{const fe=D.current,ee=V.current;if(ee!==E){const G=N.current,X=tm(fe);E?be("MOUNT"):X==="none"||(fe==null?void 0:fe.display)==="none"?be("UNMOUNT"):be(ee&&G!==X?"ANIMATION_OUT":"UNMOUNT"),V.current=E}},[E,be]),Hf(()=>{if(a){const fe=G=>{const X=tm(D.current).includes(G.animationName);G.target===a&&X&&be("ANIMATION_END")},ee=G=>{G.target===a&&(N.current=tm(D.current))};return a.addEventListener("animationstart",ee),a.addEventListener("animationcancel",fe),a.addEventListener("animationend",fe),()=>{a.removeEventListener("animationstart",ee),a.removeEventListener("animationcancel",fe),a.removeEventListener("animationend",fe)}}},[a,be]),{isPresent:["mounted","unmountSuspended"].includes(ae),ref:te.exports.useCallback(fe=>{fe&&(D.current=getComputedStyle(fe)),A(fe)},[])}}(n),g=typeof s=="function"?s({present:h.isPresent}):te.exports.Children.only(s),x=Wf(h.ref,g.ref);return typeof s=="function"||h.isPresent?te.exports.cloneElement(g,{ref:x}):null};function tm(t){return(t==null?void 0:t.animationName)||"none"}j2.displayName="Presence";function V2(t){const n=te.exports.useRef(t);return te.exports.useEffect(()=>{n.current=t},[t]),n.current}function Hy(t){const n=te.exports.useRef(t);return te.exports.useEffect(()=>{n.current=t}),te.exports.useMemo(()=>(...s)=>{var h;return(h=n.current)===null||h===void 0?void 0:h.call(n,...s)},[])}function bP(t){const n=Hy(t);te.exports.useEffect(()=>{const s=h=>{h.key==="Escape"&&n(h)};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[n])}function wP({prop:t,defaultProp:n,onChange:s=()=>{}}){const[h,g]=function({defaultProp:A,onChange:D}){const V=te.exports.useState(A),[N]=V,F=te.exports.useRef(N),ae=Hy(D);return te.exports.useEffect(()=>{F.current!==N&&(ae(N),F.current=N)},[N,F,ae]),V}({defaultProp:n,onChange:s}),x=t!==void 0,E=x?t:h,a=Hy(s);return[E,te.exports.useCallback(A=>{if(x){const D=A,V=typeof A=="function"?D(t):A;V!==t&&a(V)}else g(A)},[x,t,g,a])]}function Jc(t,n,{checkForDefaultPrevented:s=!0}={}){return function(h){if(t==null||t(h),s===!1||!h.defaultPrevented)return n==null?void 0:n(h)}}const[G2,qL]=z2("Tooltip",[N2]),nm=N2(),EP=700,[WL,TP]=G2("TooltipProvider",{isOpenDelayed:!0,delayDuration:EP,onOpen:()=>{},onClose:()=>{}}),[SP,rm]=G2("Tooltip"),CP=t=>{const{__scopeTooltip:n,children:s,open:h,defaultOpen:g=!1,onOpenChange:x,delayDuration:E}=t,a=TP("Tooltip",n),A=nm(n),[D,V]=te.exports.useState(null),N=eP(),F=te.exports.useRef(0),ae=E!=null?E:a.delayDuration,be=te.exports.useRef(!1),{onOpen:fe,onClose:ee}=a,[G=!1,X]=wP({prop:h,defaultProp:g,onChange:Pe=>{Pe&&(document.dispatchEvent(new CustomEvent("tooltip.open")),fe()),x==null||x(Pe)}}),me=te.exports.useMemo(()=>G?be.current?"delayed-open":"instant-open":"closed",[G]),Te=te.exports.useCallback(()=>{window.clearTimeout(F.current),be.current=!1,X(!0)},[X]),We=te.exports.useCallback(()=>{window.clearTimeout(F.current),F.current=window.setTimeout(()=>{be.current=!0,X(!0)},ae)},[ae,X]);return te.exports.useEffect(()=>()=>window.clearTimeout(F.current),[]),te.exports.createElement(_P,A,te.exports.createElement(SP,{scope:n,contentId:N,open:G,stateAttribute:me,trigger:D,onTriggerChange:V,onTriggerEnter:te.exports.useCallback(()=>{a.isOpenDelayed?We():Te()},[a.isOpenDelayed,We,Te]),onOpen:te.exports.useCallback(Te,[Te]),onClose:te.exports.useCallback(()=>{window.clearTimeout(F.current),X(!1),ee()},[X,ee])},s))},kP=te.exports.forwardRef((t,n)=>{const D=t,{__scopeTooltip:s}=D,h=kr(D,["__scopeTooltip"]),g=rm("TooltipTrigger",s),x=nm(s),E=Wf(n,g.onTriggerChange),a=te.exports.useRef(!1),A=te.exports.useCallback(()=>a.current=!1,[]);return te.exports.useEffect(()=>()=>document.removeEventListener("mouseup",A),[A]),te.exports.createElement(yP,Fr({asChild:!0},x),te.exports.createElement(Zc.button,Fr({"aria-describedby":g.open?g.contentId:void 0,"data-state":g.stateAttribute},h,{ref:E,onMouseEnter:Jc(t.onMouseEnter,g.onTriggerEnter),onMouseLeave:Jc(t.onMouseLeave,g.onClose),onMouseDown:Jc(t.onMouseDown,()=>{g.onClose(),a.current=!0,document.addEventListener("mouseup",A,{once:!0})}),onFocus:Jc(t.onFocus,()=>{a.current||g.onOpen()}),onBlur:Jc(t.onBlur,g.onClose),onClick:Jc(t.onClick,g.onClose)})))}),IP=te.exports.forwardRef((t,n)=>{const x=t,{forceMount:s}=x,h=kr(x,["forceMount"]),g=rm("TooltipContent",t.__scopeTooltip);return te.exports.createElement(j2,{present:s||g.open},te.exports.createElement(AP,Fr({ref:n},h)))}),AP=te.exports.forwardRef((t,n)=>{const N=t,{__scopeTooltip:s,children:h,"aria-label":g,portalled:x=!0}=N,E=kr(N,["__scopeTooltip","children","aria-label","portalled"]),a=rm("TooltipContent",s),A=nm(s),D=x?Jw:te.exports.Fragment,{onClose:V}=a;return bP(()=>V()),te.exports.useEffect(()=>(document.addEventListener("tooltip.open",V),()=>document.removeEventListener("tooltip.open",V)),[V]),te.exports.createElement(D,null,te.exports.createElement(PP,{__scopeTooltip:s}),te.exports.createElement(vP,Fr({"data-state":a.stateAttribute},A,E,{ref:n,style:Sn(bt({},E.style),{"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)"})}),te.exports.createElement(Kw,null,h),te.exports.createElement(nP,{id:a.contentId,role:"tooltip"},g||h)))}),MP=te.exports.forwardRef((t,n)=>{const x=t,{__scopeTooltip:s}=x,h=kr(x,["__scopeTooltip"]),g=nm(s);return te.exports.createElement(xP,Fr({},g,h,{ref:n}))});function PP(t){const{__scopeTooltip:n}=t,s=rm("CheckTriggerMoved",n),h=P2(s.trigger),g=h==null?void 0:h.left,x=V2(g),E=h==null?void 0:h.top,a=V2(E),A=s.onClose;return te.exports.useEffect(()=>{(x!==void 0&&x!==g||a!==void 0&&a!==E)&&A()},[A,x,a,g,E]),null}const zP=CP,DP=kP,RP=IP,LP=MP;function OP(t,n){if(t==null)return{};var s={},h=Object.keys(t),g,x;for(x=0;x<h.length;x++)g=h[x],!(n.indexOf(g)>=0)&&(s[g]=t[g]);return s}function yn(t,n){if(t==null)return{};var s=OP(t,n),h,g;if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(t);for(g=0;g<x.length;g++)h=x[g],!(n.indexOf(h)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,h)||(s[h]=t[h]))}return s}let Fn;(function(t){t[t.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",t[t.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",t[t.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",t[t.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",t[t.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",t[t.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",t[t.THEME_ERROR=6]="THEME_ERROR",t[t.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",t[t.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",t[t.EMPTY_KEY=9]="EMPTY_KEY"})(Fn||(Fn={}));const BP={[Fn.UNSUPPORTED_INPUT]:(t,n)=>[`An input with type \`${t}\` input was found at path \`${n}\` but it's not supported yet.`],[Fn.NO_COMPONENT_FOR_TYPE]:(t,n)=>[`Type \`${t}\` found at path \`${n}\` can't be displayed in panel because no component supports it yet.`],[Fn.UNKNOWN_INPUT]:(t,n)=>[`input at path \`${t}\` is not recognized.`,n],[Fn.DUPLICATE_KEYS]:(t,n,s)=>[`Key \`${t}\` of path \`${n}\` already exists at path \`${s}\`. Even nested keys need to be unique. Rename one of the keys.`],[Fn.ALREADY_REGISTERED_TYPE]:t=>[`Type ${t} has already been registered. You can't register a component with the same type.`],[Fn.CLIPBOARD_ERROR]:t=>["Error copying the value",t],[Fn.THEME_ERROR]:(t,n)=>[`Error accessing the theme \`${t}.${n}\` value.`],[Fn.PATH_DOESNT_EXIST]:t=>[`Error getting the value at path \`${t}\`. There is probably an error in your \`render\` function.`],[Fn.PATH_DOESNT_EXIST]:t=>[`Error accessing the value at path \`${t}\``],[Fn.INPUT_TYPE_OVERRIDE]:(t,n,s)=>[`Input at path \`${t}\` already exists with type: \`${n}\`. Its type cannot be overridden with type \`${s}\`.`],[Fn.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function Z2(t,n,...s){const[h,...g]=BP[n](...s);console[t]("LEVA: "+h,...g)}const as=Z2.bind(null,"warn"),FP=Z2.bind(null,"log"),$P=["value"],NP=["schema"],UP=["value"],q2=[],al={};function W2(t){let{value:n}=t,s=yn(t,$P);for(let h of q2){const g=h(n,s);if(g)return g}}function ls(t,n){let{schema:s}=n,h=yn(n,NP);if(t in al){as(Fn.ALREADY_REGISTERED_TYPE,t);return}q2.push((g,x)=>s(g,x)&&t),al[t]=h}function cs(t){return t}function Xy(t,n,s,h){const{normalize:g}=al[t];if(g)return g(n,s,h);if(typeof n!="object"||!("value"in n))return{value:n};const{value:x}=n,E=yn(n,UP);return{value:x,settings:E}}function jP(t,n,s,h,g,x){const{sanitize:E}=al[t];return E?E(n,s,h,g,x):n}function H2(t,n,s){const{format:h}=al[t];return h?h(n,s):n}function VP(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function X2(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);n&&(h=h.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),s.push.apply(s,h)}return s}function Pt(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?X2(Object(s),!0).forEach(function(h){VP(t,h,s[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):X2(Object(s)).forEach(function(h){Object.defineProperty(t,h,Object.getOwnPropertyDescriptor(s,h))})}return t}const ca=(t,n,s)=>t>s?s:t<n?n:t,GP=t=>{if(t===""||typeof t=="number")return t;try{const n=ua(t);if(!isNaN(n))return n}catch{}return parseFloat(t)},ZP=Math.log(10);function K2(t){let n=Math.abs(+String(t).replace(".",""));if(n===0)return .01;for(;n!==0&&n%10==0;)n/=10;const s=Math.floor(Math.log(n)/ZP)+1,h=Math.floor(Math.log10(Math.abs(t))),g=Math.pow(10,h-s);return Math.max(g,.001)}const im=(t,n,s)=>s===n?0:(ca(t,n,s)-n)/(s-n),om=(t,n,s)=>t*(s-n)+n,qP=()=>"_"+Math.random().toString(36).substr(2,9),Y2=/\(([0-9+\-*/^ .]+)\)/,J2=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,Q2=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,eE=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,tE=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,nE=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function ua(t){if(isNaN(Number(t)))if(Y2.test(t)){const n=t.replace(Y2,(s,h)=>String(ua(h)));return ua(n)}else if(J2.test(t)){const n=t.replace(J2,(s,h,g)=>String(Math.pow(Number(h),Number(g))));return ua(n)}else if(Q2.test(t)){const n=t.replace(Q2,(s,h,g)=>String(Number(h)*Number(g)));return ua(n)}else if(eE.test(t)){const n=t.replace(eE,(s,h,g)=>{if(g!=0)return String(Number(h)/Number(g));throw new Error("Division by zero")});return ua(n)}else if(tE.test(t)){const n=t.replace(tE,(s,h,g)=>String(Number(h)+Number(g)));return ua(n)}else if(nE.test(t)){const n=t.replace(nE,(s,h,g)=>String(Number(h)-Number(g)));return ua(n)}else return Number(t);return Number(t)}function WP(t,n){return n.reduce((s,h)=>(!!t&&t.hasOwnProperty(h)&&(s[h]=t[h]),s),{})}function HP(t,n){const s=Pt({},t);return n.forEach(h=>h in t&&delete s[h]),s}function XP(t,n){return t.reduce((s,h,g)=>Object.assign(s,{[n[g]]:h}),{})}let Qi;(function(t){t.BUTTON="BUTTON",t.BUTTON_GROUP="BUTTON_GROUP",t.MONITOR="MONITOR",t.FOLDER="FOLDER"})(Qi||(Qi={}));let eo;(function(t){t.SELECT="SELECT",t.IMAGE="IMAGE",t.NUMBER="NUMBER",t.COLOR="COLOR",t.STRING="STRING",t.BOOLEAN="BOOLEAN",t.INTERVAL="INTERVAL",t.VECTOR3D="VECTOR3D",t.VECTOR2D="VECTOR2D"})(eo||(eo={}));const KP=["type","__customInput"],YP=["render","label","optional","disabled","hint","onChange","onEditStart","onEditEnd","transient"],JP=["type"];function rE(t,n,s={},h){if(typeof t!="object"||Array.isArray(t))return{type:h,input:t,options:Pt({key:n,label:n,optional:!1,disabled:!1},s)};if("__customInput"in t){const{type:G,__customInput:X}=t,me=yn(t,KP);return rE(X,n,me,G)}const{render:g,label:x,optional:E,disabled:a,hint:A,onChange:D,onEditStart:V,onEditEnd:N,transient:F}=t,ae=yn(t,YP),be=Pt({render:g,key:n,label:x!=null?x:n,hint:A,transient:F!=null?F:!!D,onEditStart:V,onEditEnd:N},s);let{type:fe}=ae,ee=yn(ae,JP);return fe=h!=null?h:fe,fe in Qi?{type:fe,input:ee,options:be}:{type:fe,input:ee,options:Pt(Pt({},be),{},{onChange:D,optional:E!=null?E:!1,disabled:a!=null?a:!1})}}function QP(t,n,s,h){const g=rE(t,n),{type:x,input:E,options:a}=g;if(x)return x in Qi?g:{type:x,input:Xy(x,E,s,h),options:a};let A=W2(E);return A?{type:A,input:Xy(A,E,s,h),options:a}:(A=W2({value:E}),A?{type:A,input:Xy(A,{value:E},s,h),options:a}:!1)}function iE(t,n,s,h,g){const{value:x,type:E,settings:a}=t;t.value=sE({type:E,value:x,settings:a},n,s,h),t.fromPanel=g}const oE=function(n,s,h){this.type="LEVA_ERROR",this.message="LEVA: "+n,this.previousValue=s,this.error=h};function sE({type:t,value:n,settings:s},h,g,x){const E=t!=="SELECT"&&typeof h=="function"?h(n):h;let a;try{a=jP(t,E,s,n,g,x)}catch(A){throw new oE(`The value \`${h}\` did not result in a correct value.`,n,A)}if(ed(a,n))throw new oE(`The value \`${h}\` did not result in a value update, which remained the same: \`${n}\`.
        You can ignore this warning if this is the intended behavior.`,n);return a}const aE=(t,n,s=!1)=>{let h=0;return function(){const g=arguments,x=s&&!h,E=()=>t.apply(this,g);window.clearTimeout(h),h=window.setTimeout(E,n),x&&E()}},lE=t=>t.shiftKey?5:t.altKey?1/5:1,ez=["value"],tz=["min","max"],nz=t=>typeof t=="number"||typeof t=="string"&&!isNaN(parseFloat(t)),cE=(t,{min:n=-1/0,max:s=1/0,suffix:h})=>{const g=parseFloat(t);if(t===""||isNaN(g))throw Error("Invalid number");const x=ca(g,n,s);return h?x+h:x},rz=(t,{pad:n=0,suffix:s})=>{const h=parseFloat(t).toFixed(n);return s?h+s:h},uE=t=>{let{value:n}=t,s=yn(t,ez);const{min:h=-1/0,max:g=1/0}=s,x=yn(s,tz),E=ca(parseFloat(n),h,g);let a;if(!Number.isFinite(n)){const N=String(n).match(/[A-Z]+/i);N&&(a=N[0])}let A=s.step;A||(Number.isFinite(h)?Number.isFinite(g)?A=+(Math.abs(g-h)/100).toPrecision(1):A=+(Math.abs(E-h)/100).toPrecision(1):Number.isFinite(g)&&(A=+(Math.abs(g-E)/100).toPrecision(1)));const D=A?K2(A)*10:K2(E);A=A||D/10;const V=Math.round(ca(Math.log10(1/D),0,2));return{value:a?E+a:E,settings:Pt({initialValue:E,step:A,pad:V,min:h,max:g,suffix:a},x)}},hE=(t,{step:n,initialValue:s})=>{const h=Math.round((t-s)/n);return s+h*n};var dE=Object.freeze({__proto__:null,schema:nz,sanitize:cE,format:rz,normalize:uE,sanitizeStep:hE});const pE=te.exports.createContext({});function $r(){return te.exports.useContext(pE)}const Ky=te.exports.createContext(null),fE=te.exports.createContext(null),mE=te.exports.createContext(null);function sm(){return te.exports.useContext(fE)}function iz(){return te.exports.useContext(mE)}const gE=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function am(t,n){const[s,h]=t.split(" "),g={};return s!=="none"&&(g.boxShadow=`${n.inset?"inset ":""}0 0 0 $borderWidths${[n.key]} $colors${s!=="default"&&s||n.borderColor}`),h&&(g.backgroundColor=h),g}const sd={$inputStyle:()=>t=>am(t,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>t=>am(t,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>t=>am(t,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>t=>am(t,{key:"$active",borderColor:"$accent1",inset:!0})},{styled:Ct,css:HL,createTheme:oz,globalCss:sz,keyframes:XL}=hM({prefix:"leva",theme:gE(),utils:Pt(Pt({},sd),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:t=>({"&:focus":sd.$focusStyle()(t)}),$focusWithin:t=>({"&:focus-within":sd.$focusStyle()(t)}),$hover:t=>({"&:hover":sd.$hoverStyle()(t)}),$active:t=>({"&:active":sd.$activeStyle()(t)})})}),az=sz({".panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});az();function lz(t){const n=gE();if(!t)return{theme:n,className:""};Object.keys(t).forEach(h=>{Object.assign(n[h],t[h])});const s=oz(n);return{theme:n,className:s.className}}function us(t,n){const{theme:s}=te.exports.useContext(Ky);if(!(t in s)||!(n in s[t]))return as(Fn.THEME_ERROR,t,n),"";let h=n;for(;;){let g=s[t][h];if(typeof g=="string"&&g.charAt(0)==="$")h=g.substr(1);else return g}}const _E=Ct("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}}}}),yE=Ct("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${_E}`]:{paddingLeft:0}}),cz=Ct(yE,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),uz=Ct("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:""}),hz=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id"],dz=["onUpdate"];function Yy(t){let{innerLabel:n,value:s,onUpdate:h,onChange:g,onKeyDown:x,type:E,id:a}=t,A=yn(t,hz);const{id:D,emitOnEditStart:V,emitOnEditEnd:N}=$r(),F=a||D,ae=te.exports.useRef(null),be=te.exports.useCallback(ee=>G=>{const X=G.currentTarget.value;ee(X)},[]);Nt.useEffect(()=>{const ee=ae.current,G=be(X=>{h(X),N()});return ee==null||ee.addEventListener("blur",G),()=>ee==null?void 0:ee.removeEventListener("blur",G)},[be,h,N]);const fe=te.exports.useCallback(ee=>{ee.key==="Enter"&&be(h)(ee)},[be,h]);return Ft(uz,{children:[n&&typeof n=="string"?Be(yE,{children:n}):n,Be(_E,bt({levaType:E,ref:ae,id:F,type:"text",autoComplete:"off",spellCheck:"false",value:s,onChange:be(g),onFocus:()=>V(),onKeyPress:fe,onKeyDown:x},A))]})}function pz(t){let{onUpdate:n}=t,s=yn(t,dz);const h=te.exports.useCallback(x=>n(GP(x)),[n]),g=te.exports.useCallback(x=>{const E=x.key==="ArrowUp"?1:x.key==="ArrowDown"?-1:0;if(E){x.preventDefault();const a=x.altKey?.1:x.shiftKey?10:1;n(A=>parseFloat(A)+E*a)}},[n]);return Be(Yy,Sn(bt({},s),{onUpdate:h,onKeyDown:g,type:"number"}))}const lm=Ct("div",{}),Jy=Ct("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),fz=Ct("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${Jy}::after`]:{opacity:.6},[`${lm}:hover > & + ${Jy}::after`]:{opacity:.6},[`${lm}:hover > & > svg`]:{opacity:1}}),vE=Ct("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${lm}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),xE=Ct("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${vE} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},"&:hover,&:focus-within":{color:"$highlight3"}}),bE=Ct(xE,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),mz=Ct("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),gz=Ct("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),_z=Ct("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none"}}}}),wE=Ct("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),EE=Ct("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),yz=Ct("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),vz=Ct(LP,{fill:"$toolTipBackground"});function Qy({children:t}){const{className:n}=te.exports.useContext(Ky);return Be(MA,{className:n,children:t})}const xz=["align"];function bz(){const{id:t,disable:n,disabled:s}=$r();return Ft(rl,{children:[Be(gz,{id:t+"__disable",type:"checkbox",checked:!s,onChange:()=>n(!s)}),Be("label",{htmlFor:t+"__disable"})]})}function wz(t){const{id:n,optional:s,hint:h}=$r(),g=t.htmlFor||(n?{htmlFor:n}:null),x=!h&&typeof t.children=="string"?{title:t.children}:null;return Ft(rl,{children:[s&&Be(bz,{}),h!==void 0?Ft(zP,{children:[Be(DP,{asChild:!0,children:Be(wE,bt(bt({},g),t))}),Be(RP,{side:"top",sideOffset:2,children:Ft(yz,{children:[h,Be(vz,{})]})})]}):Be(wE,bt(bt(bt({},g),x),t))]})}function to(t){let{align:n}=t,s=yn(t,xz);const{value:h,label:g,key:x}=$r(),{hideCopyButton:E}=iz(),a=!E&&x!==void 0,[A,D]=te.exports.useState(!1),V=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[x]:h!=null?h:""})),D(!0)}catch{as(Fn.CLIPBOARD_ERROR,{[x]:h})}};return Ft(mz,{align:n,onPointerLeave:()=>D(!1),children:[Be(wz,bt({},s)),a&&Be("div",{title:`Click to copy ${typeof g=="string"?g:x} value`,children:A?Ft("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[Be("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),Be("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})]}):Ft("svg",{onClick:V,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[Be("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),Be("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"})]})})]})}const Ez=["toggled"],Tz=Ct("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function e0(t){let{toggled:n}=t,s=yn(t,Ez);return Be(Tz,Sn(bt({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${n?0:-90}deg)`}},s),{children:Be("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"})}))}const Sz=["input"];function Fi(t){let{input:n}=t,s=yn(t,Sz);return n?Be(bE,bt({},s)):Be(xE,bt({},s))}function TE({value:t,type:n,settings:s,setValue:h}){const[g,x]=te.exports.useState(H2(n,t,s)),E=te.exports.useRef(t),a=te.exports.useRef(s);a.current=s;const A=te.exports.useCallback(V=>x(H2(n,V,a.current)),[n]),D=te.exports.useCallback(V=>{try{h(V)}catch(N){const{type:F,previousValue:ae}=N;if(F!=="LEVA_ERROR")throw N;A(ae)}},[A,h]);return te.exports.useEffect(()=>{ed(t,E.current)||A(t),E.current=t},[t,A]),{displayValue:g,onChange:x,onUpdate:D}}function cm(t,n){const{emitOnEditStart:s,emitOnEditEnd:h}=$r();return I2(g=>{g.first&&(document.body.classList.add("panel__dragged"),s());const x=t(g);return g.last&&(document.body.classList.remove("panel__dragged"),h()),x},n)}function Cz(t){const n=te.exports.useRef(null),s=te.exports.useRef(null),h=te.exports.useRef(!1);return te.exports.useEffect(()=>{const g=aE(()=>{n.current.width=n.current.offsetWidth*window.devicePixelRatio,n.current.height=n.current.offsetHeight*window.devicePixelRatio,t(n.current,s.current)},250);return window.addEventListener("resize",g),h.current||(g(),h.current=!0),()=>window.removeEventListener("resize",g)},[t]),te.exports.useEffect(()=>{s.current=n.current.getContext("2d")},[]),[n,s]}function SE(){const t=te.exports.useRef(null),n=te.exports.useRef({x:0,y:0}),s=te.exports.useCallback(h=>{Object.assign(n.current,h),t.current&&(t.current.style.transform=`translate3d(${n.current.x}px, ${n.current.y}px, 0)`)},[]);return[t,s]}const kz=["__refCount"],t0=(t,n)=>{if(!t[n])return null;const s=t[n];return yn(s,kz)};function Iz(t){const n=sm(),[s,h]=te.exports.useState(t0(n.getData(),t)),g=te.exports.useCallback(D=>n.setValueAtPath(t,D,!0),[t,n]),x=te.exports.useCallback(D=>n.setSettingsAtPath(t,D),[t,n]),E=te.exports.useCallback(D=>n.disableInputAtPath(t,D),[t,n]),a=te.exports.useCallback(()=>n.emitOnEditStart(t),[t,n]),A=te.exports.useCallback(()=>n.emitOnEditEnd(t),[t,n]);return te.exports.useEffect(()=>{h(t0(n.getData(),t));const D=n.useStore.subscribe(V=>t0(V.data,t),h,{equalityFn:td});return()=>D()},[n,t]),[s,{set:g,setSettings:x,disable:E,storeId:n.storeId,emitOnEditStart:a,emitOnEditEnd:A}]}const Az=Ct("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),CE=Ct("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),n0=Ct("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),kE=Ct("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),IE=Ct("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function Mz({value:t,min:n,max:s,onDrag:h,step:g,initialValue:x}){const E=te.exports.useRef(null),a=te.exports.useRef(null),A=te.exports.useRef(0),D=us("sizes","scrubberWidth"),V=cm(({event:F,first:ae,xy:[be],movement:[fe],memo:ee})=>{if(ae){const{width:X,left:me}=E.current.getBoundingClientRect();A.current=X-parseFloat(D),ee=(F==null?void 0:F.target)===a.current?t:om((be-me)/X,n,s)}const G=ee+om(fe/A.current,0,s-n);return h(hE(G,{step:g,initialValue:x})),ee}),N=im(t,n,s);return Ft(kE,Sn(bt({ref:E},V()),{children:[Be(CE,{children:Be(IE,{style:{left:0,right:`${(1-N)*100}%`}})}),Be(n0,{ref:a,style:{left:`calc(${N} * (100% - ${D}))`}})]}))}const Pz=Nt.memo(({label:t,onUpdate:n,step:s,innerLabelTrim:h})=>{const[g,x]=te.exports.useState(!1),E=cm(({active:a,delta:[A],event:D,memo:V=0})=>(x(a),V+=A/2,Math.abs(V)>=1&&(n(N=>parseFloat(N)+Math.floor(V)*s*lE(D)),V=0),V));return Be(cz,Sn(bt({dragging:g,title:t.length>1?t:""},E()),{children:t.slice(0,h)}))});function AE({label:t,id:n,displayValue:s,onUpdate:h,onChange:g,settings:x,innerLabelTrim:E=1}){const a=E>0&&Be(Pz,{label:t,step:x.step,onUpdate:h,innerLabelTrim:E});return Be(pz,{id:n,value:String(s),onUpdate:h,onChange:g,innerLabel:a})}function zz(){const t=$r(),{label:n,value:s,onUpdate:h,settings:g,id:x}=t,{min:E,max:a}=g,A=a!==1/0&&E!==-1/0;return Ft(Fi,{input:!0,children:[Be(to,{children:n}),Ft(Az,{hasRange:A,children:[A&&Be(Mz,bt({value:parseFloat(s),onDrag:h},g)),Be(AE,Sn(bt({},t),{id:x,label:"value",innerLabelTrim:A?0:1}))]})]})}const{sanitizeStep:Dz}=dE,Rz=yn(dE,["sanitizeStep"]);var Lz=cs(Pt({component:zz},Rz));const Oz=(t,n)=>ui().schema({options:ui().passesAnyOf(ui().object(),ui().array())}).test(n),Bz=(t,{values:n})=>{if(n.indexOf(t)<0)throw Error("Selected value doesn't match Select options");return t},Fz=(t,{values:n})=>n.indexOf(t),$z=t=>{let{value:n,options:s}=t,h,g;return Array.isArray(s)?(g=s,h=s.map(x=>String(x))):(g=Object.values(s),h=Object.keys(s)),"value"in t?g.includes(n)||(h.unshift(String(n)),g.unshift(n)):n=g[0],Object.values(s).includes(n)||(s[String(n)]=n),{value:n,settings:{keys:h,values:g}}};var Nz=Object.freeze({__proto__:null,schema:Oz,sanitize:Bz,format:Fz,normalize:$z});const Uz=Ct("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),r0=Ct("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),jz=Ct("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${r0}:focus + &`]:{$focusStyle:""},[`${r0}:hover + &`]:{$hoverStyle:""}});function Vz({displayValue:t,value:n,onUpdate:s,id:h,settings:g}){const{keys:x,values:E}=g,a=te.exports.useRef();return n===E[t]&&(a.current=x[t]),Ft(Uz,{children:[Be(r0,{id:h,value:t,onChange:A=>s(E[Number(A.currentTarget.value)]),children:x.map((A,D)=>Be("option",{value:D,children:A},A))}),Be(jz,{children:a.current}),Be(e0,{toggled:!0})]})}function Gz(){const{label:t,value:n,displayValue:s,onUpdate:h,id:g,settings:x}=$r();return Ft(Fi,{input:!0,children:[Be(to,{children:t}),Be(Vz,{id:g,value:n,displayValue:s,onUpdate:h,settings:x})]})}var Zz=cs(Pt({component:Gz},Nz));const qz=t=>ui().string().test(t),Wz=t=>{if(typeof t!="string")throw Error("Invalid string");return t};var Hz=Object.freeze({__proto__:null,schema:qz,sanitize:Wz});const Xz=["displayValue","onUpdate","onChange"];function Kz(t){let{displayValue:n,onUpdate:s,onChange:h}=t,g=yn(t,Xz);return Be(Yy,bt({value:n,onUpdate:s,onChange:h},g))}function Yz(){const{label:t,displayValue:n,onUpdate:s,onChange:h}=$r();return Ft(Fi,{input:!0,children:[Be(to,{children:t}),Be(Kz,{displayValue:n,onUpdate:s,onChange:h})]})}var Jz=cs(Pt({component:Yz},Hz));const Qz=t=>ui().boolean().test(t),eD=t=>{if(typeof t!="boolean")throw Error("Invalid boolean");return t};var tD=Object.freeze({__proto__:null,schema:Qz,sanitize:eD});const nD=Ct("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function rD({value:t,onUpdate:n,id:s}){return Ft(nD,{children:[Be("input",{id:s,type:"checkbox",checked:t,onChange:h=>n(h.currentTarget.checked)}),Be("label",{htmlFor:s,children:Be("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:Be("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})}function iD(){const{label:t,value:n,onUpdate:s,id:h}=$r();return Ft(Fi,{input:!0,children:[Be(to,{children:t}),Be(rD,{value:n,onUpdate:s,id:h})]})}var oD=cs(Pt({component:iD},tD));const sD=["locked"];function aD({value:t,id:n,valueKey:s,settings:h,onUpdate:g,innerLabelTrim:x}){const E=te.exports.useRef(t[s]);E.current=t[s];const a=te.exports.useCallback(D=>g({[s]:sE({type:"NUMBER",value:E.current,settings:h},D)}),[g,h,s]),A=TE({type:"NUMBER",value:t[s],settings:h,setValue:a});return Be(AE,{id:n,label:s,value:t[s],displayValue:A.displayValue,onUpdate:A.onUpdate,onChange:A.onChange,settings:h,innerLabelTrim:x})}const lD=Ct("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function cD(t){let{locked:n}=t,s=yn(t,sD);return Be("svg",Sn(bt({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s),{children:n?Be("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):Be("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}))}function i0({value:t,onUpdate:n,settings:s,innerLabelTrim:h}){const{id:g,setSettings:x}=$r(),{lock:E,locked:a}=s;return Ft(lD,{withLock:E,children:[E&&Be(cD,{locked:a,onClick:()=>x({locked:!a})}),Object.keys(t).map((A,D)=>Be(aD,{id:D===0?g:`${g}.${A}`,valueKey:A,value:t,settings:s[A],onUpdate:n,innerLabelTrim:h},A))]})}const ME=(t,n)=>{const s={};let h=0,g=1/0;Object.entries(t).forEach(([x,E])=>{s[x]=uE(Pt({value:E},n[x])).settings,h=Math.max(h,s[x].step),g=Math.min(g,s[x].pad)});for(let x in s){const{step:E,min:a,max:A}=n[x]||{};!isFinite(E)&&(!isFinite(a)||!isFinite(A))&&(s[x].step=h,s[x].pad=g)}return s},uD=["lock"],hD=["value"];function dD(t){const n=ui().array().length(t).every.number(),s=h=>{if(!h||typeof h!="object")return!1;const g=Object.values(h);return g.length===t&&g.every(x=>isFinite(x))};return h=>n.test(h)||s(h)}function pD(t){return Array.isArray(t)?"array":"object"}function ad(t,n,s){return pD(t)===n?t:n==="array"?Object.values(t):XP(t,s)}const fD=(t,n,s)=>{const h=ad(t,"object",n.keys);for(let E in h)h[E]=cE(h[E],n[E]);const g=Object.keys(h);let x={};if(g.length===n.keys.length)x=h;else{const E=ad(s,"object",n.keys);if(g.length===1&&n.locked){const a=g[0],A=h[a],D=E[a],V=D!==0?A/D:1;for(let N in E)N===a?x[a]=A:x[N]=E[N]*V}else x=Pt(Pt({},E),h)}return ad(x,n.format,n.keys)},mD=(t,n)=>ad(t,"object",n.keys),gD=t=>!!t&&("step"in t||"min"in t||"max"in t);function _D(t,n,s=[]){const{lock:h=!1}=n,g=yn(n,uD),x=Array.isArray(t)?"array":"object",E=x==="object"?Object.keys(t):s,a=ad(t,"object",E),A=gD(g)?E.reduce((V,N)=>Object.assign(V,{[N]:g}),{}):g,D=ME(a,A);return{value:x==="array"?t:a,settings:Pt(Pt({},D),{},{format:x,keys:E,lock:h,locked:!1})}}function PE(t){return{schema:dD(t.length),normalize:n=>{let{value:s}=n,h=yn(n,hD);return _D(s,h,t)},format:(n,s)=>mD(n,s),sanitize:(n,s,h)=>fD(n,s,h)}}var yD={grad:.9,turn:360,rad:360/(2*Math.PI)},hs=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},Er=function(t,n,s){return n===void 0&&(n=0),s===void 0&&(s=Math.pow(10,n)),Math.round(s*t)/s+0},$i=function(t,n,s){return n===void 0&&(n=0),s===void 0&&(s=1),t>s?s:t>n?t:n},zE=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},DE=function(t){return{r:$i(t.r,0,255),g:$i(t.g,0,255),b:$i(t.b,0,255),a:$i(t.a)}},o0=function(t){return{r:Er(t.r),g:Er(t.g),b:Er(t.b),a:Er(t.a,3)}},vD=/^#([0-9a-f]{3,8})$/i,um=function(t){var n=t.toString(16);return n.length<2?"0"+n:n},RE=function(t){var n=t.r,s=t.g,h=t.b,g=t.a,x=Math.max(n,s,h),E=x-Math.min(n,s,h),a=E?x===n?(s-h)/E:x===s?2+(h-n)/E:4+(n-s)/E:0;return{h:60*(a<0?a+6:a),s:x?E/x*100:0,v:x/255*100,a:g}},LE=function(t){var n=t.h,s=t.s,h=t.v,g=t.a;n=n/360*6,s/=100,h/=100;var x=Math.floor(n),E=h*(1-s),a=h*(1-(n-x)*s),A=h*(1-(1-n+x)*s),D=x%6;return{r:255*[h,a,E,E,A,h][D],g:255*[A,h,h,a,E,E][D],b:255*[E,E,A,h,h,a][D],a:g}},OE=function(t){return{h:zE(t.h),s:$i(t.s,0,100),l:$i(t.l,0,100),a:$i(t.a)}},BE=function(t){return{h:Er(t.h),s:Er(t.s),l:Er(t.l),a:Er(t.a,3)}},FE=function(t){return LE((s=(n=t).s,{h:n.h,s:(s*=((h=n.l)<50?h:100-h)/100)>0?2*s/(h+s)*100:0,v:h+s,a:n.a}));var n,s,h},ld=function(t){return{h:(n=RE(t)).h,s:(g=(200-(s=n.s))*(h=n.v)/100)>0&&g<200?s*h/100/(g<=100?g:200-g)*100:0,l:g/2,a:n.a};var n,s,h,g},xD=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,bD=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,wD=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ED=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,s0={string:[[function(t){var n=vD.exec(t);return n?(t=n[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Er(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?Er(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var n=wD.exec(t)||ED.exec(t);return n?n[2]!==n[4]||n[4]!==n[6]?null:DE({r:Number(n[1])/(n[2]?100/255:1),g:Number(n[3])/(n[4]?100/255:1),b:Number(n[5])/(n[6]?100/255:1),a:n[7]===void 0?1:Number(n[7])/(n[8]?100:1)}):null},"rgb"],[function(t){var n=xD.exec(t)||bD.exec(t);if(!n)return null;var s,h,g=OE({h:(s=n[1],h=n[2],h===void 0&&(h="deg"),Number(s)*(yD[h]||1)),s:Number(n[3]),l:Number(n[4]),a:n[5]===void 0?1:Number(n[5])/(n[6]?100:1)});return FE(g)},"hsl"]],object:[[function(t){var n=t.r,s=t.g,h=t.b,g=t.a,x=g===void 0?1:g;return hs(n)&&hs(s)&&hs(h)?DE({r:Number(n),g:Number(s),b:Number(h),a:Number(x)}):null},"rgb"],[function(t){var n=t.h,s=t.s,h=t.l,g=t.a,x=g===void 0?1:g;if(!hs(n)||!hs(s)||!hs(h))return null;var E=OE({h:Number(n),s:Number(s),l:Number(h),a:Number(x)});return FE(E)},"hsl"],[function(t){var n=t.h,s=t.s,h=t.v,g=t.a,x=g===void 0?1:g;if(!hs(n)||!hs(s)||!hs(h))return null;var E=function(a){return{h:zE(a.h),s:$i(a.s,0,100),v:$i(a.v,0,100),a:$i(a.a)}}({h:Number(n),s:Number(s),v:Number(h),a:Number(x)});return LE(E)},"hsv"]]},$E=function(t,n){for(var s=0;s<n.length;s++){var h=n[s][0](t);if(h)return[h,n[s][1]]}return[null,void 0]},NE=function(t){return typeof t=="string"?$E(t.trim(),s0.string):typeof t=="object"&&t!==null?$E(t,s0.object):[null,void 0]},TD=function(t){return NE(t)[1]},a0=function(t,n){var s=ld(t);return{h:s.h,s:$i(s.s+100*n,0,100),l:s.l,a:s.a}},l0=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},UE=function(t,n){var s=ld(t);return{h:s.h,s:s.s,l:$i(s.l+100*n,0,100),a:s.a}},c0=function(){function t(n){this.parsed=NE(n)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return Er(l0(this.rgba),2)},t.prototype.isDark=function(){return l0(this.rgba)<.5},t.prototype.isLight=function(){return l0(this.rgba)>=.5},t.prototype.toHex=function(){return n=o0(this.rgba),s=n.r,h=n.g,g=n.b,E=(x=n.a)<1?um(Er(255*x)):"","#"+um(s)+um(h)+um(g)+E;var n,s,h,g,x,E},t.prototype.toRgb=function(){return o0(this.rgba)},t.prototype.toRgbString=function(){return n=o0(this.rgba),s=n.r,h=n.g,g=n.b,(x=n.a)<1?"rgba("+s+", "+h+", "+g+", "+x+")":"rgb("+s+", "+h+", "+g+")";var n,s,h,g,x},t.prototype.toHsl=function(){return BE(ld(this.rgba))},t.prototype.toHslString=function(){return n=BE(ld(this.rgba)),s=n.h,h=n.s,g=n.l,(x=n.a)<1?"hsla("+s+", "+h+"%, "+g+"%, "+x+")":"hsl("+s+", "+h+"%, "+g+"%)";var n,s,h,g,x},t.prototype.toHsv=function(){return n=RE(this.rgba),{h:Er(n.h),s:Er(n.s),v:Er(n.v),a:Er(n.a,3)};var n},t.prototype.invert=function(){return Kr({r:255-(n=this.rgba).r,g:255-n.g,b:255-n.b,a:n.a});var n},t.prototype.saturate=function(n){return n===void 0&&(n=.1),Kr(a0(this.rgba,n))},t.prototype.desaturate=function(n){return n===void 0&&(n=.1),Kr(a0(this.rgba,-n))},t.prototype.grayscale=function(){return Kr(a0(this.rgba,-1))},t.prototype.lighten=function(n){return n===void 0&&(n=.1),Kr(UE(this.rgba,n))},t.prototype.darken=function(n){return n===void 0&&(n=.1),Kr(UE(this.rgba,-n))},t.prototype.rotate=function(n){return n===void 0&&(n=15),this.hue(this.hue()+n)},t.prototype.alpha=function(n){return typeof n=="number"?Kr({r:(s=this.rgba).r,g:s.g,b:s.b,a:n}):Er(this.rgba.a,3);var s},t.prototype.hue=function(n){var s=ld(this.rgba);return typeof n=="number"?Kr({h:n,s:s.s,l:s.l,a:s.a}):Er(s.h)},t.prototype.isEqual=function(n){return this.toHex()===Kr(n).toHex()},t}(),Kr=function(t){return t instanceof c0?t:new c0(t)},jE=[],SD=function(t){t.forEach(function(n){jE.indexOf(n)<0&&(n(c0,s0),jE.push(n))})};function CD(t,n){var s={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},h={};for(var g in s)h[s[g]]=g;var x={};t.prototype.toName=function(E){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,A,D=h[this.toHex()];if(D)return D;if(E==null?void 0:E.closest){var V=this.toRgb(),N=1/0,F="black";if(!x.length)for(var ae in s)x[ae]=new t(s[ae]).toRgb();for(var be in s){var fe=(a=V,A=x[be],Math.pow(a.r-A.r,2)+Math.pow(a.g-A.g,2)+Math.pow(a.b-A.b,2));fe<N&&(N=fe,F=be)}return F}},n.string.push([function(E){var a=E.toLowerCase(),A=a==="transparent"?"#0000":s[a];return A?new t(A).toRgb():null},"name"])}function Qc(){return(Qc=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(t[h]=s[h])}return t}).apply(this,arguments)}function u0(t,n){if(t==null)return{};var s,h,g={},x=Object.keys(t);for(h=0;h<x.length;h++)n.indexOf(s=x[h])>=0||(g[s]=t[s]);return g}function h0(t){var n=te.exports.useRef(t),s=te.exports.useRef(function(h){n.current&&n.current(h)});return n.current=t,s.current}var eu=function(t,n,s){return n===void 0&&(n=0),s===void 0&&(s=1),t>s?s:t<n?n:t},cd=function(t){return"touches"in t},d0=function(t){return t&&t.ownerDocument.defaultView||self},VE=function(t,n,s){var h=t.getBoundingClientRect(),g=cd(n)?function(x,E){for(var a=0;a<x.length;a++)if(x[a].identifier===E)return x[a];return x[0]}(n.touches,s):n;return{left:eu((g.pageX-(h.left+d0(t).pageXOffset))/h.width),top:eu((g.pageY-(h.top+d0(t).pageYOffset))/h.height)}},GE=function(t){!cd(t)&&t.preventDefault()},p0=Nt.memo(function(t){var n=t.onMove,s=t.onKey,h=u0(t,["onMove","onKey"]),g=te.exports.useRef(null),x=h0(n),E=h0(s),a=te.exports.useRef(null),A=te.exports.useRef(!1),D=te.exports.useMemo(function(){var ae=function(ee){GE(ee),(cd(ee)?ee.touches.length>0:ee.buttons>0)&&g.current?x(VE(g.current,ee,a.current)):fe(!1)},be=function(){return fe(!1)};function fe(ee){var G=A.current,X=d0(g.current),me=ee?X.addEventListener:X.removeEventListener;me(G?"touchmove":"mousemove",ae),me(G?"touchend":"mouseup",be)}return[function(ee){var G=ee.nativeEvent,X=g.current;if(X&&(GE(G),!function(Te,We){return We&&!cd(Te)}(G,A.current)&&X)){if(cd(G)){A.current=!0;var me=G.changedTouches||[];me.length&&(a.current=me[0].identifier)}X.focus(),x(VE(X,G,a.current)),fe(!0)}},function(ee){var G=ee.which||ee.keyCode;G<37||G>40||(ee.preventDefault(),E({left:G===39?.05:G===37?-.05:0,top:G===40?.05:G===38?-.05:0}))},fe]},[E,x]),V=D[0],N=D[1],F=D[2];return te.exports.useEffect(function(){return F},[F]),Nt.createElement("div",Qc({},h,{onTouchStart:V,onMouseDown:V,className:"react-colorful__interactive",ref:g,onKeyDown:N,tabIndex:0,role:"slider"}))}),ud=function(t){return t.filter(Boolean).join(" ")},f0=function(t){var n=t.color,s=t.left,h=t.top,g=h===void 0?.5:h,x=ud(["react-colorful__pointer",t.className]);return Nt.createElement("div",{className:x,style:{top:100*g+"%",left:100*s+"%"}},Nt.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:n}}))},Yr=function(t,n,s){return n===void 0&&(n=0),s===void 0&&(s=Math.pow(10,n)),Math.round(s*t)/s},ZE=function(t){var n=t.s,s=t.v,h=t.a,g=(200-n)*s/100;return{h:Yr(t.h),s:Yr(g>0&&g<200?n*s/100/(g<=100?g:200-g)*100:0),l:Yr(g/2),a:Yr(h,2)}},m0=function(t){var n=ZE(t);return"hsl("+n.h+", "+n.s+"%, "+n.l+"%)"},g0=function(t){var n=ZE(t);return"hsla("+n.h+", "+n.s+"%, "+n.l+"%, "+n.a+")"},qE=function(t){var n=t.h,s=t.s,h=t.v,g=t.a;n=n/360*6,s/=100,h/=100;var x=Math.floor(n),E=h*(1-s),a=h*(1-(n-x)*s),A=h*(1-(1-n+x)*s),D=x%6;return{r:Yr(255*[h,a,E,E,A,h][D]),g:Yr(255*[A,h,h,a,E,E][D]),b:Yr(255*[E,E,A,h,h,a][D]),a:Yr(g,2)}},WE=function(t){var n=t.r,s=t.g,h=t.b,g=t.a,x=Math.max(n,s,h),E=x-Math.min(n,s,h),a=E?x===n?(s-h)/E:x===s?2+(h-n)/E:4+(n-s)/E:0;return{h:Yr(60*(a<0?a+6:a)),s:Yr(x?E/x*100:0),v:Yr(x/255*100),a:g}},HE=Nt.memo(function(t){var n=t.hue,s=t.onChange,h=ud(["react-colorful__hue",t.className]);return Nt.createElement("div",{className:h},Nt.createElement(p0,{onMove:function(g){s({h:360*g.left})},onKey:function(g){s({h:eu(n+360*g.left,0,360)})},"aria-label":"Hue","aria-valuetext":Yr(n)},Nt.createElement(f0,{className:"react-colorful__hue-pointer",left:n/360,color:m0({h:n,s:100,v:100,a:1})})))}),XE=Nt.memo(function(t){var n=t.hsva,s=t.onChange,h={backgroundColor:m0({h:n.h,s:100,v:100,a:1})};return Nt.createElement("div",{className:"react-colorful__saturation",style:h},Nt.createElement(p0,{onMove:function(g){s({s:100*g.left,v:100-100*g.top})},onKey:function(g){s({s:eu(n.s+100*g.left,0,100),v:eu(n.v-100*g.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Yr(n.s)+"%, Brightness "+Yr(n.v)+"%"},Nt.createElement(f0,{className:"react-colorful__saturation-pointer",top:1-n.v/100,left:n.s/100,color:m0(n)})))}),_0=function(t,n){if(t===n)return!0;for(var s in t)if(t[s]!==n[s])return!1;return!0};function KE(t,n,s){var h=h0(s),g=te.exports.useState(function(){return t.toHsva(n)}),x=g[0],E=g[1],a=te.exports.useRef({color:n,hsva:x});te.exports.useEffect(function(){if(!t.equal(n,a.current.color)){var D=t.toHsva(n);a.current={hsva:D,color:n},E(D)}},[n,t]),te.exports.useEffect(function(){var D;_0(x,a.current.hsva)||t.equal(D=t.fromHsva(x),a.current.color)||(a.current={hsva:x,color:D},h(D))},[x,t,h]);var A=te.exports.useCallback(function(D){E(function(V){return Object.assign({},V,D)})},[]);return[x,A]}var kD=typeof window!="undefined"?te.exports.useLayoutEffect:te.exports.useEffect,ID=function(){return typeof __webpack_nonce__!="undefined"?__webpack_nonce__:void 0},YE=new Map,JE=function(t){kD(function(){var n=t.current?t.current.ownerDocument:document;if(n!==void 0&&!YE.has(n)){var s=n.createElement("style");s.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,YE.set(n,s);var h=ID();h&&s.setAttribute("nonce",h),n.head.appendChild(s)}},[])},AD=function(t){var n=t.className,s=t.colorModel,h=t.color,g=h===void 0?s.defaultColor:h,x=t.onChange,E=u0(t,["className","colorModel","color","onChange"]),a=te.exports.useRef(null);JE(a);var A=KE(s,g,x),D=A[0],V=A[1],N=ud(["react-colorful",n]);return Nt.createElement("div",Qc({},E,{ref:a,className:N}),Nt.createElement(XE,{hsva:D,onChange:V}),Nt.createElement(HE,{hue:D.h,onChange:V,className:"react-colorful__last-control"}))},MD=function(t){var n=t.className,s=t.hsva,h=t.onChange,g={backgroundImage:"linear-gradient(90deg, "+g0(Object.assign({},s,{a:0}))+", "+g0(Object.assign({},s,{a:1}))+")"},x=ud(["react-colorful__alpha",n]);return Nt.createElement("div",{className:x},Nt.createElement("div",{className:"react-colorful__alpha-gradient",style:g}),Nt.createElement(p0,{onMove:function(E){h({a:E.left})},onKey:function(E){h({a:eu(s.a+E.left)})},"aria-label":"Alpha","aria-valuetext":Yr(100*s.a)+"%"},Nt.createElement(f0,{className:"react-colorful__alpha-pointer",left:s.a,color:g0(s)})))},PD=function(t){var n=t.className,s=t.colorModel,h=t.color,g=h===void 0?s.defaultColor:h,x=t.onChange,E=u0(t,["className","colorModel","color","onChange"]),a=te.exports.useRef(null);JE(a);var A=KE(s,g,x),D=A[0],V=A[1],N=ud(["react-colorful",n]);return Nt.createElement("div",Qc({},E,{ref:a,className:N}),Nt.createElement(XE,{hsva:D,onChange:V}),Nt.createElement(HE,{hue:D.h,onChange:V}),Nt.createElement(MD,{hsva:D,onChange:V,className:"react-colorful__last-control"}))},zD={defaultColor:{r:0,g:0,b:0,a:1},toHsva:WE,fromHsva:qE,equal:_0},DD=function(t){return Nt.createElement(PD,Qc({},t,{colorModel:zD}))},RD={defaultColor:{r:0,g:0,b:0},toHsva:function(t){return WE({r:t.r,g:t.g,b:t.b,a:1})},fromHsva:function(t){return{r:(n=qE(t)).r,g:n.g,b:n.b};var n},equal:_0},LD=function(t){return Nt.createElement(AD,Qc({},t,{colorModel:RD}))},QE={exports:{}},OD="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",BD=OD,FD=BD;function eT(){}function tT(){}tT.resetWarningCache=eT;var $D=function(){function t(h,g,x,E,a,A){if(A!==FD){var D=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw D.name="Invariant Violation",D}}t.isRequired=t;function n(){return t}var s={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:n,element:t,elementType:t,instanceOf:n,node:t,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:tT,resetWarningCache:eT};return s.PropTypes=s,s};QE.exports=$D();var Dn=QE.exports;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function hd(t,n,s,h){function g(x){return x instanceof s?x:new s(function(E){E(x)})}return new(s||(s=Promise))(function(x,E){function a(V){try{D(h.next(V))}catch(N){E(N)}}function A(V){try{D(h.throw(V))}catch(N){E(N)}}function D(V){V.done?x(V.value):g(V.value).then(a,A)}D((h=h.apply(t,n||[])).next())})}function dd(t,n){var s={label:0,sent:function(){if(x[0]&1)throw x[1];return x[1]},trys:[],ops:[]},h,g,x,E;return E={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function a(D){return function(V){return A([D,V])}}function A(D){if(h)throw new TypeError("Generator is already executing.");for(;s;)try{if(h=1,g&&(x=D[0]&2?g.return:D[0]?g.throw||((x=g.return)&&x.call(g),0):g.next)&&!(x=x.call(g,D[1])).done)return x;switch(g=0,x&&(D=[D[0]&2,x.value]),D[0]){case 0:case 1:x=D;break;case 4:return s.label++,{value:D[1],done:!1};case 5:s.label++,g=D[1],D=[0];continue;case 7:D=s.ops.pop(),s.trys.pop();continue;default:if(x=s.trys,!(x=x.length>0&&x[x.length-1])&&(D[0]===6||D[0]===2)){s=0;continue}if(D[0]===3&&(!x||D[1]>x[0]&&D[1]<x[3])){s.label=D[1];break}if(D[0]===6&&s.label<x[1]){s.label=x[1],x=D;break}if(x&&s.label<x[2]){s.label=x[2],s.ops.push(D);break}x[2]&&s.ops.pop(),s.trys.pop();continue}D=n.call(t,s)}catch(V){D=[6,V],g=0}finally{h=x=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}}function ND(t,n){var s=typeof Symbol=="function"&&t[Symbol.iterator];if(!s)return t;var h=s.call(t),g,x=[],E;try{for(;(n===void 0||n-- >0)&&!(g=h.next()).done;)x.push(g.value)}catch(a){E={error:a}}finally{try{g&&!g.done&&(s=h.return)&&s.call(h)}finally{if(E)throw E.error}}return x}function UD(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(ND(arguments[n]));return t}var jD=new Map([["avi","video/avi"],["gif","image/gif"],["ico","image/x-icon"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["mkv","video/x-matroska"],["mov","video/quicktime"],["mp4","video/mp4"],["pdf","application/pdf"],["png","image/png"],["zip","application/zip"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"]]);function hm(t,n){var s=VD(t);if(typeof s.path!="string"){var h=t.webkitRelativePath;Object.defineProperty(s,"path",{value:typeof n=="string"?n:typeof h=="string"&&h.length>0?h:t.name,writable:!1,configurable:!1,enumerable:!0})}return s}function VD(t){var n=t.name,s=n&&n.lastIndexOf(".")!==-1;if(s&&!t.type){var h=n.split(".").pop().toLowerCase(),g=jD.get(h);g&&Object.defineProperty(t,"type",{value:g,writable:!1,configurable:!1,enumerable:!0})}return t}var GD=[".DS_Store","Thumbs.db"];function ZD(t){return hd(this,void 0,void 0,function(){return dd(this,function(n){return[2,qD(t)&&t.dataTransfer?XD(t.dataTransfer,t.type):WD(t)]})})}function qD(t){return!!t.dataTransfer}function WD(t){var n=HD(t.target)?t.target.files?y0(t.target.files):[]:[];return n.map(function(s){return hm(s)})}function HD(t){return t!==null}function XD(t,n){return hd(this,void 0,void 0,function(){var s,h;return dd(this,function(g){switch(g.label){case 0:return t.items?(s=y0(t.items).filter(function(x){return x.kind==="file"}),n!=="drop"?[2,s]:[4,Promise.all(s.map(KD))]):[3,2];case 1:return h=g.sent(),[2,nT(rT(h))];case 2:return[2,nT(y0(t.files).map(function(x){return hm(x)}))]}})})}function nT(t){return t.filter(function(n){return GD.indexOf(n.name)===-1})}function y0(t){for(var n=[],s=0;s<t.length;s++){var h=t[s];n.push(h)}return n}function KD(t){if(typeof t.webkitGetAsEntry!="function")return iT(t);var n=t.webkitGetAsEntry();return n&&n.isDirectory?oT(n):iT(t)}function rT(t){return t.reduce(function(n,s){return UD(n,Array.isArray(s)?rT(s):[s])},[])}function iT(t){var n=t.getAsFile();if(!n)return Promise.reject(t+" is not a File");var s=hm(n);return Promise.resolve(s)}function YD(t){return hd(this,void 0,void 0,function(){return dd(this,function(n){return[2,t.isDirectory?oT(t):JD(t)]})})}function oT(t){var n=t.createReader();return new Promise(function(s,h){var g=[];function x(){var E=this;n.readEntries(function(a){return hd(E,void 0,void 0,function(){var A,D,V;return dd(this,function(N){switch(N.label){case 0:if(a.length)return[3,5];N.label=1;case 1:return N.trys.push([1,3,,4]),[4,Promise.all(g)];case 2:return A=N.sent(),s(A),[3,4];case 3:return D=N.sent(),h(D),[3,4];case 4:return[3,6];case 5:V=Promise.all(a.map(YD)),g.push(V),x(),N.label=6;case 6:return[2]}})})},function(a){h(a)})}x()})}function JD(t){return hd(this,void 0,void 0,function(){return dd(this,function(n){return[2,new Promise(function(s,h){t.file(function(g){var x=hm(g,t.fullPath);s(x)},function(g){h(g)})})]})})}var QD=function(t,n){if(t&&n){var s=Array.isArray(n)?n:n.split(","),h=t.name||"",g=(t.type||"").toLowerCase(),x=g.replace(/\/.*$/,"");return s.some(function(E){var a=E.trim().toLowerCase();return a.charAt(0)==="."?h.toLowerCase().endsWith(a):a.endsWith("/*")?x===a.replace(/\/.*$/,""):g===a})}return!0};function sT(t,n){return rR(t)||nR(t,n)||tR(t,n)||eR()}function eR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tR(t,n){if(!!t){if(typeof t=="string")return aT(t,n);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return aT(t,n)}}function aT(t,n){(n==null||n>t.length)&&(n=t.length);for(var s=0,h=new Array(n);s<n;s++)h[s]=t[s];return h}function nR(t,n){var s=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var h=[],g=!0,x=!1,E,a;try{for(s=s.call(t);!(g=(E=s.next()).done)&&(h.push(E.value),!(n&&h.length===n));g=!0);}catch(A){x=!0,a=A}finally{try{!g&&s.return!=null&&s.return()}finally{if(x)throw a}}return h}}function rR(t){if(Array.isArray(t))return t}var iR="file-invalid-type",oR="file-too-large",sR="file-too-small",aR="too-many-files",lR=function(n){n=Array.isArray(n)&&n.length===1?n[0]:n;var s=Array.isArray(n)?"one of ".concat(n.join(", ")):n;return{code:iR,message:"File type must be ".concat(s)}},lT=function(n){return{code:oR,message:"File is larger than ".concat(n," bytes")}},cT=function(n){return{code:sR,message:"File is smaller than ".concat(n," bytes")}},cR={code:aR,message:"Too many files"};function uT(t,n){var s=t.type==="application/x-moz-file"||QD(t,n);return[s,s?null:lR(n)]}function hT(t,n,s){if(pd(t.size))if(pd(n)&&pd(s)){if(t.size>s)return[!1,lT(s)];if(t.size<n)return[!1,cT(n)]}else{if(pd(n)&&t.size<n)return[!1,cT(n)];if(pd(s)&&t.size>s)return[!1,lT(s)]}return[!0,null]}function pd(t){return t!=null}function uR(t){var n=t.files,s=t.accept,h=t.minSize,g=t.maxSize,x=t.multiple,E=t.maxFiles;return!x&&n.length>1||x&&E>=1&&n.length>E?!1:n.every(function(a){var A=uT(a,s),D=sT(A,1),V=D[0],N=hT(a,h,g),F=sT(N,1),ae=F[0];return V&&ae})}function dm(t){return typeof t.isPropagationStopped=="function"?t.isPropagationStopped():typeof t.cancelBubble!="undefined"?t.cancelBubble:!1}function pm(t){return t.dataTransfer?Array.prototype.some.call(t.dataTransfer.types,function(n){return n==="Files"||n==="application/x-moz-file"}):!!t.target&&!!t.target.files}function dT(t){t.preventDefault()}function hR(t){return t.indexOf("MSIE")!==-1||t.indexOf("Trident/")!==-1}function dR(t){return t.indexOf("Edge/")!==-1}function pR(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return hR(t)||dR(t)}function Mo(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return function(h){for(var g=arguments.length,x=new Array(g>1?g-1:0),E=1;E<g;E++)x[E-1]=arguments[E];return n.some(function(a){return!dm(h)&&a&&a.apply(void 0,[h].concat(x)),dm(h)})}}var fR=["children"],mR=["open"],gR=["refKey","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_R=["refKey","onChange","onClick"];function yR(t){return bR(t)||xR(t)||pT(t)||vR()}function vR(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xR(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bR(t){if(Array.isArray(t))return x0(t)}function v0(t,n){return TR(t)||ER(t,n)||pT(t,n)||wR()}function wR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pT(t,n){if(!!t){if(typeof t=="string")return x0(t,n);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return x0(t,n)}}function x0(t,n){(n==null||n>t.length)&&(n=t.length);for(var s=0,h=new Array(n);s<n;s++)h[s]=t[s];return h}function ER(t,n){var s=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var h=[],g=!0,x=!1,E,a;try{for(s=s.call(t);!(g=(E=s.next()).done)&&(h.push(E.value),!(n&&h.length===n));g=!0);}catch(A){x=!0,a=A}finally{try{!g&&s.return!=null&&s.return()}finally{if(x)throw a}}return h}}function TR(t){if(Array.isArray(t))return t}function fT(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);n&&(h=h.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),s.push.apply(s,h)}return s}function $n(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?fT(Object(s),!0).forEach(function(h){b0(t,h,s[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):fT(Object(s)).forEach(function(h){Object.defineProperty(t,h,Object.getOwnPropertyDescriptor(s,h))})}return t}function b0(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function fm(t,n){if(t==null)return{};var s=SR(t,n),h,g;if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(t);for(g=0;g<x.length;g++)h=x[g],!(n.indexOf(h)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,h)||(s[h]=t[h]))}return s}function SR(t,n){if(t==null)return{};var s={},h=Object.keys(t),g,x;for(x=0;x<h.length;x++)g=h[x],!(n.indexOf(g)>=0)&&(s[g]=t[g]);return s}var w0=te.exports.forwardRef(function(t,n){var s=t.children,h=fm(t,fR),g=_T(h),x=g.open,E=fm(g,mR);return te.exports.useImperativeHandle(n,function(){return{open:x}},[x]),Be(rl,{children:s($n($n({},E),{},{open:x}))})});w0.displayName="Dropzone";var mT={disabled:!1,getFilesFromEvent:ZD,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null};w0.defaultProps=mT;w0.propTypes={children:Dn.func,accept:Dn.oneOfType([Dn.string,Dn.arrayOf(Dn.string)]),multiple:Dn.bool,preventDropOnDocument:Dn.bool,noClick:Dn.bool,noKeyboard:Dn.bool,noDrag:Dn.bool,noDragEventsBubbling:Dn.bool,minSize:Dn.number,maxSize:Dn.number,maxFiles:Dn.number,disabled:Dn.bool,getFilesFromEvent:Dn.func,onFileDialogCancel:Dn.func,onDragEnter:Dn.func,onDragLeave:Dn.func,onDragOver:Dn.func,onDrop:Dn.func,onDropAccepted:Dn.func,onDropRejected:Dn.func,validator:Dn.func};var gT={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function _T(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=$n($n({},mT),t),s=n.accept,h=n.disabled,g=n.getFilesFromEvent,x=n.maxSize,E=n.minSize,a=n.multiple,A=n.maxFiles,D=n.onDragEnter,V=n.onDragLeave,N=n.onDragOver,F=n.onDrop,ae=n.onDropAccepted,be=n.onDropRejected,fe=n.onFileDialogCancel,ee=n.preventDropOnDocument,G=n.noClick,X=n.noKeyboard,me=n.noDrag,Te=n.noDragEventsBubbling,We=n.validator,Pe=te.exports.useRef(null),Le=te.exports.useRef(null),Ke=te.exports.useReducer(CR,gT),Ye=v0(Ke,2),it=Ye[0],st=Ye[1],ut=it.isFocused,ht=it.isFileDialogActive,kt=it.draggedFiles,Tt=te.exports.useCallback(function(){Le.current&&(st({type:"openDialog"}),Le.current.value=null,Le.current.click())},[st]),Gt=function(){ht&&setTimeout(function(){if(Le.current){var $t=Le.current.files;$t.length||(st({type:"closeDialog"}),typeof fe=="function"&&fe())}},300)};te.exports.useEffect(function(){return window.addEventListener("focus",Gt,!1),function(){window.removeEventListener("focus",Gt,!1)}},[Le,ht,fe]);var nn=te.exports.useCallback(function(ct){!Pe.current||!Pe.current.isEqualNode(ct.target)||(ct.keyCode===32||ct.keyCode===13)&&(ct.preventDefault(),Tt())},[Pe,Le]),an=te.exports.useCallback(function(){st({type:"focus"})},[]),In=te.exports.useCallback(function(){st({type:"blur"})},[]),er=te.exports.useCallback(function(){G||(pR()?setTimeout(Tt,0):Tt())},[Le,G]),Ze=te.exports.useRef([]),_t=function($t){Pe.current&&Pe.current.contains($t.target)||($t.preventDefault(),Ze.current=[])};te.exports.useEffect(function(){return ee&&(document.addEventListener("dragover",dT,!1),document.addEventListener("drop",_t,!1)),function(){ee&&(document.removeEventListener("dragover",dT),document.removeEventListener("drop",_t))}},[Pe,ee]);var dt=te.exports.useCallback(function(ct){ct.preventDefault(),ct.persist(),di(ct),Ze.current=[].concat(yR(Ze.current),[ct.target]),pm(ct)&&Promise.resolve(g(ct)).then(function($t){dm(ct)&&!Te||(st({draggedFiles:$t,isDragActive:!0,type:"setDraggedFiles"}),D&&D(ct))})},[g,D,Te]),Ut=te.exports.useCallback(function(ct){ct.preventDefault(),ct.persist(),di(ct);var $t=pm(ct);if($t&&ct.dataTransfer)try{ct.dataTransfer.dropEffect="copy"}catch{}return $t&&N&&N(ct),!1},[N,Te]),vn=te.exports.useCallback(function(ct){ct.preventDefault(),ct.persist(),di(ct);var $t=Ze.current.filter(function(tr){return Pe.current&&Pe.current.contains(tr)}),cn=$t.indexOf(ct.target);cn!==-1&&$t.splice(cn,1),Ze.current=$t,!($t.length>0)&&(st({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),pm(ct)&&V&&V(ct))},[Pe,V,Te]),wn=te.exports.useCallback(function(ct){ct.preventDefault(),ct.persist(),di(ct),Ze.current=[],pm(ct)&&Promise.resolve(g(ct)).then(function($t){if(!(dm(ct)&&!Te)){var cn=[],tr=[];$t.forEach(function(Nn){var Jr=uT(Nn,s),Nr=v0(Jr,2),Ti=Nr[0],dr=Nr[1],Qr=hT(Nn,E,x),ji=v0(Qr,2),pr=ji[0],rr=ji[1],ro=We?We(Nn):null;if(Ti&&pr&&!ro)cn.push(Nn);else{var Si=[dr,rr];ro&&(Si=Si.concat(ro)),tr.push({file:Nn,errors:Si.filter(function(zo){return zo})})}}),(!a&&cn.length>1||a&&A>=1&&cn.length>A)&&(cn.forEach(function(Nn){tr.push({file:Nn,errors:[cR]})}),cn.splice(0)),st({acceptedFiles:cn,fileRejections:tr,type:"setFiles"}),F&&F(cn,tr,ct),tr.length>0&&be&&be(tr,ct),cn.length>0&&ae&&ae(cn,ct)}}),st({type:"reset"})},[a,s,E,x,A,g,F,ae,be,Te,We]),An=function($t){return h?null:$t},ur=function($t){return X?null:An($t)},It=function($t){return me?null:An($t)},di=function($t){Te&&$t.stopPropagation()},no=te.exports.useMemo(function(){return function(){var ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},$t=ct.refKey,cn=$t===void 0?"ref":$t,tr=ct.onKeyDown,Nn=ct.onFocus,Jr=ct.onBlur,Nr=ct.onClick,Ti=ct.onDragEnter,dr=ct.onDragOver,Qr=ct.onDragLeave,ji=ct.onDrop,pr=fm(ct,gR);return $n($n(b0({onKeyDown:ur(Mo(tr,nn)),onFocus:ur(Mo(Nn,an)),onBlur:ur(Mo(Jr,In)),onClick:An(Mo(Nr,er)),onDragEnter:It(Mo(Ti,dt)),onDragOver:It(Mo(dr,Ut)),onDragLeave:It(Mo(Qr,vn)),onDrop:It(Mo(ji,wn))},cn,Pe),!h&&!X?{tabIndex:0}:{}),pr)}},[Pe,nn,an,In,er,dt,Ut,vn,wn,X,me,h]),Po=te.exports.useCallback(function(ct){ct.stopPropagation()},[]),Ni=te.exports.useMemo(function(){return function(){var ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},$t=ct.refKey,cn=$t===void 0?"ref":$t,tr=ct.onChange,Nn=ct.onClick,Jr=fm(ct,_R),Nr=b0({accept:s,multiple:a,type:"file",style:{display:"none"},onChange:An(Mo(tr,wn)),onClick:An(Mo(Nn,Po)),autoComplete:"off",tabIndex:-1},cn,Le);return $n($n({},Nr),Jr)}},[Le,s,a,wn,h]),hr=kt.length,Ui=hr>0&&uR({files:kt,accept:s,minSize:E,maxSize:x,multiple:a,maxFiles:A}),Ot=hr>0&&!Ui;return $n($n({},it),{},{isDragAccept:Ui,isDragReject:Ot,isFocused:ut&&!h,getRootProps:no,getInputProps:Ni,rootRef:Pe,inputRef:Le,open:An(Tt)})}function CR(t,n){switch(n.type){case"focus":return $n($n({},t),{},{isFocused:!0});case"blur":return $n($n({},t),{},{isFocused:!1});case"openDialog":return $n($n({},t),{},{isFileDialogActive:!0});case"closeDialog":return $n($n({},t),{},{isFileDialogActive:!1});case"setDraggedFiles":var s=n.isDragActive,h=n.draggedFiles;return $n($n({},t),{},{draggedFiles:h,isDragActive:s});case"setFiles":return $n($n({},t),{},{acceptedFiles:n.acceptedFiles,fileRejections:n.fileRejections});case"reset":return $n({},gT);default:return t}}function kR(t){let n;const s=new Set,h=(D,V)=>{const N=typeof D=="function"?D(n):D;if(N!==n){const F=n;n=V?N:Object.assign({},n,N),s.forEach(ae=>ae(n,F))}},g=()=>n,x=(D,V=g,N=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let F=V(n);function ae(){const be=V(n);if(!N(F,be)){const fe=F;D(F=be,fe)}}return s.add(ae),()=>s.delete(ae)},A={setState:h,getState:g,subscribe:(D,V,N)=>V||N?x(D,V,N):(s.add(D),()=>s.delete(D)),destroy:()=>s.clear()};return n=t(h,g,A),A}const IR=typeof window=="undefined"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),yT=IR?te.exports.useEffect:te.exports.useLayoutEffect;function AR(t){const n=typeof t=="function"?kR(t):t,s=(h=n.getState,g=Object.is)=>{const[,x]=te.exports.useReducer(ee=>ee+1,0),E=n.getState(),a=te.exports.useRef(E),A=te.exports.useRef(h),D=te.exports.useRef(g),V=te.exports.useRef(!1),N=te.exports.useRef();N.current===void 0&&(N.current=h(E));let F,ae=!1;(a.current!==E||A.current!==h||D.current!==g||V.current)&&(F=h(E),ae=!g(N.current,F)),yT(()=>{ae&&(N.current=F),a.current=E,A.current=h,D.current=g,V.current=!1});const be=te.exports.useRef(E);yT(()=>{const ee=()=>{try{const X=n.getState(),me=A.current(X);D.current(N.current,me)||(a.current=X,N.current=me,x())}catch{V.current=!0,x()}},G=n.subscribe(ee);return n.getState()!==be.current&&ee(),G},[]);const fe=ae?F:N.current;return te.exports.useDebugValue(fe),fe};return Object.assign(s,n),s[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const h=[s,n];return{next(){const g=h.length<=0;return{value:h.shift(),done:g}}}},s}const MR=t=>(n,s,h)=>{const g=h.subscribe;return h.subscribe=(E,a,A)=>{let D=E;if(a){const V=(A==null?void 0:A.equalityFn)||Object.is;let N=E(h.getState());D=F=>{const ae=E(F);if(!V(N,ae)){const be=N;a(N=ae,be)}},(A==null?void 0:A.fireImmediately)&&a(N,N)}return g(D)},t(n,s,h)};/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var PR=function(n){return n!=null&&typeof n=="object"&&Array.isArray(n)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var zR=PR;function vT(t){return zR(t)===!0&&Object.prototype.toString.call(t)==="[object Object]"}var xT=function(n){var s,h;return!(vT(n)===!1||(s=n.constructor,typeof s!="function")||(h=s.prototype,vT(h)===!1)||h.hasOwnProperty("isPrototypeOf")===!1)};/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var DR=xT,E0=function(n){return DR(n)||typeof n=="function"||Array.isArray(n)};/*!
 * for-in <https://github.com/jonschlinkert/for-in>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var RR=function(n,s,h){for(var g in n)if(s.call(h,n[g],g,n)===!1)break},LR=E0,OR=RR;function bT(t,n){for(var s=arguments.length,h=0;++h<s;){var g=arguments[h];T0(g)&&OR(g,BR,t)}return t}function BR(t,n){if(!!FR(n)){var s=this[n];T0(t)&&T0(s)?bT(s,t):this[n]=t}}function T0(t){return LR(t)&&!Array.isArray(t)}function FR(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"}var $R=bT;/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var NR=function(t,n,s,h,g){if(!UR(t)||!n)return t;if(n=mm(n),s&&(n+="."+mm(s)),h&&(n+="."+mm(h)),g&&(n+="."+mm(g)),n in t)return t[n];for(var x=n.split("."),E=x.length,a=-1;t&&++a<E;){for(var A=x[a];A[A.length-1]==="\\";)A=A.slice(0,-1)+"."+x[++a];t=t[A]}return t};function UR(t){return t!==null&&(typeof t=="object"||typeof t=="function")}function mm(t){return t?Array.isArray(t)?t.join("."):t:""}/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var jR=function(t,n){if(t===null||typeof t=="undefined")throw new TypeError("expected first argument to be an object.");if(typeof n=="undefined"||typeof Symbol=="undefined"||typeof Object.getOwnPropertySymbols!="function")return t;for(var s=Object.prototype.propertyIsEnumerable,h=Object(t),g=arguments.length,x=0;++x<g;)for(var E=Object(arguments[x]),a=Object.getOwnPropertySymbols(E),A=0;A<a.length;A++){var D=a[A];s.call(E,D)&&(h[D]=E[D])}return h},VR=E0,GR=jR,ZR=Object.assign||function(t){if(t===null||typeof t=="undefined")throw new TypeError("Cannot convert undefined or null to object");wT(t)||(t={});for(var n=1;n<arguments.length;n++){var s=arguments[n];WR(s)&&(s=HR(s)),wT(s)&&(qR(t,s),GR(t,s))}return t};function qR(t,n){for(var s in n)XR(n,s)&&(t[s]=n[s])}function WR(t){return t&&typeof t=="string"}function HR(t){var n={};for(var s in t)n[s]=t[s];return n}function wT(t){return t&&typeof t=="object"||VR(t)}function XR(t,n){return Object.prototype.hasOwnProperty.call(t,n)}/*!
 * split-string <https://github.com/jonschlinkert/split-string>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var KR=ZR,YR=function(t,n,s){if(typeof t!="string")throw new TypeError("expected a string");typeof n=="function"&&(s=n,n=null),typeof n=="string"&&(n={sep:n});var h=KR({sep:"."},n),g=h.quotes||['"',"'","`"],x;h.brackets===!0?x={"<":">","(":")","[":"]","{":"}"}:h.brackets&&(x=h.brackets);var E=[],a=[],A=[""],D=h.sep,V=t.length,N=-1,F;function ae(){if(x&&a.length)return x[a[a.length-1]]}for(;++N<V;){var be=t[N],fe=t[N+1],ee={val:be,idx:N,arr:A,str:t};if(E.push(ee),be==="\\"){ee.val=QR(h,t,N)===!0?be+fe:fe,ee.escaped=!0,typeof s=="function"&&s(ee),A[A.length-1]+=ee.val,N++;continue}if(x&&x[be]){a.push(be);var G=ae(),X=N+1;if(t.indexOf(G,X+1)!==-1)for(;a.length&&X<V;){var me=t[++X];if(me==="\\"){me++;continue}if(g.indexOf(me)!==-1){X=S0(t,me,X+1);continue}if(G=ae(),a.length&&t.indexOf(G,X+1)===-1)break;if(x[me]){a.push(me);continue}G===me&&a.pop()}if(F=X,F===-1){A[A.length-1]+=be;continue}be=t.slice(N,F+1),ee.val=be,ee.idx=N=F}if(g.indexOf(be)!==-1){if(F=S0(t,be,N+1),F===-1){A[A.length-1]+=be;continue}JR(be,h)===!0?be=t.slice(N,F+1):be=t.slice(N+1,F),ee.val=be,ee.idx=N=F}if(typeof s=="function"&&(s(ee,E),be=ee.val,N=ee.idx),ee.val===D&&ee.split!==!1){A.push("");continue}A[A.length-1]+=ee.val}return A};function S0(t,n,s,h){var g=t.indexOf(n,s);return t.charAt(g-1)==="\\"?S0(t,n,g+1):g}function JR(t,n){return n.keepDoubleQuotes===!0&&t==='"'||n.keepSingleQuotes===!0&&t==="'"?!0:n.keepQuotes}function QR(t,n,s){return typeof t.keepEscaping=="function"?t.keepEscaping(n,s):t.keepEscaping===!0||n[s+1]==="\\"}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var ET=function(n){return typeof n!="undefined"&&n!==null&&(typeof n=="object"||typeof n=="function")},TT=ET,e3=function(n){TT(n)||(n={});for(var s=arguments.length,h=1;h<s;h++){var g=arguments[h];TT(g)&&t3(n,g)}return n};function t3(t,n){for(var s in n)n3(n,s)&&(t[s]=n[s])}function n3(t,n){return Object.prototype.hasOwnProperty.call(t,n)}/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var r3=YR,i3=e3,ST=xT,CT=ET,o3=function(t,n,s){if(!CT(t)||(Array.isArray(n)&&(n=[].concat.apply([],n).join(".")),typeof n!="string"))return t;for(var h=r3(n,{sep:".",brackets:!0}).filter(s3),g=h.length,x=-1,E=t;++x<g;){var a=h[x];if(x!==g-1){CT(E[a])||(E[a]={}),E=E[a];continue}ST(E[a])&&ST(s)?E[a]=i3({},E[a],s):E[a]=s}return t};function s3(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"}var C0=E0,kT=$R,a3=NR,IT=o3,l3=function(n,s,h){if(!C0(n))throw new TypeError("expected an object");if(typeof s!="string"||h==null)return kT.apply(null,arguments);if(typeof h=="string")return IT(n,s,h),n;var g=a3(n,s);return C0(h)&&C0(g)&&(h=kT({},g,h)),IT(n,s,h),n};const AT=(...t)=>t.filter(Boolean).join(".");function c3(t){const n=t.split(".");return[n.pop(),n.join(".")||void 0]}function u3(t,n){return Object.entries(WP(t,n)).reduce((s,[,{value:h,disabled:g,key:x}])=>(s[x]=g?void 0:h,s),{})}function h3(t,n){const s=te.exports.useRef();return(n?ed:td)(t,s.current)||(s.current=t),s.current}function MT(t,n){return te.exports.useMemo(t,h3(n,!0))}function d3(t){const n=te.exports.useRef(null),s=te.exports.useRef(null),h=te.exports.useRef(!0);return te.exports.useLayoutEffect(()=>{t||(n.current.style.height="0px",n.current.style.overflow="hidden")},[]),te.exports.useEffect(()=>{if(h.current){h.current=!1;return}let g;const x=n.current,E=()=>{t&&(x.style.removeProperty("height"),x.style.removeProperty("overflow"),s.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};x.addEventListener("transitionend",E,{once:!0});const{height:a}=s.current.getBoundingClientRect();return x.style.height=a+"px",t||(x.style.overflow="hidden",g=window.setTimeout(()=>x.style.height="0px",50)),()=>{x.removeEventListener("transitionend",E),clearTimeout(g)}},[t]),{wrapperRef:n,contentRef:s}}const p3=t=>{const[n,s]=te.exports.useState(t.getVisiblePaths());return te.exports.useEffect(()=>{s(t.getVisiblePaths());const h=t.useStore.subscribe(t.getVisiblePaths,s,{equalityFn:td});return()=>h()},[t]),n};function f3(t,n,s){return t.useStore(g=>{const x=Pt(Pt({},s),g.data);return u3(x,n)},td)}function PT(t=3){const n=te.exports.useRef(null),s=te.exports.useRef(null),[h,g]=te.exports.useState(!1),x=te.exports.useCallback(()=>g(!0),[]),E=te.exports.useCallback(()=>g(!1),[]);return te.exports.useLayoutEffect(()=>{if(h){const{bottom:a,top:A,left:D}=n.current.getBoundingClientRect(),{height:V}=s.current.getBoundingClientRect(),N=a+V>window.innerHeight-40?"up":"down";s.current.style.position="fixed",s.current.style.zIndex="10000",s.current.style.left=D+"px",N==="down"?s.current.style.top=a+t+"px":s.current.style.bottom=window.innerHeight-A+t+"px"}},[t,h]),{popinRef:n,wrapperRef:s,shown:h,show:x,hide:E}}SD([CD]);const m3={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};ui.extend({color:()=>t=>Kr(t).isValid()});const g3=t=>ui().color().test(t);function zT(t,{format:n,hasAlpha:s,isString:h}){const g=m3[n]+(h&&n!=="hex"?"String":""),x=t[g]();return typeof x=="object"&&!s?HP(x,["a"]):x}const DT=(t,n)=>{const s=Kr(t);if(!s.isValid())throw Error("Invalid color");return zT(s,n)},_3=(t,n)=>zT(Kr(t),Pt(Pt({},n),{},{isString:!0,format:"hex"})),y3=({value:t})=>{const n=TD(t),s=n==="name"?"hex":n,h=typeof t=="object"?"a"in t:n==="hex"&&t.length===8||/^(rgba)|(hsla)|(hsva)/.test(t),g={format:s,hasAlpha:h,isString:typeof t=="string"};return{value:DT(t,g),settings:g}};var v3=Object.freeze({__proto__:null,schema:g3,sanitize:DT,format:_3,normalize:y3});const x3=Ct("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),b3=Ct("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),w3=Ct("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function RT(t,n){return n!=="rgb"?Kr(t).toRgb():t}function E3({value:t,displayValue:n,settings:s,onUpdate:h}){const{emitOnEditStart:g,emitOnEditEnd:x}=$r(),{format:E,hasAlpha:a}=s,{popinRef:A,wrapperRef:D,shown:V,show:N,hide:F}=PT(),ae=te.exports.useRef(0),[be,fe]=te.exports.useState(()=>RT(t,E)),ee=a?DD:LD,G=()=>{fe(RT(t,E)),N(),g()},X=()=>{F(),x(),window.clearTimeout(ae.current)},me=()=>{ae.current=window.setTimeout(X,500)};return te.exports.useEffect(()=>()=>window.clearTimeout(ae.current),[]),Ft(rl,{children:[Be(x3,{ref:A,active:V,onClick:()=>G(),style:{color:n}}),V&&Ft(Qy,{children:[Be(EE,{onPointerUp:X}),Be(w3,{ref:D,onMouseEnter:()=>window.clearTimeout(ae.current),onMouseLeave:Te=>Te.buttons===0&&me(),children:Be(ee,{color:be,onChange:h})})]})]})}function T3(){const{value:t,displayValue:n,label:s,onChange:h,onUpdate:g,settings:x}=$r();return Ft(Fi,{input:!0,children:[Be(to,{children:s}),Ft(b3,{children:[Be(E3,{value:t,displayValue:n,onChange:h,onUpdate:g,settings:x}),Be(Yy,{value:n,onChange:h,onUpdate:g})]})]})}var S3=cs(Pt({component:T3},v3));function C3(){const{label:t,displayValue:n,onUpdate:s,settings:h}=$r();return Ft(Fi,{input:!0,children:[Be(to,{children:t}),Be(i0,{value:n,settings:h,onUpdate:s})]})}var k3=cs(Pt({component:C3},PE(["x","y","z"])));const I3=Ct("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),A3=Ct("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function M3({value:t,settings:n,onUpdate:s}){const h=te.exports.useRef(),g=te.exports.useRef(0),x=te.exports.useRef(0),E=te.exports.useRef(1),[a,A]=te.exports.useState(!1),[D,V]=te.exports.useState(!1),[N,F]=SE(),ae=te.exports.useRef(null),be=te.exports.useRef(null);te.exports.useLayoutEffect(()=>{if(a){const{top:ut,left:ht,width:kt,height:Tt}=ae.current.getBoundingClientRect();be.current.style.left=ht+kt/2+"px",be.current.style.top=ut+Tt/2+"px"}},[a]);const{keys:[fe,ee],joystick:G}=n,X=G==="invertY"?1:-1,{[fe]:{step:me},[ee]:{step:Te}}=n,We=us("sizes","joystickWidth"),Pe=us("sizes","joystickHeight"),Le=parseFloat(We)*.8/2,Ke=parseFloat(Pe)*.8/2,Ye=te.exports.useCallback(()=>{h.current||(V(!0),g.current&&F({x:g.current*Le}),x.current&&F({y:x.current*-Ke}),h.current=window.setInterval(()=>{s(ut=>{const ht=me*g.current*E.current,kt=X*Te*x.current*E.current;return Array.isArray(ut)?{[fe]:ut[0]+ht,[ee]:ut[1]+kt}:{[fe]:ut[fe]+ht,[ee]:ut[ee]+kt}})},16))},[Le,Ke,s,F,me,Te,fe,ee,X]),it=te.exports.useCallback(()=>{window.clearTimeout(h.current),h.current=void 0,V(!1)},[]);te.exports.useEffect(()=>{function ut(ht){E.current=lE(ht)}return window.addEventListener("keydown",ut),window.addEventListener("keyup",ut),()=>{window.clearTimeout(h.current),window.removeEventListener("keydown",ut),window.removeEventListener("keyup",ut)}},[]);const st=cm(({first:ut,active:ht,delta:[kt,Tt],movement:[Gt,nn]})=>{ut&&A(!0);const an=ca(Gt,-Le,Le),In=ca(nn,-Ke,Ke);g.current=Math.abs(Gt)>Math.abs(an)?Math.sign(Gt-an):0,x.current=Math.abs(nn)>Math.abs(In)?Math.sign(In-nn):0;let er=t[fe],Ze=t[ee];ht?(g.current||(er+=kt*me*E.current,F({x:an})),x.current||(Ze-=X*Tt*Te*E.current,F({y:In})),g.current||x.current?Ye():it(),s({[fe]:er,[ee]:Ze})):(A(!1),g.current=0,x.current=0,F({x:0,y:0}),it())});return Be(I3,Sn(bt({ref:ae},st()),{children:a&&Be(Qy,{children:Ft(A3,{ref:be,isOutOfBounds:D,children:[Be("div",{}),Be("span",{ref:N})]})})}))}const P3=Ct("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function z3(){const{label:t,displayValue:n,onUpdate:s,settings:h}=$r();return Ft(Fi,{input:!0,children:[Be(to,{children:t}),Ft(P3,{withJoystick:!!h.joystick,children:[h.joystick&&Be(M3,{value:n,settings:h,onUpdate:s}),Be(i0,{value:n,settings:h,onUpdate:s})]})]})}const D3=["joystick"],LT=PE(["x","y"]),R3=t=>{let{joystick:n=!0}=t,s=yn(t,D3);const{value:h,settings:g}=LT.normalize(s);return{value:h,settings:Pt(Pt({},g),{},{joystick:n})}};var L3=cs(Pt(Pt({component:z3},LT),{},{normalize:R3}));const O3=t=>{if(t!==void 0){if(t instanceof File)try{return URL.createObjectURL(t)}catch{return}if(typeof t=="string"&&t.indexOf("blob:")===0)return t;throw Error("Invalid image format [undefined | blob |\xA0File].")}},B3=(t,n)=>typeof n=="object"&&"image"in n,F3=({image:t})=>({value:t});var $3=Object.freeze({__proto__:null,sanitize:O3,schema:B3,normalize:F3});const N3=Ct("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),U3=Ct("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),j3=Ct("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),V3=Ct("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),G3=Ct("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),Z3=Ct("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function q3(){const{label:t,value:n,onUpdate:s}=$r(),{popinRef:h,wrapperRef:g,shown:x,show:E,hide:a}=PT(),A=te.exports.useCallback(ae=>{ae.length&&s(ae[0])},[s]),D=te.exports.useCallback(ae=>{ae.stopPropagation(),s(void 0)},[s]),{getRootProps:V,getInputProps:N,isDragAccept:F}=_T({maxFiles:1,accept:"image/*",onDrop:A});return Ft(Fi,{input:!0,children:[Be(to,{children:t}),Ft(N3,{children:[Be(j3,{ref:h,hasImage:!!n,onPointerDown:()=>!!n&&E(),onPointerUp:a,style:{backgroundImage:n?`url(${n})`:"none"}}),x&&!!n&&Ft(Qy,{children:[Be(EE,{onPointerUp:a,style:{cursor:"pointer"}}),Be(V3,{ref:g,style:{backgroundImage:`url(${n})`}})]}),Ft(U3,Sn(bt({},V({isDragAccept:F})),{children:[Be("input",bt({},N())),Be(G3,{children:F?"drop image":"click or drop"})]})),Be(Z3,{onClick:D,disabled:!n})]})]})}var W3=cs(Pt({component:q3},$3));const OT=ui().number(),H3=(t,n)=>ui().array().length(2).every.number().test(t)&&ui().schema({min:OT,max:OT}).test(n),k0=t=>({min:t[0],max:t[1]}),BT=(t,{bounds:[n,s]},h)=>{const g={min:h[0],max:h[1]},{min:x,max:E}=Pt(Pt({},g),t);return[ca(Number(x),n,Math.max(n,E)),ca(Number(E),Math.min(s,x),s)]},X3=({value:t,min:n,max:s})=>{const h={min:n,max:s},g=ME(k0(t),{min:h,max:h}),x=[n,s],E=Pt(Pt({},g),{},{bounds:x});return{value:BT(k0(t),E,t),settings:E}};var K3=Object.freeze({__proto__:null,schema:H3,format:k0,sanitize:BT,normalize:X3});const Y3=["value","bounds","onDrag"],J3=["bounds"],Q3=Ct("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function eL(t){let{value:n,bounds:[s,h],onDrag:g}=t,x=yn(t,Y3);const E=te.exports.useRef(null),a=te.exports.useRef(null),A=te.exports.useRef(null),D=te.exports.useRef(0),V=us("sizes","scrubberWidth"),N=cm(({event:be,first:fe,xy:[ee],movement:[G],memo:X={}})=>{if(fe){const{width:Te,left:We}=E.current.getBoundingClientRect();D.current=Te-parseFloat(V);const Pe=(be==null?void 0:be.target)===a.current||(be==null?void 0:be.target)===A.current;X.pos=om((ee-We)/Te,s,h);const Le=Math.abs(X.pos-n.min)-Math.abs(X.pos-n.max);X.key=Le<0||Le===0&&X.pos<=n.min?"min":"max",Pe&&(X.pos=n[X.key])}const me=X.pos+om(G/D.current,0,h-s);return g({[X.key]:Dz(me,x[X.key])}),X}),F=`calc(${im(n.min,s,h)} * (100% - ${V} - 8px) + 4px)`,ae=`calc(${1-im(n.max,s,h)} * (100% - ${V} - 8px) + 4px)`;return Ft(kE,Sn(bt({ref:E},N()),{children:[Be(CE,{children:Be(IE,{style:{left:F,right:ae}})}),Be(n0,{position:"left",ref:a,style:{left:F}}),Be(n0,{position:"right",ref:A,style:{right:ae}})]}))}function tL(){const{label:t,displayValue:n,onUpdate:s,settings:h}=$r(),g=yn(h,J3);return Be(rl,{children:Ft(Fi,{input:!0,children:[Be(to,{children:t}),Ft(Q3,{children:[Be(eL,Sn(bt({value:n},h),{onDrag:s})),Be(i0,{value:n,settings:g,onUpdate:s,innerLabelTrim:0})]})]})})}var nL=cs(Pt({component:tL},K3));const rL=()=>{const t=new Map;return{on:(n,s)=>{let h=t.get(n);h===void 0&&(h=new Set,t.set(n,h)),h.add(s)},off:(n,s)=>{const h=t.get(n);h!==void 0&&(h.delete(s),h.size===0&&t.delete(n))},emit:(n,...s)=>{const h=t.get(n);if(h!==void 0)for(const g of h)g(...s)}}},iL=["type","value"],oL=["onChange","transient","onEditStart","onEditEnd"],sL=function(){const n=AR(MR(()=>({data:{}}))),s=rL();this.storeId=qP(),this.useStore=n;const h={},g=new Set;this.getVisiblePaths=()=>{const E=this.getData(),a=Object.keys(E),A=[];Object.entries(h).forEach(([V,N])=>{N.render&&a.some(F=>F.indexOf(V)===0)&&!N.render(this.get)&&A.push(V+".")});const D=[];return g.forEach(V=>{V in E&&E[V].__refCount>0&&A.every(N=>V.indexOf(N)===-1)&&(!E[V].render||E[V].render(this.get))&&D.push(V)}),D},this.setOrderedPaths=E=>{E.forEach(a=>g.add(a))},this.orderPaths=E=>(this.setOrderedPaths(E),E),this.disposePaths=E=>{n.setState(a=>{const A=a.data;return E.forEach(D=>{if(D in A){const V=A[D];V.__refCount--,V.__refCount===0&&V.type in Qi&&delete A[D]}}),{data:A}})},this.dispose=()=>{n.setState(()=>({data:{}}))},this.getFolderSettings=E=>h[E]||{},this.getData=()=>n.getState().data,this.addData=(E,a)=>{n.setState(A=>{const D=A.data;return Object.entries(E).forEach(([V,N])=>{let F=D[V];if(F){const{type:ae,value:be}=N,fe=yn(N,iL);ae!==F.type?as(Fn.INPUT_TYPE_OVERRIDE,ae):((F.__refCount===0||a)&&Object.assign(F,fe),F.__refCount++)}else D[V]=Pt(Pt({},N),{},{__refCount:1})}),{data:D}})},this.setValueAtPath=(E,a,A)=>{n.setState(D=>{const V=D.data;return iE(V[E],a,E,this,A),{data:V}})},this.setSettingsAtPath=(E,a)=>{n.setState(A=>{const D=A.data;return D[E].settings=Pt(Pt({},D[E].settings),a),{data:D}})},this.disableInputAtPath=(E,a)=>{n.setState(A=>{const D=A.data;return D[E].disabled=a,{data:D}})},this.set=(E,a)=>{n.setState(A=>{const D=A.data;return Object.entries(E).forEach(([V,N])=>{try{iE(D[V],N,void 0,void 0,a)}catch{}}),{data:D}})},this.getInput=E=>{try{return this.getData()[E]}catch{as(Fn.PATH_DOESNT_EXIST,E)}},this.get=E=>{var a;return(a=this.getInput(E))===null||a===void 0?void 0:a.value},this.emitOnEditStart=E=>{s.emit(`onEditStart:${E}`,this.get(E),E,Pt(Pt({},this.getInput(E)),{},{get:this.get}))},this.emitOnEditEnd=E=>{s.emit(`onEditEnd:${E}`,this.get(E),E,Pt(Pt({},this.getInput(E)),{},{get:this.get}))},this.subscribeToEditStart=(E,a)=>{const A=`onEditStart:${E}`;return s.on(A,a),()=>s.off(A,a)},this.subscribeToEditEnd=(E,a)=>{const A=`onEditEnd:${E}`;return s.on(A,a),()=>s.off(A,a)};const x=(E,a,A)=>{const D={};return Object.entries(E).forEach(([V,N])=>{if(V==="")return as(Fn.EMPTY_KEY);let F=AT(a,V);if(N.type===Qi.FOLDER){const ae=x(N.schema,F,A);Object.assign(D,ae),F in h||(h[F]=N.settings)}else if(V in A)as(Fn.DUPLICATE_KEYS,V,F,A[V].path);else{const ae=QP(N,V,F,D);if(ae){const{type:be,options:fe,input:ee}=ae,{onChange:G,transient:X,onEditStart:me,onEditEnd:Te}=fe,We=yn(fe,oL);D[F]=Pt(Pt(Pt({type:be},We),ee),{},{fromPanel:!0}),A[V]={path:F,onChange:G,transient:X,onEditStart:me,onEditEnd:Te}}else as(Fn.UNKNOWN_INPUT,F,N)}}),D};this.getDataFromSchema=E=>{const a={};return[x(E,"",a),a]}},FT=new sL,aL={collapsed:!1};function lL(t,n){return{type:Qi.FOLDER,schema:t,settings:Pt(Pt({},aL),n)}}const cL=t=>"__levaInput"in t,uL=(t,n)=>{const s={},h=n?n.toLowerCase():null;return t.forEach(g=>{const[x,E]=c3(g);(!h||x.toLowerCase().indexOf(h)>-1)&&l3(s,E,{[x]:{__levaInput:!0,path:g}})}),s};function hL({toggle:t,toggled:n,name:s}){return Ft(fz,{onClick:()=>t(),children:[Be(e0,{toggled:n}),Be("div",{children:s})]})}const dL=["type","label","path","valueKey","value","settings","setValue","disabled"];function pL(t){let{type:n,label:s,path:h,valueKey:g,value:x,settings:E,setValue:a,disabled:A}=t,D=yn(t,dL);const{displayValue:V,onChange:N,onUpdate:F}=TE({type:n,value:x,settings:E,setValue:a}),ae=al[n].component;return ae?Be(pE.Provider,{value:Pt({key:g,path:h,id:""+h,label:s,displayValue:V,value:x,onChange:N,onUpdate:F,settings:E,setValue:a,disabled:A},D),children:Be(_z,{disabled:A,children:Be(ae,{})})}):(as(Fn.NO_COMPONENT_FOR_TYPE,n,h),null)}const fL=Ct("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function mL({onClick:t,settings:n,label:s}){const h=sm();return Be(Fi,{children:Be(fL,{disabled:n.disabled,onClick:()=>t(h.get),children:s})})}const gL=Ct("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),_L=Ct("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),yL=({label:t,opts:n})=>{let s=typeof t=="string"&&t.trim()===""?null:t,h=n;return typeof n.opts=="object"&&(h.label!==void 0&&(s=n.label),h=n.opts),{label:s,opts:h}};function vL(t){const{label:n,opts:s}=yL(t),h=sm();return Ft(Fi,{input:!!n,children:[n&&Be(to,{children:n}),Be(gL,{children:Object.entries(s).map(([g,x])=>Be(_L,{onClick:()=>x(h.get),children:g},g))})]})}const xL=Ct("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),$T=100;function bL(t,n){t.push(n),t.length>$T&&t.shift()}const wL=te.exports.forwardRef(function({initialValue:t},n){const s=us("colors","highlight3"),h=us("colors","elevation2"),g=us("colors","highlight1"),[x,E]=te.exports.useMemo(()=>[Kr(g).alpha(.4).toRgbString(),Kr(g).alpha(.1).toRgbString()],[g]),a=te.exports.useRef([t]),A=te.exports.useRef(t),D=te.exports.useRef(t),V=te.exports.useRef(),N=te.exports.useCallback((be,fe)=>{if(!be)return;const{width:ee,height:G}=be,X=new Path2D,me=ee/$T,Te=G*.05;for(let Le=0;Le<a.current.length;Le++){const Ke=im(a.current[Le],A.current,D.current),Ye=me*Le,it=G-Ke*(G-Te*2)-Te;X.lineTo(Ye,it)}fe.clearRect(0,0,ee,G);const We=new Path2D(X);We.lineTo(me*(a.current.length+1),G),We.lineTo(0,G),We.lineTo(0,0);const Pe=fe.createLinearGradient(0,0,0,G);Pe.addColorStop(0,x),Pe.addColorStop(1,E),fe.fillStyle=Pe,fe.fill(We),fe.strokeStyle=h,fe.lineJoin="round",fe.lineWidth=14,fe.stroke(X),fe.strokeStyle=s,fe.lineWidth=2,fe.stroke(X)},[s,h,x,E]),[F,ae]=Cz(N);return te.exports.useImperativeHandle(n,()=>({frame:be=>{(A.current===void 0||be<A.current)&&(A.current=be),(D.current===void 0||be>D.current)&&(D.current=be),bL(a.current,be),V.current=requestAnimationFrame(()=>N(F.current,ae.current))}}),[F,ae,N]),te.exports.useEffect(()=>()=>cancelAnimationFrame(V.current),[]),Be(xL,{ref:F})}),NT=t=>Number.isFinite(t)?t.toPrecision(2):t.toString(),EL=te.exports.forwardRef(function({initialValue:t},n){const[s,h]=te.exports.useState(NT(t));return te.exports.useImperativeHandle(n,()=>({frame:g=>h(NT(g))}),[]),Be("div",{children:s})});function UT(t){return typeof t=="function"?t():t.current}function TL({label:t,objectOrFn:n,settings:s}){const h=te.exports.useRef(),g=te.exports.useRef(UT(n));return te.exports.useEffect(()=>{const x=window.setInterval(()=>{var E;document.hidden||(E=h.current)===null||E===void 0||E.frame(UT(n))},s.interval);return()=>window.clearInterval(x)},[n,s.interval]),Ft(Fi,{input:!0,children:[Be(to,{align:"top",children:t}),s.graph?Be(wL,{ref:h,initialValue:g.current}):Be(EL,{ref:h,initialValue:g.current})]})}const SL=["type","label","key"],CL={[Qi.BUTTON]:mL,[Qi.BUTTON_GROUP]:vL,[Qi.MONITOR]:TL},kL=Nt.memo(({path:t})=>{const[n,{set:s,setSettings:h,disable:g,storeId:x,emitOnEditStart:E,emitOnEditEnd:a}]=Iz(t);if(!n)return null;const{type:A,label:D,key:V}=n,N=yn(n,SL);if(A in Qi){const F=CL[A];return Be(F,bt({label:D,path:t},N))}return A in al?Be(pL,bt({type:A,label:D,storeId:x,path:t,valueKey:V,setValue:s,setSettings:h,disable:g,emitOnEditStart:E,emitOnEditEnd:a},N),x+t):(FP(Fn.UNSUPPORTED_INPUT,A,t),null)}),IL=({name:t,path:n,tree:s})=>{const h=sm(),g=AT(n,t),{collapsed:x,color:E}=h.getFolderSettings(g),[a,A]=te.exports.useState(!x),D=te.exports.useRef(null),V=us("colors","folderWidgetColor"),N=us("colors","folderTextColor");return te.exports.useLayoutEffect(()=>{D.current.style.setProperty("--leva-colors-folderWidgetColor",E||V),D.current.style.setProperty("--leva-colors-folderTextColor",E||N)},[E,V,N]),Ft(lm,{ref:D,children:[Be(hL,{name:t,toggled:a,toggle:()=>A(F=>!F)}),Be(jT,{parent:g,tree:s,toggled:a})]})},jT=Nt.memo(({isRoot:t=!1,fill:n=!1,flat:s=!1,parent:h,tree:g,toggled:x})=>{const{wrapperRef:E,contentRef:a}=d3(x);return Be(Jy,{ref:E,isRoot:t,fill:n,flat:s,children:Be(vE,{ref:a,isRoot:t,toggled:x,children:Object.entries(g).map(([A,D])=>cL(D)?Be(kL,{valueKey:D.valueKey,path:D.path},D.path):Be(IL,{name:A,path:h,tree:D},A))})})}),AL=Ct("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${bE}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),VT=40,gm=Ct("i",{$flexCenter:"",width:VT,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),ML=Ct("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),PL=Ct("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${gm}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),zL=Ct("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),DL=Ct("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:VT}}}}),RL=Nt.forwardRef(({setFilter:t,toggle:n},s)=>{const[h,g]=te.exports.useState(""),x=te.exports.useMemo(()=>aE(t,250),[t]),E=()=>{t(""),g("")},a=A=>{const D=A.currentTarget.value;n(!0),g(D)};return te.exports.useEffect(()=>{x(h)},[h,x]),Ft(rl,{children:[Be(zL,{ref:s,value:h,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:A=>A.stopPropagation(),onChange:a}),Be(gm,{onClick:()=>E(),style:{visibility:h?"visible":"hidden"},children:Be("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor",children:Be("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})})]})});function LL({setFilter:t,onDrag:n,toggle:s,toggled:h,title:g,drag:x,filterEnabled:E}){const[a,A]=te.exports.useState(!1),D=te.exports.useRef(null);te.exports.useEffect(()=>{var N,F;a?(N=D.current)===null||N===void 0||N.focus():(F=D.current)===null||F===void 0||F.blur()},[a]);const V=I2(({offset:[N,F]})=>n({x:N,y:F}),{filterTaps:!0});return te.exports.useEffect(()=>{const N=F=>{F.key==="L"&&F.shiftKey&&F.metaKey&&A(ae=>!ae)};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[]),Ft(rl,{children:[Ft(ML,{mode:x?"drag":void 0,children:[Be(gm,{active:!h,onClick:()=>s(),children:Be(e0,{toggled:h,width:12,height:8})}),Be(DL,Sn(bt({},x?V():{}),{drag:x,filterEnabled:E,children:g===void 0&&x?Ft("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg",children:[Be("circle",{cx:"2",cy:"2",r:"2"}),Be("circle",{cx:"14",cy:"2",r:"2"}),Be("circle",{cx:"26",cy:"2",r:"2"}),Be("circle",{cx:"2",cy:"12",r:"2"}),Be("circle",{cx:"14",cy:"12",r:"2"}),Be("circle",{cx:"26",cy:"12",r:"2"})]}):g})),E&&Be(gm,{active:a,onClick:()=>A(N=>!N),children:Ft("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20",children:[Be("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),Be("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})]})})]}),Be(PL,{toggled:a,children:Be(RL,{ref:D,setFilter:t,toggle:s})})]})}const OL=["store","hidden","theme","collapsed"];function BL(t){let{store:n,hidden:s=!1,theme:h,collapsed:g=!1}=t,x=yn(t,OL);const E=MT(()=>lz(h),[h]),[a,A]=te.exports.useState(!g),D=typeof g=="object"?!g.collapsed:a,V=te.exports.useMemo(()=>typeof g=="object"?N=>{typeof N=="function"?g.onChange(!N(!g.collapsed)):g.onChange(!N)}:A,[g]);return!n||s?null:Be(Ky.Provider,{value:E,children:Be(FL,Sn(bt({store:n},x),{toggled:D,setToggle:V,rootClass:E.className}))})}const FL=Nt.memo(({store:t,rootClass:n,fill:s=!1,flat:h=!1,oneLineLabels:g=!1,titleBar:x={title:void 0,drag:!0,filter:!0},hideCopyButton:E=!1,toggled:a,setToggle:A})=>{var D,V;const N=p3(t),[F,ae]=te.exports.useState(""),be=te.exports.useMemo(()=>uL(N,F),[N,F]),[fe,ee]=SE(),G=N.length>0,X=typeof x=="object"&&x.title||void 0,me=typeof x=="object"&&(D=x.drag)!==null&&D!==void 0?D:!0,Te=typeof x=="object"&&(V=x.filter)!==null&&V!==void 0?V:!0;return Be(mE.Provider,{value:{hideCopyButton:E},children:Ft(AL,{ref:fe,className:n,fill:s,flat:h,oneLineLabels:g,hideTitleBar:!x,style:{display:G?"block":"none"},children:[x&&Be(LL,{onDrag:ee,setFilter:ae,toggle:We=>A(Pe=>We!=null?We:!Pe),toggled:a,title:X,drag:me,filterEnabled:Te}),G&&Be(fE.Provider,{value:t,children:Be(jT,{isRoot:!0,fill:s,flat:h,tree:be,toggled:a})})]})})}),$L=["isRoot"];let _m=!1,ll=null;function NL(t){let{isRoot:n=!1}=t,s=yn(t,$L);return te.exports.useEffect(()=>(_m=!0,!n&&ll&&(ll.remove(),ll=null),()=>{n||(_m=!1)}),[n]),Be(BL,bt({store:FT},s))}function UL(t){te.exports.useEffect(()=>{t&&!_m&&(ll||(ll=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(ll),$w.render(Be(NL,{isRoot:!0}),ll))),_m=!0)},[t])}function jL(t,n,s,h,g){let x,E,a,A,D;return typeof t=="string"?(E=t,x=n,Array.isArray(s)?D=s:s&&("store"in s?(A=s,D=h):(a=s,Array.isArray(h)?D=h:(A=h,D=g)))):(x=t,Array.isArray(n)?D=n:(A=n,D=s)),{schema:x,folderName:E,folderSettings:a,hookSettings:A,deps:D||[]}}function KL(t,n,s,h,g){const{folderName:x,schema:E,folderSettings:a,hookSettings:A,deps:D}=jL(t,n,s,h,g),V=typeof E=="function",N=te.exports.useRef(!1),F=te.exports.useRef(!0),ae=MT(()=>{N.current=!0;const it=typeof E=="function"?E():E;return x?{[x]:lL(it,a)}:it},D),be=!(A!=null&&A.store);UL(be);const[fe]=te.exports.useState(()=>(A==null?void 0:A.store)||FT),[ee,G]=te.exports.useMemo(()=>fe.getDataFromSchema(ae),[fe,ae]),[X,me,Te,We,Pe]=te.exports.useMemo(()=>{const it=[],st=[],ut={},ht={},kt={};return Object.values(G).forEach(({path:Tt,onChange:Gt,onEditStart:nn,onEditEnd:an,transient:In})=>{it.push(Tt),Gt?(ut[Tt]=Gt,In||st.push(Tt)):st.push(Tt),nn&&(ht[Tt]=nn),an&&(kt[Tt]=an)}),[it,st,ut,ht,kt]},[G]),Le=te.exports.useMemo(()=>fe.orderPaths(X),[X,fe]),Ke=f3(fe,me,ee),Ye=te.exports.useCallback(it=>{const st=Object.entries(it).reduce((ut,[ht,kt])=>Object.assign(ut,{[G[ht].path]:kt}),{});fe.set(st,!1)},[fe,G]);return te.exports.useEffect(()=>{const it=!F.current&&N.current;return fe.addData(ee,it),F.current=!1,N.current=!1,()=>fe.disposePaths(Le)},[fe,Le,ee]),te.exports.useEffect(()=>{const it=[];return Object.entries(Te).forEach(([st,ut])=>{ut(fe.get(st),st,Pt({initial:!0,get:fe.get},fe.getInput(st)));const ht=fe.useStore.subscribe(kt=>{const Tt=kt.data[st];return[Tt.disabled?void 0:Tt.value,Tt]},([kt,Tt])=>ut(kt,st,Pt({initial:!1,get:fe.get},Tt)),{equalityFn:td});it.push(ht)}),()=>it.forEach(st=>st())},[fe,Te]),te.exports.useEffect(()=>{const it=[];return Object.entries(We).forEach(([st,ut])=>it.push(fe.subscribeToEditStart(st,ut))),Object.entries(Pe).forEach(([st,ut])=>it.push(fe.subscribeToEditEnd(st,ut))),()=>it.forEach(st=>st())},[We,Pe,fe]),V?[Ke,Ye]:Ke}ls(eo.SELECT,Zz);ls(eo.IMAGE,W3);ls(eo.NUMBER,Lz);ls(eo.COLOR,S3);ls(eo.STRING,Jz);ls(eo.BOOLEAN,oD);ls(eo.INTERVAL,nL);ls(eo.VECTOR3D,k3);ls(eo.VECTOR2D,L3);export{Nt as R,ZL as a,$w as b,Be as j,GL as m,te as r,KL as u};
